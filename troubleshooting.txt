############# OGG-00868 #####################

rman target / catalog rman@rman11d
restore archivelog from sequence 

run
{
 set archivelog destination to '/oragg/blctdmd';
 restore archivelog from sequence 91045;
}


###########
# blcdwsd #
# uxd33   #
# 4/13    #
###########

OGG-00199	Table BLCDWSD.ENT_STAGING.S1_FQQ_LIFEPRO_CIK_SOX_POLCY does not exist in target database.

-- tables missing in Linux DB
ENT_STAGING.DON
ENT_STAGING.DUMMY_S2_DDD_AIM_DAILY_COMSN
ENT_STAGING.S1_FQQ_AWD_SOX_POLCY
ENT_STAGING.S1_FQQ_LIFECM_CPL_SOX_POLCY
ENT_STAGING.S1_FQQ_VNTG_ONE_R12_SOX_POLCY
ENT_STAGING.S1_FQQ_VNTG_ONE_TRAD_SOX_POLCY
ENT_STAGING.XYZUTTAM

-- in Linux, not AIX
S1_FQQ_CAA_SOX_POLICY

-- /oragg/blcdwsd/dmpdir/blcdwsd_ent_staging_tbls.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=blcdwsd_%U.dmp
LOGFILE=blcdwsd_ent_staging_tbls.log
PARALLEL=4
METRICS=Y
TABLES=ENT_STAGING.DON,ENT_STAGING.DUMMY_S2_DDD_AIM_DAILY_COMSN,ENT_STAGING.S1_FQQ_AWD_SOX_POLCY,ENT_STAGING.S1_FQQ_LIFECM_CPL_SOX_POLCY,ENT_STAGING.S1_FQQ_VNTG_ONE_R12_SOX_POLCY,ENT_STAGING.S1_FQQ_VNTG_ONE_TRAD_SOX_POLCY,ENT_STAGING.XYZUTTAM

expdp \"/ as sysdba\" parfile=/oragg/blcdwsd/dmpdir/blcdwsd_ent_staging_tbls.par


-- /database/cblcdwsd_admn01/scripts/impdp_blcdwsd_ent_staging_tbls.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=blcdwsd_%U.dmp
LOGFILE=impdp_blcdwsd_ent_staging_tbls.log
table_exists_action=replace
PARALLEL=4
CLUSTER=Y
METRICS=Y
TRANSFORM=TABLE_COMPRESSION_CLAUSE:"COMPRESS FOR OLTP"
LOGTIME=ALL

impdp \"sys@blcdwsd as sysdba\" parfile=/database/cblcdwsd_admn01/scripts/impdp_blcdwsd_ent_staging_tbls.par


OGG-00199  Table BLCDWSD.ENT_STAGING.S1_FQQ_LIFEPRO_CIK_SOX_POLCY does not exist in target database

-- /oragg/blcdwsd/dmpdir/blcdwsd_ent_staging_tbls2.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=blcdwsd_ent_staging_%U.dmp
LOGFILE=blcdwsd_ent_staging_tbls2.log
PARALLEL=4
METRICS=Y
TABLES=ENT_STAGING.S1_FQQ_LIFEPRO_CIK_SOX_POLCY

expdp \"/ as sysdba\" parfile=/oragg/blcdwsd/dmpdir/blcdwsd_ent_staging_tbls2.par

-- /database/cblcdwsd_admn01/scripts/impdp_blcdwsd_ent_staging_tbls.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=blcdwsd_ent_staging_%U.dmp
LOGFILE=impdp_blcdwsd_ent_staging_tbls2.log
table_exists_action=replace
PARALLEL=4
CLUSTER=Y
METRICS=Y
TRANSFORM=TABLE_COMPRESSION_CLAUSE:"COMPRESS FOR OLTP"
LOGTIME=ALL

impdp \"sys@blcdwsd as sysdba\" parfile=/database/cblcdwsd_admn01/scripts/impdp_blcdwsd_ent_staging_tbls2.par


###########
# infdqd  #
# uxd34   #
# 4/13    #
###########

OGG-01296	Error mapping from INF_DQMREP.PO_REQUESTRESPONSE to INFDQD.INF_DQMREP.PO_REQUESTRESPONSE

edit params
MAPEXCLUDE 
start E

previous cause: no unique key on table with LOB data
for INF_DQMREP.PO_TYPEDELEMENT PK, UK and FK not in Linux DB


-- /oragg/infdqd/dmpdir/expdp_infdqd_indexes.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=infdqd_%U.dmp
LOGFILE=infdqd_indexes.log
PARALLEL=4
METRICS=Y
INCLUDE=INDEX
SCHEMAS=INF_DQMREP,INFDQ_PROFILING,INFDQ_STAGE,INFDQ_DATA_SVCS,INFDQ_DSHBRDRPT_SAMPLE,INF_PCMR,INFDQ_HTWKF,INFDQ_IV9_JASPER,GGTEST

expdp \"/ as sysdba\" parfile=/oragg/infdqd/dmpdir/expdp_infdqd_indexes.par

-- /database/cinfdqd_admn01/scripts/impdp_infdqd_indexonly.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=infdqd_%U.dmp
LOGFILE=impdp_infdqd_indexes.log
table_exists_action=replace
PARALLEL=8
CLUSTER=Y
METRICS=Y
TRANSFORM=TABLE_COMPRESSION_CLAUSE:"COMPRESS FOR OLTP"
LOGTIME=ALL

impdp \"sys@infdqd as sysdba\" parfile=/database/cinfdqd_admn01/scripts/impdp_infdqd_indexonly.par
04/13/2017 16:20:58.676: ORA-39083: Object type INDEX_STATISTICS failed to create with error:
ORA-01403: no data found
ORA-01403: no data found

--select owner, index_name
set long 10000000
set lines 1000 pages 0
set feedback off
set trimspool on
col ddl format a1000
spool /oragg/infdqd/dmpdir/infdqd_unq_indexes.sql
select DBMS_METADATA.GET_DDL('INDEX',INDEX_NAME,OWNER)||';' ddl
from dba_constraints where constraint_type in ('P','U') and owner not in
('GGS','ANONYMOUS','APEX_040200','APPQOSSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE') 
and index_name not like 'BIN$%';


###########
# prodd   #
# uxd33   #
# 4/18    #
###########

-- prodd export
ORA-01466	unable to read data - table definition has changed
-- expdp_prodd_missing.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=prodd_missing_%U.dmp
LOGFILE=expdp_prodd_missing.log
PARALLEL=4
METRICS=Y
EXCLUDE=STATISTICS
TABLES=CINASM.TRANSACTIONS_TMP_DIFF,CCMDAILY.TRANSACTIONS_TMP,CINASM.HOLDINGS_TMP_DIFF,CINASM.HOLD_PRICE_TMP_DIFF,CINASM.HOLDINGS_TMP,CINASM.SEC_PRICE_TMP_DIFF,CCMDAILY.SECURITIES_TMP,CINASM.HOLD_PRICE_TMP,CINASM.TRANSACTIONS_TMP,CINASM.CAM_PRICE_TMP_DIFF,CINASM.SECURITIES_TMP,CCMDAILY.CAM_PRICE_TMP,CCMDAILY.SEC_PRICE_TMP,CINASM.SEC_PRICE_TMP,CCMDAILY.SINK_SCHEDULE_TMP,CINASM.CAM_PRICE_TMP,CINASM.SINK_SCHEDULE_TMP,CCMDAILY.FLOAT_SCHEDULE_TMP,CCMDAILY.ISSUER_TMP,CINASM.FLOAT_SCHEDULE_TMP_DIFF,CCMDAILY.CALL_SCHEDULE_TMP,CINASM.CALL_SCHEDULE_TMP,CINASM.ISSUER_TMP,CINASM.SECURITIES_TMP_DIFF,CCMDAILY.OID_SCHEDULE_TMP,CCMDAILY.PORTFOLIOS_TMP,CCMDAILY.PORT_PRICE_TMP,CCMDAILY.PUT_SCHEDULE_TMP,CCMDAILY.RESTRICTED_SEC_TMP,CCMDAILY.STEP_SCHEDULE_TMP,CCMDAILY.UNCOLLAT_SCHEDULE_TMP,CCMDAILY.BROKER_CONTACT_TMP,CCMDAILY.BROKER_TMP,CCMDAILY.CAMRA_ANALYSTS_TMP,CCMDAILY.CONVERTIBLE_SCHEDULE_TMP,CCMDAILY.CUSTODIAN_ACCT_TMP,CCMDAILY.CUSTODIAN_TMP,CINASM.BROKER_TMP,CINASM.CAMRA_ANALYSTS_TMP,CINASM.CONVERTIBLE_SCHEDULE_TMP,CINASM.CUSTODIAN_ACCT_TMP,CINASM.CUSTODIAN_TMP,CINASM.OID_SCHEDULE_TMP,CINASM.PORTFOLIOS_TMP,CINASM.PUT_SCHEDULE_TMP,CINASM.RESTRICTED_SEC_TMP,CINASM.STEP_SCHEDULE_TMP,CINASM.UNCOLLAT_SCHEDULE_TMP,CINASM.BROKER_CONTACT_TMP,CINASM.CALL_SCHEDULE_TMP_DIFF,CINASM.CUSTODIAN_ACCT_TMP,CINASM.CUSTODIAN_TMP,CINASM.OID_SCHEDULE_TMP,CINASM.PORTFOLIOS_TMP,CINASM.PUT_SCHEDULE_TMP,CINASM.RESTRICTED_SEC_TMP,CINASM.STEP_SCHEDULE_TMP,CINASM.UNCOLLAT_SCHEDULE_TMP,CINASM.BROKER_CONTACT_TMP,CINASM.CALL_SCHEDULE_TMP_DIFF,CINASM.OID_SCHEDULE_TMP_DIFF,CINASM.PORT_PRICE_TMP_DIFF,CINASM.SINK_SCHEDULE_TMP_DIFF,CINASM.UNCOLLAT_SCHEDULE_TMP_DIFF

expdp ggs parfile=expdp_prodd_missing.par

-- impdp_prodd_missing.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=prodd_missing_%U.dmp
LOGFILE=impdp_prodd_missing.log
table_exists_action=replace
PARALLEL=4
CLUSTER=Y
METRICS=Y
TRANSFORM=TABLE_COMPRESSION_CLAUSE:"COMPRESS FOR OLTP"
LOGTIME=ALL

impdp system@prodd parfile=/database/cprodd_admn01/scripts/impdp_prodd_missing.par

-- prodd import
-- external tables (files do not exist; get DDL only)
set long 10000000
col "STMT" format a2500
spool create_ext_tables.sql
select DBMS_METADATA.GET_DDL('TABLE',TABLE_NAME,OWNER)||';' "STMT"
from dba_external_tables;

LP4086                         CQ_TMP_EXT
SYSTEM                         ET$03CE80230001
TRCANLZR                       TRCA_CONTROL
TRCANLZR                       TRCA_EXTENTS_DM
TRCANLZR                       TRCA_EXTENTS_LM
TRCANLZR                       TRCA_FILE
TRCANLZR                       TRCA_INDEXES
TRCANLZR                       TRCA_IND_COLUMNS
TRCANLZR                       TRCA_OBJECTS
TRCANLZR                       TRCA_PARAMETER2
TRCANLZR                       TRCA_SEGMENTS
TRCANLZR                       TRCA_TABLES
TRCANLZR                       TRCA_TAB_COLS


18-APR-17 12:16:11.218: ORA-39083: Object type CONSTRAINT:"CCM_PKG.PK_WORKSTATIONS" failed to create with error:
ORA-01950: no privileges on tablespace 'CCM_SMALL_IDX'
cat 4_create_quotas_prodd.sql | grep CCM_PKG

SET ECHO OFF
SET DEFINE OFF
SET ESCAPE OFF
SET FEEDBACK OFF
SET HEAD ON
SET SERVEROUTPUT ON SIZE 1000000
SET TERMOUT ON
SET TIMING OFF
SET LINES 2500
SET PAGES 0
SET TRIMSPOOL ON
SET LONG 1000000
SET NUMFORMAT 999999999999999990
spool 4_create_quotas_prodd.sql
SELECT 'alter user '|| owner || ' quota UNLIMITED on ' || tablespace_name || ';'
FROM dba_tables
WHERE tablespace_name is not null and owner NOT IN 
('GGS','ANONYMOUS','APEX_040200','APPQOSSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE')
	UNION
SELECT 'alter user '|| owner || ' quota UNLIMITED on ' || tablespace_name || ';'
FROM dba_indexes
WHERE tablespace_name is not null and owner NOT IN 
('GGS','ANONYMOUS','APEX_040200','APPQOSSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE')
	UNION
select 'alter user '|| username ||
	case
		when max_bytes = -1 then ' quota UNLIMITED'
		else ' quota '||to_char(max_bytes)
	end ||
  ' on ' || tablespace_name || ';'
from dba_ts_quotas
WHERE tablespace_name is not null and username NOT IN
('GGS','ANONYMOUS','APEX_040200','APPQOSSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE');

ORA-01843: not a valid month
/database/cprodd_admn01/scripts/default_dates_ddl.sql

-- impdp_prodd_month.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=prodd_%U.dmp
LOGFILE=impdp_prodd_month.log
table_exists_action=truncate
PARALLEL=4
CLUSTER=Y
METRICS=Y
TRANSFORM=TABLE_COMPRESSION_CLAUSE:"COMPRESS FOR OLTP"
LOGTIME=ALL
TABLES=BCHWUD.BEECHWOOD_LOOKUP,BCHWUD.BEECHWOOD_ISSUER_LOOKUP,CCMEOM.PAR_COUPON_TMP,CINYC1.PAR_COUPON_TMP,CINYC1.BEECHWOOD_WILMINGTON_LOOKUP,CINYC1.BEECHWOOD_IGNORE,CINYC1.WILMINGTON_IGNORE,BCHWUD.BEECHWOOD_WILMINGTON_LOOKUP,BCHWUD.BEECHWOOD_IGNORE,BCHWUD.WILMINGTON_IGNORE

impdp system@prodd parfile=impdp_prodd_month.par

set long 10000000
col "STMT" format a2500
select DBMS_METADATA.GET_DDL('TABLE',TABLE_NAME,OWNER)||';' "STMT"
from dba_tables where owner||'.'||table_name in 
('BCHWUD.BEECHWOOD_LOOKUP','BCHWUD.BEECHWOOD_ISSUER_LOOKUP','CCMEOM.PAR_COUPON_TMP','CINYC1.PAR_COUPON_TMP','CINYC1.BEECHWOOD_WILMINGTON_LOOKUP','CINYC1.BEECHWOOD_IGNORE','CINYC1.WILMINGTON_IGNORE','BCHWUD.BEECHWOOD_WILMINGTON_LOOKUP','BCHWUD.BEECHWOOD_IGNORE','BCHWUD.WILMINGTON_IGNORE');


select OWNER||'.'||TABLE_NAME, DATA_DEFAULT
from dba_tab_cols 
where DATA_DEFAULT is not null and DATA_TYPE in ('DATE')
order by 1;

19-APR-17 17:16:54.073: Starting "SYSTEM"."SYS_IMPORT_FULL_01":  "system/********@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAINVD01.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=prodd)))" parfile=/database/cprodd_admn01/scripts/impdp_prodd_2.par 
line 12495	ORA-23421: job number 6908 is not a job in the job queue

DataPump Import (IMPDP) Fails With Errors ORA-39083 ORA-23421 When Importing REFRESH_GROUP (Doc ID 972344.1)
execute impdp by SYSTEM without SCHEMAS parameter

ORA-01843: not a valid month - REFRESH_GROUP
"CAIRO"."BENCHMARK_RATES_VIEW"
"CAIRO"."COMP_LOB_PRICE_MVIEW"
"CAIRO"."CRE_SUMMARY_MVIEW"
"CAIRO"."FITCH_CHANGE_MVIEW"
"CAIRO"."LOBSMU"
"CAIRO"."MOODY_CHANGE_MVIEW"
"CAIRO"."PRICE_CHANGE_MVIEW"
"CAIRO"."RATING_CHANGE_UNION_MVIEW"
"CAIRO"."RATING_CHANGE_UNION_MVIEW_SB"
"CAIRO"."RATING_WATCH_MVIEW"
"CAIRO"."RATING_WATCH_UNION_MVIEW"
"CAIRO"."S_P_CHANGE_MVIEW"
"CAIROSTAGE"."BENCHMARK_RATES_VIEW"
"CAIROSTAGE"."CRE_SUMMARY_MVIEW"

select RNAME, ROWNER from DBA_REFRESH order by 1,2;

-- /database/cprodd_admn01/scripts/impdp_prodd_refreshgroups.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=prodd_%U.dmp
LOGFILE=impdp_proddi_refresh_groups.log
table_exists_action=replace
PARALLEL=4
INCLUDE=REFRESH_GROUP

impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAINVD01.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=prodd)))\" parfile=impdp_prodd_refreshgroups.par
ORA-39083: Object type REFRESH_GROUP:"CAIRO"."FITCH_CHANGE_MVIEW" failed to create with error:
ORA-39083: Object type REFRESH_GROUP:"CAIRO"."MOODY_CHANGE_MVIEW" failed to create with error:
ORA-39083: Object type REFRESH_GROUP:"CAIRO"."S_P_CHANGE_MVIEW" failed to create with error:
ORA-39083: Object type REFRESH_GROUP:"CCMDAILY"."BEC_TEST_REFRESH" failed to create with error:
ORA-39083: Object type REFRESH_GROUP:"CCMDAILY"."EIA_ASSET_MVIEW" failed to create with error:
ORA-39083: Object type REFRESH_GROUP:"CCMDAILY"."EIA_LIAB_WEEK_MVIEW" failed to create with error:

ORA-23421: job number 1328 is not a job in the job queue

set lines 2500
set pages 0
set feedback off
set trimspool on
set long 10000000
col "STMT" format a2500
spool refresh_groups_prodd.sql
select DBMS_METADATA.GET_DDL('REFRESH_GROUP',RNAME,ROWNER)||chr(10)||'/' "STMT"
from DBA_REFRESH;

scp refresh_groups_prodd.sql lxorainvd01:/database/cprodd_admn01/scripts

@refresh_groups_prodd.sql
ORA-23401: materialized view "CCMDAILY"."EIA_ASSET_MVIEW" does not exist
ORA-23401: materialized view "CCMDAILY"."EIA_LIAB_WEEK_MVIEW" does not exist
ORA-01435: user does not exist


-- before creating 
col job format 99990
col what format a70
select job, what from dba_jobs order by 1;
   JOB WHAT
------ ----------------------------------------------------------------------
     1 dbms_refresh.refresh('"CAIRO"."BENCHMARK_RATES_VIEW"');
     3 dbms_refresh.refresh('"CAIRO"."S_P_CHANGE_MVIEW"');
    21 dbms_refresh.refresh('"CAIRO"."BENCHMARK_RATES_VIEW"');
  1326 dbms_refresh.refresh('"CAIRO"."MOODY_CHANGE_MVIEW"');
  1327 dbms_refresh.refresh('"CAIRO"."S_P_CHANGE_MVIEW"');
  1328 dbms_refresh.refresh('"CAIRO"."FITCH_CHANGE_MVIEW"');
  1346 dbms_refresh.refresh('"CAIRO"."PRICE_CHANGE_MVIEW"');
  1390 dbms_refresh.refresh('"CAIRO"."RATING_CHANGE_UNION_MVIEW"');
  1415 dbms_refresh.refresh('"CAIRO"."RATING_WATCH_UNION_MVIEW"');
  1416 dbms_refresh.refresh('"CAIRO"."RATING_WATCH_MVIEW"');
  1525 dbms_refresh.refresh('"CAIRO"."CRE_SUMMARY_MVIEW"');
  1563 dbms_refresh.refresh('"CAIRO"."BENCHMARK_RATES_VIEW"');
  1564 dbms_refresh.refresh('"CAIRO"."TOTAL_RISK_AGGREGATION"');
  5527 dbms_refresh.refresh('"CAIRO"."RATING_CHANGE_UNION_MVIEW"');
  5787 dbms_refresh.refresh('"CAIRO"."RATING_CHANGE_UNION_MVIEW_SB"');
  5971 dbms_refresh.refresh('"CAIRO"."RATING_WATCH_MVIEW"');
  6207 dbms_refresh.refresh('"CAIRO"."RATING_WATCH_UNION_MVIEW"');
  6787 dbms_refresh.refresh('"CAIRO"."PRICE_CHANGE_MVIEW"');
  6947 dbms_refresh.refresh('"CAIRO"."COMP_LOB_PRICE_MVIEW"');
  7387 dbms_refresh.refresh('"CAIRO"."LOBSMU"');
  7828 dbms_refresh.refresh('"CAIRO"."CRE_SUMMARY_MVIEW"');
  7848 dbms_refresh.refresh('"CAIROSTAGE"."CRE_SUMMARY_MVIEW"');
  9468 dbms_refresh.refresh('"CAIROSTAGE"."BENCHMARK_RATES_VIEW"');
  9530 dbms_refresh.refresh('"CAIRO"."BENCHMARK_RATES_VIEW"');
 
-- after creating refresh groups
   JOB WHAT
------ ----------------------------------------------------------------------
     1 dbms_refresh.refresh('"CAIRO"."BENCHMARK_RATES_VIEW"');
     3 dbms_refresh.refresh('"CAIRO"."S_P_CHANGE_MVIEW"');
    21 dbms_refresh.refresh('"CAIRO"."BENCHMARK_RATES_VIEW"');
    41 dbms_refresh.refresh('"CAIRO"."COMP_LOB_PRICE_MVIEW"');
    42 dbms_refresh.refresh('"CAIRO"."CRE_SUMMARY_MVIEW"');
    43 dbms_refresh.refresh('"CAIRO"."FITCH_CHANGE_MVIEW"');
    44 dbms_refresh.refresh('"CAIRO"."LOBSMU"');
    45 dbms_refresh.refresh('"CAIRO"."MOODY_CHANGE_MVIEW"');
    46 dbms_refresh.refresh('"CAIRO"."PRICE_CHANGE_MVIEW"');
    47 dbms_refresh.refresh('"CAIRO"."RATING_CHANGE_UNION_MVIEW"');
    48 dbms_refresh.refresh('"CAIRO"."RATING_CHANGE_UNION_MVIEW_SB"');
    49 dbms_refresh.refresh('"CAIRO"."RATING_WATCH_MVIEW"');
    50 dbms_refresh.refresh('"CAIRO"."RATING_WATCH_UNION_MVIEW"');
    51 dbms_refresh.refresh('"CAIROSTAGE"."BENCHMARK_RATES_VIEW"');
    52 dbms_refresh.refresh('"CAIROSTAGE"."CRE_SUMMARY_MVIEW"');
    53 dbms_refresh.refresh('"CCMDAILY"."BEC_TEST_REFRESH"');
  1326 dbms_refresh.refresh('"CAIRO"."MOODY_CHANGE_MVIEW"');
  1327 dbms_refresh.refresh('"CAIRO"."S_P_CHANGE_MVIEW"');
  1328 dbms_refresh.refresh('"CAIRO"."FITCH_CHANGE_MVIEW"');
  1346 dbms_refresh.refresh('"CAIRO"."PRICE_CHANGE_MVIEW"');
  1390 dbms_refresh.refresh('"CAIRO"."RATING_CHANGE_UNION_MVIEW"');
  1415 dbms_refresh.refresh('"CAIRO"."RATING_WATCH_UNION_MVIEW"');
  1416 dbms_refresh.refresh('"CAIRO"."RATING_WATCH_MVIEW"');
  1525 dbms_refresh.refresh('"CAIRO"."CRE_SUMMARY_MVIEW"');
  1563 dbms_refresh.refresh('"CAIRO"."BENCHMARK_RATES_VIEW"');
  1564 dbms_refresh.refresh('"CAIRO"."TOTAL_RISK_AGGREGATION"');
  5527 dbms_refresh.refresh('"CAIRO"."RATING_CHANGE_UNION_MVIEW"');
  5787 dbms_refresh.refresh('"CAIRO"."RATING_CHANGE_UNION_MVIEW_SB"');
  5971 dbms_refresh.refresh('"CAIRO"."RATING_WATCH_MVIEW"');
  6207 dbms_refresh.refresh('"CAIRO"."RATING_WATCH_UNION_MVIEW"');
  6787 dbms_refresh.refresh('"CAIRO"."PRICE_CHANGE_MVIEW"');
  6947 dbms_refresh.refresh('"CAIRO"."COMP_LOB_PRICE_MVIEW"');
  7387 dbms_refresh.refresh('"CAIRO"."LOBSMU"');
  7828 dbms_refresh.refresh('"CAIRO"."CRE_SUMMARY_MVIEW"');
  7848 dbms_refresh.refresh('"CAIROSTAGE"."CRE_SUMMARY_MVIEW"');
  9468 dbms_refresh.refresh('"CAIROSTAGE"."BENCHMARK_RATES_VIEW"');
  9530 dbms_refresh.refresh('"CAIRO"."BENCHMARK_RATES_VIEW"');
37 rows selected.



ORA-39083: Object type CONSTRAINT:"LP4086"."PK_LP_HPI_ZIP" failed to create with error:
ORA-02437: cannot validate (LP4086.PK_LP_HPI_ZIP) - primary key violated
Failing sql is:
ALTER TABLE "LP4086"."LP_HPI_ZIP" ADD CONSTRAINT "PK_LP_HPI_ZIP" PRIMARY KEY ("STATE_CODE", "FIPS_CODE", "ZIP_CODE", "DATA_PERIOD", "TIER_CODE") USING INDEX (CREATE UNIQUE INDEX "LP4086"."PK_LP_HPI_ZIP" ON "LP4086"."LP_HPI_ZIP" ("STATE_CODE", "FIPS_CODE", "ZIP_CODE", "DATA_PERIOD", "TIER_CODE") PCTFREE 10 INITRANS 2 MAXTRANS 255 NOLO

set long 40
col owner format a20
col constraint_name format a30
col column_name format a30
select dc.owner, dc.constraint_name, col.column_name, dc.constraint_type, dc.status
from dba_constraints dc join dba_cons_columns col
  on dc.constraint_name = col.constraint_name
where dc.owner not in 
order by dc.constraint_type desc, dc.constraint_name asc;
OWNER                CONSTRAINT_NAME                COLUMN_NAME                    C STATUS
-------------------- ------------------------------ ------------------------------ - --------
LP4086               PK_LP_HPI_ZIP                  STATE_CODE                     P ENABLED
LP4086               PK_LP_HPI_ZIP                  FIPS_CODE                      P ENABLED
LP4086               PK_LP_HPI_ZIP                  TIER_CODE                      P ENABLED
LP4086               PK_LP_HPI_ZIP                  DATA_PERIOD                    P ENABLED
LP4086               PK_LP_HPI_ZIP                  ZIP_CODE                       P ENABLED


ALTER TABLE "LP4086"."LP_HPI_ZIP" ADD CONSTRAINT "PK_LP_HPI_ZIP" PRIMARY KEY ("STATE_CODE", "FIPS_CODE", "ZIP_CODE", "DATA_PERIOD", "TIER_CODE")
USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 NOLOGGING
STORAGE(INITIAL 5242880 NEXT 5242880 MINEXTENTS 1 MAXEXTENTS 2147483645
PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
TABLESPACE "LP4086_CQ_D"
enable novalidate;
ORA-02437: cannot validate (LP4086.PK_LP_HPI_ZIP) - primary key violated

ALTER INDEX "LP4086"."PK_LP_HPI_ZIP"  UNUSABLE ENABLE;



/*--- DB links ---*/

--*** AIX***
set lines 150 pages 200
col db_link format a30
col host format a118
select db_link, host from dba_db_links order by 1;
DB_LINK                        HOST
------------------------------ ----------------------------------------------------------------------------------------------------------------------
CAMRALINK                      (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=proddtocamramainut)) (HS=OK))
CAMRALINK1                     (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=sqlprod4086tocamra)) (HS=OK))
CAMRARUNTIME                   (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=proddtocamramainprod)) (HS=OK))
CAMRA_UAT                      (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=proddtocamramainuat)) (HS=OK))
I1NTSAS_LINK                   (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=proddtoi1ntsassqldb)) (HS=OK))
LMS                            (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=sqllms4086tout)) (HS=OK))
LMSBETA                        (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=sql2k54086touat)) (HS=OK))
LMSRUNTIME                     (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=orauttolmsv10prod)) (HS=OK))
LMS_V10_RO                     (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=sql2k54086)) (HS=OK))
LPBETA                         (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = lperfm_pkg.conseco.com)(PORT= 1521))) (CONNECT_DATA = (SID = lperfm)))
LPLINK                         (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prodd_pkg.conseco.com)(PORT= 1521))) (CONNECT_DATA = (SID = prodd)))
MCAMRALINK                     (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=proddtomcamra4086prod)) (HS=OK))
PMBETA                         (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prodm_pkg.conseco.com)(PORT= 1521))) (CONNECT_DATA = (SID = prodm)))
PMRUNTIME                      (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prod_pkg.conseco.com)(PORT =1521))) (CONNECT_DATA = (SID = prod)))
PMSIT                          (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prodt-pkg.conseco.com)(PORT= 1521))) (CONNECT_DATA =(SID = prodt)))
PRODLINK                       10.11.194.46:1521/PRODD
PRTEST                         (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prodd_pkg.conseco.com)(PORT= 1521))) (CONNECT_DATA = (SID = trmpd)))
TRADELINK                      (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = trmpd_pkg.conseco.com)(PORT= 1521))) (CONNECT_DATA = (SID = trmpd)))
TRBETA                         (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = trmpm_pkg.conseco.com)(PORT= 1521))) (CONNECT_DATA = (SID = trmpm)))
TRRUNTIME                      (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = trmp_pkg.conseco.com)(PORT =1521))) (CONNECT_DATA = (SID = trmp)))
TRTEST                         (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = trmpd_pkg.conseco.com)(PORT= 1521)))(CONNECT_DATA = (SID = trmpd)))


select 'select sysdate from dual@'||db_link||';' from dba_db_links order by 1;
select sysdate from dual@CAMRALINK1;
select sysdate from dual@CAMRALINK;
select sysdate from dual@CAMRARUNTIME;
select sysdate from dual@CAMRA_UAT;
select sysdate from dual@I1NTSAS_LINK;
select sysdate from dual@LMS;				-- not working
select sysdate from dual@LMSBETA;

select sysdate from dual@LMSRUNTIME;
select sysdate from dual@LMS_V10_RO;
select sysdate from dual@LPBETA;
select sysdate from dual@LPLINK;
select sysdate from dual@MCAMRALINK;
select sysdate from dual@ORA_DSGD_DBL;
select sysdate from dual@ORA_DSGP_DBL;
select sysdate from dual@PMBETA;
select sysdate from dual@PMRUNTIME;
select sysdate from dual@PMSIT;
select sysdate from dual@PRODLINK;
select sysdate from dual@PRTEST;
select sysdate from dual@TRADELINK;
select sysdate from dual@TRBETA;
select sysdate from dual@TRRUNTIME;
select sysdate from dual@TRTEST;

-- /nomove/app/oracle/gateway/11g/6/hs/admin
scp initproddtocamramainut.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin
scp initsqlprod4086tocamra.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin
scp initproddtocamramainprod.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin
scp initproddtocamramainuat.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin
scp initproddtoi1ntsassqldb.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin
scp initsqllms4086tout.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin
scp initsql2k54086touat.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin
scp initorauttolmsv10prod.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin
scp initsql2k54086.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin
scp initproddtomcamra4086prod.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin

-- /move/ODBC_Progress/Connect64forODBC71

-- listener.ora
SID_LIST_LISTENER =
  (SID_LIST =
      (SID_DESC =
         (SID_NAME = PLSExtProc)
         (ORACLE_HOME = /nomove/app/oracle/db/11g/6)
         (PROGRAM = extproc)
      )
      (SID_DESC=
         (SID_NAME=proddtocamra4086prod)
         (ORACLE_HOME=/nomove/app/oracle/gateway/11g/6)
         (PROGRAM=dg4odbc)
         (ENVS=LIBPATH=/move/ODBC_Progress/Connect64forODBC71/lib:/nomove/app/oracle/gateway/11g/6)
      )
  )


--*** Linux ***
set lines 150 pages 200
col db_link format a30
col host format a118
select db_link, host from dba_db_links order by 1;
(same as above)

-- /app/oracle/product/gateway/12c/1/hs/admin/initproddtocamramainut.ora
HS_FDS_CONNECT_INFO = PRODDTOCAMRAMAINUT
HS_FDS_TRACE_LEVEL = 0
HS_FDS_SHAREABLE_NAME = /usr/lib64/libodbc.so
HS_FDS_TRACE_FILE_NAME = /app/oracle/product/gateway/12c/1/hs/admin/
set ODBCINI=/etc/odbc.ini

set LIBPATH=/usr/lib64

-- /etc/odbc.ini (must use root to edit)

-- listener.ora
SID_LIST_LISTENER =
  (SID_LIST =
      (SID_DESC =
         (SID_NAME = PLSExtProc)
         (ORACLE_HOME = /app/oracle/product/db/12c/1)
         (PROGRAM = extproc)
      )
      (SID_DESC=
         (SID_NAME=proddtocamramainut)
         (ORACLE_HOME=/app/oracle/product/gateway/12c/1)
         (PROGRAM=dg4odbc)
         (ENVS=LIBPATH=/usr/lib64:/app/oracle/product/gateway/12c/1)
      )
      (SID_DESC=
         (SID_NAME=sqlprod4086tocamra)
         (ORACLE_HOME=/app/oracle/product/gateway/12c/1)
         (PROGRAM=dg4odbc)
         (ENVS=LIBPATH=/usr/lib64:/app/oracle/product/gateway/12c/1)
      )
      (SID_DESC=
         (SID_NAME=proddtocamramainprod)
         (ORACLE_HOME=/app/oracle/product/gateway/12c/1)
         (PROGRAM=dg4odbc)
         (ENVS=LIBPATH=/usr/lib64:/app/oracle/product/gateway/12c/1)
      )
      (SID_DESC=
         (SID_NAME=proddtocamramainuat)
         (ORACLE_HOME=/app/oracle/product/gateway/12c/1)
         (PROGRAM=dg4odbc)
         (ENVS=LIBPATH=/usr/lib64:/app/oracle/product/gateway/12c/1)
      )
      (SID_DESC=
         (SID_NAME=proddtoi1ntsassqldb)
         (ORACLE_HOME=/app/oracle/product/gateway/12c/1)
         (PROGRAM=dg4odbc)
         (ENVS=LIBPATH=/usr/lib64:/app/oracle/product/gateway/12c/1)
      )
      (SID_DESC=
         (SID_NAME=sqllms4086tout)
         (ORACLE_HOME=/app/oracle/product/gateway/12c/1)
         (PROGRAM=dg4odbc)
         (ENVS=LIBPATH=/usr/lib64:/app/oracle/product/gateway/12c/1)
      )
      (SID_DESC=
         (SID_NAME=sql2k54086touat)
         (ORACLE_HOME=/app/oracle/product/gateway/12c/1)
         (PROGRAM=dg4odbc)
         (ENVS=LIBPATH=/usr/lib64:/app/oracle/product/gateway/12c/1)
      )
      (SID_DESC=
         (SID_NAME=orauttolmsv10prod)
         (ORACLE_HOME=/app/oracle/product/gateway/12c/1)
         (PROGRAM=dg4odbc)
         (ENVS=LIBPATH=/usr/lib64:/app/oracle/product/gateway/12c/1)
      )
      (SID_DESC=
         (SID_NAME=sql2k54086)
         (ORACLE_HOME=/app/oracle/product/gateway/12c/1)
         (PROGRAM=dg4odbc)
         (ENVS=LIBPATH=/usr/lib64:/app/oracle/product/gateway/12c/1)
      )
      (SID_DESC=
         (SID_NAME=proddtomcamra4086prod)
         (ORACLE_HOME=/app/oracle/product/gateway/12c/1)
         (PROGRAM=dg4odbc)
         (ENVS=LIBPATH=/usr/lib64:/app/oracle/product/gateway/12c/1)
      )
  )
  
lsnrctl stop
lsnrctl start

set lines 150 pages 200
set long 10000000
select DBMS_METADATA.GET_DDL('DB_LINK','CAMRALINK','PUBLIC') from dual;

DROP PUBLIC DATABASE LINK "CAMRALINK";

CREATE PUBLIC DATABASE LINK "CAMRALINK"
CONNECT TO "CAMRA4086" IDENTIFIED BY &pwd
USING '(DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=LXORAINVD01.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=proddtocamramainut)) (HS=OK))';

select '1' from dual@CAMRALINK;

SET ECHO ON
SET DEFINE ON
SET ESCAPE OFF
SET FEEDBACK OFF
SET HEAD ON
SET SERVEROUTPUT ON SIZE 1000000
SET TERMOUT ON
SET TIMING OFF
SET LINES 200
SET PAGES 0
SET TRIMSPOOL ON
SET LONG 10000000
SET NUMFORMAT 999999999999999990
col "STMT" format a2500
spool recreate_db_links_prodd.sql
select case
	when OWNER='PUBLIC' then 'DROP PUBLIC DATABASE LINK '
	else 'DROP DATABASE LINK '||OWNER||'.'
	end
	||DB_LINK||';' "STMT"
from dba_db_links where upper(HOST) like '%HS%';

select DBMS_METADATA.GET_DDL('DB_LINK',DB_LINK,OWNER)||';' "STMT"
from dba_db_links where upper(HOST) like '%HS%';
spool off

vim recreate_db_links_prodd.sql

CREATE PUBLIC DATABASE LINK "CAMRALINK1"
   CONNECT TO "Camra4086" IDENTIFIED BY "footb@ll12"
   USING '(DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=LXORAINVD01.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=sqlprod4086tocamra)) (HS=OK))';

select 'select sysdate from dual@'||db_link||';' from dba_db_links where upper(HOST) like '%HS%' order by 1;
select sysdate from dual@CAMRALINK1;		-- good
select sysdate from dual@CAMRALINK;			-- good
select sysdate from dual@CAMRARUNTIME;		-- good
select sysdate from dual@CAMRA_UAT;			-- good
select sysdate from dual@I1NTSAS_LINK;		-- good
select sysdate from dual@LMS;				-- doesn't work on AIX
select sysdate from dual@LMSBETA;			-- 
ORA-28500: connection from ORACLE to a non-Oracle system returned this message:
[DataDirect][ODBC SQL Server Wire Protocol driver][SQL Server]Cannot open database "lms" requested by the login. The login failed. {08001,NativeErr =
4060}[DataDirect][ODBC SQL Server Wire Protocol driver][SQL Server]Login failed for user 'lms4086data'. {28000,NativeErr = 18456}
ORA-02063: preceding 2 lines from LMSBETA

select sysdate from dual@LMSRUNTIME;		-- good
select sysdate from dual@LMS_V10_RO;		-- 
ORA-01017: invalid username/password; logon denied
[DataDirect][ODBC SQL Server Wire Protocol driver][SQL Server]Login failed for user 'LMS4086Data'. {28000,NativeErr = 18456}
ORA-02063: preceding 2 lines from LMS_V10_RO

select sysdate from dual@MCAMRALINK;		-- good

set lines 150 pages 200
col owner format a25
col db_link format a25
col host format a95
select OWNER, DB_LINK, HOST
from dba_db_links where upper(HOST) not like '%HS%'
order by 1;
OWNER                     DB_LINK                   HOST
------------------------- ------------------------- -----------------------------------------------------------------------------------------------
PUBLIC                    TRTEST                    (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = trmpd_pkg.conseco.com)(PORT = 1521)))(CONNECT_DATA = (SID = trmpd)))
PUBLIC                    TRRUNTIME                 (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = trmp_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = trmp)))
PUBLIC                    TRBETA                    (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = trmpm_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = trmpm)))
PUBLIC                    TRADELINK                 (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = trmpd_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = trmpd)))
PUBLIC                    PRTEST                    (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prodd_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = trmpd)))
PUBLIC                    PRODLINK                  10.11.194.46:1521/PRODD
PUBLIC                    DSGD_DBL                  (DESCRIPTION = (ADDRESS_LIST = (ADDRESS= (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = dsgd_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = dsgd)))
PUBLIC                    PMRUNTIME                 (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prod_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = prod)))
PUBLIC                    PMBETA                    (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prodm_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = prodm)))
PUBLIC                    LPLINK                    (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prodd_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = prodd)))
PUBLIC                    LPBETA                    (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = lperfm_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = lperfm)))
PUBLIC                    DSGP_DBL                  (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = dsgp_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = dsgp)))
PUBLIC                    PMSIT                     (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prodt-pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA =(SID = prodt)))

select 'select sysdate from dual@'||db_link||';' from dba_db_links where upper(HOST) not like '%HS%' order by 1;
select sysdate from dual@DSGD_DBL;
select sysdate from dual@DSGP_DBL;
select sysdate from dual@LPBETA;		-- doesn't work on AIX
ORA-12505: TNS:listener does not currently know of SID given in connect descriptor
select sysdate from dual@LPLINK;		-- good
select sysdate from dual@PMBETA;		-- good
select sysdate from dual@PMRUNTIME;		-- good
select sysdate from dual@PMSIT;			-- good
select sysdate from dual@PRODLINK;		--
ORA-12154: TNS:could not resolve the connect identifier specified
 
select sysdate from dual@PRTEST;		-- good
select sysdate from dual@TRADELINK;		-- good
select sysdate from dual@TRBETA;		-- good
select sysdate from dual@TRRUNTIME;		-- good
select sysdate from dual@TRTEST;		-- good

ALTER SESSION CLOSE DATABASE LINK &what_link;

CREATE PUBLIC DATABASE LINK "PRODLINK"
CONNECT TO "DBLINK" IDENTIFIED BY VALUES ':1'
USING '10.11.194.46:1521/PRODD';

CREATE PUBLIC DATABASE LINK "LPBETA"
CONNECT TO "DBLINK_READONLY" IDENTIFIED BY VALUES ':1'
USING '(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = lperfm_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = lperfm)))';

DROP PUBLIC DATABASE LINK "PRODLINK";
CREATE PUBLIC DATABASE LINK "PRODLINK"
USING '(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prodd_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = prodd)))';

DROP PUBLIC DATABASE LINK "LPBETA";
CREATE PUBLIC DATABASE LINK "LPBETA"
USING '(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = lperfm_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = lperfm)))';


/*** GoldenGate Replicat ***/

RPRODD1
2017-04-21 14:54:24  WARNING OGG-01154  SQL error 1 mapping CCMWEB.CAIRO_SESSIONS to PRODD.CCMWEB.CAIRO_SESSIONS OCI Error ORA-00001: unique constraint (CC
EB.PK_CAIRO_SESSIONS) violated (status = 1), SQL <INSERT INTO "CCMWEB"."CAIRO_SESSIONS" ("SESSION_ID","USER_ID","VALID","START_DATE","START_TIME","END_DATE
"END_TIME","IP_ADDRESS") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7)>.
2017-04-21 14:54:24  ERROR   OGG-01296  Error mapping from CCMWEB.CAIRO_SESSIONS to PRODD.CCMWEB.CAIRO_SESSIONS.

-- RPRODD1.dsc
Aborting transaction on /app/oracle/product/ggate/12c/1/dirdat/prodd/ra beginning at seqno 7 rba 591777142
                         error at seqno 7 rba 591777142
SESSION_ID = CAI20170330083720

-- aix DB
alter session set nls_date_format='MM/DD/YYY HH24:MI:SS';
select * from CCMWEB.CAIRO_SESSIONS where SESSION_ID = 'CAI20170330083720';
SESSION_ID        USER_ID    V START_DATE         START_TIM END_DATE           END_TIME  IP_ADDRESS
----------------- ---------- - ------------------ --------- ------------------ --------- ------------------------------
CAI20170330083720 cnogj7     T 03/30/017 00:00:00 08:37:20                               linux07/10.11.149.157

-- linux DB
SESSION_ID        USER_ID    V START_DATE         START_TIM END_DATE           END_TIME  IP_ADDRESS
----------------- ---------- - ------------------ --------- ------------------ --------- ------------------------------
CAI20170330083720 cnogj7     T 03/30/017 00:00:00 08:37:20                               linux07/10.11.149.157

delete from CCMWEB.CAIRO_SESSIONS where SESSION_ID = 'CAI20170330083720';
ORA-02292: integrity constraint (CCMWEB.FK_CAIRO_SERVICE_TRACKING2) violated - child record found

--- Possible Cause of Ora-1: Unique Constraint Violation Error in Replicat (Doc ID 1342233.1) ---
> cat EPRODD17.rpt | grep CAIRO_SESSIONS
2017-04-18 08:46:09  INFO    OGG-06509  Using the following key columns for source table CCMWEB.CAIRO_SESSIONS: SESSION_ID.

> cat RPRODD12.rpt | grep CAIRO_SESSIONS
2017-04-20 10:10:14  INFO    OGG-06510  Using the following key columns for target table PRODD.CCMWEB.CAIRO_SESSIONS: SESSION_ID.

-- linux DB
set lines 150 pages 200
col "TRIGGER" format a40
col description format a65
col status format a12
SELECT dt.owner||'.'||dt.trigger_name "TRIGGER", dt.status, dt.description
FROM dba_triggers dt
WHERE dt.table_owner='CCMWEB' and dt.table_name='CAIRO_SESSIONS';
TRIGGER                                  STATUS       DESCRIPTION
---------------------------------------- ------------ -----------------------------------------------------------------
AUDITOR.WEB_CAIRO_SION_TG                ENABLED      web_cairo_sion_tg
                                                      after update of  END_DATE, END_TIME, IP_ADDRESS, SESSION_ID, STAR
                                                      T_DATE, START_TIME, USER_ID, VALID on ccmweb.cairo_sessions
                                                      for each row
AUDITOR.WEB_CAIRO_SION_INS_TG            ENABLED      web_cairo_sion_ins_tg
                                                      after insert on ccmweb.cairo_sessions
                                                      for each row
AUDITOR.WEB_CAIRO_SION_DEL_TG            ENABLED      web_cairo_sion_del_tg
                                                      after delete on ccmweb.cairo_sessions
                                                      for each row

view params RPRODD1
DBOPTIONS SUPPRESSTRIGGERS

-- aix
select count(*) from CCMWEB.CAIRO_SERVICE_TRACKING where SESSION_ID = 'CAI20170330083720';
176

-- linux
176

set lines 150 pages 200
select 'select sysdate from dual@'||db_link||';' from dba_db_links order by 1;
select sysdate from dual@CAMRALINK;			-- good
select sysdate from dual@CAMRARUNTIME;		-- good
select sysdate from dual@DSGD_DBL;			-- ORA-12505: TNS:listener does not currently know of SID given in connect descriptor
select sysdate from dual@DSGP_DBL;			-- good
select sysdate from dual@LMS;				-- good
select sysdate from dual@LMSBETA;			-- doesn't work on AIX
select sysdate from dual@LMSRUNTIME;		-- good
select sysdate from dual@MCAMRALINK;		-- good
select sysdate from dual@PMBETA;			-- good
select sysdate from dual@PMRUNTIME;			-- good
select sysdate from dual@PRBETA;			-- good
select sysdate from dual@PRODLINK;			-- good
select sysdate from dual@PRTEST;			-- good
select sysdate from dual@TRADELINK;			-- ORA-12505: TNS:listener does not currently know of SID given in connect descriptor
select sysdate from dual@TRBETA;			-- good
select sysdate from dual@TRRUNTIME;			-- good
select sysdate from dual@TRSIT;				-- good
select sysdate from dual@TRTEST;			-- ORA-12505: TNS:listener does not currently know of SID given in connect descriptor

col db_link format a30
col host format a100
select db_link, host from dba_db_links where db_link in ('DSGD_DBL','TRADELINK','TRTEST');
DB_LINK                        HOST
------------------------------ ----------------------------------------------------------------------------------------------------
DSGD_DBL                       (DESCRIPTION = (ADDRESS_LIST = (ADDRESS= (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = dsgd_pkg.co
                               nseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = dsgd)))
TRTEST                         (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = trmpd_pkg.
                               conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = trmpd)))
TRADELINK                      (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = trmpd_pkg.
                               conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = trmpd)))

SET ECHO ON
SET DEFINE ON
SET ESCAPE OFF
SET FEEDBACK OFF
SET HEAD ON
SET SERVEROUTPUT ON SIZE 1000000
SET TERMOUT ON
SET TIMING OFF
SET LINES 200
SET PAGES 0
SET TRIMSPOOL ON
SET LONG 10000000
SET NUMFORMAT 999999999999999990
col "STMT" format a2500
spool recreate_db_links2.sql
select case
	when OWNER='PUBLIC' then 'DROP PUBLIC DATABASE LINK '
	else 'DROP DATABASE LINK '||OWNER||'.'
	end
	||DB_LINK||';' "STMT"
from dba_db_links where db_link in ('DSGD_DBL','TRADELINK','TRTEST');

select DBMS_METADATA.GET_DDL('DB_LINK',DB_LINK,OWNER)||';' "STMT"
from dba_db_links where db_link in ('DSGD_DBL','TRADELINK','TRTEST');
spool off

-- impdp_db_link_prodd.par
logfile=impdp_db_link_prodd.log
directory=CNO_MIGRATE
dumpfile=prodd_metadata_%U.dmp
METRICS=Y
INCLUDE=DB_LINK:"in ('TRADELINK','TRTEST')"
FULL=Y
CONTENT=METADATA_ONLY

impdp \"sys@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAINVD01.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=prodd))) as sysdba\" parfile=impdp_db_link_prodd.par

select sysdate from dual@DSGD_DBL;			-- good
select sysdate from dual@TRADELINK;			-- good
select sysdate from dual@TRTEST;			-- good



############
# TRMPD    #
# DB LINKS #
# 24 APR   #
############

DB_LINK                        HOST
------------------------------ ----------------------------------------------------------------------------------------------------------------------
CAMRALINK                      (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521))(CONNECT_DATA=(SID=trmpdtocamramainut))(HS=OK))
CAMRARUNTIME                   (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521))(CONNECT_DATA=(SID=trmpdtocamramainprod))(HS=OK))
LMS                            (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521))(CONNECT_DATA=(SID=trmpdtolmsdev))(HS=OK))
LMSBETA                        (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521))(CONNECT_DATA=(SID=trmpdtolmsuat))(HS=OK))
LMSRUNTIME                     (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=orauttolmsv10prod)) (HS=OK))
MCAMRALINK                     (DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=uxd33.conseco.com)(PORT=1521))(CONNECT_DATA=(SID=trmpdtomcamra4086prod))(HS=OK))

SID List
--------
trmpdtocamramainut
trmpdtocamramainprod
trmpdtolmsdev
trmpdtolmsuat
orauttolmsv10prod
trmpdtomcamra4086prod

scp inittrmpdtocamramainut.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin 
scp inittrmpdtocamramainprod.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin 
scp inittrmpdtolmsdev.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin 
scp inittrmpdtolmsuat.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin 
scp initorauttolmsv10prod.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin 
scp inittrmpdtomcamra4086prod.ora LXORAINVD01:/app/oracle/product/gateway/12c/1/hs/admin 


cd /app/oracle/product/gateway/12c/1/hs/admin
HS_FDS_SHAREABLE_NAME = /usr/lib64/libodbc.so
HS_FDS_TRACE_FILE_NAME = /app/oracle/product/gateway/12c/1/hs/admin/
set ODBCINI=/etc/odbc.ini

-- linux DB
SET ECHO ON
SET DEFINE ON
SET ESCAPE OFF
SET FEEDBACK OFF
SET HEAD ON
SET SERVEROUTPUT ON SIZE 1000000
SET TERMOUT ON
SET TIMING OFF
SET LINES 200
SET PAGES 0
SET TRIMSPOOL ON
SET LONG 10000000
SET NUMFORMAT 999999999999999990
col "STMT" format a2500
spool recreate_db_links.sql
select case
	when OWNER='PUBLIC' then 'DROP PUBLIC DATABASE LINK '
	else 'DROP DATABASE LINK '||OWNER||'.'
	end
	||DB_LINK||';' "STMT"
from dba_db_links where upper(HOST) like '%HS%';

select DBMS_METADATA.GET_DDL('DB_LINK',DB_LINK,OWNER)||';' "STMT"
from dba_db_links where upper(HOST) like '%HS%';
spool off



###########
# blcfdsd #
# cigfdsd #
# dsrd    #
# idwd    #
###########

SET ECHO ON
SET DEFINE ON
SET ESCAPE OFF
SET FEEDBACK OFF
SET HEAD ON
SET SERVEROUTPUT ON SIZE 1000000
SET TERMOUT ON
SET TIMING OFF
SET LINES 200
SET PAGES 0
SET TRIMSPOOL ON
SET LONG 10000
SET NUMFORMAT 999999999999999990

column filename new_val filename
select '/nomove/app/oracle/ggate/12c/1/RestoreUsers_'||name||'.sql' filename from v$database; 
spool &filename
select 'ALTER USER '||username||' ACCOUNT '||account_status||';'
from dba_users
where ACCOUNT_STATUS in ('OPEN','EXPIRED') and USERNAME not in ('GGS','SYS','SYSTEM','DBSNMP')
order by 1;
SPOOL OFF

select '/nomove/app/oracle/ggate/12c/1/LockUsers_'||name||'.sql' filename from v$database; 
spool &filename
select 'ALTER USER '||username||' ACCOUNT LOCK;'
from dba_users
where ACCOUNT_STATUS in ('OPEN','EXPIRED') and USERNAME not in ('GGS','SYS','SYSTEM','DBSNMP')
order by 1;
SPOOL OFF

@&filename


########
# IDWD #
########

set lines 150 pages 200
select 'select sysdate from dual@'||db_link||';' from dba_db_links order by 1;
select sysdate from dual@ABCINFOP_DBL;
ORA-01017: invalid username/password; logon denied
ORA-02063: preceding line from ABCINFOP_DBL

select sysdate from dual@BIZLINKP_DBL;		-- good
select sysdate from dual@BIZLINK_DBL;		-- good
select sysdate from dual@BLCDWP_AWD_DBL;
ORA-01017: invalid username/password; logon denied
ORA-02063: preceding line from BLCDWP_AWD_DBL

select sysdate from dual@BLCNAVP_DBL;		-- good
select sysdate from dual@BPA_DBL;			-- good
select sysdate from dual@DBL_TAI_DB;		-- good
select sysdate from dual@DBL_TAI_PROD;		-- good
select sysdate from dual@DB_DSRD;
ORA-01017: invalid username/password; logon denied
ORA-02063: preceding line from DB_DSRD

select sysdate from dual@DSGD_DBL;
select sysdate from dual@DSGP_DBL;
select sysdate from dual@DWSPROD_DBL;		-- good
select sysdate from dual@EZAPP_DBL;			-- good
select sysdate from dual@IDM_DBL;			-- good
select sysdate from dual@IDWM_DBL;			-- good
select sysdate from dual@IDWP;
ORA-12154: TNS:could not resolve the connect identifier specified

select sysdate from dual@IDWPSYNC_DBL;		-- good
select sysdate from dual@IDWP_DBL;			-- good
select sysdate from dual@IDWT_DBL;			-- good
select sysdate from dual@INFD_RO_DBL;		-- good
select sysdate from dual@LR_BIZLINK_DBL;	-- good
select sysdate from dual@NTSQL_COMM_DBL;
ORA-28500: connection from ORACLE to a non-Oracle system returned this message:
[DataDirect][ODBC SQL Server Wire Protocol driver][SQL Server]Cannot open database "ltcg_dev" requested by the login. The login failed.
{08001,NativeErr = 4060}[DataDirect][ODBC SQL Server Wire Protocol driver][SQL Server]Login failed for user 'DWS_LTCG_RO'. {28000,NativeErr = 18456}
ORA-02063: preceding 2 lines from NTSQL_COMM_DBL

select sysdate from dual@PRIV_DBL;
ORA-12170: TNS:Connect timeout occurred

select sysdate from dual@RPS02UT_DBL;		-- good
select sysdate from dual@RPSRPTG_DBL;		-- good
select sysdate from dual@SQL2K5_ERIC;
ORA-12154: TNS:could not resolve the connect identifier specified

select sysdate from dual@SQL_DSLOBHEALTH;	-- good
select sysdate from dual@SQL_TEST;
ORA-28500: connection from ORACLE to a non-Oracle system returned this message:
[DataDirect][ODBC SQL Server Wire Protocol driver][SQL Server]Cannot open database "ltcg_dev" requested by the login. The login failed.
{08001,NativeErr = 4060}[DataDirect][ODBC SQL Server Wire Protocol driver][SQL Server]Login failed for user 'DWS_LTCG_RO'. {28000,NativeErr = 18456}
ORA-02063: preceding 2 lines from SQL_TEST


#########
# FDLZD #
#########
ORA-01400	cannot insert NULL into ("FDLZ_FPMD"."FE_QRTZ_SCHEDULER_STATE"."CHECKIN_INTERVAL")

-- AIX database
SQL> desc FDLZ_FPMD.FE_QRTZ_SCHEDULER_STATE
 Name                                                                                Null?    Type
 ----------------------------------------------------------------------------------- -------- --------------------------------------------------------
 SCHED_NAME                                                                          NOT NULL VARCHAR2(120)
 INSTANCE_NAME                                                                       NOT NULL VARCHAR2(200)
 LAST_CHECKIN_TIME                                                                   NOT NULL NUMBER(13)
 CHECKIN_INTERVAL                                                                    NOT NULL NUMBER(13)
(same on Linux)

SQL> set long 40
SQL> col owner format a20
SQL> col constraint_name format a30
SQL> col column_name format a30
SQL> select dc.owner, dc.constraint_name, col.column_name, dc.constraint_type, dc.status
fr  2  om dba_constraints dc join dba_cons_columns col
  on dc.constraint_name = col.constraint_name
  3    4  where dc.table_name='&tbl_name' and dc.owner='&what_owner'
order by dc.constraint_type desc, dc.constraint_nam  5  e asc;
Enter value for tbl_name: FE_QRTZ_SCHEDULER_STATE
Enter value for what_owner: FDLZ_FPMD
old   4: where dc.table_name='&tbl_name' and dc.owner='&what_owner'
new   4: where dc.table_name='FE_QRTZ_SCHEDULER_STATE' and dc.owner='FDLZ_FPMD'
OWNER                CONSTRAINT_NAME                COLUMN_NAME                    C STATUS
-------------------- ------------------------------ ------------------------------ - --------
FDLZ_FPMD            FE_QRTZ_SCHEDULER_STATE_PK     INSTANCE_NAME                  P ENABLED
FDLZ_FPMD            FE_QRTZ_SCHEDULER_STATE_PK     SCHED_NAME                     P ENABLED
FDLZ_FPMD            SYS_C0026974                   SCHED_NAME                     C ENABLED
FDLZ_FPMD            SYS_C0026975                   INSTANCE_NAME                  C ENABLED
FDLZ_FPMD            SYS_C0026976                   LAST_CHECKIN_TIME              C ENABLED
FDLZ_FPMD            SYS_C0026977                   CHECKIN_INTERVAL               C ENABLED
(same on Linux)

set long 40
col owner format a20
col constraint_name format a20
select dc.owner, dc.constraint_name, dc.constraint_type, dc.search_condition, dc.status
from dba_constraints dc
where dc.constraint_type='C' and dc.table_name='FE_QRTZ_SCHEDULER_STATE'
order by dc.constraint_name;
OWNER                CONSTRAINT_NAME      C SEARCH_CONDITION                         STATUS
-------------------- -------------------- - ---------------------------------------- --------
FDLZ_FPMD            SYS_C0026974         C "SCHED_NAME" IS NOT NULL                 ENABLED
FDLZ_FPMD            SYS_C0026975         C "INSTANCE_NAME" IS NOT NULL              ENABLED
FDLZ_FPMD            SYS_C0026976         C "LAST_CHECKIN_TIME" IS NOT NULL          ENABLED
FDLZ_FPMD            SYS_C0026977         C "CHECKIN_INTERVAL" IS NOT NULL           ENABLED
(same on Linux)

-- discard file
Current time: 2017-04-27 00:04:57
Discarded record from action ABEND on error 1400
OCI Error ORA-01403: no data found, SQL <UPDATE "FDLZ_FPMD"."FE_QRTZ_SCHEDULER_STATE" x SET x."LAST_CHECKIN_TIME" = :a5 WHERE x."SCHED_NAME" = :b0 AND x."INS
TANCE_NAME" = :b1>
Aborting transaction on /app/oracle/product/ggate/11g/1/dirdat/fdlzd/ra beginning at seqno 0 rba 20806
                         error at seqno 0 rba 20806
SCHED_NAME = quartzScheduler
INSTANCE_NAME = lxtcclud011492730286542
LAST_CHECKIN_TIME = 1493124726773
SCHED_NAME = quartzScheduler
INSTANCE_NAME = lxtcclud011492730286542
LAST_CHECKIN_TIME = 1493124771778

select * from FDLZ_FPMD.FE_QRTZ_SCHEDULER_STATE
where SCHED_NAME = 'quartzScheduler' and INSTANCE_NAME = 'lxtcclud011492730286542' and LAST_CHECKIN_TIME = 1493124726773;
no rows selected
(same)

select * from FDLZ_FPMD.FE_QRTZ_SCHEDULER_STATE
where SCHED_NAME = 'quartzScheduler' and INSTANCE_NAME = 'lxtcclud011492730286542' and LAST_CHECKIN_TIME = 1493124771778;
no rows selected
(same)

-- ggsci
edit params RFDLZD1
--HANDLECOLLISIONS
REPERROR (1400,DISCARD)

start RFDLZD1
REPLICAT   RFDLZD1   Last Started 2017-04-27 12:09   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 12:06:33 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzd/ra000000000
                     2017-04-27 00:02:37.969911  RBA 20547

2017-04-27 12:09:06  WARNING OGG-01154  SQL error 1403 mapping FDLZ_FPMD.FE_QRTZ_SCHEDULER_STATE to FDLZ_FPMD.FE_QRTZ_SCHEDULER_STATE OCI Error ORA-01403: no
 data found, SQL <UPDATE "FDLZ_FPMD"."FE_QRTZ_SCHEDULER_STATE" x SET x."LAST_CHECKIN_TIME" = :a5 WHERE x."SCHED_NAME" = :b0 AND x."INSTANCE_NAME" = :b1>.

edit params RFDLZD1
HANDLECOLLISIONS

start RFDLZD1
REPLICAT   RFDLZD1   Last Started 2017-04-27 12:10   Status RUNNING
INTEGRATED
Checkpoint Lag       35:23:34 (updated 00:00:14 ago)
Process ID           26462
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzd/ra000000000
                     2017-04-26 00:47:44.765744  RBA 131329670

EXTRACT     STOPPED     EFDLZD1     00:00:01      13:38:30
start EFDLZD1

EXTRACT    EFDLZD1   Last Started 2017-04-27 12:12   Status RUNNING
Checkpoint Lag       00:00:01 (updated 13:39:35 ago)
Process ID           44302932
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-04-26 22:33:17
                     SCN 2547.3039559834 (10942321262746)

info PFDLZD1

EXTRACT    PFDLZD1   Last Started 2017-04-26 23:59   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:00:01 ago)
Process ID           45417014
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/fdlzd/ea000000002
                     2017-04-27 12:01:53.000000  RBA 132873

					 
###########
# PRODD   #
# RPRODD1 #
###########

2017-04-27 20:16:27  ERROR   OGG-00665  OCI Error calling OCITransCommit (status = 23413-ORA-23413: table "CCMPROD"."LIABILITY_PRICE" does not have a materia
lized view log), SQL<BEGIN dbms_apply_adm.delete_error(:1); END;>.

select object_type from dba_objects where owner='CCMPROD' and object_name='LIABILITY_PRICE';
TABLE

select count(*) from "CCMPROD"."LIABILITY_PRICE";
28481899
28448995

edit params RPRODD1
REPERROR (23413,DISCARD)
(same error)


###########
# CNOFDWD #
# impdp   #
###########

04/27/2017 10:21:00.835: ORA-31693: Table data object "DATA_MART"."FACT_SLA_TRNSCTN_DLY_HIST":"SYS_P7310" failed to load/unload and is being skipped due to error:
ORA-02354: error in exporting/importing data
ORA-14401: inserted partition key is outside specified partition

-- AIX
set lines 150 pages 200
col "TABLE" format a40
col "POS" format 90
col partition_name format a25
set long 40
break on "TABLE"
select table_owner||'.'||table_name "TABLE", partition_position "POS", partition_name, high_value 
from dba_tab_partitions where table_name='FACT_SLA_TRNSCTN_DLY_HIST' order by "POS";
TABLE                                    POS PARTITION_NAME            HIGH_VALUE
---------------------------------------- --- ------------------------- ----------------------------------------
DATA_MART.FACT_SLA_TRNSCTN_DLY_HIST        1 P001                      TO_DATE(' 1980-01-01 00:00:00', 'SYYYY-M
                                           2 SYS_P7310                 TO_DATE(' 2012-02-01 00:00:00', 'SYYYY-M
                                           3 SYS_P5474                 TO_DATE(' 2013-08-01 00:00:00', 'SYYYY-M
                                           4 SYS_P4125                 TO_DATE(' 2014-11-01 00:00:00', 'SYYYY-M
                                           5 SYS_P4126                 TO_DATE(' 2015-07-01 00:00:00', 'SYYYY-M
                                           6 SYS_P4124                 TO_DATE(' 2015-08-01 00:00:00', 'SYYYY-M
                                           7 SYS_P4123                 TO_DATE(' 2015-09-01 00:00:00', 'SYYYY-M
                                           8 SYS_P4127                 TO_DATE(' 2015-10-01 00:00:00', 'SYYYY-M
                                           9 SYS_P4122                 TO_DATE(' 2015-11-01 00:00:00', 'SYYYY-M
                                          10 SYS_P4129                 TO_DATE(' 2015-12-01 00:00:00', 'SYYYY-M
                                          11 SYS_P4128                 TO_DATE(' 2016-01-01 00:00:00', 'SYYYY-M
                                          12 SYS_P5764                 TO_DATE(' 2016-02-01 00:00:00', 'SYYYY-M
                                          13 SYS_P5765                 TO_DATE(' 2016-03-01 00:00:00', 'SYYYY-M
                                          14 SYS_P10286                TO_DATE(' 2016-08-01 00:00:00', 'SYYYY-M
                                          15 SYS_P11736                TO_DATE(' 2016-09-01 00:00:00', 'SYYYY-M
                                          16 SYS_P10226                TO_DATE(' 2016-10-01 00:00:00', 'SYYYY-M
                                          17 SYS_P11737                TO_DATE(' 2016-11-01 00:00:00', 'SYYYY-M
                                          18 SYS_P11738                TO_DATE(' 2016-12-01 00:00:00', 'SYYYY-M
                                          19 SYS_P11739                TO_DATE(' 2017-01-01 00:00:00', 'SYYYY-M
(same on linux)

select count(*) from "DATA_MART"."FACT_SLA_TRNSCTN_DLY_HIST" partition (SYS_P7310);
11830	- AIX
0		- Linux

select count(*) from "DATA_MART"."FACT_SLA_TRNSCTN_DLY_HIST" partition (SYS_P4127);
2591948	- both

col COLUMN_NAME format a30
select * from DBA_PART_KEY_COLUMNS where owner='DATA_MART' and name='FACT_SLA_TRNSCTN_DLY_HIST';
OWNER                          NAME                           OBJEC COLUMN_NAME                    COLUMN_POSITION
------------------------------ ------------------------------ ----- ------------------------------ ---------------
DATA_MART                      FACT_SLA_TRNSCTN_DLY_HIST      TABLE DIM_EFF_DT                                   1

select count(*) from "DATA_MART"."FACT_SLA_TRNSCTN_DLY_HIST" partition (SYS_P7310)
where DIM_EFF_DT > TO_DATE('2012-02-01 00:00:00', 'YYYY-MM-DD HH24:MI:SS');
0
select count(*) from "DATA_MART"."FACT_SLA_TRNSCTN_DLY_HIST" partition (SYS_P7310)
where DIM_EFF_DT > TO_DATE('2012-02-01', 'YYYY-MM-DD');

alter session set nls_date_format='SYYYY-MM-DD HH24:MI:SS';
select min(DIM_EFF_DT) from "DATA_MART"."FACT_SLA_TRNSCTN_DLY_HIST" partition (SYS_P7310);
2013-01-31 00:00:00
select max(DIM_EFF_DT) from "DATA_MART"."FACT_SLA_TRNSCTN_DLY_HIST" partition (SYS_P7310);
2013-01-31 00:00:00
select DIM_EFF_DT from "DATA_MART"."FACT_SLA_TRNSCTN_DLY_HIST" partition (SYS_P7310) where rownum<11;
DIM_EFF_DT
--------------------
 2013-01-31 00:00:00
 2013-01-31 00:00:00
 2013-01-31 00:00:00
 2013-01-31 00:00:00
 2013-01-31 00:00:00
 2013-01-31 00:00:00
 2013-01-31 00:00:00
 2013-01-31 00:00:00
 2013-01-31 00:00:00
 2013-01-31 00:00:00

select max(DIM_EFF_DT) from "DATA_MART"."FACT_SLA_TRNSCTN_DLY_HIST" partition (SYS_P5474);
no rows
select max(DIM_EFF_DT) from "DATA_MART"."FACT_SLA_TRNSCTN_DLY_HIST" partition (SYS_P4125);
 2014-10-29 00:00:00
select max(DIM_EFF_DT) from "DATA_MART"."FACT_SLA_TRNSCTN_DLY_HIST" partition (SYS_P4126);
 2015-06-30 00:00:00
select max(DIM_EFF_DT) from "DATA_MART"."FACT_SLA_TRNSCTN_DLY_HIST" partition (SYS_P4124);
 2015-07-31 00:00:00
select max(DIM_EFF_DT) from "DATA_MART"."FACT_SLA_TRNSCTN_DLY_HIST" partition (SYS_P4123);
 2015-08-31 00:00:00
select max(DIM_EFF_DT) from "DATA_MART"."FACT_SLA_TRNSCTN_DLY_HIST" partition (SYS_P4127);
 2015-09-18 00:00:00
 

###########
# PRODD   #
# RPRODD1 #
# 4/28    #
###########
2017-04-28 14:20:40  ERROR   OGG-00199  Table PRODD.CCMEOM.M2M_SPREAD_CALUATIONS_TMP does not exist in target database.

--- AIX
col object_name format a30
select owner, object_name, created from dba_objects where object_name='M2M_SPREAD_CALUATIONS_TMP' and object_type='TABLE' and owner='CCMEOM';
OWNER                          OBJECT_NAME                    CREATED
------------------------------ ------------------------------ ----------
CCMEOM                         M2M_SPREAD_CALUATIONS_TMP      04/28/2017


############
# infdqd   #
# EINFDQD1 #
# uxd34    #
# 5/4      #
############

2017-05-04 08:30:19  ERROR   OGG-06601  Mismatch between the length of seqno from checkpoint (9) and recovery (6) for extract trail /nomove/app/oracle/ggate/12c/1/dirdat/infdqd/ea.

-- info E showch
-- (get seq# & RBA for write checkpoint #1)
-- (get details of current read checkpoint)
-- start E
-- info P
-- (per log read checkpoint it's at last record)
-- alter extract E etrollover
-- start E

info PINFDQD1

EXTRACT    PINFDQD1  Last Started 2017-05-03 22:29   Status RUNNING
Checkpoint Lag       00:00:00 (updated 09:24:24 ago)
Process ID           24576102
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/infdqd/ea000000000
                     First Record  RBA 1408

delete PINFDQD1
-- recreated

info EINFDQD1 showch

EXTRACT    EINFDQD1  Last Started 2017-05-04 08:30   Status ABENDED
Checkpoint Lag       00:00:09 (updated 09:06:08 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-05-03 23:29:50
                     SCN 2546.2326759382 (10937313494998)


Current Checkpoint Detail:

Read Checkpoint #1

  Oracle Integrated Redo Log

  Startup Checkpoint (starting position in the data source):
    Timestamp: 2017-05-03 22:28:47.000000
    SCN: Not available

  Recovery Checkpoint (position of oldest unprocessed transaction in the data source):
    Timestamp: 2017-05-03 23:29:50.000000
    SCN: 2546.2326759381 (10937313494997)

  Current Checkpoint (position of last record read in the data source):
    Timestamp: 2017-05-03 23:29:50.000000
    SCN: 2546.2326759382 (10937313494998)

Write Checkpoint #1

  GGS Log Trail

  Current Checkpoint (current write position):
    Sequence #: 0
    RBA: 1508241
    Timestamp: 2017-05-03 23:29:59.727588
    Extract Trail: /nomove/app/oracle/ggate/12c/1/dirdat/infdqd/ea
    Seqno Length: 9
    Flip Seqno Length: No
    Trail Type: EXTTRAIL

Header:
  Version = 2
  Record Source = A
  Type = 13
  # Input Checkpoints = 1
  # Output Checkpoints = 1

File Information:
  Block Size = 2048
  Max Blocks = 100
  Record Length = 2048
  Current Offset = 0

Configuration:
  Data Source = 3
  Transaction Integrity = 1
  Task Type = 0

Status:
  Start Time = 2017-05-04 08:30:19
  Last Update Time = 2017-05-03 23:29:59
  Stop Status = A
  Last Result = 520

alter extract EINFDQD1 etrollover
start EINFDQD1

EXTRACT    EINFDQD1  Last Started 2017-05-04 08:44   Status RUNNING
Checkpoint Lag       09:15:05 (updated 00:00:00 ago)
Process ID           54264200
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-05-03 23:29:50
                     SCN 2546.2326759382 (10937313494998)

delete extract PINFDQD1
add extract PINFDQD1, exttrailsource /nomove/app/oracle/ggate/12c/1/dirdat/infdqd/ea
add rmttrail /app/oracle/product/ggate/12c/1/dirdat/infdqd/ra, extract PINFDQD1, megabytes 1000
start PINFDQD1

EXTRACT    PINFDQD1  Last Started 2017-05-04 08:51   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           13959424
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/infdqd/ea000000000
                     First Record  RBA 0

stop PINFDQD1
alter extract PINFDQD1 extseqno 1 extrba 0
start PINFDQD1

info EINFDQD1

EXTRACT    EINFDQD1  Last Started 2017-05-04 08:44   Status RUNNING
Checkpoint Lag       00:00:10 (updated 00:00:07 ago)
Process ID           54264200
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-05-04 09:01:40
                     SCN 2546.2326872127 (10937313607743)
					 
info PINFDQD1

EXTRACT    PINFDQD1  Last Started 2017-05-04 08:54   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:00:02 ago)
Process ID           39387422
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/infdqd/ea000000001
                     2017-05-04 09:02:25.000000  RBA 5396319

					 
##########
# infdqd #
# impdp  #
# 5/4    #
##########


  SID SERIAL# TIMEOUT ERROR_MSG
----- ------- ------- -----------------------------------------------------------------------------------------------
SQL_TEXT
-----------------------------------------------------------------------------------------------------------------------
   29   56695    7200
BEGIN :1 := sys.kupc$que_int.receive(:2); END;

  638   22353    7200 ORA-30036: unable to extend segment by 8 in undo tablespace 'UNDO'
INSERT /*+ APPEND PARALLEL("IDP_VERBOSE_FIELD_DTL_RES",4)+*/ INTO RELATIONAL("INFDQ_PROFILING"."IDP_VERBOSE_FIELD_DTL_R
ES" NOT XMLTYPE) ("SOURCE_ID", "DP_ROW_NUMBER", "FIELD_KEY", "FIELD_VALUE")     SELECT "SOURCE_ID", "DP_ROW_NUMBER", "F
IELD_KEY", "FIELD_VALUE"     FROM "SYSTEM"."ET$027E57510001" KU$


-- import killed

SQL> ! df -h /database/infdqd01
Filesystem                        Size  Used Avail Use% Mounted on
/dev/mapper/infdqdvg-infdqd01_lv  133G  126G   51M 100% /database/infdqd01

SQL> ! df -h /database/cinfdqd01
Filesystem                         Size  Used Avail Use% Mounted on
/dev/mapper/infdqdvg-cinfdqd01_lv  9.8G  9.1G  136M  99% /database/cinfdqd01

SQL> ! df -h /database/cinfdqd_arch01
Filesystem                              Size  Used Avail Use% Mounted on
/dev/mapper/infdqdvg-cinfdqd_arch01_lv  9.8G  8.1G  1.2G  88% /database/cinfdqd_arch01

ID FILE_NAME                                                                           MB      MAXMB AUT
---- --------------------------------------------------------------------------- ---------- ---------- ---
   3 /database/infdqd01/oradata/temp01.dbf                                           30,720     30,720 NO
   4 /database/infdqd01/oradata/temp02.dbf                                           30,000     30,000 NO
   5 /database/infdqd01/oradata/temp03.dbf                                            9,216      9,216 NO
                                                                                 ---------- ----------
TOTA                                                                                 69,936     69,936

ALTER DATABASE TEMPFILE 3 RESIZE 512m;
ALTER DATABASE TEMPFILE 4 RESIZE 512m;
ALTER DATABASE TEMPFILE 5 RESIZE 512m;

ALTER DATABASE TEMPFILE 3 AUTOEXTEND ON NEXT 512M MAXSIZE 10G;
ALTER DATABASE TEMPFILE 4 AUTOEXTEND ON NEXT 512M MAXSIZE 10G;
ALTER DATABASE TEMPFILE 5 AUTOEXTEND ON NEXT 512M MAXSIZE 10G;

        ID FILE_NAME                                                          MB      MaxMB AUT
---------- ------------------------------------------------------------ -------- ---------- ---
         5 /database/cinfdqd01/oradata/undo.dbf                            5,632      8,192 YES
        37 /database/cinfdqd_arch01/undo03.dbf                             8,192      8,192 YES
        13 /database/infdqd01/oradata/undo01.dbf                          30,720     30,720 NO
        36 /database/infdqd01/oradata/undo02.dbf                           3,328      3,328 NO
                                                                        -------- ----------
TOTAL                                                                     47,872     50,432

ALTER DATABASE DATAFILE 37 AUTOEXTEND ON MAXSIZE 10g;

create undo tablespace UNDOTBS1 datafile '/database/cinfdqd01/oradata/undotbs1.dbf' size 100M;
alter system set undo_tablespace='UNDOTBS1' scope=both;
drop  tablespace UNDO including contents and datafiles;
ORA-01548: active rollback segment '_SYSSMU10_3903158857$' found, terminate dropping tablespace

ALTER PLUGGABLE DATABASE infdqd CLOSE;
DROP PLUGGABLE DATABASE infdqd INCLUDING DATAFILES;

shutdown abort;
startup restrict mount;
DROP DATABASE;

-- build script up to metadata import
./GG_2_Linux_build_DB_infdqd.sh

        ID FILE_NAME                                                                           MB      MaxMB AUT
---------- --------------------------------------------------------------------------- ---------- ---------- ---
         5 /database/cinfdqd01/oradata/undo.dbf                                               100        100 NO
        13 /database/infdqd01/oradata/undo01.dbf                                            2,000      2,000 NO
                                                                                       ---------- ----------
TOTAL                                                                                       2,100      2,100

SQL> ! df -h /database/cinfdqd01
Filesystem                         Size  Used Avail Use% Mounted on
/dev/mapper/infdqdvg-cinfdqd01_lv  9.8G  4.0G  5.3G  43% /database/cinfdqd01

SQL> ! df -h /database/infdqd01
Filesystem                        Size  Used Avail Use% Mounted on
/dev/mapper/infdqdvg-infdqd01_lv  133G  5.5G  121G   5% /database/infdqd01

SQL> ! df -h /app/oracle
Filesystem                        Size  Used Avail Use% Mounted on
/dev/mapper/orahomevg-orahome_lv   50G   21G   30G  41% /app/oracle

SQL> ! df -h /database/cinfdqd_arch01
Filesystem                              Size  Used Avail Use% Mounted on
/dev/mapper/infdqdvg-cinfdqd_arch01_lv  9.8G   37M  9.2G   1% /database/cinfdqd_arch01

-- unable to get table size from AIX
-- in TS INFDQ_PROFILING_DATA, which is 56 GB

ALTER TABLESPACE UNDO ADD DATAFILE '/database/cinfdqd_arch01/undo_temp01.dbf' SIZE 9G;
ALTER TABLESPACE UNDO ADD DATAFILE '/database/infdqd01/oradata/undo_temp02.dbf' SIZE 31G;
ALTER TABLESPACE UNDO ADD DATAFILE '/database/infdqd01/oradata/undo_temp03.dbf' SIZE 30G;
        ID FILE_NAME                                                                           MB      MaxMB AUT
---------- --------------------------------------------------------------------------- ---------- ---------- ---
         5 /database/cinfdqd01/oradata/undo.dbf                                               100        100 NO
        36 /database/cinfdqd_arch01/undo_temp01.dbf                                         9,216      9,216 NO
        13 /database/infdqd01/oradata/undo01.dbf                                            2,000      2,000 NO
        37 /database/infdqd01/oradata/undo_temp02.dbf                                      31,744     31,744 NO
        38 /database/infdqd01/oradata/undo_temp03.dbf                                      30,720     30,720 NO
                                                                                       ---------- ----------
TOTAL                                                                                      73,780     73,780

df -h /database/infdqd01
Filesystem                        Size  Used Avail Use% Mounted on
/dev/mapper/infdqdvg-infdqd01_lv  133G   67G   60G  53% /database/infdqd01

cd /database/cinfdqd_admn01/scripts
-- impdp_infdqd_table1.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=infdqd_%U.dmp
LOGFILE=impdp_infdqd_table1.log
table_exists_action=replace
PARALLEL=4
CLUSTER=Y
METRICS=Y
TRANSFORM=TABLE_COMPRESSION_CLAUSE:"COMPRESS FOR OLTP"
LOGTIME=ALL
TABLES=INFDQ_PROFILING.IDP_VERBOSE_FIELD_DTL_RES

impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAENTD01.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=infdqd)))\" parfile=impdp_infdqd_table1.par

05/05/2017 00:17:30.538: ORA-39171: Job is experiencing a resumable wait.
Resumable error: ORA-01652: unable to extend temp segment by 128 in tablespace TEMP
...
05/05/2017 00:33:33.356: Resumable stmt start: 05/04/17 22:58:54 stmt suspend: 05/05/17 00:31:12
05/05/2017 03:45:16.626: ORA-39171: Job is experiencing a resumable wait.
Resumable error: ORA-01654: unable to extend index INFDQ_PROFILING.SYS_IOT_TOP_92628 by 128 in tablespace INFDQ_PROFILING_DATA
...
05/05/2017 07:48:54.025: Resumable stmt status: TIMEOUT
...
ORA-30032: the suspended (resumable) statement has timed out
ORA-01654: unable to extend index INFDQ_PROFILING.SYS_IOT_TOP_92628 by 128 in tablespace INFDQ_PROFILING_DATA

-- PDB
DISK                                             MB      MaxMB
---------------------------------------- ---------- ----------
/app/oracle/home/oradata/                    25,000     25,000
/database/infdqd01/oradata/                  63,370    279,720
                                         ---------- ----------
TOTAL                                        88,370    304,720

        ID FILE_NAME                                                                           MB      MaxMB AUT
---------- --------------------------------------------------------------------------- ---------- ---------- ---
        39 /app/oracle/home/oradata/infdq_profiling_data_04.dbf                            10,000     10,000 NO
        28 /database/infdqd01/oradata/infdq_profiling_data_01.dbf                           2,100     32,000 YES
        34 /database/infdqd01/oradata/infdq_profiling_data_02.dbf                           2,200     32,000 YES
        35 /database/infdqd01/oradata/infdq_profiling_data_03.dbf                           2,000     32,000 YES
                                                                                       ---------- ----------
TOTAL                                                                                      16,300    106,000


-- CDB
        ID FILE_NAME                                                                           MB      MaxMB AUT
---------- --------------------------------------------------------------------------- ---------- ---------- ---
         5 /database/cinfdqd01/oradata/undo.dbf                                               100        100 NO
        36 /database/cinfdqd_arch01/undo_temp01.dbf                                         9,216      9,216 NO
        13 /database/infdqd01/oradata/undo01.dbf                                            2,000      2,000 NO
        37 /database/infdqd01/oradata/undo_temp02.dbf                                      31,744     31,744 NO
        38 /database/infdqd01/oradata/undo_temp03.dbf                                      30,720     30,720 NO
                                                                                       ---------- ----------
TOTAL                                                                                      73,780     73,780
-- max used 45,930

ALTER DATABASE DATAFILE 38 RESIZE 3000M;
ORA-03297: file contains used data beyond requested RESIZE value

create undo tablespace UNDO_RBS1 datafile '/database/infdqd01/oradata/undo_rbs01.dbf' size 100M;
alter system set undo_tablespace=undo_rbs1;
drop tablespace undo including contents and datafiles;

df -h /database/cinfdqd01/oradata
/dev/mapper/infdqdvg-cinfdqd01_lv  9.8G  4.0G  5.3G  43% /database/cinfdqd01

ls -l /database/cinfdqd01/oradata/undo*
No such file or directory

df -h /database/cinfdqd_arch01
/dev/mapper/infdqdvg-cinfdqd_arch01_lv  9.8G   37M  9.2G   1% /database/cinfdqd_arch01

ls -l /database/cinfdqd_arch01/undo*
No such file or directory

df -h /database/infdqd01/oradata
/dev/mapper/infdqdvg-infdqd01_lv  158G  127G   23G  85% /database/infdqd01

ls -l /database/infdqd01/oradata/undo*
-rw-r-----. 1 oracle dba 104865792 May  5 12:14 /database/infdqd01/oradata/undo_rbs01.dbf

create undo tablespace UNDO datafile '/database/cinfdqd01/oradata/undo01.dbf' size 2000M;
ALTER TABLESPACE UNDO ADD DATAFILE '/database/cinfdqd_arch01/undo_temp01.dbf' SIZE 9G;
ALTER TABLESPACE UNDO ADD DATAFILE '/database/infdqd01/oradata/undo_temp02.dbf' SIZE 30G REUSE;
ALTER TABLESPACE UNDO ADD DATAFILE '/database/infdqd01/oradata/undo_temp03.dbf' SIZE 9G;

alter system set undo_tablespace=undo;
drop tablespace undo_rbs1 including contents and datafiles;

  ID FILE_NAME                                                    TS                           MB      MAXMB AUT
---- ------------------------------------------------------------ -------------------- ---------- ---------- ---
   5 /app/oracle/home/oradata/temp03.dbf                          TEMP                     15,000     15,000 NO
   3 /database/infdqd01/oradata/temp01.dbf                        TEMP                     30,720     30,720 NO
   4 /database/infdqd01/oradata/temp02.dbf                        TEMP                     25,000     25,000 NO
                                                                                       ---------- ----------
TOTA                                                                                       70,720     70,720

df -h /database/infdqd01/oradata
/dev/mapper/infdqdvg-infdqd01_lv  158G  103G   47G  69% /database/infdqd01

-- table import - 2nd attempt
impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAENTD01.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=infdqd)))\" parfile=impdp_infdqd_table1.par

05/05/2017 12:48:59.497: Startup took 5 seconds
...
05/05/2017 16:08:28.981: ORA-39171: Job is experiencing a resumable wait.
Resumable error: ORA-30036: unable to extend segment by 8 in undo tablespace 'UNDO'
...
05/05/2017 18:05:19.185: Resumable stmt status: TIMEOUT
...
05/05/2017 18:56:45.165: ORA-31693: Table data object "INFDQ_PROFILING"."IDP_VERBOSE_FIELD_DTL_RES" failed to load/unload and is bein                    g skipped due to error:
ORA-30032: the suspended (resumable) statement has timed out
ORA-30036: unable to extend segment by 8 in undo tablespace 'UNDO'


SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- ---------------
SGA    DEFAULT buffer cache            64       64       64 STATIC
       Shared IO Pool                  16       16       16 STATIC
       java pool                       16       16       16 STATIC
       large pool                      16       16       16 STATIC
       shared pool                    608      608      608 STATIC
       streams pool                   704      704      704 STATIC
******                           -------- -------- --------
TOTAL                               1,424    1,424    1,424

alter system set memory_max_target=4g comment='old value 1504M' scope=spfile;
alter system set memory_target=4g comment='old value 1504M' scope=spfile;
alter system set sga_max_size=4g comment='old value 1504M' scope=spfile;

SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- ---------------
       DEFAULT buffer cache         1,072    1,072    1,072 INITIALIZING
       Shared IO Pool                  16       16       16 STATIC
       java pool                       16       16       16 STATIC
       large pool                      16       16       16 STATIC
       shared pool                    608      608      608 STATIC
       streams pool                   704      704      704 STATIC
******                           -------- -------- --------
TOTAL                               2,432    2,432    2,432

								size	used	avail	used%
/database/cinfdqd01/oradata		9.8		5.8		3.5		63%
/database/cinfdqd_arch01		9.8		9.1		172M	99%
/database/infdqd01/oradata		158		105		45		70%
/app/oracle						50		41		9.0		82%
/oragg							2T		1.3T	741G	64%

        ID FILE_NAME                                                                           MB      MaxMB AUT
---------- --------------------------------------------------------------------------- ---------- ---------- ---
        41 /database/cinfdqd01/oradata/undo01.dbf                                           2,000      2,000 NO
        42 /database/cinfdqd_arch01/undo_temp01.dbf                                         9,216      9,216 NO
        43 /database/infdqd01/oradata/undo_temp02.dbf                                      30,720     30,720 NO
        44 /database/infdqd01/oradata/undo_temp03.dbf                                       9,216      9,216 NO
                                                                                       ---------- ----------
TOTAL                                                                                      51,152     51,152

mkdir /oragg/infdqd/undo
ALTER TABLESPACE UNDO ADD DATAFILE '/oragg/infdqd/undo/undo_temp04.dbf' SIZE 30G;
ALTER TABLESPACE UNDO ADD DATAFILE '/oragg/infdqd/undo/undo_temp05.dbf' SIZE 30G;

        ID FILE_NAME                                                                           MB      MaxMB AUT
---------- --------------------------------------------------------------------------- ---------- ---------- ---
        41 /database/cinfdqd01/oradata/undo01.dbf                                           2,000      2,000 NO
        42 /database/cinfdqd_arch01/undo_temp01.dbf                                         9,216      9,216 NO
        43 /database/infdqd01/oradata/undo_temp02.dbf                                      30,720     30,720 NO
        44 /database/infdqd01/oradata/undo_temp03.dbf                                       9,216      9,216 NO
        45 /oragg/infdqd/undo/undo_temp04.dbf                                              30,720     30,720 NO
        46 /oragg/infdqd/undo/undo_temp05.dbf                                              30,720     30,720 NO
                                                                                       ---------- ----------
TOTAL                                                                                     112,592    112,592

-- table import - 3rd attempt
cd /database/cinfdqd_admn01/scripts
-- impdp_infdqd_table1.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=infdqd_%U.dmp
LOGFILE=impdp_infdqd_table1.log
table_exists_action=replace
PARALLEL=6
METRICS=Y
TRANSFORM=TABLE_COMPRESSION_CLAUSE:"COMPRESS FOR OLTP"
LOGTIME=ALL
TABLES=INFDQ_PROFILING.IDP_VERBOSE_FIELD_DTL_RES

impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAENTD01.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=infdqd)))\" parfile=impdp_infdqd_table1.par

05/06/2017 11:18:09.935: Startup took 1 seconds
...
05/06/2017 14:51:46.844: ORA-39171: Job is experiencing a resumable wait.
Resumable error: ORA-30036: unable to extend segment by 8 in undo tablespace 'UNDO'


ALTER TABLESPACE UNDO ADD DATAFILE '/oragg/infdqd/undo/undo_temp06.dbf' SIZE 30G;

05/06/2017 15:37:36.932: . . imported "INFDQ_PROFILING"."IDP_VERBOSE_FIELD_DTL_RES"  38.92 GB 1542097914 rows in 15560 seconds
05/06/2017 15:37:37.066:      Completed 2054 SCHEMA_EXPORT/TABLE/TABLE_DATA objects in 234112 seconds
05/06/2017 15:37:37.186: Job "SYSTEM"."SYS_IMPORT_TABLE_01" completed with 4 error(s) at Sat May 6 15:37:37 2017 elapsed 0 04:19:29

select count(*) from "INFDQ_PROFILING"."IDP_VERBOSE_FIELD_DTL_RES" ;
1,542,097,914

STATUS          MB
--------- --------
EXPIRED          1
UNEXPIRED  132,296

create undo tablespace UNDO_RBS1 datafile '/database/infdqd01/oradata/undo_rbs01.dbf' size 100M;
alter system set undo_tablespace=undo_rbs1;

STATUS          MB
--------- --------
EXPIRED    132,297
UNEXPIRED        3

drop tablespace undo including contents and datafiles;
create undo tablespace UNDO datafile '/database/cinfdqd01/oradata/undo01.dbf' size 2000M;
alter system set undo_tablespace=undo;
drop tablespace undo_rbs1 including contents and datafiles;

  ID FILE_NAME                                                    TS                           MB      MAXMB AUT
---- ------------------------------------------------------------ -------------------- ---------- ---------- ---
   5 /app/oracle/home/oradata/temp03.dbf                          TEMP                     15,000     15,000 NO
   3 /database/infdqd01/oradata/temp01.dbf                        TEMP                     30,720     30,720 NO
   4 /database/infdqd01/oradata/temp02.dbf                        TEMP                     25,000     25,000 NO
                                                                                       ---------- ----------
TOTA                                                                                       70,720     70,720

alter database tempfile 4 drop including datafiles;
ALTER DATABASE TEMPFILE 3 RESIZE 10G;

  ID FILE_NAME                                                    TS                           MB      MAXMB AUT
---- ------------------------------------------------------------ -------------------- ---------- ---------- ---
   5 /app/oracle/home/oradata/temp03.dbf                          TEMP                     15,000     15,000 NO
   3 /database/infdqd01/oradata/temp01.dbf                        TEMP                     10,240     10,240 NO
                                                                                       ---------- ----------
TOTA                                                                                       25,240     25,240

df -h /database/infdqd01
/dev/mapper/infdqdvg-infdqd01_lv  158G   50G  101G  34% /database/infdqd01

-- impdp_infdqd_full.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=infdqd_%U.dmp
LOGFILE=impdp_infdqd_full.log
table_exists_action=skip
PARALLEL=4
CLUSTER=Y
METRICS=Y
TRANSFORM=TABLE_COMPRESSION_CLAUSE:"COMPRESS FOR OLTP"
LOGTIME=ALL

impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAENTD01.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=infdqd)))\" parfile=impdp_infdqd_full.par

05/06/2017 16:01:47.252: Startup took 1 seconds
05/06/2017 16:10:31.180: Job "SYSTEM"."SYS_IMPORT_FULL_01" completed with 9 error(s) at Sat May 6 16:10:31 2017 elapsed 0 00:08:44

alter system set memory_max_target=1504m scope=spfile;
alter system set memory_target=1504m scope=spfile;
alter system set sga_max_size=1504m scope=spfile;

  ID FILE_NAME                                                    TS                           MB      MAXMB AUT
---- ------------------------------------------------------------ -------------------- ---------- ---------- ---
   5 /app/oracle/home/oradata/temp03.dbf                          TEMP                     15,000     15,000 NO
   3 /database/infdqd01/oradata/temp01.dbf                        TEMP                     10,240     10,240 NO
                                                                                       ---------- ----------
TOTA                                                                                       25,240     25,240

alter database tempfile 5 drop including datafiles;
ALTER DATABASE TEMPFILE 3 RESIZE 2G;

  ID FILE_NAME                                                    TS                           MB      MAXMB AUT
---- ------------------------------------------------------------ -------------------- ---------- ---------- ---
   3 /database/infdqd01/oradata/temp01.dbf                        TEMP                      2,048      2,048 NO
                                                                                       ---------- ----------
TOTA                                                                                        2,048      2,048

desc "INFDQ_PROFILING"."IDP_VERBOSE_FIELD_DTL_RES"
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 SOURCE_ID                                 NOT NULL NUMBER(19)
 DP_ROW_NUMBER                             NOT NULL NUMBER(19)
 FIELD_KEY                                 NOT NULL NUMBER(19)
 FIELD_VALUE                                        VARCHAR2(255 CHAR)
 
 
*** SR 3-14842771621 ***
-- indexes
INDEX                             INDEX_TYPE      STATUS   COLUMN_NAME                    COLUMN_EXPRESSION
------------------------------    --------------- -------- ------------------------------ ------------------------------
INFDQ_PROFILING.SYS_IOT_TOP_88790 IOT - TOP       VALID    DP_ROW_NUMBER
                                                           FIELD_KEY
                                                           SOURCE_ID

-- constraints
OWNER                CONSTRAINT_NAME                COLUMN_NAME                    C STATUS
-------------------- ------------------------------ ------------------------------ - --------
INFDQ_PROFILING      SYS_IOT_TOP_88790              FIELD_KEY                      P ENABLED
INFDQ_PROFILING      SYS_IOT_TOP_88790              SOURCE_ID                      P
INFDQ_PROFILING      SYS_IOT_TOP_88790              DP_ROW_NUMBER                  P
INFDQ_PROFILING      SYS_C0021090                   SOURCE_ID                      C
INFDQ_PROFILING      SYS_C0021091                   DP_ROW_NUMBER                  C
INFDQ_PROFILING      SYS_C0021092                   FIELD_KEY                      C

-- per Doc ID 1951350.1
1) Disable the constraints
2) Exclude indexes and statistics from import then create/gather them manually after import finish
3) Use Datapump parameter TABLE_EXISTS_ACTION=REPLACE instead of APPEND or TRUNCATE. Refer to Doc ID 1358280.1
4) Check free space in the undo tablespace and add more space, if required.
5) Create a new Undo tablespace and use is for the Import operation.

 
############
# infdqd   #
# RINFDQD1 #
# lxoggm01 #
# 5/7      #
############

2017-05-07 10:14:47  ERROR   OGG-02191  Incompatible record 101 in /app/oracle/product/ggate/12c/1/dirdat/infdqd/ra000000000, rba 67870 when getting trail header.

REPLICAT   RINFDQD1  Last Started 2017-05-07 10:14   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 18:29:00 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/infdqd/ra000000000
                     First Record  RBA 0

-- https://minersoracleblog.wordpress.com/2014/10/20/oracle-golden-gate-ogg-01028-incompatible-record/
./logdump
open /app/oracle/product/ggate/12c/1/dirdat/infdqd/ra000000000
ghdr on
pos 67870
n
Bad record found at RBA 67870, format 5.50 Header token)
 6847 5100                                         | hGQ.

sfh prev
___________________________________________________________________
Hdr-Ind    :     E  (x45)     Partition  :     .  (x0c)
UndoFlag   :     .  (x00)     BeforeAfter:     A  (x41)
RecLength  :   103  (x0067)   IO Time    : 2017/05/03 22:56:10.971.187
IOType     :     5  (x05)     OrigNode   :   255  (xff)
TransInd   :     .  (x01)     FormatType :     R  (x52)
SyskeyLen  :     0  (x00)     Incomplete :     .  (x00)
AuditRBA   :         31       AuditPos   : 7323596
Continued  :     N  (x00)     RecCount   :     1  (x01)

2017/05/03 22:56:10.971.187 Insert               Len   103 RBA 67735
Name: INF_DQMREP.PR_ATTRIBUTE  (TDR Index: 5)
After  Image:                                             Partition 12   G  m
 0000 0009 0000 0005 3430 3538 3500 0100 2900 0000 | ........40585...)...
 2552 4550 4f2e 5359 5354 454d 2e50 5253 5f50 4152 | %REPO.SYSTEM.PRS_PAR
 454e 545f 464f 4c44 4552 5f49 445f 4154 5452 0002 | ENT_FOLDER_ID_ATTR..
 001c 0000 0018 553a 6258 6d4c 7331 534f 4565 616c | ......U:bXmLs1SOEeal
 764c 5258 7252 4668 4751 0003 0009 0000 0005 3338 | vLRXrRFhGQ........38
 3430 32                                           | 402

sfh next
___________________________________________________________________
Hdr-Ind    :     E  (x45)     Partition  :     .  (x0c)
UndoFlag   :     .  (x00)     BeforeAfter:     A  (x41)
RecLength  :    88  (x0058)   IO Time    : 2017/05/03 22:56:10.971.187
IOType     :     5  (x05)     OrigNode   :   255  (xff)
TransInd   :     .  (x01)     FormatType :     R  (x52)
SyskeyLen  :     0  (x00)     Incomplete :     .  (x00)
AuditRBA   :         31       AuditPos   : 7323596
Continued  :     N  (x00)     RecCount   :     1  (x01)

2017/05/03 22:56:10.971.187 Insert               Len    88 RBA 67918
Name: INF_DQMREP.PR_ATTRIBUTE  (TDR Index: 5)
After  Image:                                             Partition 12   G  m
 0000 0009 0000 0005 3430 3538 3500 0100 2500 0000 | ........40585...%...
 2152 4550 4f2e 5345 5256 4943 455f 5052 4f50 2e43 | !REPO.SERVICE_PROP.C
 5245 4154 4544 5f42 595f 4154 5452 0002 0011 0000 | REATED_BY_ATTR......
 000d 4164 6d69 6e69 7374 7261 746f 7200 0300 0900 | ..Administrator.....
 0000 0533 3834 3032                               | ...38402
 
start RINFDQD1


2017-05-07 11:36:27  WARNING OGG-01154  SQL error 1403 mapping INF_DQMREP.DLM_LOCKS to INF_DQMREP.DLM_LOCKS OCI Error ORA-01403: no data found, SQL <UPDATE "INF_DQMREP"."DLM_LOCKS" x SET x."END_TIME" = :a3 WHERE x."ID" = :b0>.

edit params RINFDQD1
HANDLECOLLISIONS


2017-05-07 12:07:47  WARNING OGG-01154  SQL error 2292 mapping INF_DQMREP.PR_RESOURCE to INF_DQMREP.PR_RESOURCE OCI Error ORA-02292: integrity constraint
 (INF_DQMREP.FK_PR_ATTRIBUTE_PR) violated - child record found (status = 2292), SQL <DELETE FROM "INF_DQMREP"."PR_RESOURCE"  WHERE "PRR_ID" = :b0>.

-- RINFDQD1.dsc
Mapping problem with delete record (target format)...
PRR_ID = 370217
PRR_VERSION = 1
PRR_PARENTPATH = /
PRR_RELROOT = -1
PRR_MAXIID = 0
PRR_NUMOBJECTS = 1
PRR_NSID = 28
PRR_PARENTID = 37580
PRR_PARENTCONTAINER = 37580
PRR_NAME = resource_366526
PRR_TYPENAME = com.informatica.repository.models.persist.resiliency.impl.RequestResponseImpl

select count(*) FROM "INF_DQMREP"."PR_RESOURCE"  WHERE "PRR_ID" = 370217;
AIX		1
Linux	0

-- PK for INF_DQMREP.FK_PR_ATTRIBUTE_PR
CONSTRAINT_NAME                TABLE                                              COLUMN_NAME
------------------------------ -------------------------------------------------- ------------------------------
SYS_C0016452                   INF_DQMREP.PR_RESOURCE                             PRR_ID

select count(*) from INF_DQMREP.PR_RESOURCE where "PRR_PARENTCONTAINER" = 370217;
AIX		0
Linux	0

edit params RINFDQD1
(comment out HANDLECOLLISIONS)
start RINFDQD1
(same error)

-- AIX
col "STMT" format a10000
select 'insert into INF_DQMREP.PR_RESOURCE (PRR_ID, PRR_VERSION, PRR_PARENTPATH, PRR_RELROOT, PRR_MAXIID, PRR_NUMOBJECTS, PRR_NSID, PRR_PARENTID, PRR_PARENTCONTAINER, PRR_NAME, PRR_TYPENAME, PRR_OID) values ('||
PRR_ID||','||PRR_VERSION||','''||PRR_PARENTPATH||''','||PRR_RELROOT||','||PRR_MAXIID||','||PRR_NUMOBJECTS||','||PRR_NSID||','||PRR_PARENTID||','||PRR_PARENTCONTAINER||','''||PRR_NAME||''','''||PRR_TYPENAME||''','||PRR_OID||');' "STMT"
from INF_DQMREP.PR_RESOURCE where "PRR_ID" = 370217;

-- Linux
insert into INF_DQMREP.PR_RESOURCE 
(PRR_ID, PRR_VERSION, PRR_PARENTPATH, PRR_RELROOT, PRR_MAXIID, PRR_NUMOBJECTS, PRR_NSID, PRR_PARENTID, PRR_PARENTCONTAINER, PRR_NAME, PRR_TYPENAME, PRR_OID) 
values 
(370217,1,'/',-1,0,1,28,37580,37580,'resource_366526','com.informatica.repository.models.persist.resiliency.impl.RequestResponseImpl',127);
commit;

start RINFDQD1
(same error)

select count(*) FROM "INF_DQMREP"."PR_RESOURCE"  WHERE "PRR_ID" = 370217;
AIX		1
Linux	1

select count(*) FROM "INF_DQMREP"."PR_RESOURCE"  WHERE "PRR_ID" = 370217;

select count(*) from INF_DQMREP.PR_RESOURCE where "PRR_ID" = 370217;
AIX		1
Linux	0

-- Linux
ALTER TABLE INF_DQMREP.PR_RESOURCE DISABLE CONSTRAINT FK_PR_RESOURCE_PR_;

edit params RINFDQD1
HANDLECOLLISIONS
start RINFDQD1
(same error)

select dbms_metadata.get_ddl('CONSTRAINT',CONSTRAINT_NAME,OWNER) 
from dba_constraints where TABLE_NAME='PR_RESOURCE' and CONSTRAINT_NAME not like 'FK_PR_RESOURCE_PR%';
ORA-31603: object "FK_PR_RESOURCE_PR_" of type CONSTRAINT not found in schema "INF_DQMREP"
(same in AIX and Linux - all others return DDL)

  CREATE TABLE "INF_DQMREP"."PR_RESOURCE"
   (    "PRR_ID" NUMBER(19,0) NOT NULL ENABLE,
        "PRR_VERSION" NUMBER(10,0) NOT NULL ENABLE,
        "PRR_PARENTPATH" VARCHAR2(595 CHAR),
        "PRR_RELROOT" NUMBER(19,0) NOT NULL ENABLE,
        "PRR_MAXIID" NUMBER(19,0) NOT NULL ENABLE,
        "PRR_NUMOBJECTS" NUMBER(19,0) NOT NULL ENABLE,
        "PRR_NSID" NUMBER(10,0) NOT NULL ENABLE,
        "PRR_PARENTID" NUMBER(19,0) NOT NULL ENABLE,
        "PRR_PARENTCONTAINER" NUMBER(19,0),
        "PRR_NAME" VARCHAR2(255 CHAR) NOT NULL ENABLE,
        "PRR_TYPENAME" VARCHAR2(765 CHAR),
        "PRR_OID" NUMBER(19,0),
         UNIQUE ("PRR_NSID", "PRR_PARENTID", "PRR_NAME")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "INF_DQMREP_DATA"  ENABLE,
         PRIMARY KEY ("PRR_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "INF_DQMREP_DATA"  ENABLE,
         CONSTRAINT "FK_PR_RESOURCE_PR_" FOREIGN KEY ("PRR_PARENTCONTAINER")
          REFERENCES "INF_DQMREP"."PR_RESOURCE" ("PRR_ID") DISABLE
   ) SEGMENT CREATION IMMEDIATE
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255
 ROW STORE COMPRESS ADVANCED LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "INF_DQMREP_DATA"

ALTER TABLE "INF_DQMREP"."PR_RESOURCE" DROP CONSTRAINT FK_PR_RESOURCE_PR_;
OWNER                CONSTRAINT_NAME                COLUMN_NAME                    C STATUS
-------------------- ------------------------------ ------------------------------ - --------
INF_DQMREP           SYS_C0016451                   PRR_NAME                       U ENABLED
INF_DQMREP           SYS_C0016451                   PRR_NSID                       U ENABLED
INF_DQMREP           SYS_C0016451                   PRR_PARENTID                   U ENABLED
INF_DQMREP           SYS_C0016452                   PRR_ID                         P ENABLED
INF_DQMREP           SYS_C0013741                   PRR_ID                         C ENABLED
INF_DQMREP           SYS_C0013742                   PRR_VERSION                    C ENABLED
INF_DQMREP           SYS_C0013743                   PRR_RELROOT                    C ENABLED
INF_DQMREP           SYS_C0013744                   PRR_MAXIID                     C ENABLED
INF_DQMREP           SYS_C0013745                   PRR_NUMOBJECTS                 C ENABLED
INF_DQMREP           SYS_C0013746                   PRR_NSID                       C ENABLED
INF_DQMREP           SYS_C0013747                   PRR_PARENTID                   C ENABLED
INF_DQMREP           SYS_C0013748                   PRR_NAME                       C ENABLED

start RINFDQD1
(same error)

ALTER TABLE INF_DQMREP.PR_RESOURCE DISABLE CONSTRAINT SYS_C0016451;
ALTER TABLE INF_DQMREP.PR_RESOURCE DISABLE CONSTRAINT SYS_C0013741;
ALTER TABLE INF_DQMREP.PR_RESOURCE DISABLE CONSTRAINT SYS_C0013742;
ALTER TABLE INF_DQMREP.PR_RESOURCE DISABLE CONSTRAINT SYS_C0013743;
ALTER TABLE INF_DQMREP.PR_RESOURCE DISABLE CONSTRAINT SYS_C0013744;
ALTER TABLE INF_DQMREP.PR_RESOURCE DISABLE CONSTRAINT SYS_C0013745;
ALTER TABLE INF_DQMREP.PR_RESOURCE DISABLE CONSTRAINT SYS_C0013746;
ALTER TABLE INF_DQMREP.PR_RESOURCE DISABLE CONSTRAINT SYS_C0013747;
ALTER TABLE INF_DQMREP.PR_RESOURCE DISABLE CONSTRAINT SYS_C0013748;

start RINFDQD1
(same error)

REPLICAT   RINFDQD1  Last Started 2017-05-07 18:08   Status ABENDED
INTEGRATED
Checkpoint Lag       79:28:06 (updated 06:03:20 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/infdqd/ra000000002
                     2017-05-04 04:39:31.380114  RBA 4642110

./logdump
open /app/oracle/product/ggate/12c/1/dirdat/infdqd/ra000000002
ghdr on
pos 4642110
detail on
n
___________________________________________________________________
Hdr-Ind    :     E  (x45)     Partition  :     .  (x00)
UndoFlag   :     .  (x00)     BeforeAfter:     A  (x41)
RecLength  :  1253  (x04e5)   IO Time    : 2017/05/04 08:44:58.384.861
IOType     :   170  (xaa)     OrigNode   :     2  (x02)
TransInd   :     .  (x03)     FormatType :     R  (x52)
SyskeyLen  :     0  (x00)     Incomplete :     .  (x00)
DDR/TDR Idx:   (001, 021)     AuditPos   : 5600272
Continued  :     N  (x00)     RecCount   :     1  (x01)

2017/05/04 08:44:58.384.861 Metadata             Len 1253 RBA 4642110
___________________________________________________________________
Hdr-Ind    :     E  (x45)     Partition  :     .  (x0c)
UndoFlag   :     .  (x00)     BeforeAfter:     A  (x41)
RecLength  :   265  (x0109)   IO Time    : 2017/05/04 04:40:54.984.790
IOType     :     5  (x05)     OrigNode   :   255  (xff)
TransInd   :     .  (x03)     FormatType :     R  (x52)
SyskeyLen  :     0  (x00)     Incomplete :     .  (x00)
AuditRBA   :         45       AuditPos   : 5600272
Continued  :     N  (x00)     RecCount   :     1  (x01)

2017/05/04 04:40:54.984.790 Insert               Len   265 RBA 4643446


alter replicat RINFDQD1 extseqno 2 extrba 4642110
(same error)

ALTER TABLE "INF_DQMREP"."PR_RESOURCE"
ADD CONSTRAINT FK_PR_RESOURCE_PR 
FOREIGN KEY (PRR_PARENTCONTAINER) 
REFERENCES "INF_DQMREP"."PR_RESOURCE" ("PRR_ID") ON DELETE SET NULL;
ALTER TABLE INF_DQMREP.PR_RESOURCE DISABLE CONSTRAINT FK_PR_RESOURCE_PR;


set truncate off 
set linesize 900 
set LONG 990000 
set longchunksize 9000
set  numwidth 15 
set heading off 
set feedback off 
set trimspool on 
set appinfo on 
set verify off;

echo 'info RINFDQD1 showch' | ./ggsci > SRDC_GG_CHKPINFO.txt


*** Per Oracle replicat pointing to AIX database ***
Replicat and Pump deleted and recreated

info PINFDQD1
EXTRACT    PINFDQD1  Last Started 2017-05-07 20:42   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           41812550
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/infdqd/ea000000000
                     2017-05-03 23:29:32.000000  RBA 1508241

send extract PINFDQD1 status
EXTRACT PINFDQD1 (PID 41812550)
  Current status: Recovery complete: At EOF

  Current read position:
  Sequence #: 0
  RBA: 1508241
  Timestamp: 2017-05-03 23:29:32.000000
  Extract Trail: /nomove/app/oracle/ggate/12c/1/dirdat/infdqd/ea

  Current write position:
  Sequence #: 0
  RBA: 1508301
  Timestamp: 2017-05-07 20:53:30.378810
  Extract Trail: /app/oracle/product/ggate/12c/1/dirdat/infdqd/ra

stop PINFDQD1
alter extract PINFDQD1 extseqno 1 extrba 0
start PINFDQD1

EXTRACT    PINFDQD1  Last Started 2017-05-07 20:56   Status RUNNING
Checkpoint Lag       83:24:59 (updated 00:00:00 ago)
Process ID           13500864
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/infdqd/ea000000001
                     2017-05-04 09:31:24.000000  RBA 6364869

info RINFDQD1
REPLICAT   RINFDQD1  Last Started 2017-05-07 20:37   Status ABENDED
INTEGRATED
Checkpoint Lag       93:13:54 (updated 00:00:34 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/infdqd/ra000000002
                     2017-05-03 23:42:36.110184  RBA 4642110

2017-05-07 20:56:31  WARNING OGG-01154  SQL error 1 mapping INF_DQMREP.PR_RESOURCE to INFDQD.INF_DQMREP.PR_RESOURCE OCI Error ORA-00001: unique constrain
t (INF_DQMREP.SYS_C0016452) violated (status = 1), SQL <INSERT INTO "INF_DQMREP"."PR_RESOURCE" ("PRR_ID","PRR_VERSION","PRR_PARENTPATH","PRR_RELROOT","PR
R_MAXIID","PRR_NUMOBJECTS","PRR_NSID","PRR_PARENTID","PRR_PARENTCONTAINER","PRR_NAME","PRR_TYPENAME","PRR_OID") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:
a8,:a9,:a10,:a11)>.

edit params RINFDQD1
REPERROR (1,DISCARD)
start RINFDQD1

2017-05-07 21:04:35  WARNING OGG-01154  SQL error 1403 mapping INF_DQMREP.PO_REQUESTRESPONSE to INFDQD.INF_DQMREP.PO_REQUESTRESPONSE OCI Error ORA-01403:
 no data found, SQL <DELETE FROM "INF_DQMREP"."PO_REQUESTRESPONSE"  WHERE "PSR_OPID" = :b0>.

edit params RINFDQD1
REPERROR (1403,DISCARD)
start RINFDQD1


############
# infdqd   #
# PINFDQD1 #
############

-- pump not pushing over latest trail file

REPLICAT   RINFDQD1  Last Started 2017-05-07 21:07   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:08 (updated 00:00:04 ago)
Process ID           19274
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/infdqd/ra000000002
                     2017-05-08 08:34:02.440518  RBA 77201350

EXTRACT    PINFDQD1  Last Started 2017-05-07 20:56   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:00:02 ago)
Process ID           13500864
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/infdqd/ea000000003
                     2017-05-08 08:40:56.000000  RBA 58795644

send extract PINFDQD1 status

EXTRACT PINFDQD1 (PID 13500864)
  Current status: Recovery complete: At EOF

  Current read position:
  Sequence #: 3
  RBA: 58786764
  Timestamp: 2017-05-08 08:37:27.000000
  Extract Trail: /nomove/app/oracle/ggate/12c/1/dirdat/infdqd/ea

  Current write position:
  Sequence #: 2
  RBA: 77210778
  Timestamp: 2017-05-08 08:37:43.061677
  Extract Trail: /app/oracle/product/ggate/12c/1/dirdat/infdqd/ra

  
############
# inf91d   #
# EINF91D1 #
# uxd34    #
# 5/10     #
############

2017-05-10 20:06:41  ERROR   OGG-06601  Mismatch between the length of seqno from checkpoint (9) and recovery (6) for extract trail /nomove/app/oracle/ggate/12c/1/dirdat/inf91d/ea.

send extract PINF91D1 status

EXTRACT PINF91D1 (PID 64684300)
  Current status: Recovery complete: At EOF

  Current read position:
  Sequence #: 0
  RBA: 33885752
  Timestamp: 2017-05-09 16:19:54.000000
  Extract Trail: /nomove/app/oracle/ggate/12c/1/dirdat/inf91d/ea

stop PINF91D1
alter extract EINF91D1 etrollover
start EINF91D1

EXTRACT    EINF91D1  Last Started 2017-05-10 20:19   Status RUNNING
Checkpoint Lag       27:59:15 (updated 00:00:00 ago)
Process ID           50266412
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-05-09 16:19:57
                     SCN 2547.3004524213 (10942286227125)

sh ls -l /nomove/app/oracle/ggate/12c/1/dirdat/inf91d
total 72488
drwxrwxrwx    2 591421462 591415677       4096 May  9 16:27 dmpdir
-rwxrwxrwx    1 591421462 591415677   33885752 May  9 16:19 ea000000000
-rw-r-----    1 oracle   dba         3071394 May 10 20:19 ea000000001

alter extract PINF91D1 extseqno 1 extrba 0
start PINF91D1

EXTRACT    PINF91D1  Last Started 2017-05-10 20:20   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:00:10 ago)
Process ID           54657618
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/inf91d/ea000000001
                     First Record  RBA 0

					 
##################
# infdqd         #
# lxora12cinfs02 #
# 6/3            #
##################

2017-06-02 16:42:39.099000 -04:00
statement in resumable session 'SYSTEM.SYS_IMPORT_FULL_01.1' was suspended due to
    ORA-01652: unable to extend temp segment by 128 in tablespace TEMP
...
2017-06-02 16:52:00.449000 -04:00
ALTER DATABASE TEMPFILE 3 RESIZE 10g
Resize operation completed for file# 213, old size 102400K, new size 10485760K
...
2017-06-02 16:58:37.402000 -04:00
statement in resumable session 'SYSTEM.SYS_IMPORT_FULL_01.1' was suspended due to
    ORA-01652: unable to extend temp segment by 128 in tablespace TEMP
...
2017-06-02 17:04:46.906000 -04:00
ALTER TABLESPACE TEMP ADD TEMPFILE '/database/infdqd01/oradata/temp03.dbf' SIZE 10g
...
2017-06-02 17:11:44.870000 -04:00
statement in resumable session 'SYSTEM.SYS_IMPORT_FULL_01.1' was suspended due to
    ORA-01652: unable to extend temp segment by 128 in tablespace TEMP
...
2017-06-02 17:18:00.635000 -04:00
ALTER DATABASE TEMPFILE 3 RESIZE 20g
Resize operation completed for file# 213, old size 10485760K, new size 20971520K
...
2017-06-02 17:24:34.288000 -04:00
statement in resumable session 'SYSTEM.SYS_IMPORT_FULL_01.1' was suspended due to
    ORA-01652: unable to extend temp segment by 128 in tablespace TEMP
...
2017-06-02 17:26:32.164000 -04:00
ALTER DATABASE TEMPFILE 3 RESIZE 30g
Resize operation completed for file# 213, old size 20971520K, new size 31457280K
...
2017-06-02 17:33:23.243000 -04:00
statement in resumable session 'SYSTEM.SYS_IMPORT_FULL_01.1' was suspended due to
    ORA-01652: unable to extend temp segment by 128 in tablespace TEMP
...
2017-06-02 17:44:37.801000 -04:00
ALTER DATABASE TEMPFILE 4 RESIZE 30g
Resize operation completed for file# 214, old size 10485760K, new size 31457280K
2017-06-02 17:45:07.800000 -04:00
ALTER DATABASE TEMPFILE 5 RESIZE 30g
Resize operation completed for file# 215, old size 10485760K, new size 31457280K
...
2017-06-02 17:46:26.579000 -04:00
ALTER TABLESPACE TEMP ADD TEMPFILE '/database/infdqd01/oradata/temp04.dbf' SIZE 30g
2017-06-02 17:46:37.357000 -04:00
ALTER TABLESPACE TEMP ADD TEMPFILE '/database/infdqd01/oradata/temp05.dbf' SIZE 30g
...
TABLESPACE_NAME                  MB_TOTAL    MB_USED    MB_FREE
------------------------------ ---------- ---------- ----------
TEMP                               153600      66965      86636
...
2017-06-02 19:10:12.953000 -04:00
statement in resumable session 'SYSTEM.SYS_IMPORT_FULL_01.1' was suspended due to
    ORA-30036: unable to extend segment by 8 in undo tablespace 'UNDO'
...
2017-06-02 19:22:03.329000 -04:00
ALTER DATABASE DATAFILE 5 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M
Completed: ALTER DATABASE DATAFILE 5 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M
Resize operation completed for file# 5, old size 102400K, new size 364544K
...
2017-06-02 19:49:55.093000 -04:00
statement in resumable session 'SYSTEM.SYS_IMPORT_FULL_01.1' was suspended due to
    ORA-30036: unable to extend segment by 8 in undo tablespace 'UNDO'
...
2017-06-02 19:52:19.218000 -04:00
ALTER DATABASE DATAFILE 13 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M
2017-06-02 19:52:21.524000 -04:00
Resize operation completed for file# 13, old size 2048000K, new size 2310144K
...
2017-06-02 20:19:43.883000 -04:00
statement in resumable session 'SYSTEM.SYS_IMPORT_FULL_01.1' was suspended due to
    ORA-30036: unable to extend segment by 8 in undo tablespace 'UNDO'
...
2017-06-02 20:23:00.378000 -04:00
ALTER TABLESPACE UNDO ADD DATAFILE '/database/infdqd01/oradata/undo02.dbf' SIZE 32000m
...
2017-06-02 20:34:37.188000 -04:00
ALTER TABLESPACE UNDO ADD DATAFILE '/database/infdqd01/oradata/undo03.dbf' SIZE 32000m
...


###########
# prodt   #
# extract #
# uxt33   #
# 6/9     #
###########

-- Newly added integrated replicat hangs and waits on library cache lock (Doc ID 2058020.1)
 select /*+ ordered */ w1.sid  waiting_session,
           h1.sid  holding_session,
        w.kgllktype lock_or_pin,
           w.kgllkhdl address,
          decode(h.kgllkmod,  0, 'None', 1, 'Null', 2, 'Share', 3, 'Exclusive',
              'Unknown') mode_held,
        decode(w.kgllkreq,  0, 'None', 1, 'Null', 2, 'Share', 3, 'Exclusive',
            'Unknown') mode_requested
     from dba_kgllock w, dba_kgllock h, v$session w1, v$session h1
 where
     (((h.kgllkmod != 0) and (h.kgllkmod != 1)
     and ((h.kgllkreq = 0) or (h.kgllkreq = 1)))
   and
     (((w.kgllkmod = 0) or (w.kgllkmod= 1))
        and ((w.kgllkreq != 0) and (w.kgllkreq != 1))))
  and  w.kgllktype      =  h.kgllktype
     and  w.kgllkhdl =  h.kgllkhdl
  and  w.kgllkuse     =   w1.saddr
     and  h.kgllkuse     =   h1.saddr;
	 
	 
SQL> alter system set aq_tm_processes=0;

Check if all qmon processes disappeared at os level or not 

select program from v$session where program like '%QMON%' or program like '%Q0%';

and then execute below SQL:

SQL> alter system set aq_tm_processes=1;


############
# blcdwst  #
# RBL_WST1 #
# 6/9      #
############

2017-06-10 05:58:47  WARNING OGG-01154  SQL error 1403 mapping DWPERSIST.AUDIT_EXTRACT_PERID to BLCDWST.DWPERSIST.AUDIT_EXTRACT_PERID OCI Error ORA-01403: no data f
nd, SQL <
UPDATE "DWPERSIST"."AUDIT_EXTRACT_PERID" x 
SET x."PROCESS" = :a8,x."START_WORKFLOW" = :a9,x."SRC_EXTRACT_FROM_DATE" = :a10,x."SRC_EXTRACT_TO_DATE" = :a11,x
SUCCESS_FLAG" = :a12,x."PARAMETER_OVERRIDE" = :a13,x."INSRT_DATE" = :a14,x."LAST_UPDAT_DATE" = :a15 
WHERE x."PROCESS" = :b0 AND x."START_WORKFLOW" = :b1 AND x."SRC_
TRACT_FROM_DATE" = :b2 AND x."SRC_EXTRACT_TO_DATE" = :b3 AND x."SUCCESS_FLAG" = :b4 AND x."PARAMETER_OVERRIDE" = :b5 AND x."INSRT_DATE" = :b6 AND x."LAST_UPDAT_DATE
= :b7 AND ROWNUM = 1>.

-- discard file
Mapping problem with unified PK update record (target format)...
*
PROCESS = IFP
START_WORKFLOW = wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily
SRC_EXTRACT_FROM_DATE = 2017-06-08 09:00:22
SRC_EXTRACT_TO_DATE = 2017-06-08 09:00:23
SUCCESS_FLAG = N
PARAMETER_OVERRIDE = N
INSRT_DATE = 2017-06-09 06:49:39
LAST_UPDAT_DATE = 2017-06-09 06:49:39

PROCESS = IFP
START_WORKFLOW = wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily
SRC_EXTRACT_FROM_DATE = 2017-06-08 09:00:22
SRC_EXTRACT_TO_DATE = 2017-06-09 06:38:38
SUCCESS_FLAG = Y
PARAMETER_OVERRIDE = N
INSRT_DATE = 2017-06-09 06:49:39
LAST_UPDAT_DATE = 2017-06-09 07:26:25

-- data pump
. . exported "DWPERSIST"."AUDIT_EXTRACT_PERID"           588.1 KB    7687 rows
06/09/2017 09:51:36.405: . . imported "DWPERSIST"."AUDIT_EXTRACT_PERID"           588.1 KB    7687 rows in 0 seconds


-- sqlplus
select owner, table_name, record_count
from ggtest.row_count_aix
where owner='DWPERSIST' and table_name='AUDIT_EXTRACT_PERID';
aix		7687
linux	7687

select owner, table_name, record_count
from ggtest.row_count_linux
where owner='DWPERSIST' and table_name='AUDIT_EXTRACT_PERID';
linux	7687

select count(*) from DWPERSIST.AUDIT_EXTRACT_PERID;
aix		7705
linux	7694

select count(*) from DWPERSIST.AUDIT_EXTRACT_PERID where 
PROCESS = 'IFP' and
START_WORKFLOW = 'wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily' and
SRC_EXTRACT_FROM_DATE = to_date('2017-06-08 09:00:22','YYYY-MM-DD HH24:MI:SS') and
SRC_EXTRACT_TO_DATE = to_date('2017-06-08 09:00:23','YYYY-MM-DD HH24:MI:SS') and
SUCCESS_FLAG = 'N' and
PARAMETER_OVERRIDE = 'N' and
INSRT_DATE = to_date('2017-06-09 06:49:39','YYYY-MM-DD HH24:MI:SS') and
LAST_UPDAT_DATE = to_date('2017-06-09 06:49:39','YYYY-MM-DD HH24:MI:SS');
aix		0
linux	0

select count(*) from DWPERSIST.AUDIT_EXTRACT_PERID where 
PROCESS = 'IFP' and
START_WORKFLOW = 'wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily' and
SRC_EXTRACT_FROM_DATE = to_date('2017-06-08 09:00:22','YYYY-MM-DD HH24:MI:SS') and
SRC_EXTRACT_TO_DATE = to_date('2017-06-09 06:38:38','YYYY-MM-DD HH24:MI:SS') and
SUCCESS_FLAG = 'Y' and
PARAMETER_OVERRIDE = 'N' and
INSRT_DATE = to_date('2017-06-09 06:49:39','YYYY-MM-DD HH24:MI:SS') and
LAST_UPDAT_DATE = to_date('2017-06-09 07:26:25','YYYY-MM-DD HH24:MI:SS');
aix		1
linux	0

-- linux
insert into DWPERSIST.AUDIT_EXTRACT_PERID 
(PROCESS, START_WORKFLOW, SRC_EXTRACT_FROM_DATE, SRC_EXTRACT_TO_DATE, SUCCESS_FLAG, PARAMETER_OVERRIDE, INSRT_DATE,LAST_UPDAT_DATE)
values
('IFP','wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily', to_date('2017-06-08 09:00:22','YYYY-MM-DD HH24:MI:SS'), to_date('2017-06-09 06:38:38','YYYY-MM-DD HH24:MI:SS'),
'Y', 'N',  to_date('2017-06-09 06:49:39','YYYY-MM-DD HH24:MI:SS'), to_date('2017-06-09 07:26:25','YYYY-MM-DD HH24:MI:SS'));

-- ggsci
start RBL_WST1
REPLICAT   RBL_WST1  Last Started 2017-06-10 12:09   Status ABENDED
INTEGRATED
Checkpoint Lag       14:03:20 (updated 16:43:07 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/blcdwst/ra000000009
                     2017-06-09 05:24:57.280498  RBA 879208446

2017-06-10 12:10:01  WARNING OGG-01154  SQL error 1403 mapping DWPERSIST.AUDIT_EXTRACT_PERID to BLCDWST.DWPERSIST.AUDIT_EXTRACT_PERID
-- nothing new in discard file

-- linux
delete from DWPERSIST.AUDIT_EXTRACT_PERID where 
PROCESS = 'IFP' and
START_WORKFLOW = 'wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily' and
SRC_EXTRACT_FROM_DATE = to_date('2017-06-08 09:00:22','YYYY-MM-DD HH24:MI:SS') and
SRC_EXTRACT_TO_DATE = to_date('2017-06-09 06:38:38','YYYY-MM-DD HH24:MI:SS') and
SUCCESS_FLAG = 'Y' and
PARAMETER_OVERRIDE = 'N' and
INSRT_DATE = to_date('2017-06-09 06:49:39','YYYY-MM-DD HH24:MI:SS') and
LAST_UPDAT_DATE = to_date('2017-06-09 07:26:25','YYYY-MM-DD HH24:MI:SS');

insert into DWPERSIST.AUDIT_EXTRACT_PERID 
(PROCESS, START_WORKFLOW, SRC_EXTRACT_FROM_DATE, SRC_EXTRACT_TO_DATE, SUCCESS_FLAG, PARAMETER_OVERRIDE, INSRT_DATE,LAST_UPDAT_DATE)
values
('IFP','wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily',to_date('2017-06-08 09:00:22','YYYY-MM-DD HH24:MI:SS'),to_date('2017-06-08 09:00:23','YYYY-MM-DD HH24:MI:SS'),
'N','N',to_date('2017-06-09 06:49:39','YYYY-MM-DD HH24:MI:SS'),to_date('2017-06-09 06:49:39','YYYY-MM-DD HH24:MI:SS'));
commit;

-- ggsci
start RBL_WST1

REPLICAT   RBL_WST1  Last Started 2017-06-10 12:18   Status ABENDED
INTEGRATED
Checkpoint Lag       06:05:41 (updated 06:37:38 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/blcdwst/ra000000012
                     2017-06-10 07:01:54.505445  RBA 302677558

2017-06-10 13:07:41  WARNING OGG-01154  SQL error 1403 mapping DWPERSIST.AUDIT_EXTRACT_PERID to BLCDWST.DWPERSIST.AUDIT_EXTRACT_PERID 
OCI Error ORA-01403: no data found, SQL 
<UPDATE "DWPERSIST"."AUDIT_EXTRACT_PERID" x 
SET x."PROCESS" = :a8,x."START_WORKFLOW" = :a9,x."SRC_EXTRACT_FROM_DATE" = :a10,x."SRC_EXTRACT_TO_DATE" = :a11,x."SUCCESS_FLAG" = :a12,x."PARAMETER_OVERRIDE" = :a13,x."INSRT_DATE" = :a14,x."LAST_UPDAT_DATE" = :a15 
WHERE x."PROCESS" = :b0 AND x."START_WORKFLOW" = :b1 AND x."SRC_EXTRACT_FROM_DATE" = :b2 AND x."SRC_EXTRACT_TO_DATE" = :b3 AND x."SUCCESS_FLAG" = :b4 AND x."PARAMETER_OVERRIDE" = :b5 AND x."INSRT_DATE" = :b6 AND x."LAST_UPDAT_DATE" = :b7 AND ROWNUM = 1>.

-- discard file
PROCESS = IFP
START_WORKFLOW = wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily
SRC_EXTRACT_FROM_DATE = 2017-06-09 06:38:39
SRC_EXTRACT_TO_DATE = 2017-06-09 06:38:40
SUCCESS_FLAG = N
PARAMETER_OVERRIDE = N
INSRT_DATE = 2017-06-10 07:20:56
LAST_UPDAT_DATE = 2017-06-10 07:20:56

PROCESS = IFP
START_WORKFLOW = wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily
SRC_EXTRACT_FROM_DATE = 2017-06-09 06:38:39
SRC_EXTRACT_TO_DATE = 2017-06-10 07:06:39
SUCCESS_FLAG = Y
PARAMETER_OVERRIDE = N
INSRT_DATE = 2017-06-10 07:20:56
LAST_UPDAT_DATE = 2017-06-10 07:42:28

-- sqlplus
select count(*) from DWPERSIST.AUDIT_EXTRACT_PERID where 
PROCESS = 'IFP' and
START_WORKFLOW = 'wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily' and
SRC_EXTRACT_FROM_DATE = to_date('2017-06-09 06:38:39','YYYY-MM-DD HH24:MI:SS') and
SRC_EXTRACT_TO_DATE = to_date('2017-06-09 06:38:40','YYYY-MM-DD HH24:MI:SS') and
SUCCESS_FLAG = 'N' and
PARAMETER_OVERRIDE = 'N' and
INSRT_DATE = to_date('2017-06-10 07:20:56','YYYY-MM-DD HH24:MI:SS') and
LAST_UPDAT_DATE = to_date('2017-06-10 07:20:56','YYYY-MM-DD HH24:MI:SS');
aix		0
linux	0

select count(*) from DWPERSIST.AUDIT_EXTRACT_PERID where 
PROCESS = 'IFP' and
START_WORKFLOW = 'wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily' and
SRC_EXTRACT_FROM_DATE = to_date('2017-06-09 06:38:39','YYYY-MM-DD HH24:MI:SS') and
SRC_EXTRACT_TO_DATE = to_date('2017-06-10 07:06:39','YYYY-MM-DD HH24:MI:SS') and
SUCCESS_FLAG = 'Y' and
PARAMETER_OVERRIDE = 'N' and
INSRT_DATE = to_date('2017-06-10 07:20:56','YYYY-MM-DD HH24:MI:SS') and
LAST_UPDAT_DATE = to_date('2017-06-10 07:42:28','YYYY-MM-DD HH24:MI:SS');
aix		1
linux	0

-- linux
insert into DWPERSIST.AUDIT_EXTRACT_PERID 
(PROCESS, START_WORKFLOW, SRC_EXTRACT_FROM_DATE, SRC_EXTRACT_TO_DATE, SUCCESS_FLAG, PARAMETER_OVERRIDE, INSRT_DATE,LAST_UPDAT_DATE)
values
('IFP','wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily',
to_date('2017-06-09 06:38:39','YYYY-MM-DD HH24:MI:SS'),
to_date('2017-06-09 06:38:40','YYYY-MM-DD HH24:MI:SS'),
'N','N',
to_date('2017-06-10 07:20:56','YYYY-MM-DD HH24:MI:SS'),
to_date('2017-06-10 07:20:56','YYYY-MM-DD HH24:MI:SS'));
commit;

-- ggsci
start RBL_WST1

REPLICAT   RBL_WST1  Last Started 2017-06-10 20:09   Status RUNNING
INTEGRATED
Checkpoint Lag       09:56:58 (updated 00:02:35 ago)
Process ID           14680
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/blcdwst/ra000000012
                     2017-06-10 10:13:03.927832  RBA 328927106


###############
# LXORADWST01 #
# 6/12        #
###############

-- /app/oracle/product/ggate/12c/1
Program     Status      Group       Lag at Chkpt  Time Since Chkpt
MANAGER     STOPPED

-- ggserr.log
2017-06-12 11:39:16  INFO    OGG-00987  Oracle GoldenGate Command Interpreter for Oracle:  GGSCI command (oracle): info all.
2017-06-12 11:39:21  INFO    OGG-00987  Oracle GoldenGate Command Interpreter for Oracle:  GGSCI command (oracle): start mgr.
2017-06-12 11:39:21  WARNING OGG-01877  Oracle GoldenGate Manager for Oracle, mgr.prm:  Missing explicit accessrule for server collector.
2017-06-12 11:39:21  INFO    OGG-00960  Oracle GoldenGate Manager for Oracle, mgr.prm:  Access granted (rule #8).
2017-06-12 11:39:21  ERROR   OGG-01224  Oracle GoldenGate Manager for Oracle, mgr.prm:  Address already in use.
2017-06-12 11:39:21  ERROR   OGG-01668  Oracle GoldenGate Manager for Oracle, mgr.prm:  PROCESS ABENDING.

-- no changes
(oracle@LXORADWST01:none-/app/oracle/product/ggate/12c/1/dirprm)> ll
total 8
-rw-r--r--. 1 oracle dba 218 Jun  4 22:15 ealldbs_DDL.inc
-rw-r--r--. 1 oracle dba 724 Jun  2 08:23 mgr.prm

-- MGR.rpt
(same as ggserr.log)

> netstat -tuplen | grep 7819
tcp6       0      0 :::7819                 :::*                    LISTEN      591421462  12990554   110556/./mgr
> netstat -tuplen | grep 7919
tcp6       0      0 :::7919                 :::*                    LISTEN      591421462  12989744   110506/./mgr

-- /app/oracle/product/ggate/11g/1
(no installation)

> ps -ef | grep mgr
oracle   110506      1  0 Jun06 ?        00:03:21 ./mgr PARAMFILE /app/oracle/product/ggate/11g/1/dirprm/mgr.prm REPORTFILE /app/oracle/product/ggate/11g/1/dirrpt/MGR.rpt PROCESSID MGR USESUBDIRS
oracle   110556      1  0 Jun06 ?        00:03:53 ./mgr PARAMFILE /app/oracle/product/ggate/12c/1/dirprm/mgr.prm REPORTFILE /app/oracle/product/ggate/12c/1/dirrpt/MGR.rpt PROCESSID MGR USESUBDIRS

> kill 110506
> kill 110556

./ggsci
start mgr

Program     Status      Group       Lag at Chkpt  Time Since Chkpt
MANAGER     RUNNING


##################
# infdqd         #
# lxora12cinfs02 #
# 6/3            #
##################

-- Oracle SR
Adding undo space and raising retention in the parameters won't help. 
LOBs have their own undo in the lob tablespace, independent of system undo. 
So we are seeing messages on LOB things, we need to add a datafile to the LOB tablespace. 

-- INFDQ_PROFILING LOB data
OWNER                          TABLE_NAME                     COLUMN_NAME                              TABLESPACE_NAME
------------------------------ ------------------------------ ---------------------------------------- ------------------------------
INFDQ_PROFILING                IDP_PQ_SERIALIZED_PR           SERIALIZED_PR                            INFDQ_PROFILING_DATA
INFDQ_PROFILING                IDP_PQ_SERIALIZED_PT           SERIALIZED_PT                            INFDQ_PROFILING_DATA
INFDQ_PROFILING                IDP_PROFILE_VERSION            PROFILE_DESC                             INFDQ_PROFILING_DATA

-- linux (6/12)
        ID FILE_NAME                                                                           MB      MaxMB AUT
---------- --------------------------------------------------------------------------- ---------- ---------- ---
        29 /database/infdqd01/oradata/infdq_profiling_data_01.dbf                             100     32,000 YES
        35 /database/infdqd01/oradata/infdq_profiling_data_02.dbf                             100     32,000 YES
        36 /database/infdqd01/oradata/infdq_profiling_data_03.dbf                             100     32,000 YES
                                                                                       ---------- ----------
TOTAL                                                                                         300     96,000

! df -h /database/infdqd01/oradata
Filesystem                          Size  Used Avail Use% Mounted on
/dev/mapper/databasevg-database_lv 1000G  436G  565G  44% /database

ALTER TABLESPACE INFDQ_PROFILING_DATA ADD DATAFILE '/database/infdqd01/oradata/infdq_profiling_data_04.dbf' SIZE 100M AUTOEXTEND ON NEXT 500M MAXSIZE 32000M;
ALTER TABLESPACE INFDQ_PROFILING_DATA ADD DATAFILE '/database/infdqd01/oradata/infdq_profiling_data_05.dbf' SIZE 100M AUTOEXTEND ON NEXT 500M MAXSIZE 32000M;

        ID FILE_NAME                                                                           MB      MaxMB AUT
---------- --------------------------------------------------------------------------- ---------- ---------- ---
        29 /database/infdqd01/oradata/infdq_profiling_data_01.dbf                             100     32,000 YES
        35 /database/infdqd01/oradata/infdq_profiling_data_02.dbf                             100     32,000 YES
        36 /database/infdqd01/oradata/infdq_profiling_data_03.dbf                             100     32,000 YES
        37 /database/infdqd01/oradata/infdq_profiling_data_04.dbf                             100     32,000 YES
        38 /database/infdqd01/oradata/infdq_profiling_data_05.dbf                             100     32,000 YES
                                                                                       ---------- ----------
TOTAL                                                                                         500    160,000

impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORA12CINFS02.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=infdqd)))\" parfile=/database/cinfdqd_admn01/scripts/impdp_infdqd.par

Resumable error: ORA-01652: unable to extend temp segment by 128 in tablespace TEMP
06/12/2017 17:06:16.278: Resumable stmt: INSERT /*+ APPEND PARALLEL("IDP_VERBOSE_FIELD_DTL_RES",4)+*/ INTO RELATIONAL("INFDQ_PROFILING"."IDP_VERBOSE_FIELD_DTL_RES" NOT XMLTYPE) ("SOURCE_ID", "DP_ROW_NUMBER", "FIELD_KEY", "FIELD_VALUE")     SELECT "SOURCE_ID", "DP_ROW_NUMBER", "FIELD_KEY", "FIELD_VALUE"     FROM "SYSTEM"."ET$002802400001" KU$

set lines 150 pages 200
col USERNAME format a10
col TABLESPACE format a8
select username, session_num, tablespace, segtype, segfile#, ts#, con_id
from v$tempseg_usage
where segtype like '%LOB%'
order by con_id, segtype, segfile#; 
USERNAME   SESSION_NUM TABLESPA SEGTYPE     SEGFILE#        TS#     CON_ID
---------- ----------- -------- --------- ---------- ---------- ----------
                 55674 TEMP     LOB_DATA         211          3          1
                 55674 TEMP     LOB_INDEX        211          3          1
SYSTEM           60141 UNDO     LOB_DATA           0          2          3
SYSTEM           46434 UNDO     LOB_DATA           0          2          3
SYSTEM           58725 UNDO     LOB_DATA           0          2          3
SYSTEM            7684 UNDO     LOB_DATA           0          2          3
SYSTEM             576 UNDO     LOB_DATA           0          2          3
SYSTEM            9384 UNDO     LOB_DATA           0          2          3
SYSTEM             576 UNDO     LOB_INDEX          0          2          3

  ID FILE_NAME                                                    TS                           MB      MAXMB AUT
---- ------------------------------------------------------------ -------------------- ---------- ---------- ---
   3 /database/infdqd01/oradata/temp01.dbf                        TEMP                        100        100 NO
   4 /database/infdqd01/oradata/temp02.dbf                        TEMP                     10,240     10,240 NO
                                                                                       ---------- ----------
TOTA                                                                                       10,340     10,340

ALTER DATABASE TEMPFILE 3 AUTOEXTEND ON NEXT 256M maxsize 32000m;
ALTER DATABASE TEMPFILE 4 AUTOEXTEND ON NEXT 256M maxsize 32000m;

ALTER TABLESPACE TEMP ADD TEMPFILE '/database/infdqd01/oradata/temp03.dbf' SIZE 32000m;
ALTER TABLESPACE TEMP ADD TEMPFILE '/database/infdqd01/oradata/temp04.dbf' SIZE 32000m;
ALTER TABLESPACE TEMP ADD TEMPFILE '/database/infdqd01/oradata/temp05.dbf' SIZE 32000m;

  ID FILE_NAME                                                            MB      MaxMB AUT
---- ------------------------------------------------------------ ---------- ---------- ---
   5 /database/cinfdqd01/oradata/undo.dbf                                100        100 NO
  14 /database/infdqd01/oradata/undo01.dbf                             2,000      2,000 NO
                                                                  ---------- ----------
TOTA                                                                   2,100      2,100

ALTER DATABASE DATAFILE 5 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M;
ALTER DATABASE DATAFILE 14 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M;
ALTER TABLESPACE UNDO ADD DATAFILE '/database/infdqd01/oradata/undo02.dbf' SIZE 32000m;
ALTER TABLESPACE UNDO ADD DATAFILE '/database/infdqd01/oradata/undo03.dbf' SIZE 32000m;

06/12/2017 16:54:33.764: Starting "SYSTEM"."SYS_IMPORT_FULL_01":  "system/********@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORA12CINFS02.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=infdqd)))" parfile=/database/cinfdqd_admn01/scripts/impdp_infdqd.par
...
06/12/2017 17:06:16.276: ORA-39171: Job is experiencing a resumable wait.
Resumable error: ORA-01652: unable to extend temp segment by 128 in tablespace TEMP
06/12/2017 17:06:16.278: Resumable stmt: INSERT /*+ APPEND PARALLEL("IDP_VERBOSE_FIELD_DTL_RES",4)+*/ INTO RELATIONAL("INFDQ_PROFILING"."IDP_VERBOSE_FIELD_DTL_RES" NOT XMLTYPE) ("SOURCE_ID", "DP_ROW_NUMBER", "FIELD_KEY", "FIELD_VALUE")     SELECT "SOURCE_ID", "DP_ROW_NUMBER", "FIELD_KEY", "FIELD_VALUE"     FROM "SYSTEM"."ET$002802400001" KU$
...
06/12/2017 22:26:29.510: ORA-39171: Job is experiencing a resumable wait.
Resumable error: ORA-30036: unable to extend segment by 8 in undo tablespace 'UNDO'
06/12/2017 22:26:29.647: Resumable stmt: INSERT /*+ APPEND PARALLEL("IDP_VERBOSE_FIELD_DTL_RES",4)+*/ INTO RELATIONAL("INFDQ_PROFILING"."IDP_VERBOSE_FIELD_DTL_RES" NOT XMLTYPE) ("SOURCE_ID", "DP_ROW_NUMBER", "FIELD_KEY", "FIELD_VALUE")     SELECT "SOURCE_ID", "DP_ROW_NUMBER", "FIELD_KEY", "FIELD_VALUE"     FROM "SYSTEM"."ET$002802400001" KU$
...
06/13/2017 00:23:33.986: ORA-39171: Job is experiencing a resumable wait.
Resumable error: ORA-30036: unable to extend segment by 8 in undo tablespace 'UNDO'
06/13/2017 00:23:33.990: Resumable stmt:
06/13/2017 00:23:33.992: Resumable stmt status: TIMEOUT
06/13/2017 00:23:33.993: Resumable stmt start: 06/12/17 16:55:47 stmt suspend: 06/12/17 22:21:07
...
06/13/2017 02:11:10.630: ORA-31693: Table data object "INFDQ_PROFILING"."IDP_VERBOSE_FIELD_DTL_RES" failed to load/unload and is being skipped due to error:
ORA-30032: the suspended (resumable) statement has timed out
ORA-30036: unable to extend segment by 8 in undo tablespace 'UNDO'
...
06/13/2017 02:19:51.829: Job "SYSTEM"."SYS_IMPORT_FULL_01" completed with 83 error(s) at Tue Jun 13 02:19:51 2017 elapsed 0 09:25:20

  ID FILE_NAME                                                                           MB      MaxMB AUT
---- --------------------------------------------------------------------------- ---------- ---------- ---
   5 /database/cinfdqd01/oradata/undo.dbf                                            32,000     32,000 YES
  14 /database/infdqd01/oradata/undo01.dbf                                           32,000     32,000 YES
  39 /database/infdqd01/oradata/undo02.dbf                                           32,000     32,000 NO
  40 /database/infdqd01/oradata/undo03.dbf                                           32,000     32,000 NO
                                                                                 ---------- ----------
TOTA                                                                                128,000    128,000

BEGIN_TIME      END_TIME            TXNs   ACTIVE MB    UNEXP MB      EXP MB     USED MB
--------------- --------------- -------- ----------- ----------- ----------- -----------
12-JUN-17 20:00 12-JUN-17 20:10    8,893           2          48          35         170
12-JUN-17 20:10 12-JUN-17 20:20  525,672         174          42          41      11,808
12-JUN-17 20:20 12-JUN-17 20:30  526,847      24,092          42          41      12,074
12-JUN-17 20:30 12-JUN-17 20:40  545,080      36,764          42          41      12,670
12-JUN-17 20:40 12-JUN-17 20:50  524,604      36,764          42          41      12,194
12-JUN-17 20:50 12-JUN-17 21:00  512,582      48,924          42          41      11,907
12-JUN-17 21:00 12-JUN-17 21:10  485,869      60,831           7          73      11,111
12-JUN-17 21:10 12-JUN-17 21:20  521,973      71,968          15           1      10,112
12-JUN-17 21:20 12-JUN-17 21:30  475,247      82,080          15           1      10,404
12-JUN-17 21:30 12-JUN-17 21:40  453,150      92,453          11           0      10,355
12-JUN-17 21:40 12-JUN-17 21:50  431,277     102,821          11           0       9,851
12-JUN-17 21:50 12-JUN-17 22:00  414,226     112,676          12           0       9,484
12-JUN-17 22:00 12-JUN-17 22:10  140,963     125,072          31           3       2,961
12-JUN-17 22:10 12-JUN-17 22:20  133,074     127,915          32           0       2,854
12-JUN-17 22:20 12-JUN-17 22:30    8,291     127,996           0           0          82

  ID FILE_NAME                                                                           MB      MAXMB AUT
---- --------------------------------------------------------------------------- ---------- ---------- ---
   3 /database/infdqd01/oradata/temp01.dbf                                           19,044     32,000 YES
   4 /database/infdqd01/oradata/temp02.dbf                                           12,544     32,000 YES
   5 /database/infdqd01/oradata/temp03.dbf                                           32,000     32,000 NO
   6 /database/infdqd01/oradata/temp04.dbf                                           32,000     32,000 NO
   7 /database/infdqd01/oradata/temp05.dbf                                           32,000     32,000 NO
                                                                                 ---------- ----------
TOTA                                                                                127,588    160,000

TABLESPACE_NAME                  MB_TOTAL    MB_USED    MB_FREE
------------------------------ ---------- ---------- ----------
TEMP                               127588      66929     127583


############
# blcdwst  #
# RBL_WST1 #
# 6/13     #
############

REPLICAT   RBL_WST1  Last Started 2017-06-13 12:09   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:50 (updated 00:24:57 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/blcdwst/ra000000017
                     2017-06-13 11:53:27.731695  RBA 486674590

-- RBL_WST1.rpt
2017-06-13 12:09:32  WARNING OGG-01154  SQL error 1403 mapping DWPERSIST.AUDIT_EXTRACT_PERID to BLCDWST.DWPERSIST.AUDIT_EXTRACT_PERID OCI Error ORA-01403: no data found, SQL <UPDATE "DWPERSIST"."AUDIT_EXTRACT_PERID" x SET x."PROCESS" = :a8,x."START_WORKFLOW" = :a9,x."SRC_EXTRACT_FROM_DATE" = :a10,x."SRC_EXTRACT_TO_DATE" = :a11,x."SUCCESS_FLAG" = :a12,x."PARAMETER_OVERRIDE" = :a13,x."INSRT_DATE" = :a14,x."LAST_UPDAT_DATE" = :a15 WHERE x."PROCESS" = :b0 AND x."START_WORKFLOW" = :b1 AND x."SRC_EXTRACT_FROM_DATE" = :b2 AND x."SRC_EXTRACT_TO_DATE" = :b3 AND x."SUCCESS_FLAG" = :b4 AND x."PARAMETER_OVERRIDE" = :b5 AND x."INSRT_DATE" = :b6 AND x."LAST_UPDAT_DATE" = :b7 AND ROWNUM = 1>.
2017-06-13 12:09:32  ERROR   OGG-01296  Error mapping from DWPERSIST.AUDIT_EXTRACT_PERID to BLCDWST.DWPERSIST.AUDIT_EXTRACT_PERID.

-- RBL_WST1.dsc
OCI Error ORA-01403: no data found, SQL <
UPDATE "DWPERSIST"."AUDIT_EXTRACT_PERID" x 
SET x."PROCESS" = :a8,x."START_WORKFLOW" = :a9,x."SRC_EXTRACT_FROM_DATE" = :a10,x."SRC_EXTRACT_TO_DATE" = :a11,x."SUCCESS_FLAG" = :a12,x."PARAMETER_OVERRIDE" = :a13,x."INSRT_DATE" = :a14,x."LAST_UPDAT_DATE" = :a15 
WHERE x."PROCESS" = :b0 AND x."START_WORKFLOW" = :b1 AND x."SRC_EXTRACT_FROM_DATE" = :b2 AND x."SRC_EXTRACT_TO_DATE" = :b3 AND x."SUCCESS_FLAG" = :b4 AND x."PARAMETER_OVERRIDE" = :b5 AND x."INSRT_DATE" = :b6 AND x."LAST_UPDAT_DATE" = :b7 AND ROWNUM = 1>

PROCESS = IFP
START_WORKFLOW = wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily
SRC_EXTRACT_FROM_DATE = 2017-06-10 07:06:40
SRC_EXTRACT_TO_DATE = 2017-06-10 07:06:41
SUCCESS_FLAG = N
PARAMETER_OVERRIDE = N
INSRT_DATE = 2017-06-13 11:26:00
LAST_UPDAT_DATE = 2017-06-13 11:26:00

PROCESS = IFP
START_WORKFLOW = wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily
SRC_EXTRACT_FROM_DATE = 2017-06-10 07:06:40
SRC_EXTRACT_TO_DATE = 2017-06-13 11:15:13
SUCCESS_FLAG = Y
PARAMETER_OVERRIDE = N
INSRT_DATE = 2017-06-13 11:26:00
LAST_UPDAT_DATE = 2017-06-13 11:54:14

-- lxoradwst01
select count(*) from "DWPERSIST"."AUDIT_EXTRACT_PERID" where
PROCESS = 'IFP' and
START_WORKFLOW = 'wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily' and
SRC_EXTRACT_FROM_DATE = to_date('2017-06-10 07:06:40','YYYY-MM-DD HH24:MI:SS') and
SRC_EXTRACT_TO_DATE = to_date('2017-06-10 07:06:41','YYYY-MM-DD HH24:MI:SS') and
SUCCESS_FLAG = 'N' and
PARAMETER_OVERRIDE = 'N' and
INSRT_DATE = to_date('2017-06-13 11:26:00','YYYY-MM-DD HH24:MI:SS') and
LAST_UPDAT_DATE = to_date('2017-06-13 11:26:00','YYYY-MM-DD HH24:MI:SS');
  COUNT(*)
----------
         0

select count(*) from "DWPERSIST"."AUDIT_EXTRACT_PERID" where
PROCESS = 'IFP' and
START_WORKFLOW = 'wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily' and
SRC_EXTRACT_FROM_DATE = to_date('2017-06-10 07:06:40','YYYY-MM-DD HH24:MI:SS') and
SRC_EXTRACT_TO_DATE = to_date('2017-06-13 11:15:13','YYYY-MM-DD HH24:MI:SS') and
SUCCESS_FLAG = 'Y' and
PARAMETER_OVERRIDE = 'N' and
INSRT_DATE = to_date('2017-06-13 11:26:00','YYYY-MM-DD HH24:MI:SS') and
LAST_UPDAT_DATE = to_date('2017-06-13 11:54:14','YYYY-MM-DD HH24:MI:SS');
  COUNT(*)
----------
         0

insert into "DWPERSIST"."AUDIT_EXTRACT_PERID"
(PROCESS,START_WORKFLOW,SRC_EXTRACT_FROM_DATE ,SRC_EXTRACT_TO_DATE ,SUCCESS_FLAG ,PARAMETER_OVERRIDE ,INSRT_DATE ,LAST_UPDAT_DATE )
values
('IFP','wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily',to_date('2017-06-10 07:06:40','YYYY-MM-DD HH24:MI:SS')
,to_date('2017-06-10 07:06:41','YYYY-MM-DD HH24:MI:SS'),'N','N',to_date('2017-06-13 11:26:00','YYYY-MM-DD HH24:MI:SS')
,to_date('2017-06-13 11:26:00','YYYY-MM-DD HH24:MI:SS'));
commit;

-- ggsci
start RBL_WST1

REPLICAT   RBL_WST1  Last Started 2017-06-13 12:44   Status RUNNING
INTEGRATED
Checkpoint Lag       00:05:23 (updated 00:02:23 ago)
Process ID           4392
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/blcdwst/ra000000017
                     2017-06-13 12:58:15.776268  RBA 991256196

############
# cnofdwt  #
# RCN_DWT1 #
# 6/14     #
############

REPLICAT   RCN_DWT1  Last Started 2017-06-14 09:04   Status ABENDED
INTEGRATED
Checkpoint Lag       01:27:15 (updated 00:07:18 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/cnofdwt/ra000000000
                     2017-06-14 07:37:25.147063  RBA 20133

-- RCN_DWT1.rpt
2017-06-14 09:04:40  INFO    OGG-06513  Resolving target sequence :CNOFDWT.AUDIT_DW.SEQ_INB_PROCESS_CONTROL_LOG.
2017-06-14 09:04:40  WARNING OGG-01154  SQL error 6550 mapping AUDIT_DW.SEQ_INB_PROCESS_CONTROL_LOG to CNOFDWT.AUDIT_DW.SEQ_INB_PROCESS_CONTROL_LOG.
2017-06-14 09:04:40  ERROR   OGG-01296  Error mapping from AUDIT_DW.SEQ_INB_PROCESS_CONTROL_LOG to CNOFDWT.AUDIT_DW.SEQ_INB_PROCESS_CONTROL_LOG.

-- RCN_DWT1.dsc
Problem replicating AUDIT_DW.SEQ_INB_PROCESS_CONTROL_LOG to CNOFDWT.AUDIT_DW.SEQ_INB_PROCESS_CONTROL_LOG
Mapping problem with compressed update record (target format)...
*
No columns were available
*

-- uxt33
set lines 150 pages 200
col owner format a30
col object_name format a30
select owner, object_name, object_type, status
from dba_objects
where owner='AUDIT_DW' and object_name='SEQ_INB_PROCESS_CONTROL_LOG';
OWNER                          OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ------------------------------ ----------------------- -------
AUDIT_DW                       SEQ_INB_PROCESS_CONTROL_LOG    SEQUENCE                VALID

SELECT AUDIT_DW.SEQ_INB_PROCESS_CONTROL_LOG.CURRVAL FROM dual;
ORA-08002: sequence SEQ_INB_PROCESS_CONTROL_LOG.CURRVAL is not yet defined in this session

-- LXORAFINT01
alter session set container=cnofdwt;
OWNER                          OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ------------------------------ ----------------------- -------
AUDIT_DW                       SEQ_INB_PROCESS_CONTROL_LOG    SEQUENCE                VALID

-- UXT33
dblogin userid ggs@cnofdwt
flush sequence AUDIT_DW.SEQ_INB_PROCESS_CONTROL_LOG

-- LXOGGM01
start RCN_DWT1
ABENDED
RBA 20133

-- LXOGGM01 - GLOBALS
GGSCHEMA ggs

-- RCN_DWT1 params
USERID ggs@cnofdwt

-- LXORAFINT01
col object_name format a30
select object_type, object_name, status from dba_objects where owner='GGS' order by 1,2;
OBJECT_TYPE             OBJECT_NAME                    STATUS
----------------------- ------------------------------ -------
PROCEDURE               GETSEQFLUSH                    VALID
PROCEDURE               REPLICATESEQUENCE              VALID
PROCEDURE               SEQTRACE                       VALID
PROCEDURE               UPDATESEQUENCE                 VALID

alter session set container=cnofdwt;
select object_type, object_name, status from dba_objects where owner='GGS' and object_type='PROCEDURE' order by 1,2;
no rows selected

@/app/oracle/product/ggate/12c/1/sequence.sql
OBJECT_TYPE             OBJECT_NAME                    STATUS
----------------------- ------------------------------ -------
PROCEDURE               GETSEQFLUSH                    VALID
PROCEDURE               REPLICATESEQUENCE              VALID
PROCEDURE               SEQTRACE                       VALID
PROCEDURE               UPDATESEQUENCE                 VALID

-- LXOGGM01
start RCN_DWT1
REPLICAT   RCN_DWT1  Last Started 2017-06-14 10:35   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           12807
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/cnofdwt/ra000000000
                     2017-06-14 10:35:51.906394  RBA 13860936

############
# blcdwst  #
# RBL_WST1 #
# 6/14     #
############

REPLICAT   RBL_WST1  Last Started 2017-06-13 12:44   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:55 (updated 01:20:45 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/blcdwst/ra000000020
                     2017-06-14 09:40:50.663107  RBA 398410439

-- RBL_WST1.dsc
OCI Error ORA-01403: no data found, SQL <
UPDATE "DWPERSIST"."AUDIT_EXTRACT_PERID" x 
SET x."PROCESS" = :a8,x."START_WORKFLOW" = :a9,x."SRC_EXTRACT_FROM_DATE" = :a10,x."SRC_EXTRACT
_TO_DATE" = :a11,x."SUCCESS_FLAG" = :a12,x."PARAMETER_OVERRIDE" = :a13,x."INSRT_DATE" = :a14,x."LAST_UPDAT_DATE" = :a15 
WHERE x."PROCESS" = :b0 AND x."START_WORKFLOW" = :b1 AND x
."SRC_EXTRACT_FROM_DATE" = :b2 AND x."SRC_EXTRACT_TO_DATE" = :b3 AND x."SUCCESS_FLAG" = :b4 AND x."PARAMETER_OVERRIDE" = :b5 AND x."INSRT_DATE" = :b6 AND x."LAST_UPDAT_DATE" = :b
7 AND ROWNUM = 1>

PROCESS = IFP
START_WORKFLOW = wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily
SRC_EXTRACT_FROM_DATE = 2017-06-13 11:15:14
SRC_EXTRACT_TO_DATE = 2017-06-13 11:15:15
SUCCESS_FLAG = N
PARAMETER_OVERRIDE = N
INSRT_DATE = 2017-06-14 09:04:03
LAST_UPDAT_DATE = 2017-06-14 09:04:03

select count(*) from "DWPERSIST"."AUDIT_EXTRACT_PERID" where
PROCESS = 'IFP' and
START_WORKFLOW = 'wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily' and
SRC_EXTRACT_FROM_DATE = to_date('2017-06-13 11:15:14','YYYY-MM-DD HH24:MI:SS') and
SRC_EXTRACT_TO_DATE = to_date('2017-06-13 11:15:15','YYYY-MM-DD HH24:MI:SS') and
SUCCESS_FLAG = 'N' and
PARAMETER_OVERRIDE = 'N' and
INSRT_DATE = to_date('2017-06-14 09:04:03','YYYY-MM-DD HH24:MI:SS') and
LAST_UPDAT_DATE = to_date('2017-06-14 09:04:03','YYYY-MM-DD HH24:MI:SS');

insert into "DWPERSIST"."AUDIT_EXTRACT_PERID"
(PROCESS,START_WORKFLOW,SRC_EXTRACT_FROM_DATE ,SRC_EXTRACT_TO_DATE ,SUCCESS_FLAG ,PARAMETER_OVERRIDE ,INSRT_DATE ,LAST_UPDAT_DATE )
values
('IFP','wf_DM_POLCY_DIMSN_PDT_UPDATE_Daily',to_date('2017-06-13 11:15:14','YYYY-MM-DD HH24:MI:SS'),to_date('2017-06-13 11:15:15','YYYY-MM-DD HH24:MI:SS'),
'N','N',to_date('2017-06-14 09:04:03','YYYY-MM-DD HH24:MI:SS'),to_date('2017-06-14 09:04:03','YYYY-MM-DD HH24:MI:SS'));


############
# infdmt   #
# RINFDMT1 #
# 6/15     #
############

REPLICAT   RINFDMT1  Last Started 2017-06-15 12:31   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:12 (updated 00:43:54 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/infdmt/ra000000000
                     2017-06-15 12:02:13.502083  RBA 58423854

2017-06-15 12:31:26  WARNING OGG-01154  SQL error 1403 mapping INF_DQDM.ISP_MASTER_ELECTION to INFDMT.INF_DQDM.ISP_MASTER_ELECTION OCI Error ORA-01403: no data found
, SQL <UPDATE "INF_DQDM"."ISP_MASTER_ELECTION" x SET x."DOMAIN_NAME" = :a6,x."NODE_NAME" = :a7,x."HOST_NAME" = :a8,x."PORTNUM" = :a9,x."LAST_REFRESH_TIME" = :a10,x."
ELECTION_STATUS" = :a11 WHERE x."DOMAIN_NAME" = :b0 AND x."NODE_NAME" = :b1 AND x."HOST_NAME" = :b2 AND x."PORTNUM" = :b3 AND x."LAST_REFRESH_TIME" = :b4 AND x."ELEC
TION_STATUS" = :b5 AND ROWNUM = 1>.

-- RINFDMT1.dsc
DOMAIN_NAME = DQDOMAIN_INTEGRATION961
NODE_NAME = node01_lxinfdqt02
HOST_NAME = LXINFDQT02
PORTNUM = 6006
LAST_REFRESH_TIME = 1497542524250
ELECTION_STATUS = Election Complete

DOMAIN_NAME = DQDOMAIN_INTEGRATION961
NODE_NAME = node01_lxinfdqt02
HOST_NAME = LXINFDQT02
PORTNUM = 6006
LAST_REFRESH_TIME = 1497542539250
ELECTION_STATUS = Election Complete

-- LXORAENTT01
alter session set container=infdmt;
select count(*) from INF_DQDM.ISP_MASTER_ELECTION where
DOMAIN_NAME = 'DQDOMAIN_INTEGRATION961' and
NODE_NAME = 'node01_lxinfdqt02' and
HOST_NAME = 'LXINFDQT02' and
PORTNUM = 6006 and
LAST_REFRESH_TIME = 1497542524250 and
ELECTION_STATUS = 'Election Complete';
  COUNT(*)
----------
         0

select count(*) from INF_DQDM.ISP_MASTER_ELECTION where
DOMAIN_NAME = 'DQDOMAIN_INTEGRATION961' and
NODE_NAME = 'node01_lxinfdqt02' and
HOST_NAME = 'LXINFDQT02' and
PORTNUM = 6006 and
LAST_REFRESH_TIME = 1497542539250 and
ELECTION_STATUS = 'Election Complete';

insert into INF_DQDM.ISP_MASTER_ELECTION
(DOMAIN_NAME, NODE_NAME, HOST_NAME, PORTNUM, LAST_REFRESH_TIME, ELECTION_STATUS)
values
('DQDOMAIN_INTEGRATION961','node01_lxinfdqt02','LXINFDQT02',6006,1497542524250,'Election Complete');
commit;

-- ggsci
start RINFDMT1
REPLICAT   RINFDMT1  Last Started 2017-06-15 13:50   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:22 ago)
Process ID           24016
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/infdmt/ra000000000
                     2017-06-15 13:50:42.247436  RBA 58464161

					 
############
# trecsct  #
# RTR_SCT1 #
# 6/19     #
############

2017-06-19 08:35:37  WARNING OGG-01154  SQL error 30036 mapping TRECS.TEMP_CUSTOMFIELDS to TRECS.TEMP_CUSTOMFIELDS OCI Error ORA-30036: unable to extend segment by 8
 in undo tablespace 'UNDO' (status = 30036), SQL <DELETE FROM "TRECS"."TEMP_CUSTOMFIELDS"  WHERE "TRANID" = :b0 AND "FIELDNUMBER" = :b1>.
2017-06-19 08:35:37  ERROR   OGG-01296  Error mapping from TRECS.TEMP_CUSTOMFIELDS to TRECS.TEMP_CUSTOMFIELDS.

        ID FILE_NAME                                                                           MB      MaxMB AUT
---------- --------------------------------------------------------------------------- ---------- ---------- ---
         3 /database/trecsct01/oradata/undo01.dbf                                           3,072      3,072 NO
                                                                                       ---------- ----------
TOTAL                                                                                       3,072      3,072

Filesystem                              Size  Used Avail Use% Mounted on
/dev/mapper/trecsctvg01-trecsct01_lv01  379G  124G  237G  35% /database/trecsct01

-- undo size script skipped during DB build
-- extended manually


############
# documkrt #
# PDO_KRT1 #
# 6/19     #
############

2017-06-19 00:39:54  ERROR   OGG-01233  Send TCP params error: TCP/IP error 32 (Broken pipe), endpoint: lxoggm01:7833.

-- restarted


###########
# pbizt   #
# PPBIZT2 #
# 6/20    #
###########

2017-06-20 14:39:01  WARNING OGG-06591  Reading the output trail file /app/oracle/product/ggate/12c/1/dirdat/pbizt/RR/ra000000 encounters an error from position 0, r
escan from the file header to recover.
2017-06-20 14:39:11  ERROR   OGG-01031  There is a problem in network communication, a remote file problem, encryption keys for target and source do not match (if us
ing ENCRYPT) or an unknown error. (Reply received is Unable to open file "/app/oracle/product/ggate/12c/1/dirdat/pbizt/RR/ra000000000" (error 11, Resource temporaril
y unavailable)).

EXTRACT    PPBIZT2   Last Started 2017-06-20 15:00   Status ABENDED
Checkpoint Lag       00:00:00 (updated 01:27:17 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/pbizt/RR/ea000000000
                     First Record  RBA 0

REPLICAT   RPBIZT2   Last Started 2017-06-20 14:21   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:03 ago)
Process ID           28235
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/pbizt/RR/ra000000000
                     2017-06-20 14:07:45.887261  RBA 158977

-- lxoggm01
stop RPBIZT2

REPLICAT   RPBIZT2   Last Started 2017-06-20 14:21   Status STOPPED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:08 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/pbizt/RR/ra000000000
                     2017-06-20 14:07:45.887261  RBA 158977

dblogin userid GGS@pbizt password M00nl1ght
delete RPBIZT2

ll /app/oracle/product/ggate/11g/1/dirdat/pbizt/RR
-rw-r-----. 1 oracle dba 159465 Jun 20 13:46 ra000000000

rm /app/oracle/product/ggate/11g/1/dirdat/pbizt/RR/ra*

-- lxorabpat02
dblogin userid GGS@cpbizt password M00nl1ght
delete PPBIZT2
add extract PPBIZT2, exttrailsource /app/oracle/product/ggate/12c/1/dirdat/pbizt/RR/ea
add rmttrail /app/oracle/product/ggate/12c/1/dirdat/pbizt/RR/ra, extract PPBIZT2, megabytes 1000
start PPBIZT2

EXTRACT    PPBIZT2   Last Started 2017-06-20 15:18   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:00:06 ago)
Process ID           31447
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/pbizt/RR/ea000000001
                     2017-06-20 13:46:04.354465  RBA 1829

-- lxoggm01
./GGRR_4_start_replicat_LXOGG.sh

REPLICAT   RPBIZT2   Last Started 2017-06-20 15:20   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:02:56 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/pbizt/RR/ra000000000
                     First Record  RBA 0

2017-06-20 15:20:44  WARNING OGG-01154  SQL error 1 mapping PBIZT.GGTEST.OBJECT_COUNT_LINUX to GGTEST.OBJECT_COUNT_LINUX OCI Error ORA-00001: unique constraint (GGTEST.OBJECT_COUNT_LINUX_PK) violated (status = 1), SQL <INSERT INTO "GGTEST"."OBJECT_COUNT_LINUX" ("OWNER","OBJECT_NAME","OBJECT_TYPE","STATUS") VALUES (:a0,:a1,:a2,:a3)>.

-- RPBIZT2.dsc
OCI Error ORA-00001: unique constraint (GGTEST.OBJECT_COUNT_LINUX_PK) violated (status = 1), SQL <INSERT INTO "GGTEST"."OBJECT_COUNT_LINUX" ("OWNER","OBJECT_NAME","O
BJECT_TYPE","STATUS") VALUES (:a0,:a1,:a2,:a3)>

OWNER = AUDSYS
OBJECT_NAME = CLI_LOB$ba785071$1$1
OBJECT_TYPE = INDEX
STATUS = VALID

-- uxt34
select count(*) from "GGTEST"."OBJECT_COUNT_LINUX" where
OWNER = 'AUDSYS' and
OBJECT_NAME = 'CLI_LOB$ba785071$1$1' and
OBJECT_TYPE = 'INDEX' and
STATUS = 'VALID';
  COUNT(*)
----------
         1

delete from "GGTEST"."OBJECT_COUNT_LINUX" where
OWNER = 'AUDSYS' and
OBJECT_NAME = 'CLI_LOB$ba785071$1$1' and
OBJECT_TYPE = 'INDEX' and
STATUS = 'VALID';

-- lxoggm01
start RPBIZT2

-- RPBIZT2.dsc
OCI Error ORA-00001: unique constraint (GGTEST.OBJECT_COUNT_LINUX_PK) violated (status = 1), SQL <INSERT INTO "GGTEST"."OBJECT_COUNT_LINUX" ("OWNER","OBJECT_NAME","O
BJECT_TYPE","STATUS") VALUES (:a0,:a1,:a2,:a3)>

OWNER = AUDSYS
OBJECT_NAME = CLI_LOB$d335bc94$2$1
OBJECT_TYPE = INDEX
STATUS = VALID

-- ggsci
edit params RPBIZT2
MAPEXCLUDE pbizt.GGTEST.OBJECT_COUNT_LINUX
MAPEXCLUDE pbizt.GGTEST.ROW_COUNT_LINUX

start RPBIZT2

REPLICAT   RPBIZT2   Last Started 2017-06-20 15:50   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:16 ago)
Process ID           29296
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/pbizt/RR/ra000000000
                     2017-06-20 15:50:20.884141  RBA 110208


###########
# fdlzt   #
# RFDLZT1 #
# 6/20    #
###########

REPLICAT   RFDLZT1   Last Started 2017-06-20 17:54   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:54:00 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzt/ra000000000
                     First Record  RBA 0

2017-06-20 17:54:50  WARNING OGG-01154  SQL error 1403 mapping FDLZ_FPMD.DIT_LOAD_DRIVER to FDLZ_FPMD.DIT_LOAD_DRIVER OCI Error ORA-01403: no data found, SQL <UPDATE
 "FDLZ_FPMD"."DIT_LOAD_DRIVER" x SET x."PROCESS_TYPE" = :a15,x."STAGE_VERSION" = :a16,x."STAGE_FLAG" = :a17,x."INBOUND_FLAG" = :a18,x."PERSISTENT_FLAG" = :a19,x."TRA
NSFORMATION_FLAG" = :a20,x."OUTBOUND_FLAG" = :a21,x."PUB_POLICY_FLAG" = :a22,x."PUB_CURRENT_FLAG" = :a23,x."ERROR_FLAG" = :a24,x."STATUS" = :a25,x."RETRO_FLAG" = :a2
6,x."RUN_FLAG" = :a27,x."UPDATED_BY" = :a28,x."UPDATED_DATE" = :a29 WHERE x."PROCESS_TYPE" = :b0 AND x."STAGE_VERSION" = :b1 AND x."STAGE_FLAG" is NULL AND x."INBOUN
D_FLAG" is NULL AND x."PERSISTENT_FLAG" is NULL AND x."TRANSFORMATION_FLAG" is NULL AND x."OUTBOUND_FLAG" is NULL AND x."PUB_POLICY_FLAG" is NULL AND x."PUB_CURRENT_
FLAG" is NULL AND x."ERROR_FLAG" is NULL AND x."STATUS" = :b10 AND x."RETRO_FLAG" = :b11 AND x."RUN_FLAG" is NULL AND x."UPDATED_BY" = :b13 AND x."UPDATED_DATE" = :b
14 AND ROWNUM = 1>.

-- dirrpt/RFDLZT1.dsc
OCI Error ORA-01403: no data found, SQL <UPDATE "FDLZ_FPMD"."DIT_LOAD_DRIVER" x SET x."PROCESS_TYPE" = :a15,x."STAGE_VERSION" = :a16,x."STAGE_FLAG" = :a17,x."INBOUND
_FLAG" = :a18,x."PERSISTENT_FLAG" = :a19,x."TRANSFORMATION_FLAG" = :a20,x."OUTBOUND_FLAG" = :a21,x."PUB_POLICY_FLAG" = :a22,x."PUB_CURRENT_FLAG" = :a23,x."ERROR_FLAG
" = :a24,x."STATUS" = :a25,x."RETRO_FLAG" = :a26,x."RUN_FLAG" = :a27,x."UPDATED_BY" = :a28,x."UPDATED_DATE" = :a29 WHERE x."PROCESS_TYPE" = :b0 AND x."STAGE_VERSION"
 = :b1 AND x."STAGE_FLAG" is NULL AND x."INBOUND_FLAG" is NULL AND x."PERSISTENT_FLAG" is NULL AND x."TRANSFORMATION_FLAG" is NULL AND x."OUTBOUND_FLAG" is NULL AND
x."PUB_POLICY_FLAG" is NULL AND x."PUB_CURRENT_FLAG" is NULL AND x."ERROR_FLAG" is NULL AND x."STATUS" = :b10 AND x."RETRO_FLAG" = :b11 AND x."RUN_FLAG" is NULL AND
x."UPDATED_BY" = :b13 AND x."UPDATED_DATE" = :b14 AND ROWNUM = 1>

PROCESS_TYPE = ISSUE_CIC
STAGE_VERSION = 1
STAGE_FLAG = NULL
INBOUND_FLAG = NULL
PERSISTENT_FLAG = NULL
TRANSFORMATION_FLAG = NULL
OUTBOUND_FLAG = NULL
PUB_POLICY_FLAG = NULL
PUB_CURRENT_FLAG = NULL
ERROR_FLAG = NULL
STATUS = Completed
RETRO_FLAG = N
RUN_FLAG = NULL
UPDATED_BY = wf_hop3_error_frm_ob_iss_wnic_d
UPDATED_DATE = 2017-06-20 11:44:32

PROCESS_TYPE = ISSUE_CIC
STAGE_VERSION = 1
STAGE_FLAG = R
INBOUND_FLAG = NULL
PERSISTENT_FLAG = NULL
TRANSFORMATION_FLAG = NULL
OUTBOUND_FLAG = NULL
PUB_POLICY_FLAG = NULL
PUB_CURRENT_FLAG = NULL
ERROR_FLAG = NULL
STATUS = Completed
RETRO_FLAG = N
RUN_FLAG = NULL
UPDATED_BY = wf_hop0_cic_s1_frm_cic_iss_wnic_d
UPDATED_DATE = 2017-06-20 11:52:41

-- LXORAFINT01
select count(*) from "FDLZ_FPMD"."DIT_LOAD_DRIVER" where
PROCESS_TYPE = 'ISSUE_CIC' and
STAGE_VERSION = 1 and
STATUS = 'Completed' and
RETRO_FLAG = 'N' and
UPDATED_BY = 'wf_hop3_error_frm_ob_iss_wnic_d' and
UPDATED_DATE = to_date('2017-06-20 11:44:32','YYYY-MM-DD HH24:MI:SS');
  COUNT(*)
----------
         0

select count(*) from "FDLZ_FPMD"."DIT_LOAD_DRIVER" where
PROCESS_TYPE = 'ISSUE_CIC' and
STAGE_VERSION = 1 and
STAGE_FLAG = 'R' and
STATUS = 'Completed' and
RETRO_FLAG = 'N' and
UPDATED_BY = 'wf_hop0_cic_s1_frm_cic_iss_wnic_d' and
UPDATED_DATE = to_date('2017-06-20 11:52:41','YYYY-MM-DD HH24:MI:SS');

insert into "FDLZ_FPMD"."DIT_LOAD_DRIVER"
(PROCESS_TYPE,STAGE_VERSION, STATUS, RETRO_FLAG, UPDATED_BY, UPDATED_DATE)
values
('ISSUE_CIC', 1,'Completed', 'N' , 'wf_hop3_error_frm_ob_iss_wnic_d' , to_date('2017-06-20 11:44:32','YYYY-MM-DD HH24:MI:SS'));
commit;

-- LXOGGM01
start RFDLZT1

REPLICAT   RFDLZT1   Last Started 2017-06-20 18:19   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:17 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzt/ra000000000
                     2017-06-20 18:19:14.690641  RBA 48227

2017-06-20 18:19:15  WARNING OGG-01154  SQL error 1 mapping FDLZ_FPMD.ERROR_DETAIL_STG_SOURCE to FDLZ_FPMD.ERROR_DETAIL_STG_SOURCE OCI Error ORA-00001: unique constr
aint (FDLZ_FPMD.ERROR_DETAIL_STG_SOURCE_PK) violated (status = 1), SQL <INSERT INTO "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" ("BATCH_ID","ADMIN_SYSTEM","ADMIN_COMPANY_C
ODE","ADMIN_BASE_PLAN_CODE","ADMIN_POLICY_NUMBER","ISSUE_AGE","ISSUE_DATE","ISSUE_STATE","PRIMARY_BIRTH_DATE","PRIMARY_SEX","RECORD_START_DATE","RESIDENT_STATE","RES
IDENT_ZIP","RIDER_PLANS","FLAG","HASH_KEY","VALUATION_DATE","CREATED_BY","UPDATED_BY","CREATED_DATE","UPDATED_DATE") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,
:a10,:a11,:a12,:a13,:a14,:a15,:a16,:a17,:a18,:a19,:a20)>.

-- dirrpt/RFDLZT1.dsc
BATCH_ID = 27396
ADMIN_SYSTEM = CIC
ADMIN_COMPANY_CODE = CAP
ADMIN_BASE_PLAN_CODE = CH70S1A
ADMIN_POLICY_NUMBER = 302546599
ISSUE_AGE = 37
ISSUE_DATE = 2000-12-15 00:00:00
ISSUE_STATE = VA
PRIMARY_BIRTH_DATE = 1963-05-15 00:00:00
PRIMARY_SEX = F
RECORD_START_DATE = 2017-05-26 00:00:00
RESIDENT_STATE = VA
RESIDENT_ZIP = 23223
RIDER_PLANS = 'CH7RS1A','M01XH','R51RS1','R51XS1'
FLAG = C
HASH_KEY = BD327E3D68C412AD41C1B59110CF83E8
VALUATION_DATE = 2017-06-30 00:00:00
CREATED_BY = s_hop3_error_stg_frm_source_ob_cib_d
UPDATED_BY = s_hop3_error_stg_frm_source_ob_cib_d
CREATED_DATE = 2017-06-20 12:08:01
UPDATED_DATE = 2017-06-20 12:08:01

-- LXORAFINT01
OWNER                CONSTRAINT_NAME                COLUMN_NAME                    C STATUS
-------------------- ------------------------------ ------------------------------ - --------
FDLZ_FPMD            ERROR_DETAIL_STG_SOURCE_PK     ADMIN_POLICY_NUMBER            P ENABLED
FDLZ_FPMD            ERROR_DETAIL_STG_SOURCE_PK     BATCH_ID                       P ENABLED
FDLZ_FPMD            ERROR_DETAIL_STG_SOURCE_PK     ADMIN_SYSTEM                   P ENABLED
FDLZ_FPMD            ERROR_DETAIL_STG_SOURCE_PK     ADMIN_COMPANY_CODE             P ENABLED

select count(*) from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'CAP' and
ADMIN_POLICY_NUMBER = 302546599;
  COUNT(*)
----------
         1

select count(*) from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'CAP' and
ADMIN_BASE_PLAN_CODE = 'CH70S1A' and
ADMIN_POLICY_NUMBER = 302546599 and
ISSUE_AGE = 37 and
ISSUE_DATE = to_date('2000-12-15 00:00:00','YYYY-MM-DD HH24:MI:SS') and
ISSUE_STATE = 'VA' and
PRIMARY_BIRTH_DATE = to_date('1963-05-15 00:00:00','YYYY-MM-DD HH24:MI:SS') and
PRIMARY_SEX = 'F' and
RECORD_START_DATE = to_date('2017-05-26 00:00:00','YYYY-MM-DD HH24:MI:SS') and
RESIDENT_STATE = 'VA' and
RESIDENT_ZIP = 23223 and
--RIDER_PLANS = 'CH7RS1A','M01XH','R51RS1','R51XS1' and
FLAG = 'C' and
HASH_KEY = 'BD327E3D68C412AD41C1B59110CF83E8' and
VALUATION_DATE = to_date('2017-06-30 00:00:00','YYYY-MM-DD HH24:MI:SS') and
CREATED_BY = 's_hop3_error_stg_frm_source_ob_cib_d' and
UPDATED_BY = 's_hop3_error_stg_frm_source_ob_cib_d' and
CREATED_DATE = to_date('2017-06-20 12:08:01','YYYY-MM-DD HH24:MI:SS') and
UPDATED_DATE = to_date('2017-06-20 12:08:01','YYYY-MM-DD HH24:MI:SS');
  COUNT(*)
----------
         1

delete from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'CAP' and
ADMIN_POLICY_NUMBER = 302546599;
commit;

-- dirrpt/RFDLZT1.dsc
BATCH_ID = 27396
ADMIN_SYSTEM = CIC
ADMIN_COMPANY_CODE = TLI
ADMIN_BASE_PLAN_CODE = T008NTIT1
ADMIN_POLICY_NUMBER = T  200916

select count(*) from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'TLI' and
ADMIN_BASE_PLAN_CODE = 'T008NTIT1' and
ADMIN_POLICY_NUMBER = 'T  200916';
  COUNT(*)
----------
         1

delete from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'TLI' and
ADMIN_BASE_PLAN_CODE = 'T008NTIT1' and
ADMIN_POLICY_NUMBER = 'T  200916';

-- dirrpt/RFDLZT1.dsc
BATCH_ID = 27396
ADMIN_SYSTEM = CIC
ADMIN_COMPANY_CODE = GAR
ADMIN_BASE_PLAN_CODE = C247NA0E
ADMIN_POLICY_NUMBER = 01A0913123

select count(*) from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'GAR' and
ADMIN_BASE_PLAN_CODE = 'C247NA0E' and
ADMIN_POLICY_NUMBER = '01A0913123';

delete from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'GAR' and
ADMIN_BASE_PLAN_CODE = 'C247NA0E' and
ADMIN_POLICY_NUMBER = '01A0913123';

-- dirrpt/RFDLZT1.dsc
BATCH_ID = 27396
ADMIN_SYSTEM = CIC
ADMIN_COMPANY_CODE = CAP
ADMIN_BASE_PLAN_CODE = XH10F5
ADMIN_POLICY_NUMBER = 303551762

select count(*) from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'CAP' and
ADMIN_BASE_PLAN_CODE = 'XH10F5' and
ADMIN_POLICY_NUMBER = '303551762';

delete from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'CAP' and
ADMIN_BASE_PLAN_CODE = 'XH10F5' and
ADMIN_POLICY_NUMBER = '303551762';

-- dirrpt/RFDLZT1.dsc
BATCH_ID = 27396
ADMIN_SYSTEM = CIC
ADMIN_COMPANY_CODE = CAP
ADMIN_BASE_PLAN_CODE = XH10F5
ADMIN_POLICY_NUMBER = 303592747

select count(*) from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'CAP' and
ADMIN_BASE_PLAN_CODE = 'XH10F5' and
ADMIN_POLICY_NUMBER = '303592747';

delete from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'CAP' and
ADMIN_BASE_PLAN_CODE = 'XH10F5' and
ADMIN_POLICY_NUMBER = '303592747';

-- dirrpt/RFDLZT1.dsc
BATCH_ID = 27396
ADMIN_SYSTEM = CIC
ADMIN_COMPANY_CODE = CAP
ADMIN_POLICY_NUMBER = 303572780

select count(*) from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'CAP' and
ADMIN_POLICY_NUMBER = '303572780';

delete from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'CAP' and
ADMIN_POLICY_NUMBER = '303572780';

-- dirrpt/RFDLZT1.dsc
BATCH_ID = 27396
ADMIN_SYSTEM = CIC
ADMIN_COMPANY_CODE = CAP
ADMIN_POLICY_NUMBER = 303580763

select count(*) from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'CAP' and
ADMIN_POLICY_NUMBER = '303580763';

delete from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'CAP' and
ADMIN_POLICY_NUMBER = '303580763';

-- dirrpt/RFDLZT1.dsc
BATCH_ID = 27396
ADMIN_SYSTEM = CIC
ADMIN_COMPANY_CODE = CAP
ADMIN_POLICY_NUMBER = 303567329

select count(*) from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'CAP' and
ADMIN_POLICY_NUMBER = '303567329';

delete from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'CAP' and
ADMIN_POLICY_NUMBER = '303567329';

-- dirrpt/RFDLZT1.dsc
BATCH_ID = 27396
ADMIN_SYSTEM = CIC
ADMIN_COMPANY_CODE = CAP
ADMIN_POLICY_NUMBER = 200815

from "FDLZ_FPMD"."ERROR_DETAIL_STG_SOURCE" where
BATCH_ID = 27396 and
ADMIN_SYSTEM = 'CIC' and
ADMIN_COMPANY_CODE = 'CAP' and
ADMIN_POLICY_NUMBER = '200815';

-- LXOGGM01
edit params RFDLZT1
REPERROR (1,DISCARD)

-- report
2017-06-20 19:14:16  WARNING OGG-01154  SQL error 6550 mapping FDLZ_FPMD.SQ_BATCH_ID to FDLZ_FPMD.SQ_BATCH_ID.

@/app/oracle/scripts/12cupgrade/sequence_auto.sql

REPLICAT   RFDLZT1   Last Started 2017-06-20 19:16   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           30712
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzt/ra000000000
                     2017-06-20 19:16:58.495951  RBA 491960

					 
############
# documkrt #
# RDO_KRT2 #
# 6/21     #
############

REPLICAT   RDO_KRT2  Last Started 2017-06-20 14:11   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:05 (updated 09:38:54 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/documkrt/RR/ra000000000
                     2017-06-21 00:09:41.360355  RBA 210027676

2017-06-21 00:09:55  WARNING OGG-02531  Inbound server OGG$RDO_KRT2 error status ORA-26808:ORA-26808: Apply process AS08 died unexpectedly.
ORA-30036: unable to extend segment by 8 in undo tablespace 'UNDO'

-- uxt33
        ID FILE_NAME                                                                           MB      MaxMB AUT
---------- --------------------------------------------------------------------------- ---------- ---------- ---
         3 /move/documkrt01/oradata/undo01.dbf                                                100        100 NO
                                                                                       ---------- ----------
TOTAL                                                                                         100        100

df -g /move/documkrt01
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
/dev/documkrtlv    504.00    497.16    2%       17     1% /move/documkrt01

ALTER DATABASE DATAFILE 3 RESIZE 1000M;

-- ggsci
start RDO_KRT2

REPLICAT   RDO_KRT2  Last Started 2017-06-21 10:19   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:07 ago)
Process ID           3242
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/documkrt/RR/ra000000000
                     2017-06-21 10:19:22.516998  RBA 210027933


###########
# fdlzt   #
# RFDLZT1 #
# 6/21    #
###########

REPLICAT   RFDLZT1   Last Started 2017-06-20 19:16   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:15 (updated 12:43:27 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzt/ra000000002
                     2017-06-20 21:05:13.065289  RBA 6832669

2017-06-20 21:05:28  WARNING OGG-01154  SQL error 1403 mapping FDLZ_EBS.EBS_PROCESS_CONTROL_LOG to FDLZ_EBS.EBS_PROCESS_CONTROL_LOG OCI Error ORA-01403:
no data found, SQL <UPDATE "FDLZ_EBS"."EBS_PROCESS_CONTROL_LOG" x SET x."EBS_PROCESS_CONTROL_KEY" = :a18,x."SOURCE_NAME" = :a19,x."FILE_NAME" = :a20,x."B
ATCH_ID" = :a21,x."BATCH_REC_COUNT" = :a22,x."BATCH_DEBIT_AMTS" = :a23,x."BATCH_CREDIT_AMTS" = :a24,x."PASSED_S1_COUNT" = :a25,x."PASSED_S1_AMOUNT" = :a2
6,x."PASSED_S2_COUNT" = :a27,x."PASSED_CV4_CHECK" = :a28,x."PASSED_CV12_CHECK" = :a29,x."PASSED_EBS_STAGING_COUNT" = :a30,x."PASSED_EBS_STAGING_AMOUNT" =
 :a31,x."INSERT_DATE" = :a32,x."UPDATED_BY" = :a33,x."UPDATE_DATE" = :a34,x."SOURCE_REC_COUNT" = :a35 WHERE x."EBS_PROCESS_CONTROL_KEY" = :b0 AND x."SOUR
CE_NAME" = :b1 AND x."FILE_NAME" is NULL AND x."BATCH_ID" = :b3 AND x."BATCH_REC_COUNT" = :b4 AND x."BATCH_DEBIT_AMTS" = :b5 AND x."BATCH_CREDIT_AMTS" =
:b6 AND x."PASSED_S1_COUNT" is NULL AND x."PASSED_S1_AMOUNT" is NULL AND x."PASSED_S2_COUNT" is NULL AND x."PASSED_CV4_CHECK" is NULL AND x."PASSED_CV12_
CHECK" is NULL AND x."PASSED_EBS_STAGING_COUNT" is NULL AND x."PASSED_EBS_STAGING_AMOUNT" is NULL AND x."INSERT_DATE" = :b14 AND x."UPDATED_BY" = :b15 AN
D x."UPDATE_DATE" is NULL AND x."SOURCE_REC_COUNT" = :b17 AND ROWNUM = 1>.

-- dirrpt/RFDLZT1.dsc
EBS_PROCESS_CONTROL_KEY = 13520
SOURCE_NAME = ISSUE AFFILIATE
FILE_NAME = NULL
BATCH_ID = ISSCML17276
BATCH_REC_COUNT = 27
BATCH_DEBIT_AMTS = 3208.5
BATCH_CREDIT_AMTS = 3208.5
PASSED_S1_COUNT = NULL
PASSED_S1_AMOUNT = NULL
PASSED_S2_COUNT = NULL
PASSED_CV4_CHECK = NULL
PASSED_CV12_CHECK = NULL
PASSED_EBS_STAGING_COUNT = NULL
PASSED_EBS_STAGING_AMOUNT = NULL
INSERT_DATE = 2017-06-20 21:04:31
UPDATED_BY = m_INB_ISSUE_CARMEL
UPDATE_DATE = NULL
SOURCE_REC_COUNT = 27

EBS_PROCESS_CONTROL_KEY = 13520
SOURCE_NAME = ISSUE AFFILIATE
FILE_NAME = NULL
BATCH_ID = ISSCML17276
BATCH_REC_COUNT = 27
BATCH_DEBIT_AMTS = 3208.5
BATCH_CREDIT_AMTS = 3208.5
PASSED_S1_COUNT = Y
PASSED_S1_AMOUNT = Y
PASSED_S2_COUNT = NULL
PASSED_CV4_CHECK = NULL
PASSED_CV12_CHECK = NULL
PASSED_EBS_STAGING_COUNT = NULL
PASSED_EBS_STAGING_AMOUNT = NULL
INSERT_DATE = 2017-06-20 21:04:31
UPDATED_BY = m_PASSTHRU_VALUES_PCL_Upd
UPDATE_DATE = 2017-06-20 21:04:53
SOURCE_REC_COUNT = 27

-- LXORAFINT01
select count(*) from FDLZ_EBS.EBS_PROCESS_CONTROL_LOG where
EBS_PROCESS_CONTROL_KEY = 13520 and
SOURCE_NAME = 'ISSUE AFFILIATE' and
FILE_NAME is NULL and
BATCH_ID = 'ISSCML17276' and
BATCH_REC_COUNT = 27 and
BATCH_DEBIT_AMTS = 3208.5 and
BATCH_CREDIT_AMTS = 3208.5 and
PASSED_S1_COUNT is NULL and
PASSED_S1_AMOUNT is NULL and
PASSED_S2_COUNT is NULL and
PASSED_CV4_CHECK is NULL and
PASSED_CV12_CHECK is NULL and
PASSED_EBS_STAGING_COUNT is NULL and
PASSED_EBS_STAGING_AMOUNT is NULL and
INSERT_DATE = to_date('2017-06-20 21:04:31','YYYY-MM-DD HH24:MI:SS') and
UPDATED_BY = 'm_INB_ISSUE_CARMEL' and
UPDATE_DATE is NULL and
SOURCE_REC_COUNT = 27;
  COUNT(*)
----------
         0

insert into FDLZ_EBS.EBS_PROCESS_CONTROL_LOG
(EBS_PROCESS_CONTROL_KEY , SOURCE_NAME , FILE_NAME , BATCH_ID , BATCH_REC_COUNT , BATCH_DEBIT_AMTS , BATCH_CREDIT_AMTS , PASSED_S1_COUNT ,
 PASSED_S1_AMOUNT,  PASSED_S2_COUNT , PASSED_CV4_CHECK, PASSED_CV12_CHECK , PASSED_EBS_STAGING_COUNT ,  PASSED_EBS_STAGING_AMOUNT, 
 INSERT_DATE , UPDATED_BY , UPDATE_DATE , SOURCE_REC_COUNT )
values
(13520 , 'ISSUE AFFILIATE' , NULL , 'ISSCML17276' , 27 , 3208.5 , 3208.5 , NULL , NULL , NULL , NULL , NULL , NULL , NULL ,
 to_date('2017-06-20 21:04:31','YYYY-MM-DD HH24:MI:SS'),  'm_INB_ISSUE_CARMEL' , NULL , 27);

start RFDLZT1

REPLICAT   RFDLZT1   Last Started 2017-06-21 10:04   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:01 ago)
Process ID           3207
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzt/ra000000002
                     2017-06-21 10:04:59.042942  RBA 7186875


###########
# fdlzt   #
# RFDLZT1 #
# 6/21    #
###########

REPLICAT   RFDLZT1   Last Started 2017-06-21 10:40   Status ABENDED
INTEGRATED
Checkpoint Lag       02:16:48 (updated 00:26:40 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzt/ra000000007
                     2017-06-21 08:36:17.890411  RBA 465647498

2017-06-21 10:53:08  WARNING OGG-01154  SQL error 1403 mapping FDLZ_EBS.EBS_PROCESS_CONTROL_LOG to FDLZ_EBS.EBS_PROCESS_CONTROL_LOG OCI Error ORA-01403:
no data found, SQL <UPDATE "FDLZ_EBS"."EBS_PROCESS_CONTROL_LOG" x SET x."EBS_PROCESS_CONTROL_KEY" = :a18,x."SOURCE_NAME" = :a19,x."FILE_NAME" = :a20,x."B
ATCH_ID" = :a21,x."BATCH_REC_COUNT" = :a22,x."BATCH_DEBIT_AMTS" = :a23,x."BATCH_CREDIT_AMTS" = :a24,x."PASSED_S1_COUNT" = :a25,x."PASSED_S1_AMOUNT" = :a2
6,x."PASSED_S2_COUNT" = :a27,x."PASSED_CV4_CHECK" = :a28,x."PASSED_CV12_CHECK" = :a29,x."PASSED_EBS_STAGING_COUNT" = :a30,x."PASSED_EBS_STAGING_AMOUNT" =
 :a31,x."INSERT_DATE" = :a32,x."UPDATED_BY" = :a33,x."UPDATE_DATE" = :a34,x."SOURCE_REC_COUNT" = :a35 WHERE x."EBS_PROCESS_CONTROL_KEY" = :b0 AND x."SOUR
CE_NAME" = :b1 AND x."FILE_NAME" is NULL AND x."BATCH_ID" = :b3 AND x."BATCH_REC_COUNT" = :b4 AND x."BATCH_DEBIT_AMTS" = :b5 AND x."BATCH_CREDIT_AMTS" =
:b6 AND x."PASSED_S1_COUNT" is NULL AND x."PASSED_S1_AMOUNT" is NULL AND x."PASSED_S2_COUNT" is NULL AND x."PASSED_CV4_CHECK" is NULL AND x."PASSED_CV12_
CHECK" is NULL AND x."PASSED_EBS_STAGING_COUNT" is NULL AND x."PASSED_EBS_STAGING_AMOUNT" is NULL AND x."INSERT_DATE" = :b14 AND x."UPDATED_BY" = :b15 AN
D x."UPDATE_DATE" is NULL AND x."SOURCE_REC_COUNT" = :b17 AND ROWNUM = 1>.

-- dirrpt/RFDLZT1.dsc
EBS_PROCESS_CONTROL_KEY = 13528
SOURCE_NAME = ISSUE AFFILIATE
FILE_NAME = NULL
BATCH_ID = ISSCML17283
BATCH_REC_COUNT = 111
BATCH_DEBIT_AMTS = 29979.31
BATCH_CREDIT_AMTS = 29979.31
PASSED_S1_COUNT = NULL
PASSED_S1_AMOUNT = NULL
PASSED_S2_COUNT = NULL
PASSED_CV4_CHECK = NULL
PASSED_CV12_CHECK = NULL
PASSED_EBS_STAGING_COUNT = NULL
PASSED_EBS_STAGING_AMOUNT = NULL
INSERT_DATE = 2017-06-21 10:27:40
UPDATED_BY = m_INB_ISSUE_CARMEL
UPDATE_DATE = NULL
SOURCE_REC_COUNT = 111

select count(*) from FDLZ_EBS.EBS_PROCESS_CONTROL_LOG where
EBS_PROCESS_CONTROL_KEY = 13528 and
SOURCE_NAME = 'ISSUE AFFILIATE' and
FILE_NAME is NULL and
BATCH_ID = 'ISSCML17283' and
BATCH_REC_COUNT = 111 and
BATCH_DEBIT_AMTS = 29979.31 and
BATCH_CREDIT_AMTS = 29979.31 and
PASSED_S1_COUNT is NULL and
PASSED_S1_AMOUNT is NULL and
PASSED_S2_COUNT is NULL and
PASSED_CV4_CHECK is NULL and
PASSED_CV12_CHECK is NULL and
PASSED_EBS_STAGING_COUNT is NULL and
PASSED_EBS_STAGING_AMOUNT is NULL and
INSERT_DATE = to_date('2017-06-21 10:27:40','YYYY-MM-DD HH24:MI:SS') and
UPDATED_BY = 'm_INB_ISSUE_CARMEL' and
UPDATE_DATE is NULL and
SOURCE_REC_COUNT = 111;

  COUNT(*)
----------
         0

insert into FDLZ_EBS.EBS_PROCESS_CONTROL_LOG
(EBS_PROCESS_CONTROL_KEY , SOURCE_NAME , FILE_NAME , BATCH_ID , BATCH_REC_COUNT , BATCH_DEBIT_AMTS , BATCH_CREDIT_AMTS , PASSED_S1_COUNT ,
 PASSED_S1_AMOUNT,  PASSED_S2_COUNT , PASSED_CV4_CHECK, PASSED_CV12_CHECK , PASSED_EBS_STAGING_COUNT ,  PASSED_EBS_STAGING_AMOUNT, 
 INSERT_DATE , UPDATED_BY , UPDATE_DATE , SOURCE_REC_COUNT )
values
(13528 , 'ISSUE AFFILIATE' , NULL ,  'ISSCML17283' , 111 , 29979.31 , 29979.31 , NULL , NULL , NULL , NULL , NULL , NULL , NULL ,
 to_date('2017-06-21 10:27:40','YYYY-MM-DD HH24:MI:SS'), 'm_INB_ISSUE_CARMEL' , NULL,111);
 
REPLICAT   RFDLZT1   Last Started 2017-06-21 11:35   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:04 ago)
Process ID           3759
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzt/ra000000007
                     2017-06-21 11:35:49.178618  RBA 467792697

					 
###########
# fdlzt   #
# RFDLZT1 #
# 6/21    #
###########

REPLICAT   RFDLZT1   Last Started 2017-06-21 11:35   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:05:38 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzt/ra000000007
                     2017-06-21 11:35:49.178618  RBA 467792697

2017-06-21 11:35:50  WARNING OGG-01154  SQL error 1403 mapping FDLZ_EBS.EBS_PROCESS_CONTROL_LOG to FDLZ_EBS.EBS_PROCESS_CONTROL_LOG OCI Error ORA-01403:
no data found, SQL <UPDATE "FDLZ_EBS"."EBS_PROCESS_CONTROL_LOG" x SET x."EBS_PROCESS_CONTROL_KEY" = :a18,x."SOURCE_NAME" = :a19,x."FILE_NAME" = :a20,x."B
ATCH_ID" = :a21,x."BATCH_REC_COUNT" = :a22,x."BATCH_DEBIT_AMTS" = :a23,x."BATCH_CREDIT_AMTS" = :a24,x."PASSED_S1_COUNT" = :a25,x."PASSED_S1_AMOUNT" = :a2
6,x."PASSED_S2_COUNT" = :a27,x."PASSED_CV4_CHECK" = :a28,x."PASSED_CV12_CHECK" = :a29,x."PASSED_EBS_STAGING_COUNT" = :a30,x."PASSED_EBS_STAGING_AMOUNT" =
 :a31,x."INSERT_DATE" = :a32,x."UPDATED_BY" = :a33,x."UPDATE_DATE" = :a34,x."SOURCE_REC_COUNT" = :a35 WHERE x."EBS_PROCESS_CONTROL_KEY" = :b0 AND x."SOUR
CE_NAME" = :b1 AND x."FILE_NAME" is NULL AND x."BATCH_ID" = :b3 AND x."BATCH_REC_COUNT" = :b4 AND x."BATCH_DEBIT_AMTS" = :b5 AND x."BATCH_CREDIT_AMTS" =
:b6 AND x."PASSED_S1_COUNT" is NULL AND x."PASSED_S1_AMOUNT" is NULL AND x."PASSED_S2_COUNT" is NULL AND x."PASSED_CV4_CHECK" is NULL AND x."PASSED_CV12_
CHECK" is NULL AND x."PASSED_EBS_STAGING_COUNT" is NULL AND x."PASSED_EBS_STAGING_AMOUNT" is NULL AND x."INSERT_DATE" = :b14 AND x."UPDATED_BY" = :b15 AN
D x."UPDATE_DATE" is NULL AND x."SOURCE_REC_COUNT" = :b17 AND ROWNUM = 1>.

-- linux
select table_name from dba_tables where owner='FDLZ_EBS' order by 1;
138 rows selected.

edit params RFDLZT1
-- after all other MAP statements
INSERTMISSINGUPDATES
MAP FDLZ_EBS.EBS_PROCESS_CONTROL_LOG, TARGET FDLZ_EBS.EBS_PROCESS_CONTROL_LOG;

start RFDLZT1

2017-06-21 12:09:51  WARNING OGG-02081  Detected duplicate TABLE/MAP entry for source table FDLZ_EBS.EBS_PROCESS_CONTROL_LOG and target table FDLZ_EBS.EB
S_PROCESS_CONTROL_LOG. Using prior TABLE/MAP specification.

-- linux
select 'MAP '||owner||'.'||table_name||', TARGET '||owner||'.'||table_name||';' from dba_tables where owner='FDLZ_EBS' order by 1;
MAP FDLZ_EBS.COMPALLOC_STORAGE, TARGET FDLZ_EBS.COMPALLOC_STORAGE;
MAP FDLZ_EBS.COMPALLOC_STORAGE_LOG, TARGET FDLZ_EBS.COMPALLOC_STORAGE_LOG;
MAP FDLZ_EBS.COMP_PROCESS_CONTROL_LOG, TARGET FDLZ_EBS.COMP_PROCESS_CONTROL_LOG;
MAP FDLZ_EBS.CON_EVENTBASED_FAH, TARGET FDLZ_EBS.CON_EVENTBASED_FAH;
MAP FDLZ_EBS.CON_PASSTHRU, TARGET FDLZ_EBS.CON_PASSTHRU;
MAP FDLZ_EBS.CON_PAYMENTS, TARGET FDLZ_EBS.CON_PAYMENTS;
MAP FDLZ_EBS.EBS_AUDIT_BATCH_HEADR_LOG, TARGET FDLZ_EBS.EBS_AUDIT_BATCH_HEADR_LOG;
MAP FDLZ_EBS.EBS_COMP_STORAGE, TARGET FDLZ_EBS.EBS_COMP_STORAGE;
MAP FDLZ_EBS.EBS_CURRENT_BATCH, TARGET FDLZ_EBS.EBS_CURRENT_BATCH;
MAP FDLZ_EBS.EVNTBSD_PROCESS_CONTROL_LOG, TARGET FDLZ_EBS.EVNTBSD_PROCESS_CONTROL_LOG;
MAP FDLZ_EBS.FAH_ACCNT_PASSTHRU, TARGET FDLZ_EBS.FAH_ACCNT_PASSTHRU;
MAP FDLZ_EBS.INB_ACO_CARMEL, TARGET FDLZ_EBS.INB_ACO_CARMEL;
MAP FDLZ_EBS.INB_ACO_CHICAGO, TARGET FDLZ_EBS.INB_ACO_CHICAGO;
MAP FDLZ_EBS.INB_AIM_FAH_DETAIL, TARGET FDLZ_EBS.INB_AIM_FAH_DETAIL;
MAP FDLZ_EBS.INB_AIM_PAYMENTS, TARGET FDLZ_EBS.INB_AIM_PAYMENTS;
MAP FDLZ_EBS.INB_AIM_SUPPLIERS, TARGET FDLZ_EBS.INB_AIM_SUPPLIERS;
MAP FDLZ_EBS.INB_BICPS_CLAIMS_AFFIL_CARMEL, TARGET FDLZ_EBS.INB_BICPS_CLAIMS_AFFIL_CARMEL;
MAP FDLZ_EBS.INB_BICPS_CLAIMS_CHICAGO, TARGET FDLZ_EBS.INB_BICPS_CLAIMS_CHICAGO;
MAP FDLZ_EBS.INB_BICPS_REVERSALS_CARMEL, TARGET FDLZ_EBS.INB_BICPS_REVERSALS_CARMEL;
MAP FDLZ_EBS.INB_BICPS_REVERSALS_CHICAGO, TARGET FDLZ_EBS.INB_BICPS_REVERSALS_CHICAGO;
MAP FDLZ_EBS.INB_BRAC_DETAIL, TARGET FDLZ_EBS.INB_BRAC_DETAIL;
MAP FDLZ_EBS.INB_CAMRA_COMMON, TARGET FDLZ_EBS.INB_CAMRA_COMMON;
MAP FDLZ_EBS.INB_CASHTICKET, TARGET FDLZ_EBS.INB_CASHTICKET;
MAP FDLZ_EBS.INB_CDS_COMMON, TARGET FDLZ_EBS.INB_CDS_COMMON;
MAP FDLZ_EBS.INB_CLC_CARMEL, TARGET FDLZ_EBS.INB_CLC_CARMEL;
MAP FDLZ_EBS.INB_CONCUR_PAYMENTS, TARGET FDLZ_EBS.INB_CONCUR_PAYMENTS;
MAP FDLZ_EBS.INB_CRS_COMMON, TARGET FDLZ_EBS.INB_CRS_COMMON;
MAP FDLZ_EBS.INB_DDA_CARMEL, TARGET FDLZ_EBS.INB_DDA_CARMEL;
MAP FDLZ_EBS.INB_DDA_CHICAGO, TARGET FDLZ_EBS.INB_DDA_CHICAGO;
MAP FDLZ_EBS.INB_DRM_CLAIMS_EXPENSE, TARGET FDLZ_EBS.INB_DRM_CLAIMS_EXPENSE;
MAP FDLZ_EBS.INB_DRM_CLAIMS_INVESTIGATE, TARGET FDLZ_EBS.INB_DRM_CLAIMS_INVESTIGATE;
MAP FDLZ_EBS.INB_DSC_CARMEL, TARGET FDLZ_EBS.INB_DSC_CARMEL;
MAP FDLZ_EBS.INB_DSF_CARMEL, TARGET FDLZ_EBS.INB_DSF_CARMEL;
MAP FDLZ_EBS.INB_DSS_CARMEL, TARGET FDLZ_EBS.INB_DSS_CARMEL;
MAP FDLZ_EBS.INB_EBS_BRAC, TARGET FDLZ_EBS.INB_EBS_BRAC;
MAP FDLZ_EBS.INB_EBS_COMP_BONUS, TARGET FDLZ_EBS.INB_EBS_COMP_BONUS;
MAP FDLZ_EBS.INB_EBS_COMP_PPSP, TARGET FDLZ_EBS.INB_EBS_COMP_PPSP;
MAP FDLZ_EBS.INB_EBS_COMP_RATIO_M, TARGET FDLZ_EBS.INB_EBS_COMP_RATIO_M;
MAP FDLZ_EBS.INB_EBS_COMP_RATIO_Q, TARGET FDLZ_EBS.INB_EBS_COMP_RATIO_Q;
MAP FDLZ_EBS.INB_EBS_COMP_RATIO_Y, TARGET FDLZ_EBS.INB_EBS_COMP_RATIO_Y;
MAP FDLZ_EBS.INB_ESI_COMMON, TARGET FDLZ_EBS.INB_ESI_COMMON;
MAP FDLZ_EBS.INB_ESSBASE_COMPALLOC, TARGET FDLZ_EBS.INB_ESSBASE_COMPALLOC;
MAP FDLZ_EBS.INB_EWIRE_COMMON, TARGET FDLZ_EBS.INB_EWIRE_COMMON;
MAP FDLZ_EBS.INB_FSP, TARGET FDLZ_EBS.INB_FSP;
MAP FDLZ_EBS.INB_GILSBAR_DISB, TARGET FDLZ_EBS.INB_GILSBAR_DISB;
MAP FDLZ_EBS.INB_GILSBAR_PREMIUM, TARGET FDLZ_EBS.INB_GILSBAR_PREMIUM;
MAP FDLZ_EBS.INB_INVOICE_DETAIL, TARGET FDLZ_EBS.INB_INVOICE_DETAIL;
MAP FDLZ_EBS.INB_ISSUE_CARMEL, TARGET FDLZ_EBS.INB_ISSUE_CARMEL;
MAP FDLZ_EBS.INB_ISSUE_CARMEL_TEST_DATA, TARGET FDLZ_EBS.INB_ISSUE_CARMEL_TEST_DATA;
MAP FDLZ_EBS.INB_ISSUE_CHICAGO, TARGET FDLZ_EBS.INB_ISSUE_CHICAGO;
MAP FDLZ_EBS.INB_ISSUE_CHICAGO_TEST_DATA, TARGET FDLZ_EBS.INB_ISSUE_CHICAGO_TEST_DATA;
MAP FDLZ_EBS.INB_LCA, TARGET FDLZ_EBS.INB_LCA;
MAP FDLZ_EBS.INB_LGS_CARMEL, TARGET FDLZ_EBS.INB_LGS_CARMEL;
MAP FDLZ_EBS.INB_LIFECOMM_BLC, TARGET FDLZ_EBS.INB_LIFECOMM_BLC;
MAP FDLZ_EBS.INB_LIFECOMM_CP, TARGET FDLZ_EBS.INB_LIFECOMM_CP;
MAP FDLZ_EBS.INB_LMS_COMMON, TARGET FDLZ_EBS.INB_LMS_COMMON;
MAP FDLZ_EBS.INB_LOCKBOX_5A, TARGET FDLZ_EBS.INB_LOCKBOX_5A;
MAP FDLZ_EBS.INB_LOCKBOX_5B, TARGET FDLZ_EBS.INB_LOCKBOX_5B;
MAP FDLZ_EBS.INB_LOCKBOX_5C_NO_DOC, TARGET FDLZ_EBS.INB_LOCKBOX_5C_NO_DOC;
MAP FDLZ_EBS.INB_LOCKBOX_5C_RETAIL, TARGET FDLZ_EBS.INB_LOCKBOX_5C_RETAIL;
MAP FDLZ_EBS.INB_LOCKBOX_5D, TARGET FDLZ_EBS.INB_LOCKBOX_5D;
MAP FDLZ_EBS.INB_LPR_CAA, TARGET FDLZ_EBS.INB_LPR_CAA;
MAP FDLZ_EBS.INB_LPR_CAA_PAC, TARGET FDLZ_EBS.INB_LPR_CAA_PAC;
MAP FDLZ_EBS.INB_LPR_CIK_COMMON, TARGET FDLZ_EBS.INB_LPR_CIK_COMMON;
MAP FDLZ_EBS.INB_LPR_EFT_COMMON, TARGET FDLZ_EBS.INB_LPR_EFT_COMMON;
MAP FDLZ_EBS.INB_NT, TARGET FDLZ_EBS.INB_NT;
MAP FDLZ_EBS.INB_OHIO_NAT_CARMEL, TARGET FDLZ_EBS.INB_OHIO_NAT_CARMEL;
MAP FDLZ_EBS.INB_OOO_WORKDAY_DETAIL, TARGET FDLZ_EBS.INB_OOO_WORKDAY_DETAIL;
MAP FDLZ_EBS.INB_OUTBOUND_A_H_EXTRACT, TARGET FDLZ_EBS.INB_OUTBOUND_A_H_EXTRACT;
MAP FDLZ_EBS.INB_OUTBOUND_IISIS_EXTRACT, TARGET FDLZ_EBS.INB_OUTBOUND_IISIS_EXTRACT;
MAP FDLZ_EBS.INB_PAYMENT_WRAPBACK, TARGET FDLZ_EBS.INB_PAYMENT_WRAPBACK;
MAP FDLZ_EBS.INB_PHS_COMMON, TARGET FDLZ_EBS.INB_PHS_COMMON;
MAP FDLZ_EBS.INB_PP1_BENEFIT, TARGET FDLZ_EBS.INB_PP1_BENEFIT;
MAP FDLZ_EBS.INB_PP1_CHECK, TARGET FDLZ_EBS.INB_PP1_CHECK;
MAP FDLZ_EBS.INB_PPSP_CHICAGO, TARGET FDLZ_EBS.INB_PPSP_CHICAGO;
MAP FDLZ_EBS.INB_PPSP_SHARP, TARGET FDLZ_EBS.INB_PPSP_SHARP;
MAP FDLZ_EBS.INB_PPS_CARMEL, TARGET FDLZ_EBS.INB_PPS_CARMEL;
MAP FDLZ_EBS.INB_PROCESSOR_CP, TARGET FDLZ_EBS.INB_PROCESSOR_CP;
MAP FDLZ_EBS.INB_RCT_LOCKBOX_COMMON, TARGET FDLZ_EBS.INB_RCT_LOCKBOX_COMMON;
MAP FDLZ_EBS.INB_RCT_PAC_CAAJNL1P, TARGET FDLZ_EBS.INB_RCT_PAC_CAAJNL1P;
MAP FDLZ_EBS.INB_RCT_PAC_CHSTRNRP, TARGET FDLZ_EBS.INB_RCT_PAC_CHSTRNRP;
MAP FDLZ_EBS.INB_RCT_PAC_CIKJNL1P, TARGET FDLZ_EBS.INB_RCT_PAC_CIKJNL1P;
MAP FDLZ_EBS.INB_RCT_PAC_DPDAUP40, TARGET FDLZ_EBS.INB_RCT_PAC_DPDAUP40;
MAP FDLZ_EBS.INB_RLD_COMMON, TARGET FDLZ_EBS.INB_RLD_COMMON;
MAP FDLZ_EBS.INB_RPS_COMMON, TARGET FDLZ_EBS.INB_RPS_COMMON;
MAP FDLZ_EBS.INB_SHARP_BNA, TARGET FDLZ_EBS.INB_SHARP_BNA;
MAP FDLZ_EBS.INB_SHARP_CARMEL, TARGET FDLZ_EBS.INB_SHARP_CARMEL;
MAP FDLZ_EBS.INB_SHARP_CHICAGO, TARGET FDLZ_EBS.INB_SHARP_CHICAGO;
MAP FDLZ_EBS.INB_TAI_COMMON, TARGET FDLZ_EBS.INB_TAI_COMMON;
MAP FDLZ_EBS.INB_TREASURY_COMMON, TARGET FDLZ_EBS.INB_TREASURY_COMMON;
MAP FDLZ_EBS.INB_UNIVITA_CLAIMS, TARGET FDLZ_EBS.INB_UNIVITA_CLAIMS;
MAP FDLZ_EBS.INB_UNIVITA_PREMIUM, TARGET FDLZ_EBS.INB_UNIVITA_PREMIUM;
MAP FDLZ_EBS.INB_VANTAGE12_CP, TARGET FDLZ_EBS.INB_VANTAGE12_CP;
MAP FDLZ_EBS.INB_VANTAGE21_CP, TARGET FDLZ_EBS.INB_VANTAGE21_CP;
MAP FDLZ_EBS.INB_VEC, TARGET FDLZ_EBS.INB_VEC;
MAP FDLZ_EBS.INB_WRE_CARMEL, TARGET FDLZ_EBS.INB_WRE_CARMEL;
MAP FDLZ_EBS.INB_XTIVA_FAH_DETAIL, TARGET FDLZ_EBS.INB_XTIVA_FAH_DETAIL;
MAP FDLZ_EBS.INB_XTIVA_PAYMENTS, TARGET FDLZ_EBS.INB_XTIVA_PAYMENTS;
MAP FDLZ_EBS.INB_XTIVA_SUPPLIERS, TARGET FDLZ_EBS.INB_XTIVA_SUPPLIERS;
MAP FDLZ_EBS.INTERIM_WILTONRE, TARGET FDLZ_EBS.INTERIM_WILTONRE;
MAP FDLZ_EBS.INTERIM_WILTONRE_TEMP, TARGET FDLZ_EBS.INTERIM_WILTONRE_TEMP;
MAP FDLZ_EBS.OUT_COMP_BONUS, TARGET FDLZ_EBS.OUT_COMP_BONUS;
MAP FDLZ_EBS.OUT_COMP_PPSP, TARGET FDLZ_EBS.OUT_COMP_PPSP;
MAP FDLZ_EBS.OUT_COMP_RATIO_M, TARGET FDLZ_EBS.OUT_COMP_RATIO_M;
MAP FDLZ_EBS.OUT_COMP_RATIO_Q, TARGET FDLZ_EBS.OUT_COMP_RATIO_Q;
MAP FDLZ_EBS.OUT_COMP_RATIO_Y, TARGET FDLZ_EBS.OUT_COMP_RATIO_Y;
MAP FDLZ_EBS.OUT_EVENTBASED_FAH, TARGET FDLZ_EBS.OUT_EVENTBASED_FAH;
MAP FDLZ_EBS.OUT_PAYMENTS_DETAIL, TARGET FDLZ_EBS.OUT_PAYMENTS_DETAIL;
MAP FDLZ_EBS.OUT_PAYMENTS_HEADER, TARGET FDLZ_EBS.OUT_PAYMENTS_HEADER;
MAP FDLZ_EBS.OUT_SUPPLIERS, TARGET FDLZ_EBS.OUT_SUPPLIERS;
MAP FDLZ_EBS.PAYMENTS_PROCESS_CONTROL_LOG, TARGET FDLZ_EBS.PAYMENTS_PROCESS_CONTROL_LOG;
MAP FDLZ_EBS.REF_WILTONRE_GL_MAPPING, TARGET FDLZ_EBS.REF_WILTONRE_GL_MAPPING;
MAP FDLZ_EBS.S1_DDD_TRECS_ADJUSTMENT_DETAIL, TARGET FDLZ_EBS.S1_DDD_TRECS_ADJUSTMENT_DETAIL;
MAP FDLZ_EBS.S1_DDD_TRECS_UNMATCHED_FAH, TARGET FDLZ_EBS.S1_DDD_TRECS_UNMATCHED_FAH;
MAP FDLZ_EBS.S1_DDD_TRECS_UNMATCHED_FAH_STG, TARGET FDLZ_EBS.S1_DDD_TRECS_UNMATCHED_FAH_STG;
MAP FDLZ_EBS.S2_DDO_FAH_ACCNT_PASSTHRU, TARGET FDLZ_EBS.S2_DDO_FAH_ACCNT_PASSTHRU;
MAP FDLZ_EBS.S2_DDO_TRECS_UNMATCHED, TARGET FDLZ_EBS.S2_DDO_TRECS_UNMATCHED;
MAP FDLZ_EBS.SUPPLIERS_PROCESS_CONTROL_LOG, TARGET FDLZ_EBS.SUPPLIERS_PROCESS_CONTROL_LOG;
MAP FDLZ_EBS.TEMP_S2_DDO_FAH_ACCNT_PASSTHRU, TARGET FDLZ_EBS.TEMP_S2_DDO_FAH_ACCNT_PASSTHRU;
MAP FDLZ_EBS.TMP_UN_S2_DDO_FAH_ACNT_PASTHRU, TARGET FDLZ_EBS.TMP_UN_S2_DDO_FAH_ACNT_PASTHRU;
MAP FDLZ_EBS.TRANS_COMPALLOC_DELTA, TARGET FDLZ_EBS.TRANS_COMPALLOC_DELTA;
MAP FDLZ_EBS.TRANS_CV12_REF_OUT, TARGET FDLZ_EBS.TRANS_CV12_REF_OUT;
MAP FDLZ_EBS.TRANS_EVENTBASED_OUT, TARGET FDLZ_EBS.TRANS_EVENTBASED_OUT;
MAP FDLZ_EBS.TRANS_PASSTHRU_OUT, TARGET FDLZ_EBS.TRANS_PASSTHRU_OUT;
MAP FDLZ_EBS.TRANS_PASSTHRU_OUT_PRE, TARGET FDLZ_EBS.TRANS_PASSTHRU_OUT_PRE;
MAP FDLZ_EBS.TRANS_PAYMENTS_OUT, TARGET FDLZ_EBS.TRANS_PAYMENTS_OUT;
MAP FDLZ_EBS.TRANS_REF_OUT, TARGET FDLZ_EBS.TRANS_REF_OUT;
MAP FDLZ_EBS.TRANS_SUPPLIERS_OUT, TARGET FDLZ_EBS.TRANS_SUPPLIERS_OUT;
MAP FDLZ_EBS.TRANS_VALUES_EVENTBASED, TARGET FDLZ_EBS.TRANS_VALUES_EVENTBASED;
MAP FDLZ_EBS.TRANS_VALUES_PASSTHRU, TARGET FDLZ_EBS.TRANS_VALUES_PASSTHRU;
MAP FDLZ_EBS.TRECS_AUTOMATCH_ACCOUNT_STG, TARGET FDLZ_EBS.TRECS_AUTOMATCH_ACCOUNT_STG;
MAP FDLZ_EBS.TRECS_CONSIDERED_UNMATCHED, TARGET FDLZ_EBS.TRECS_CONSIDERED_UNMATCHED;
MAP FDLZ_EBS.TRECS_PENDING_TRANS_KEYS, TARGET FDLZ_EBS.TRECS_PENDING_TRANS_KEYS;
MAP FDLZ_EBS.WILTONRE_CONTROL, TARGET FDLZ_EBS.WILTONRE_CONTROL;
MAP FDLZ_EBS.WILTONRE_CONTROL_BKP, TARGET FDLZ_EBS.WILTONRE_CONTROL_BKP;
MAP FDLZ_EBS.WILTONRE_PCL, TARGET FDLZ_EBS.WILTONRE_PCL;
MAP FDLZ_EBS.WRAPBACK_TRANS_OUT, TARGET FDLZ_EBS.WRAPBACK_TRANS_OUT;

edit params RFDLZT1
--MAP FDLZ_EBS.*, TARGET FDLZ_EBS.*;
(add above)

start RFDLZT1

REPLICAT   RFDLZT1   Last Started 2017-06-21 12:21   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           3971
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzt/ra000000007
                     2017-06-21 12:21:06.162675  RBA 471329872


###########
# fnp8t   #
# RFNP8T2 #
# 6/21    #
###########

REPLICAT   RFNP8T2   Last Started 2017-06-20 14:16   Status ABENDED
INTEGRATED
Checkpoint Lag       00:01:06 (updated 12:39:01 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fnp8t/RR/ra000000000
                     2017-06-20 21:09:31.379607  RBA 2782595

2017-06-20 21:10:49  WARNING OGG-01154  SQL error 1403 mapping P8ICCDS03.UI_ACCESS to P8ICCDS03.UI_ACCESS OCI Error ORA-01403: no data found, SQL <UPDATE
 "P8ICCDS03"."UI_ACCESS" x SET x."OWNER_ID" = :a3,x."OWNER_NAME" = :a4,x."HEARTBEAT" = :a5 WHERE x."OWNER_ID" = :b0 AND x."OWNER_NAME" = :b1 AND x."HEART
BEAT" = :b2 AND ROWNUM = 1>.

-- dirrpt/RFNP8T2.dsc
OWNER_ID = <Raw Data>
OWNER_NAME = tcp://ntfnicct07.conseco.ad:34177/NetSvc
HEARTBEAT = 26757

OWNER_ID = <Raw Data>
OWNER_NAME = tcp://ntfnicct07.conseco.ad:34177/NetSvc
HEARTBEAT = 28786

-- LXORABPAT02
Name                                      Null?    Type
----------------------------------------- -------- ----------------------------
OWNER_ID                                  NOT NULL RAW(16)
OWNER_NAME                                NOT NULL NVARCHAR2(2000)
HEARTBEAT                                 NOT NULL NUMBER(10)

select * from P8ICCDS03.UI_ACCESS where
OWNER_NAME = 'tcp://ntfnicct07.conseco.ad:34177/NetSvc' and
HEARTBEAT = 26757;
no rows selected

select * from P8ICCDS03.UI_ACCESS where
OWNER_NAME = 'tcp://ntfnicct07.conseco.ad:34177/NetSvc' and
HEARTBEAT = 28786;

select count(*) from P8ICCDS03.UI_ACCESS;
  COUNT(*)
----------
         1

select * from P8ICCDS03.UI_ACCESS;
F1EC267457F9C74DA1481CE10AB9CD13
tcp://ntfnicct07.conseco.ad:34177/NetSvc
     28808

-- uxt34
select count(*) from P8ICCDS03.UI_ACCESS;
  COUNT(*)
----------
         1

select * from P8ICCDS03.UI_ACCESS;
F1EC267457F9C74DA1481CE10AB9CD13
tcp://ntfnicct07.conseco.ad:34177/NetSvc
     33055

select 'MAP '||owner||'.'||table_name||', TARGET '||owner||'.'||table_name||';' from dba_tables where owner='P8ICCDS03' order by 1;
MAP P8ICCDS03.BLACK_LIST, TARGET P8ICCDS03.BLACK_LIST;
MAP P8ICCDS03.COLLECTOR, TARGET P8ICCDS03.COLLECTOR;
MAP P8ICCDS03.CONFIGURATION, TARGET P8ICCDS03.CONFIGURATION;
MAP P8ICCDS03.CONNECTOR, TARGET P8ICCDS03.CONNECTOR;
MAP P8ICCDS03.DATA_REVISION, TARGET P8ICCDS03.DATA_REVISION;
MAP P8ICCDS03.EXPRESSION, TARGET P8ICCDS03.EXPRESSION;
MAP P8ICCDS03.GENERIC_DATA, TARGET P8ICCDS03.GENERIC_DATA;
MAP P8ICCDS03.METADATA_FACTORY, TARGET P8ICCDS03.METADATA_FACTORY;
MAP P8ICCDS03.METADATA_FACTORY_STRINGS, TARGET P8ICCDS03.METADATA_FACTORY_STRINGS;
MAP P8ICCDS03.METADATA_PROPERTY, TARGET P8ICCDS03.METADATA_PROPERTY;
MAP P8ICCDS03.METADATA_PROPERTY_STRINGS, TARGET P8ICCDS03.METADATA_PROPERTY_STRINGS;
MAP P8ICCDS03.METADATA_PROP_DESC, TARGET P8ICCDS03.METADATA_PROP_DESC;
MAP P8ICCDS03.METADATA_SOURCE, TARGET P8ICCDS03.METADATA_SOURCE;
MAP P8ICCDS03.PARAMETER_MAP, TARGET P8ICCDS03.PARAMETER_MAP;
MAP P8ICCDS03.REPORT_CONFIGURATION, TARGET P8ICCDS03.REPORT_CONFIGURATION;
MAP P8ICCDS03.REPORT_DATA_HOUR, TARGET P8ICCDS03.REPORT_DATA_HOUR;
MAP P8ICCDS03.REPORT_DATA_MINUTE, TARGET P8ICCDS03.REPORT_DATA_MINUTE;
MAP P8ICCDS03.RULE_NODE_MAP, TARGET P8ICCDS03.RULE_NODE_MAP;
MAP P8ICCDS03.SCHEMA_VERSION, TARGET P8ICCDS03.SCHEMA_VERSION;
MAP P8ICCDS03.TASK_METHOD, TARGET P8ICCDS03.TASK_METHOD;
MAP P8ICCDS03.TASK_NODE, TARGET P8ICCDS03.TASK_NODE;
MAP P8ICCDS03.TASK_NODE_TYPE, TARGET P8ICCDS03.TASK_NODE_TYPE;
MAP P8ICCDS03.TASK_ROUTE, TARGET P8ICCDS03.TASK_ROUTE;
MAP P8ICCDS03.TASK_TEMPLATE, TARGET P8ICCDS03.TASK_TEMPLATE;
MAP P8ICCDS03.TROUTE_ENGINE, TARGET P8ICCDS03.TROUTE_ENGINE;
MAP P8ICCDS03.TROUTE_OPMODE, TARGET P8ICCDS03.TROUTE_OPMODE;
MAP P8ICCDS03.TROUTE_SOURCE_MAP, TARGET P8ICCDS03.TROUTE_SOURCE_MAP;

sh cp dirprm/RFNP8T2.prm dirprm/RFNP8T2.prm.bkp20170621

edit params RFNP8T2
-------------------
--MAP P8ICCDS03.*, TARGET P8ICCDS03.*;
(after all other MAP statements)
NOINSERTMISSINGUPDATES
(add above)
INSERTMISSINGUPDATES
MAP P8ICCDS03.UI_ACCESS, TARGET P8ICCDS03.UI_ACCESS;

start RFNP8T2

REPLICAT   RFNP8T2   Last Started 2017-06-21 15:08   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:06 ago)
Process ID           5400
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fnp8t/RR/ra000000000
                     2017-06-21 15:09:08.377479  RBA 3944593


##########
# idwt   #
# RIDWT2 #
# 6/21   #
##########

REPLICAT   RIDWT2    Last Started 2017-06-16 07:37   Status ABENDED
INTEGRATED
Checkpoint Lag       00:04:08 (updated 24:31:35 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/idwt/RR/ra000000002
                     2017-06-20 09:14:09.740268  RBA 787552440

2017-06-20 09:32:25  WARNING OGG-01154  SQL error 1688 mapping IDWT.AHM_GKPR.DWS_SHARP_SD_COVBASE to AHM_GKPR.DWS_SHARP_SD_COVBASE OCI Error ORA-01688: u
nable to extend table AHM_GKPR.DWS_SHARP_SD_COVBASE partition DWS_SHARP_SD_COVBASE_201706 by 20 in tablespace AHM_COVBASE_DWS_D (status = 1688), SQL <INS
ERT INTO "AHM_GKPR"."DWS_SHARP_SD_COVBASE" ("REPORTING_DATE","COMPANY_CODE","POLICY_NUMBER","NEW_POLICY_NUMBER","ADMIN_PLAN_CODE","AGENT_NUMBER","BASE_RI
DER_FLAG","CONVERSION_FLAG","STATE_MANAGER","PLAN_EFFECTIVE_DATE","PAID_TO_DATE","STATUS_CODE","PAYMENT_METHOD","ANNUALIZED_PREMIUM","ANNUAL_RATE","ISSUE
_STATE_CODE","POLICY_ISSUE_DATE","SALES_DIVISION","RESIDENT_STATE_CODE","RESIDENT_ZIP_CODE","GENDER","BIRTH_DATE","PREMIUM_MODE","DEFERRED_ROP_NUMBER","G
ROUP_RISK_FLAG","DEFERRED_ROP_STATUS","ROP_CASH_VALUE_STATUS","NEXT_ACTION_DATE","SECTION_125_FLAG","LAST_CHANGE_DATE","GROUP_NUMBER","WAIVER_OF_PREMIUM_
FLAG","YTD_PREMIUM","RECORD_NUMBER","LINE_OF_BUSINESS") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10,:a11,:a12,:a13,:a14,:a15,:a16,:a17,:a18,:a19
,:a20,:a21,:a22,:a23,:a24,:a25,:a26,:a27,:a28,:a29,:a30,:a31,:a32,:a33,:a34)>.

-- uxt33
        ID FILE_NAME                                                                           MB      MaxMB AUT
---------- --------------------------------------------------------------------------- ---------- ---------- ---
       501 /move/idwt02/oradata/ahm_covbase_dws_d01.dbf                                     1,024      1,024 NO
                                                                                       ---------- ----------
TOTAL                                                                                       1,024      1,024

df -g /move/idwt02
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
/dev/fslv08      222.50     87.88   61%      406     1% /move/idwt02

ALTER DATABASE DATAFILE 501 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M;

        ID FILE_NAME                                                                           MB      MaxMB AUT
---------- --------------------------------------------------------------------------- ---------- ---------- ---
       501 /move/idwt02/oradata/ahm_covbase_dws_d01.dbf                                     1,024     32,000 YES
                                                                                       ---------- ----------
TOTAL                                                                                       1,024     32,000

-- ggsci
start RIDWT2

2017-06-21 15:21:01  WARNING OGG-01154  SQL error 1653 mapping IDWT.AHM_GKPR.AHM_SHARP_SD_COVBASE to AHM_GKPR.AHM_SHARP_SD_COVBASE OCI Error ORA-01653: u
nable to extend table AHM_GKPR.AHM_SHARP_SD_COVBASE by 20 in tablespace AHM_COVBASE_USER_D (status = 1653), SQL <INSERT INTO "AHM_GKPR"."AHM_SHARP_SD_COV
BASE" ("REPORTING_DATE","COMPANY_CODE","POLICY_NUMBER","NEW_POLICY_NUMBER","ADMIN_PLAN_CODE","AGENT_NUMBER","BASE_RIDER_FLAG","CONVERSION_FLAG","STATE_MA
NAGER","PLAN_EFFECTIVE_DATE","PAID_TO_DATE","STATUS_CODE","PAYMENT_METHOD","ANNUALIZED_PREMIUM","ANNUAL_RATE","ISSUE_STATE_CODE","POLICY_ISSUE_DATE","SAL
ES_DIVISION","RESIDENT_STATE_CODE","RESIDENT_ZIP_CODE","GENDER","BIRTH_DATE","PREMIUM_MODE","DEFERRED_ROP_NUMBER","GROUP_RISK_FLAG","DEFERRED_ROP_STATUS"
,"ROP_CASH_VALUE_STATUS","NEXT_ACTION_DATE","SECTION_125_FLAG","LAST_CHANGE_DATE","GROUP_NUMBER","WAIVER_OF_PREMIUM_FLAG","YTD_PREMIUM","RECORD_NUMBER","
LINE_OF_BUSINESS") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10,:a11,:a12,:a13,:a14,:a15,:a16,:a17,:a18,:a19,:a20,:a21,:a22,:a23,:a24,:a25,:a26,:
a27,:a28,:a29,:a30,:a31,:a32,:a33,:a34)>.

-- uxt33
        ID FILE_NAME                                                                           MB      MaxMB AUT
---------- --------------------------------------------------------------------------- ---------- ---------- ---
       503 /move/idwt02/oradata/ahm_covbase_user_d01.dbf                                      500        500 NO
                                                                                       ---------- ----------
TOTAL                                                                                         500        500

ALTER DATABASE DATAFILE 503 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M;

        ID FILE_NAME                                                                           MB      MaxMB AUT
---------- --------------------------------------------------------------------------- ---------- ---------- ---
       503 /move/idwt02/oradata/ahm_covbase_user_d01.dbf                                      500     32,000 YES
                                                                                       ---------- ----------
TOTAL                                                                                         500     32,000

-- ggsci
start RIDWT2

REPLICAT   RIDWT2    Last Started 2017-06-21 15:26   Status RUNNING
INTEGRATED
Checkpoint Lag       02:21:07 (updated 00:26:10 ago)
Process ID           5506
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/idwt/RR/ra000000006
                     2017-06-21 14:27:08.071885  RBA 589803094


############
# infdmt   #
# RINFDMT2 #
# 6/21     #
############

REPLICAT   RINFDMT2  Last Started 2017-06-20 00:55   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 122:08:54 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/infdmt/RR/ra000000000
                     2017-06-16 07:41:13.509034  RBA 245406

2017-06-20 00:55:40  WARNING OGG-01154  SQL error 1403 mapping INFDMT.INF_PCDM.ISP_MASTER_ELECTION to INF_PCDM.ISP_MASTER_ELECTION OCI Error ORA-01403: n
o data found, SQL <DELETE FROM "INF_PCDM"."ISP_MASTER_ELECTION"  WHERE "DOMAIN_NAME" = :b0 AND "NODE_NAME" = :b1 AND "HOST_NAME" = :b2 AND "PORTNUM" = :b
3 AND "LAST_REFRESH_TIME" = :b4 AND "ELECTION_STATUS" = :b5 AND ROWNUM = 1>.

-- dirrpt/RINFDMT2.dsc
DOMAIN_NAME = PCDOMAIN_INTEGRATION961
NODE_NAME = node01_lxinfpct01
HOST_NAME = lxinfpct01.conseco.ad
PORTNUM = 6006
LAST_REFRESH_TIME = 1497542531699
ELECTION_STATUS = Election Complete

-- uxt34
select count(*) from INF_PCDM.ISP_MASTER_ELECTION where
DOMAIN_NAME = 'PCDOMAIN_INTEGRATION961' and
NODE_NAME = 'node01_lxinfpct01' and
HOST_NAME = 'lxinfpct01.conseco.ad' and
PORTNUM = 6006 and
LAST_REFRESH_TIME = 1497542531699 and
ELECTION_STATUS = 'Election Complete';
  COUNT(*)
----------
         0

insert into INF_PCDM.ISP_MASTER_ELECTION
(DOMAIN_NAME , NODE_NAME , HOST_NAME , PORTNUM , LAST_REFRESH_TIME,  ELECTION_STATUS )
values
( 'PCDOMAIN_INTEGRATION961',  'node01_lxinfpct01' ,  'lxinfpct01.conseco.ad' ,  6006 , 1497542531699 , 'Election Complete');

-- ggsci
start RINFDMT2

2017-06-21 15:16:54  WARNING OGG-01154  SQL error 1403 mapping INFDMT.INF_PCDM.ISP_MASTER_ELECTION to INF_PCDM.ISP_MASTER_ELECTION OCI Error ORA-01403: n
o data found, SQL <DELETE FROM "INF_PCDM"."ISP_MASTER_ELECTION"  WHERE "DOMAIN_NAME" = :b0 AND "NODE_NAME" = :b1 AND "HOST_NAME" = :b2 AND "PORTNUM" = :b
3 AND "LAST_REFRESH_TIME" = :b4 AND "ELECTION_STATUS" = :b5 AND ROWNUM = 1>.

-- dirrpt/RINFDMT2.dsc
DOMAIN_NAME = PCDOMAIN_INTEGRATION961
NODE_NAME = node02_lxinfpct02
HOST_NAME = lxinfpct02.conseco.ad
PORTNUM = 6006
LAST_REFRESH_TIME = 1497542543374
ELECTION_STATUS = Election In Progress

-- uxt34
select count(*) from INF_PCDM.ISP_MASTER_ELECTION where
DOMAIN_NAME = 'PCDOMAIN_INTEGRATION961' and
NODE_NAME = 'node02_lxinfpct02' and
HOST_NAME = 'lxinfpct02.conseco.ad' and
PORTNUM = 6006 and
LAST_REFRESH_TIME = 1497542543374 and
ELECTION_STATUS = 'Election In Progress';

insert into INF_PCDM.ISP_MASTER_ELECTION
(DOMAIN_NAME , NODE_NAME , HOST_NAME , PORTNUM , LAST_REFRESH_TIME,  ELECTION_STATUS )
values
( 'PCDOMAIN_INTEGRATION961' ,  'node02_lxinfpct02' , 'lxinfpct02.conseco.ad' , 6006 , 1497542543374 , 'Election In Progress');

-- ggsci
start RINFDMT2

REPLICAT   RINFDMT2  Last Started 2017-06-21 15:21   Status RUNNING
INTEGRATED
Checkpoint Lag       131:49:56 (updated 00:00:05 ago)
Process ID           5453
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/infdmt/RR/ra000000002
                     2017-06-16 03:31:25.627892  RBA 116964

REPLICAT   RINFDMT2  Last Started 2017-06-21 15:21   Status ABENDED
INTEGRATED
Checkpoint Lag       74:33:13 (updated 00:10:27 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/infdmt/RR/ra000000002
                     2017-06-18 12:49:25.286193  RBA 20309974

2017-06-21 15:22:58  WARNING OGG-01154  SQL error 1403 mapping INFDMT.INF_PCDM.ISP_RUN_LOG to INF_PCDM.ISP_RUN_LOG OCI Error ORA-01403: no data found, SQ
L <DELETE FROM "INF_PCDM"."ISP_RUN_LOG"  WHERE "ABSOLUTEFILENAME" = :b0 AND "NODENAME" = :b1 AND "INTEGRATIONSERVICE" = :b2 AND "REPOSITORYDOMAIN" = :b3
AND "REPOSITORYNAME" = :b4 AND "RUNCONTEXT" = :b5 AND "RUNID" = :b6 AND "ENTRYTIME" = :b7 AND "FOLDER" = :b8 AND "WORKFLOW" = :b9 AND "SESSIONPATH" = :b1
0 AND "OSUSER" is NULL AND "RUNINSTANCENAME" is NULL AND ROWNUM = 1>.

-- dirrpt/RINFDMT2.dsc
ABSOLUTEFILENAME = /app/powercenter/logs/SessLogs/s_m_STG_S2_AWD_CNTRCT_NOTE.log.20170615120207.bin
NODENAME = node02_lxinfpct02
INTEGRATIONSERVICE = ps_integration961
REPOSITORYDOMAIN = pcdomain_integration961
REPOSITORYNAME = integration961
RUNCONTEXT = 127,36741,13252
RUNID = 3037193,3037194,0
ENTRYTIME = 1497542531752
FOLDER = ods_etl_realtime_project
WORKFLOW = wf_dm_agt_dist_nbt_real_time
SESSIONPATH = wt_stg_awd/s_m_stg_s2_awd_cntrct_note
OSUSER = NULL
RUNINSTANCENAME = NULL

-- uxt34
select count(*) from INF_PCDM.ISP_RUN_LOG where
ABSOLUTEFILENAME = '/app/powercenter/logs/SessLogs/s_m_STG_S2_AWD_CNTRCT_NOTE.log.20170615120207.bin' and
NODENAME = 'node02_lxinfpct02' and
INTEGRATIONSERVICE = 'ps_integration961' and
REPOSITORYDOMAIN = 'pcdomain_integration961' and
REPOSITORYNAME = 'integration961' and
RUNCONTEXT = '127,36741,13252' and
RUNID = '3037193,3037194,0' and
ENTRYTIME = 1497542531752 and
FOLDER = 'ods_etl_realtime_project' and
WORKFLOW = 'wf_dm_agt_dist_nbt_real_time' and
SESSIONPATH = 'wt_stg_awd/s_m_stg_s2_awd_cntrct_note' and
OSUSER is NULL and
RUNINSTANCENAME is NULL;

insert into INF_PCDM.ISP_RUN_LOG
(ABSOLUTEFILENAME , NODENAME , INTEGRATIONSERVICE, REPOSITORYDOMAIN , REPOSITORYNAME , RUNCONTEXT , RUNID , ENTRYTIME , FOLDER ,
 WORKFLOW , SESSIONPATH , OSUSER , RUNINSTANCENAME )
values
( '/app/powercenter/logs/SessLogs/s_m_STG_S2_AWD_CNTRCT_NOTE.log.20170615120207.bin', 'node02_lxinfpct02' , 'ps_integration961' ,
 'pcdomain_integration961' , 'integration961' , '127,36741,13252' , '3037193,3037194,0' , 1497542531752 ,  'ods_etl_realtime_project' ,
 'wf_dm_agt_dist_nbt_real_time' , 'wt_stg_awd/s_m_stg_s2_awd_cntrct_note' , NULL , NULL);

-- ggsci
start RINFDMT2

-- dirrpt/RINFDMT2.dsc
ABSOLUTEFILENAME = /app/powercenter/logs/SessLogs/s_m_STG_S2_AWD_CNTRCT_REQ.log.20170615120207.bin
NODENAME = node01_lxinfpct01
INTEGRATIONSERVICE = ps_integration961
REPOSITORYDOMAIN = pcdomain_integration961
REPOSITORYNAME = integration961
RUNCONTEXT = 127,36741,13253
RUNID = 3037193,3037194,0
ENTRYTIME = 1497542531891
FOLDER = ods_etl_realtime_project
WORKFLOW = wf_dm_agt_dist_nbt_real_time
SESSIONPATH = wt_stg_awd/s_m_stg_s2_awd_cntrct_req
OSUSER = NULL
RUNINSTANCENAME = NULL

select count(*) from INF_PCDM.ISP_RUN_LOG where
ABSOLUTEFILENAME = '/app/powercenter/logs/SessLogs/s_m_STG_S2_AWD_CNTRCT_REQ.log.20170615120207.bin' and
NODENAME = 'node01_lxinfpct01' and
INTEGRATIONSERVICE = 'ps_integration961' and
REPOSITORYDOMAIN = 'pcdomain_integration961' and
REPOSITORYNAME = 'integration961' and
RUNCONTEXT = '127,36741,13253' and
RUNID = '3037193,3037194,0' and
ENTRYTIME = 1497542531891 and
FOLDER = 'ods_etl_realtime_project' and
WORKFLOW = 'wf_dm_agt_dist_nbt_real_time' and
SESSIONPATH = 'wt_stg_awd/s_m_stg_s2_awd_cntrct_req' and
OSUSER is NULL and
RUNINSTANCENAME is NULL;

insert into INF_PCDM.ISP_RUN_LOG
(ABSOLUTEFILENAME , NODENAME , INTEGRATIONSERVICE, REPOSITORYDOMAIN , REPOSITORYNAME , RUNCONTEXT , RUNID , ENTRYTIME , FOLDER ,
 WORKFLOW , SESSIONPATH , OSUSER , RUNINSTANCENAME )
values
( '/app/powercenter/logs/SessLogs/s_m_STG_S2_AWD_CNTRCT_REQ.log.20170615120207.bin', 'node01_lxinfpct01' , 'ps_integration961' ,
 'pcdomain_integration961' , 'integration961' , '127,36741,13253' , '3037193,3037194,0' , 1497542531891 ,  'ods_etl_realtime_project' ,
 'wf_dm_agt_dist_nbt_real_time' , 'wt_stg_awd/s_m_stg_s2_awd_cntrct_req' , NULL , NULL);

-- ggsci
start RINFDMT2

REPLICAT   RINFDMT2  Last Started 2017-06-21 15:46   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:21 (updated 00:00:00 ago)
Process ID           5598
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/infdmt/RR/ra000000002
                     2017-06-21 15:46:34.167507  RBA 73457661


############
# blcnavt  #
# EBL_AVT1 #
# 6/21     #
############

2017-06-21 10:23:09  ERROR   OGG-02028  Failed to attach to logmining server OGG$EBL_AVT1 error 26908 - ORA-26908: XStream API must be executed using a dedicated server
 process. 
 
-- uxt34
sho parameter shared_servers
NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
max_shared_servers                   integer
shared_servers                       integer     2


############
# caapmt   #
# RCAAPMT1 #
# 6/22     #
############

REPLICAT   RCAAPMT1  Last Started 2017-06-22 08:35   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 01:03:14 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/caapmt/ra000000000
                     First Record  RBA 0

2017-06-22 08:35:57  WARNING OGG-01154  SQL error 1 mapping CAAPMDB.APPMAP_STATES_20170621 to CAAPMT.CAAPMDB.APPMAP_STATES_20170621 OCI Error ORA-00001:
unique constraint (CAAPMDB.SYS_C0019374) violated (status = 1), SQL <INSERT INTO "CAAPMDB"."APPMAP_STATES_20170621" ("VERTEX_ID","ALERT_ID","START_TIME",
"END_TIME","FORK","STATE") VALUES (:a0,:a1,:a2,:a3,:a4,:a5)>.

-- dirrpt/RCAAPMT1.dsc
VERTEX_ID = 1672
ALERT_ID = 43
START_TIME = 2017-06-21 12:53:15.000000000
END_TIME = 2969-05-03 00:00:00.000000000
FORK = 1048576
STATE = 2067

-- uxt34
select count(*) from CAAPMDB.APPMAP_STATES_20170621 where
VERTEX_ID = 1672 and
ALERT_ID = 43 and
START_TIME = to_timestamp('2017-06-21 12:53:15.000000000','YYYY-MM-DD HH24:MI:SS.FF') and
END_TIME = to_timestamp('2969-05-03 00:00:00.000000000','YYYY-MM-DD HH24:MI:SS.FF') and
FORK = 1048576 and
STATE = 2067;
  COUNT(*)
----------
         0

select count(*) from CAAPMDB.APPMAP_STATES_20170621;

-- LXORAINFT01
  COUNT(*)
----------
         0

OWNER                CONSTRAINT_NAME                COLUMN_NAME                    C STATUS
-------------------- ------------------------------ ------------------------------ - --------
CAAPMDB              SYS_C0019374                   VERTEX_ID                      P ENABLED
CAAPMDB              SYS_C0019374                   ALERT_ID                       P ENABLED
CAAPMDB              SYS_C0019374                   START_TIME                     P ENABLED

select count(*) from CAAPMDB.APPMAP_STATES_20170621 where
VERTEX_ID = 1672 and
ALERT_ID = 43 and
START_TIME = to_timestamp('2017-06-21 12:53:15.000000000','YYYY-MM-DD HH24:MI:SS.FF');
--------------------------------------------------------------------------- ---------- ----------
1672
43
21-JUN-17 12.53.15.000000 PM
21-JUN-17 12.53.30.000000 PM
416124
2067

delete from CAAPMDB.APPMAP_STATES_20170621 where
VERTEX_ID = 1672 and
ALERT_ID = 43 and
START_TIME = to_timestamp('2017-06-21 12:53:15.000000000','YYYY-MM-DD HH24:MI:SS.FF');

-- ggsci
start RCAAPMT1

2017-06-22 08:57:50  WARNING OGG-01154  SQL error 1 mapping CAAPMDB.APPMAP_STATES_20170621 to CAAPMT.CAAPMDB.APPMAP_STATES_20170621 OCI Error ORA-00001:
unique constraint (CAAPMDB.SYS_C0019374) violated (status = 1), SQL <INSERT INTO "CAAPMDB"."APPMAP_STATES_20170621" ("VERTEX_ID","ALERT_ID","START_TIME",
"END_TIME","FORK","STATE") VALUES (:a0,:a1,:a2,:a3,:a4,:a5)>.

-- dirrpt/RCAAPMT1.dsc
VERTEX_ID = 2191
ALERT_ID = 43
START_TIME = 2017-06-21 12:53:15.000000000
END_TIME = 2969-05-03 00:00:00.000000000
FORK = 1048576
STATE = 2067

-- uxt34
select count(*) from CAAPMDB.APPMAP_STATES_20170621;
  COUNT(*)
----------
    205101

-- LXORAINFT01
select count(*) from CAAPMDB.APPMAP_STATES_20170621;
  COUNT(*)
----------
    205100

select count(*) from CAAPMDB.APPMAP_STATES_20170621 where
VERTEX_ID = 2191 and
ALERT_ID = 43 and
START_TIME = to_timestamp('2017-06-21 12:53:15.000000000','YYYY-MM-DD HH24:MI:SS.FF');
  COUNT(*)
----------
         1

delete from CAAPMDB.APPMAP_STATES_20170621 where
VERTEX_ID = 2191 and
ALERT_ID = 43 and
START_TIME = to_timestamp('2017-06-21 12:53:15.000000000','YYYY-MM-DD HH24:MI:SS.FF');

-- ggsci
start RCAAPMT1

2017-06-22 09:48:24  WARNING OGG-01154  SQL error 1 mapping CAAPMDB.APPMAP_STATES_20170621 to CAAPMT.CAAPMDB.APPMAP_STATES_20170621 OCI Error ORA-00001:
unique constraint (CAAPMDB.SYS_C0019374) violated (status = 1), SQL <INSERT INTO "CAAPMDB"."APPMAP_STATES_20170621" ("VERTEX_ID","ALERT_ID","START_TIME",
"END_TIME","FORK","STATE") VALUES (:a0,:a1,:a2,:a3,:a4,:a5)>.

-- dirrpt/RCAAPMT1.dsc
VERTEX_ID = 2897
ALERT_ID = 43
START_TIME = 2017-06-21 12:53:15.000000000
END_TIME = 2969-05-03 00:00:00.000000000
FORK = 1048576
STATE = 2067

select count(*) from CAAPMDB.APPMAP_STATES_20170621 where
VERTEX_ID = 2897 and
ALERT_ID = 43 and
START_TIME = to_timestamp('2017-06-21 12:53:15.000000000','YYYY-MM-DD HH24:MI:SS.FF');

delete from CAAPMDB.APPMAP_STATES_20170621 where
VERTEX_ID = 2897 and
ALERT_ID = 43 and
START_TIME = to_timestamp('2017-06-21 12:53:15.000000000','YYYY-MM-DD HH24:MI:SS.FF');

-- ggsci
start RCAAPMT1

edit params RCAAPMT1
--------------------
REPERROR (1,DISCARD)

REPLICAT   RCAAPMT1  Last Started 2017-06-22 09:53   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           11580
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/caapmt/ra000000000
                     2017-06-22 09:53:20.242282  RBA 1041362

REPLICAT   RCAAPMT1  Last Started 2017-06-22 09:53   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:50 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/caapmt/ra000000000
                     2017-06-22 09:53:31.235426  RBA 1217451

2017-06-22 09:53:31  WARNING OGG-01154  SQL error 6550 mapping CAAPMDB.TS_CONCUR_SESSIONS_TS_ID_SQ to CAAPMT.CAAPMDB.TS_CONCUR_SESSIONS_TS_ID_SQ.

-- LXORAINFT01
@/app/oracle/scripts/12cupgrade/sequence_auto.sql

-- ggsci
start RCAAPMT1

REPLICAT   RCAAPMT1  Last Started 2017-06-22 09:56   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:08 ago)
Process ID           11633
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/caapmt/ra000000000
                     2017-06-22 09:56:27.102297  RBA 1217644

					 
############
# lbillt   #
# ELBILLT1 #
# 6/22     #
############

EXTRACT    ELBILLT1  Last Started 2017-06-22 09:55   Status ABENDED
Checkpoint Lag       03:21:39 (updated 00:04:17 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-06-22 06:33:50
                     SCN 2546.1371371422 (10936358107038)

2017-06-22 09:55:29  ERROR   OGG-00868  No viable key columns found for table LISTBILL.TEMP1.

desc LISTBILL.TEMP1
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 TEXT                                               LONG

edit params ELBILLT1
--------------------
TABLEEXCLUDE LISTBILL.TEMP1;
TABLE LISTBILL.TEMP1, KEYCOLS (TEXT);

start ELBILLT1

EXTRACT    ELBILLT1  Last Started 2017-06-22 10:21   Status RUNNING
Checkpoint Lag       00:00:09 (updated 00:00:04 ago)
Process ID           64356778
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-06-22 10:22:13
                     SCN 2546.1371389551 (10936358125167)

					 
##########
# bpat   #
# RBPAT1 #
# 6/28   #
##########

REPLICAT   RBPAT1    Last Started 2017-06-28 14:16   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:05:33 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/bpat/ra000000000
                     2017-06-28 14:16:41.911587  RBA 87913

2017-06-28 14:16:41  WARNING OGG-01154  SQL error 1403 mapping BPA_APPS.CRDS_CONVERSION_DATA_REPORT to BPA_APPS.CRDS_CONVERSION_DATA_REPORT OCI Error ORA
-01403: no data found, SQL <UPDATE "BPA_APPS"."CRDS_CONVERSION_DATA_REPORT" x SET x."REPORT_ID" = :a4,x."SITE_CODE" = :a5,x."REPORT_NAME" = :a6,x."LAST_R
UN_DATE" = :a7 WHERE x."REPORT_ID" = :b0 AND x."SITE_CODE" = :b1 AND x."REPORT_NAME" = :b2 AND x."LAST_RUN_DATE" = :b3 AND ROWNUM = 1>.

-- dirrpt/RBPAT1.dsc
REPORT_ID = 2
SITE_CODE = BLC
REPORT_NAME = BLC Conversion Report
LAST_RUN_DATE = 2017-06-28 12:00:01.613000000

REPORT_ID = 2
SITE_CODE = BLC
REPORT_NAME = BLC Conversion Report
LAST_RUN_DATE = 2017-06-28 14:00:02.532000000

-- linux
select count(*) from BPA_APPS.CRDS_CONVERSION_DATA_REPORT where
REPORT_ID = 2 and
SITE_CODE = 'BLC' and
REPORT_NAME = 'BLC Conversion Report' and
LAST_RUN_DATE = to_timestamp('2017-06-28 12:00:01.613000000','YYYY-MM-DD HH24:MI:SS.FF');
  COUNT(*)
----------
         1

select count(*) from BPA_APPS.CRDS_CONVERSION_DATA_REPORT where
REPORT_ID = 2 and
SITE_CODE = 'BLC' and
REPORT_NAME = 'BLC Conversion Report' and
LAST_RUN_DATE = to_timestamp('2017-06-28 14:00:02.532000000','YYYY-MM-DD HH24:MI:SS.FF');
  COUNT(*)
----------
         0

-- tnsnames point to AIX


############
# dsrt     #
# extracts #
# 7/13     #
############

-- during GGRR_1_stop_extract_AIX.sh
Fully qualified table name GGTEST.ROW_COUNT_AIX is not found in the Oracle GoldenGate configuration.
Fully qualified table name GGTEST.OBJECT_COUNT_AIX is not found in the Oracle GoldenGate configuration.

-- added to EDSRT1.prm
TABLE GGTEST.CONSTRAINT_COUNT_AIX;
TABLE GGTEST.CONSTRAINT_COUNT_LINUX;
TABLE GGTEST.INDEX_COUNT_AIX;
TABLE GGTEST.INDEX_COUNT_LINUX;
TABLE GGTEST.OBJECT_COUNT_AIX;
TABLE GGTEST.OBJECT_COUNT_LINUX;
TABLE GGTEST.PRIV_COUNT_AIX;
TABLE GGTEST.PRIV_COUNT_LINUX;
TABLE GGTEST.ROLE_COUNT_AIX;
TABLE GGTEST.ROLE_COUNT_LINUX;
TABLE GGTEST.ROW_COUNT_AIX;
TABLE GGTEST.ROW_COUNT_LINUX;
TABLE GGTEST.TABLE1;

-- single commands
delete from GGTEST.ROW_COUNT_AIX where
DB_NAME='DSRT' and
HOST_NAME='uxt34' and
OWNER='AIM_RM_PT' and
TABLE_NAME='ACCUMULATE_PREMIUM_AMT_RSLT' and
STATUS='VALID' and
RECORD_COUNT=757630;

delete from GGTEST.OBJECT_COUNT_AIX where
OWNER='CURE_QUEUE' and
OBJECT_NAME='CCF_SHARP_BLC_POLCY_AGT' and
OBJECT_TYPE='TABLE' and
STATUS='VALID';

-- truncate
truncate table GGTEST.OBJECT_COUNT_AIX;

-- other stats (EDSRT1)
stats extract EDSRT1 latest table AIM_RM.OFFICE_DETAILS
Total inserts                                   1538.00

stats extract EDSRT1 table AIM_RM.PAYEE_CONTRACT
Total inserts                                  10208.00

stats extract EDSRT1 latest table AIM_RM.ADJ_REASON_CODES
Total inserts                                    209.00

stats extract EDSRT1 latest table AIM_RM.PLAN_TRANSACTION_TEMP
Total inserts                                 987840.00

-- other stats (RDSRT1)
stats replicat RDSRT1 latest table AIM_RM.OFFICE_DETAILS
Total inserts                                   1538.00

stats replicat RDSRT1 latest table AIM_RM.PAYEE_CONTRACT
Total inserts                                  30624.00

stats replicat RDSRT1 latest table AIM_RM.ADJ_REASON_CODES
Total inserts                                    209.00

stats replicat RDSRT1 latest table AIM_RM.PLAN_TRANSACTION_TEMP
Total inserts                                1854720.00

-- recreate extract
DBLOGIN USERID GGS@DSRT PASSWORD M00nl1ght
stop extract EDSRT1
delete extract EDSRT1
add extract EDSRT1, integrated tranlog, begin now
add exttrail /nomove/app/oracle/ggate/12c/1/dirdat/dsrt/ea, extract EDSRT1, megabytes 1000
register extract EDSRT1 database
start extract EDSRT1

2017-07-13 16:30:37  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File NA, THREAD 1, SEQUENCE 192455, SCN 0x000009f4c1b292fe. Read Position SCN:Unknown).

-- insert data
truncate table GGTEST.ROW_COUNT_AIX;

insert into GGTEST.ROW_COUNT_AIX 
(DB_NAME,HOST_NAME,OWNER,TABLE_NAME,STATUS,RECORD_COUNT)
values
('DSRT','uxt34','AIM_RM_PT','ACCUMULATE_PREMIUM_AMT_RSLT','VALID',757630);

insert into GGTEST.OBJECT_COUNT_AIX 
(OWNER,OBJECT_NAME,OBJECT_TYPE,STATUS)
values
('CURE_QUEUE','CCF_SHARP_BLC_POLCY_AGT','TABLE','VALID');


DBLOGIN USERID GGS@DSRT PASSWORD M00nl1ght
stop extract PDSRT1
delete extract PDSRT1
add extract PDSRT1, exttrailsource /nomove/app/oracle/ggate/12c/1/dirdat/dsrt/ea
add rmttrail /app/oracle/product/ggate/12c/1/dirdat/dsrt/ra, extract PDSRT1, megabytes 1000

info EDSRT1
info PDSRT1
info RDSRT1

stats extract EDSRT1 latest table GGTEST.ROW_COUNT_AIX
stats extract EDSRT1 latest table GGTEST.OBJECT_COUNT_AIX
stats extract PDSRT1 latest table GGTEST.ROW_COUNT_AIX
stats extract PDSRT1 latest table GGTEST.OBJECT_COUNT_AIX



stats replicat RDSRT1 latest table GGTEST.ROW_COUNT_AIX
Fully qualified table name GGTEST.ROW_COUNT_AIX is not found in the Oracle GoldenGate configuration.

stats replicat RDSRT1 latest table GGTEST.OBJECT_COUNT_AIX

2017-07-13 17:59:48  WARNING OGG-01154  SQL error 1 mapping GGTEST.OBJECT_COUNT_AIX to DSRT.GGTEST.OBJECT_COUNT_AIX OCI Error ORA-00001: unique constraint (GGTEST.OBJECT_COUNT_AIX_PK) violated (status = 1), SQL <INSERT INTO "GGTEST"."OBJECT_COUNT_AIX" ("OWNER","OBJECT_NAME","OBJECT_TYPE","STATUS") VALUES (:a0,:a1,:a2,:a3)>.

MAPEXCLUDE dsrt.GGTEST.OBJECT_COUNT_AIX
MAPEXCLUDE dsrt.GGTEST.ROW_COUNT_AIX

*****************
*** not fixed ***
*****************


############
# obieet   #
# post-mig #
# 7/20     #
############

grant CREATE PROCEDURE to "OBIA2_MDS";
grant CREATE PROCEDURE to "SIT_MDS";
grant CREATE SEQUENCE to "OBIA2_MDS";
grant CREATE SEQUENCE to "SIT_MDS";
grant CREATE TABLE to "SIT_MDS";
grant CREATE TABLE to "OBIA2_MDS";
grant CREATE VIEW to "SIT_BIPLATFORM";
grant CREATE VIEW to "POW_DOM";
grant CREATE VIEW to "OBIA2_BIPLATFORM";
grant CREATE VIEW to "POW_REP";


############
# dsrm     #
# uxoram01 #
# 7/19     #
############

-- during script
expdp \"/ as sysdba\" flashback_scn=10947063039626 parfile=/oragg/datapump/dsrm/expdp_dsrm.par
ORA-31693: Table data object "CURE_CORE"."PTY_OBJ_ATTR_VAL":"SYS_P4020"."SYS_SUBP9617" failed to load/unload and is being skipped due to error:
ORA-02354: error in exporting/importing data
ORA-01466: unable to read data - table definition has changed
(for lots & lots of tables)

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm.log | grep ORA-31693 > /oragg/datapump/dsrm/ora31693_dsrm_jul19.txt

-- re-run export
expdp \"/ as sysdba\" flashback_scn=10947063039626 parfile=/oragg/datapump/dsrm/expdp_dsrm_tables_fullpart.par
(same errors - tables have changed since SCN)

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm.log | grep ORA-31693 > /oragg/datapump/dsrm/ora31693_dsrm_jul20.txt
cp /oragg/datapump/dsrm/ora31693_dsrm_jul20.txt /oragg/datapump/dsrm/expdp_dsrm_tables.par
cd /oragg/datapump/dsrm

-- get SCN
set numf 99999999999990
select CURRENT_SCN from v$database;
10947099511788

-- re-run export w/ new flashback
expdp \"/ as sysdba\" flashback_scn=10947099511788 parfile=/oragg/datapump/dsrm/expdp_dsrm_tables.par
Job "SYS"."SYS_EXPORT_TABLE_01" successfully completed at Fri Jul 21 11:56:36 2017 elapsed 0 00:38:33

-- dump files
sudo su - -c "chown -R oracle:dba /oragg/datapump/dsrm"
sudo su - -c "chmod -R 777 /oragg/datapump/dsrm"

-- /database/cdsrm_admn01/scripts/impdp_dsrm_tables.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=dsrm_tables_%U.dmp
LOGFILE=impdp_dsrm_tables.log
TABLE_EXISTS_ACTION=append
PARALLEL=4
METRICS=Y
TRANSFORM=TABLE_COMPRESSION_CLAUSE:"COMPRESS FOR OLTP"
LOGTIME=ALL

-- import data
$ORACLE_HOME/bin/impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAODSM02.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=dsrm)))\" parfile=/database/cdsrm_admn01/scripts/impdp_dsrm_tables.par


alter user CURE_ SUBSCRPT quota UNLIMITED on CURE_TBLSP_DATA
                 *
ERROR at line 1:
ORA-00922: missing or invalid option 

alter user "CURE_ SUBSCRPT" quota UNLIMITED on CURE_TBLSP_DATA;
alter user "CURE_ SUBSCRPT" quota UNLIMITED on CURE_TBLSP_IDX;
alter user "CURE_ SUBSCRPT" quota UNLIMITED on USERS;

TABLE                                             AIX        LINUX          DIFFERENCE
---------------------------------------- ------------ ------------ -------------------
CURE_CORE.POLCY_OBJ_ATTR                  483,169,009  483,169,707                 698
CURE_CORE.POLCY_OBJ_ATTR_VAL              522,067,345  874,976,853           352909508
CURE_CORE.PTY_PVT                          26,746,882   26,753,383                6501
CURE_METADATA.INFO_FLOW_CMPNT_STATS            88,729       88,735                   6
CURE_METADATA.INFO_FLOW_STATS                  14,838       14,839                   1
CURE_QUEUE.PEL_FDLZ_POLCY                 115,799,035  115,806,877                7842

-- CURE_CORE.POLCY_OBJ_ATTR_VAL and CURE_QUEUE.PEL_FDLZ_POLCY part of 2nd import

OBJECT_TYPE         OBJECT_NAME                              AIX     LINUX
------------------- ---------------------------------------- ------- -------
MATERIALIZED VIEW   CURE_CORE.MV_SUBJ_AREA_ATTR_LIST         VALID   INVALID

alter materialized view CURE_CORE.MV_SUBJ_AREA_ATTR_LIST compile;

GRANTEE                        AIX_PRIVILEGE                                    LINUX_PRIVILEGE
------------------------------ ------------------------------------------------ ------------------------------------------------
CLIENT                         CREATE TABLE                                     -
CURE_CORE                      CREATE TABLE                                     -
CURE_QUEUE                     CREATE TABLE                                     -
ENTPRS_REF_LIB                 CREATE TABLE                                     -

grant CREATE TABLE to CLIENT;
grant CREATE TABLE to CURE_CORE;
grant CREATE TABLE to CURE_QUEUE;
grant CREATE TABLE to ENTPRS_REF_LIB;


##########
# dsrm   #
# RDSRM1 #
# 7/22   #
##########

2017-07-22 19:41:44  WARNING OGG-01154  SQL error 1 mapping CURE_QUEUE.CCF_SHARP_WN_POLCY_COVRG to DSRM.CURE_QUEUE.CCF_SHARP_WN_POLCY_COVRG OCI Error
ORA-00001: unique constraint (CURE_QUEUE.CCF_SHARP_WN_POLCY_COVRG_PK) violated (status = 1), SQL <INSERT INTO "CURE_QUEUE"."CCF_SHARP_WN_POLCY_COVRG"
("CCF_ID","ADMIN_SYSTM_NAME","SBJCT_AREA_NAME","OBJCT_ID","SOURC_BUSNS_KEY","ATTRB_NAME","ATTRB_VALUE","VALID_VALUE_IND","INSRT_SOURC","INSRT_TIMESTAM
P") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9)>.

-- edit params
REPERROR (1,DISCARD)


##########
# dsrm   #
# RDSRM1 #
# 7/23   #
##########

2017-07-23 19:44:38  WARNING OGG-01154  SQL error 1403 mapping CURE_QUEUE.PEL_BLCP_POL to DSRM.CURE_QUEUE.PEL_BLCP_POL OCI Error ORA-01403: no data fo
und, SQL <UPDATE "CURE_QUEUE"."PEL_BLCP_POL" x SET x."OBJ_ATTR_VAL_ID" = :a13,x."INFO_SYS_ID" = :a14,x."OBJ_ID" = :a15,x."ATTR_ID" = :a16,x."OBJ_ATTR_
VAL_TXT" = :a17,x."VALID_VAL_CD" = :a18,x."VAL_EDIT_CD" = :a19,x."EFF_FROM_DT" = :a20,x."EFF_TO_DT" = :a21,x."INSRT_DTM" = :a22,x."INSRT_SRC_NM" = :a2
3,x."LAST_UPDT_DTM" = :a24,x."LAST_UPDT_SRC_NM" = :a25 WHERE x."OBJ_ATTR_VAL_ID" = :b0 AND x."INFO_SYS_ID" = :b1 AND x."OBJ_ID" = :b2 AND x."ATTR_ID"
= :b3 AND x."OBJ_ATTR_VAL_TXT" = :b4 AND x."VALID_VAL_CD" = :b5 AND x."VAL_EDIT_CD" is NULL AND x."EFF_FROM_DT" = :b7 AND x."EFF_TO_DT" is NULL AND x.
"INSRT_DTM" = :b9 AND x."INSRT_SRC_NM" = :b10 AND x."LAST_UPDT_DTM" is NULL AND x."LAST_UPDT_SRC_NM" is NULL AND ROWNUM = 1>.

mv ./dirrpt/RDSRM1.dsc ./dirrpt/RDSRM1.dsc.20170723
-- ./dirrpt/RDSRM1.dsc.20170723
OBJ_ATTR_VAL_ID = 104873247744
INFO_SYS_ID = 120
OBJ_ID = 100717646583
ATTR_ID = 188
OBJ_ATTR_VAL_TXT = 156.11
VALID_VAL_CD = X
VAL_EDIT_CD = NULL
EFF_FROM_DT = 2017-02-28 06:47:32
EFF_TO_DT = NULL
INSRT_DTM = 2017-02-28 06:47:39
INSRT_SRC_NM = PEL_PKG.INSRT
LAST_UPDT_DTM = NULL
LAST_UPDT_SRC_NM = NULL

OBJ_ATTR_VAL_ID = 104873247744
INFO_SYS_ID = 120
OBJ_ID = 100717646583
ATTR_ID = 188
OBJ_ATTR_VAL_TXT = 156.11
VALID_VAL_CD = X
VAL_EDIT_CD = NULL
EFF_FROM_DT = 2017-02-28 06:47:32
EFF_TO_DT = 2017-07-18 14:04:50
INSRT_DTM = 2017-02-28 06:47:39
INSRT_SRC_NM = PEL_PKG.INSRT
LAST_UPDT_DTM = 2017-07-18 14:05:50
LAST_UPDT_SRC_NM = PEL_PKG.UPDT

-- LXORAODSM02
select count(*) from "CURE_QUEUE"."PEL_BLCP_POL" where
OBJ_ATTR_VAL_ID = 104873247744 and
INFO_SYS_ID = 120 and
OBJ_ID = 100717646583 and
ATTR_ID = 188 and
OBJ_ATTR_VAL_TXT = 156.11 and
VALID_VAL_CD = 'X' and
VAL_EDIT_CD is NULL and
EFF_FROM_DT = to_date('2017-02-28 06:47:32','YYYY-MM-DD HH24:MI:SS') and
EFF_TO_DT is NULL and
INSRT_DTM = to_date('2017-02-28 06:47:39','YYYY-MM-DD HH24:MI:SS') and
INSRT_SRC_NM = 'PEL_PKG.INSRT' and
LAST_UPDT_DTM is NULL and
LAST_UPDT_SRC_NM is NULL;

select count(*) from "CURE_QUEUE"."PEL_BLCP_POL" where
OBJ_ATTR_VAL_ID = 104873247744 and
INFO_SYS_ID = 120 and
OBJ_ID = 100717646583 and
ATTR_ID = 188 and
OBJ_ATTR_VAL_TXT = 156.11 and
VALID_VAL_CD = 'X' and
VAL_EDIT_CD is NULL and
EFF_FROM_DT = to_date('2017-02-28 06:47:32','YYYY-MM-DD HH24:MI:SS') and
EFF_TO_DT = to_date('2017-07-18 14:04:50','YYYY-MM-DD HH24:MI:SS') and
INSRT_DTM = to_date('2017-02-28 06:47:39','YYYY-MM-DD HH24:MI:SS') and
INSRT_SRC_NM = 'PEL_PKG.INSRT' and
LAST_UPDT_DTM = to_date('2017-07-18 14:05:50','YYYY-MM-DD HH24:MI:SS') and
LAST_UPDT_SRC_NM = 'PEL_PKG.UPDT';

insert into "CURE_QUEUE"."PEL_BLCP_POL"
(OBJ_ATTR_VAL_ID ,INFO_SYS_ID ,OBJ_ID ,ATTR_ID ,OBJ_ATTR_VAL_TXT ,VALID_VAL_CD ,VAL_EDIT_CD ,EFF_FROM_DT ,EFF_TO_DT ,
INSRT_DTM ,INSRT_SRC_NM ,LAST_UPDT_DTM ,LAST_UPDT_SRC_NM)
values
( 104873247744 , 120 , 100717646583 ,188 , 156.11 , 'X' , NULL , to_date('2017-02-28 06:47:32','YYYY-MM-DD HH24:MI:SS') ,
 NULL , to_date('2017-02-28 06:47:39','YYYY-MM-DD HH24:MI:SS') , 'PEL_PKG.INSRT' , NULL , NULL);
commit;

start RDSRM1

REPLICAT   RDSRM1    Last Started 2017-07-23 20:07   Status ABENDED
INTEGRATED
Checkpoint Lag       125:33:25 (updated 00:24:36 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000001
                     2017-07-18 14:10:47.134020  RBA 531677631

-- ./dirrpt/RDSRM1.dsc
OBJ_ATTR_VAL_ID = 104873248769
INFO_SYS_ID = 120
OBJ_ID = 100724146297
ATTR_ID = 188
OBJ_ATTR_VAL_TXT = 324.11
VALID_VAL_CD = X
VAL_EDIT_CD = NULL
EFF_FROM_DT = 2017-02-28 06:47:32
EFF_TO_DT = NULL
INSRT_DTM = 2017-02-28 06:47:39
INSRT_SRC_NM = PEL_PKG.INSRT
LAST_UPDT_DTM = NULL
LAST_UPDT_SRC_NM = NULL

OBJ_ATTR_VAL_ID = 104873248769
INFO_SYS_ID = 120
OBJ_ID = 100724146297
ATTR_ID = 188
OBJ_ATTR_VAL_TXT = 324.11
VALID_VAL_CD = 'X'
VAL_EDIT_CD = NULL
EFF_FROM_DT = to_date('2017-02-28 06:47:32','YYYY-MM-DD HH24:MI:SS') and
EFF_TO_DT = to_date('2017-07-18 14:04:50','YYYY-MM-DD HH24:MI:SS') and
INSRT_DTM = to_date('2017-02-28 06:47:39','YYYY-MM-DD HH24:MI:SS') and
INSRT_SRC_NM = 'PEL_PKG.INSRT'
LAST_UPDT_DTM = to_date('2017-07-18 14:05:50','YYYY-MM-DD HH24:MI:SS') and

LAST_UPDT_SRC_NM = PEL_PKG.UPDT

-- LXORAODSM02
select count(*) from "CURE_QUEUE"."PEL_BLCP_POL" where
OBJ_ATTR_VAL_ID = 104873248769 and
INFO_SYS_ID = 120 and
OBJ_ID = 100724146297 and
ATTR_ID = 188 and
OBJ_ATTR_VAL_TXT = 324.11 and
VALID_VAL_CD = 'X' and
VAL_EDIT_CD is NULL and
EFF_FROM_DT = to_date('2017-02-28 06:47:32','YYYY-MM-DD HH24:MI:SS') and
EFF_TO_DT is NULL and
INSRT_DTM = to_date('2017-02-28 06:47:39','YYYY-MM-DD HH24:MI:SS') and
INSRT_SRC_NM = 'PEL_PKG.INSRT' and
LAST_UPDT_DTM is NULL and
LAST_UPDT_SRC_NM is NULL;

select count(*) from "CURE_QUEUE"."PEL_BLCP_POL" where
OBJ_ATTR_VAL_ID = 104873248769 and
INFO_SYS_ID = 120 and
OBJ_ID = 100724146297 and
ATTR_ID = 188 and
OBJ_ATTR_VAL_TXT = 324.11 and
VALID_VAL_CD = 'X' and
VAL_EDIT_CD = NULL and
EFF_FROM_DT = to_date('2017-02-28 06:47:32','YYYY-MM-DD HH24:MI:SS') and
EFF_TO_DT = to_date('2017-07-18 14:04:50','YYYY-MM-DD HH24:MI:SS') and
INSRT_DTM = to_date('2017-02-28 06:47:39','YYYY-MM-DD HH24:MI:SS') and
INSRT_SRC_NM = 'PEL_PKG.INSRT' and
LAST_UPDT_DTM = to_date('2017-07-18 14:05:50','YYYY-MM-DD HH24:MI:SS') and
LAST_UPDT_SRC_NM = 'PEL_PKG.UPDT';

insert into "CURE_QUEUE"."PEL_BLCP_POL"
(OBJ_ATTR_VAL_ID ,INFO_SYS_ID ,OBJ_ID ,ATTR_ID ,OBJ_ATTR_VAL_TXT ,VALID_VAL_CD ,VAL_EDIT_CD ,EFF_FROM_DT ,EFF_TO_DT ,
INSRT_DTM ,INSRT_SRC_NM ,LAST_UPDT_DTM ,LAST_UPDT_SRC_NM)
values
(104873248769 , 120 , 100724146297 , 188 , 324.11 , 'X' , NULL , to_date('2017-02-28 06:47:32','YYYY-MM-DD HH24:MI:SS') ,
 NULL , to_date('2017-02-28 06:47:39','YYYY-MM-DD HH24:MI:SS') , 'PEL_PKG.INSRT' , NULL , NULL);
commit;

start RDSRM1

-- edit params RDSRM1
(add before other table mappings)
INSERTMISSINGUPDATES 
MAP "CURE_QUEUE"."PEL_BLCP_POL", TARGET "CURE_QUEUE"."PEL_BLCP_POL";
NOINSERTMISSINGUPDATES 

start RDSRM1

REPLICAT   RDSRM1    Last Started 2017-07-23 20:34   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:31 ago)
Process ID           9593
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000001
                     2017-07-23 20:35:09.125655  RBA 532752246

REPLICAT   RDSRM1    Last Started 2017-07-23 20:34   Status ABENDED
INTEGRATED
Checkpoint Lag       126:16:53 (updated 00:07:55 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000001
                     2017-07-18 15:05:49.189556  RBA 609399521

2017-07-23 21:26:52  ERROR   OGG-01172  Discard file (./dirrpt/RDSRM1.dsc) exceeded max bytes (500000000).

mv ./dirrpt/RDSRM1.dsc ./dirrpt/RDSRM1.dsc.201707232127

REPLICAT   RDSRM1    Last Started 2017-07-23 21:33   Status ABENDED
INTEGRATED
Checkpoint Lag       126:54:33 (updated 00:52:36 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000001
                     2017-07-18 15:23:37.753232  RBA 657716846

2017-07-23 22:18:13  ERROR   OGG-01172  Discard file (./dirrpt/RDSRM1.dsc) exceeded max bytes (500000000).

mv ./dirrpt/RDSRM1.dsc ./dirrpt/RDSRM1.dsc.201707232218

start RDSRM1

2017-07-23 23:53:52  ERROR   OGG-01172  Discard file (./dirrpt/RDSRM1.dsc) exceeded max bytes (500000000).

mv ./dirrpt/RDSRM1.dsc ./dirrpt/RDSRM1.dsc.201707232354

start RDSRM1

REPLICAT   RDSRM1    Last Started 2017-07-24 08:02   Status RUNNING
INTEGRATED
Checkpoint Lag       136:19:29 (updated 00:00:24 ago)
Process ID           13657
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000001
                     2017-07-18 15:50:35.298182  RBA 788620317

REPLICAT   RDSRM1    Last Started 2017-07-24 08:02   Status ABENDED
INTEGRATED
Checkpoint Lag       136:18:30 (updated 00:16:39 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000001
                     2017-07-18 16:34:39.581276  RBA 811413148

2017-07-24 08:53:36  ERROR   OGG-01172  Discard file (./dirrpt/RDSRM1.dsc) exceeded max bytes (500000000).

mv ./dirrpt/RDSRM1.dsc ./dirrpt/RDSRM1.dsc.201707240853

start RDSRM1

-- edit params
DISCARDROLLOVER AT 09:30
DISCARDROLLOVER AT 18:00 (already there)

REPLICAT   RDSRM1    Last Started 2017-07-24 09:10   Status ABENDED
INTEGRATED
Checkpoint Lag       137:11:14 (updated 01:49:29 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000001
                     2017-07-18 16:34:39.581276  RBA 811413148

mv ./dirrpt/RDSRM1.dsc ./dirrpt/RDSRM1.dsc.201707240946

-- edit params
DISCARDROLLOVER AT 11:50
DISCARDROLLOVER AT 12:00
DISCARDROLLOVER AT 12:10
DISCARDROLLOVER AT 12:20
DISCARDROLLOVER AT 12:30
DISCARDROLLOVER AT 12:40

2017-07-24 11:39:56  ERROR   OGG-10147  (RDSRM1.prm) line 18: Parsing error, parameter [discardrollover] cannot be specified multiple times.

start RDSRM1

mv ./dirrpt/RDSRM1.dsc ./dirrpt/RDSRM1.dsc.201707241228

REPLICAT   RDSRM1    Last Started 2017-07-24 12:30   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:04:01 ago)
Process ID           15215
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000001
                     2017-07-24 12:40:18.097967  RBA 814247639

mv ./dirrpt/RDSRM1.dsc ./dirrpt/RDSRM1.dsc.201707241316

sh ls -l ./dirrpt/RDSRM1.dsc*


##########
# dsrm   #
# PDSRM1 #
# 7/23   #
##########

EXTRACT    PDSRM1    Last Started 2017-07-20 12:59   Status ABENDED
Checkpoint Lag       02:30:37 (updated 77:18:29 ago)
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/dsrm/ea000000024
                     2017-07-20 15:30:17.000000  RBA 582908635

2017-07-20 18:01:03  ERROR   OGG-01233  Send TCP params error: TCP/IP error 32 (Broken pipe), endpoint: lxoggm01:7830.

start PDSRM1

2017-07-24 00:00:18  ERROR   OGG-01232  Receive TCP params error: TCP/IP error 73 (Connection reset by peer), endpoint: lxoggm01:7824.

start PDSRM1

2017-07-24 08:16:18  ERROR   OGG-01232  Receive TCP params error: TCP/IP error 73 (Connection reset by peer), endpoint: lxoggm01:7825.

telnet lxoggm01 7830
telnet lxoggm01 7824
telnet lxoggm01 7825

-- params
RMTHOST lxoggm01, MGRPORT 7819, TCPBUFSIZE 1000000, TCPFLUSHBYTES 1000000

start

2017-07-24 08:56:40  ERROR   OGG-01232  Receive TCP params error: TCP/IP error 73 (Connection reset by peer), endpoint: lxoggm01:7825.


##########
# dsrm   #
# EDSRM1 #
# 7/24   #
##########

EXTRACT    EDSRM1    Last Started 2017-07-20 12:59   Status STOPPED
Checkpoint Lag       56:04:47 (updated 01:28:54 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-07-22 05:10:46
                     SCN 2548.3529698745 (10947106368953)

2017-07-24 13:19:22  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File NA, THREAD 1, SEQUENCE 964482, SCN 0x000009f4d25d2f32. Read Position SCN: 2548.3529698745 (10947106368953)).

rman target / catalog rman@rman11m
restore archivelog from sequence 964482;

list BACKUP OF ARCHIVELOG SEQUENCE BETWEEN 964482 AND 964483;


############
# obieem   #
# ROBIEEM1 #
# 7/26     #
############

REPLICAT   ROBIEEM1  Last Started 2017-07-26 07:25   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:05 (updated 01:17:40 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/obieem/ra000000000
                     2017-07-26 07:38:36.347890  RBA 7457628

2017-07-26 07:38:48  ERROR   OGG-03521  Invalid character for character set UTF-8 was found while performing character validation of source column ISO_COUNTRY_NAM
E maps target column ISO_COUNTRY_NAME.

-- OGG-03521 Invalid Character For Character Set UTF-8 (Doc ID 2029686.1)
1. re requested, comment out: SETENV (NLS_LANG = "AMERICAN_AMERICA.AL32UTF8")
2. add: NOCHARSETCONVERSION

REPLICAT   ROBIEEM1  Last Started 2017-07-26 09:59   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:33 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/obieem/ra000000000
                     2017-07-26 09:59:37.589963  RBA 16747193

2017-07-26 09:59:38  WARNING OGG-01154  SQL error 1403 mapping OBAW.W_POSITION_DH_BASE_TMP to OBAW.W_POSITION_DH_BASE_TMP OCI Error ORA-01403: no data found, SQL
<UPDATE "OBAW"."W_POSITION_DH_BASE_TMP" x SET x."POSTN_INTEGRATION_ID" = :a6,x."DATASOURCE_NUM_ID" = :a7,x."SCD_TYPE1_FLG" = :a8,x."SCD_TYPE2_FLG" = :a9,x."SCD_TY
PE1B_FLG" = :a10,x."SCD_TYPE2B_FLG" = :a11 WHERE x."POSTN_INTEGRATION_ID" = :b0 AND x."DATASOURCE_NUM_ID" = :b1 AND x."SCD_TYPE1_FLG" = :b2 AND x."SCD_TYPE2_FLG"
= :b3 AND x."SCD_TYPE1B_FLG" is NULL AND x."SCD_TYPE2B_FLG" is NULL AND ROWNUM = 1>.

-- ./dirrpt/ROBIEEM1.dsc
Current time: 2017-07-26 09:59:38
POSTN_INTEGRATION_ID = PER~1142
DATASOURCE_NUM_ID = 1000
SCD_TYPE1_FLG = N
SCD_TYPE2_FLG = Y
SCD_TYPE1B_FLG = NULL
SCD_TYPE2B_FLG = NULL

POSTN_INTEGRATION_ID = PER~1142
DATASOURCE_NUM_ID = 1000
SCD_TYPE1_FLG = N
SCD_TYPE2_FLG = Y
SCD_TYPE1B_FLG = N
SCD_TYPE2B_FLG = Y

-- LXORAFINM04
select count(*) from "OBAW"."W_POSITION_DH_BASE_TMP" where
POSTN_INTEGRATION_ID = 'PER~1142' and
DATASOURCE_NUM_ID = 1000 and
SCD_TYPE1_FLG = 'N' and
SCD_TYPE2_FLG = 'Y' and
SCD_TYPE1B_FLG is NULL and
SCD_TYPE2B_FLG is NULL;
0

select count(*) from "OBAW"."W_POSITION_DH_BASE_TMP" where
POSTN_INTEGRATION_ID = 'PER~1142' and
DATASOURCE_NUM_ID = 1000 and
SCD_TYPE1_FLG = 'N' and
SCD_TYPE2_FLG = 'Y' and
SCD_TYPE1B_FLG = 'N' and
SCD_TYPE2B_FLG = 'Y';
0

insert into "OBAW"."W_POSITION_DH_BASE_TMP"
(POSTN_INTEGRATION_ID,DATASOURCE_NUM_ID,SCD_TYPE1_FLG ,SCD_TYPE2_FLG ,SCD_TYPE1B_FLG ,SCD_TYPE2B_FLG )
values
('PER~1142',1000 , 'N' , 'Y' , NULL , NULL);

-- ./dirrpt/ROBIEEM1.dsc
Current time: 2017-07-26 10:08:20
POSTN_INTEGRATION_ID = PER~1151
DATASOURCE_NUM_ID = 1000
SCD_TYPE1_FLG = Y
SCD_TYPE2_FLG = Y
SCD_TYPE1B_FLG = NULL
SCD_TYPE2B_FLG = NULL

POSTN_INTEGRATION_ID = PER~1151
DATASOURCE_NUM_ID = 1000
SCD_TYPE1_FLG = Y
SCD_TYPE2_FLG = Y
SCD_TYPE1B_FLG = Y
SCD_TYPE2B_FLG = Y

-- LXORAFINM04
insert into "OBAW"."W_POSITION_DH_BASE_TMP"
(POSTN_INTEGRATION_ID,DATASOURCE_NUM_ID,SCD_TYPE1_FLG ,SCD_TYPE2_FLG ,SCD_TYPE1B_FLG ,SCD_TYPE2B_FLG )
values
('PER~1151' ,1000, 'Y', 'Y',NULL,NULL);

-- ggsci
start ROBIEEM1
edit params ROBIEEM1

(add before other table mappings)
INSERTMISSINGUPDATES 
MAP "OBAW"."W_POSITION_DH_BASE_TMP", TARGET "OBAW"."W_POSITION_DH_BASE_TMP";
NOINSERTMISSINGUPDATES 

start ROBIEEM1

REPLICAT   ROBIEEM1  Last Started 2017-07-26 10:15   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           32154
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/obieem/ra000000000
                     2017-07-26 10:16:19.423882  RBA 44852046

					 
############
# obieem   #
# EOBIEEM1 #
# 7/26     #
############

-- lag in extract causing archive log mount to fill up

EXTRACT    EOBIEEM1  Last Started 2017-07-25 14:14   Status RUNNING
Checkpoint Lag       06:39:58 (updated 00:00:02 ago)
Process ID           3604854
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-07-26 11:00:09
                     SCN 2546.1363708502 (10936350444118)

Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
/dev/obieem_arch01     70.00      4.12   95%      274     1% /move/obieem_arch01

-- ggsci
stop EOBIEEM1
start EOBIEEM1

EXTRACT    EOBIEEM1  Last Started 2017-07-25 14:14   Status STOPPED
Checkpoint Lag       06:39:58 (updated 00:33:52 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-07-26 11:00:09
                     SCN 2546.1363708502 (10936350444118)

2017-07-26 17:43:37  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File NA, THREAD 1, SEQUENCE 28377, SCN 0x000009f251488a4e. Read Position SCN: 2546.1363708502 (10936350444118)).



############
# dsrm     #
# uxoram01 #
# 7/26     #
############

-- during export
Export: Release 11.2.0.4.0 - Production on Wed Jul 26 16:13:37 2017
Starting "SYS"."SYS_EXPORT_SCHEMA_01":  "/******** AS SYSDBA" flashback_scn=10947352685718 parfile=/oragg/datapump/dsrm/expdp_dsrm.par
Startup took 1563 seconds
Estimate in progress using BLOCKS method...
Processing object type SCHEMA_EXPORT/TABLE/TABLE_DATA
     Estimated 1507 TABLE_DATA objects in 89 seconds
./GG_1_AIX_start_extract.sh[2410]: 65077566 Killed

Export: Release 11.2.0.4.0 - Production on Wed Jul 26 16:50:23 2017
./GG_1_AIX_start_extract.sh[2415]: 54657418 Killed

-- remove dump files
rm /oragg/datapump/dsrm/*.dmp

-- manual run
expdp \"/ as sysdba\" flashback_scn=10947352685718 parfile=/oragg/datapump/dsrm/expdp_dsrm.par

-- get SCN
set numf 99999999999990
select CURRENT_SCN from v$database;

-- expdp log
Export: Release 11.2.0.4.0 - Production on Wed Jul 26 17:16:04 2017
...
ORA-23603: Streams enqueue aborted due to low SGA
ORA-39097: Data Pump job encountered unexpected error -39079
...
Job "SYS"."SYS_EXPORT_SCHEMA_01" stopped due to fatal error at Thu Jul 27 03:20:09 2017 elapsed 0 11:05:31
(17:16 to 03:20)

-- OEM
med CPU		continuous
med I/O		started just before export
high I/O	18:02 to 1:56


############
# oscrm    #
# expdp    #
# uxoram01 #
# 7/26     #
############

-- expdp log
(overwritten - not written to script log)

-- script log
*******************************************************
Today is Wed Jul 26 17:31:07 EDT 2017
(timestamp of file is 7/27 @ 01:16)

-- OEM
med CPU		17:30 to 1:49
high I/O	17:30 to 22:22
med I/O		22:22 to 1:49


############
# uxoram01 #
# 7/26     #
############

-- memory_uxoram01.log
actvalm,5248,2300,0
app4086m,3664,115,0
caapmm,3744,230,0
cnofdwm,10432,1150,0
dpmm,752,0,0
dsgm,3392,115,0
dsrm,7600,920,0
edmam,3168,115,0
fdlzm,12448,1150,0
h11drmm,3664,115,0
h11epmm,3664,115,0
h11hfmm,3664,115,0
h11soam,3664,115,0
oscrm,3392,115,0
trecscm,8256,1150,0
wstodsm,3136,115,0
total=87,823

-- nmon (7/27)
virtual mem used = 30.7 GB

-- memory spread sheet
Old Host	54,272 
Total DB	77,752
Total Host	89,528 


###########
# cigfdsm #
# expdp   #
# uxm33   #
# 7/26    #
###########

-- expdp log
Export: Release 11.2.0.4.0 - Production on Wed Jul 26 18:50:21 2017
...
Job "SYS"."SYS_EXPORT_SCHEMA_04" completed with 69 error(s) at Thu Jul 27 04:43:01 2017 elapsed 0 09:52:38

-- OEM
CPU spike	18:46 to 19:16
I/O spike	18:46 to 19:16
med CPU		18:46 to current
high I/O	18:46 to 4:16


##########
# uxm34  #
# memory #
# 7/27   #
##########

-- memory_uxm34.log
abcinfom,3168,115,0
blcfdsm,9184,1449,0
blcnavm,4096,230,0
c3appsm,3872,0,0
cdsinfom,3200,115,0
ERROR: (cnofarm)
cpsmrtsm,3216,90,0
custsvcm,3376,161,0
documkrm,7008,230,0
fnp8m,4096,345,0
ftlzm,4000,0,0
idmm,3744,60,0
lbillm,5600,690,0
mwarem,3152,115,0
obieem,9728,3533,0
padrm,3232,115,0
pbizm,3088,115,0
rman11m,1000,0,0
Total= 82,063

-- nmon (7/27)
virtual mem used = 49.8 GB

-- memory spread sheet
Old Host	97,230
Total DB	85,454
Total Host	97,230

 
#############
# VM memory #
# UAT       #
# 7/27      #
#############

LXORABPAM01
awdm		3252			1500
blcnavm		4311			1500
bpam		3791			1500
bparptm		3908			1500
custsvcm	3523			1500
padrm		3335			1500
			22,120 - 11		9000

LXORABPAM02
documkrm	7186			4200
fnp8m		4426			1500
hubm		3764			1500
lbillm		6247			1760
mwarem		3262			1500
pbizm		3188			1500
			28,073 - 11		11960

LXORACPNM01
c3appsm		3864			1500
cpsmrtsm	3303			1500
oscrm		3506			1500
			10,673 - 4		4500

LXORADWSM01
blcdwsm		9302			6040
idwm		9320			6056
			18,622 - 10		12096

LXORAENTM01
infdmm		3764			1500
infdqm		4311			1700
infpcm		5488			1700
			13,563 - 5		4900

LXORAFINM01
abcinfom	3280			1500
actvalm		7544			4512
cdsinfom	3303			1500
h11drmm		3764			1500
h11epmm		3764			1500
h11hfmm		3764			1500
h11soam		3764			1500
infgix8m	4554			1912
upkm		3220			1500
			39,957 - 10		16924

LXORAFINM02
cnofdwm		11565 - 10		8008

LXORAFINM03
fdlzm		13580			9760
ftlzm		3362			1500
trecscm		9394			6120
			26,336 - 17		17380

LXORAFINM04
obieem		13249 - 15		9472

LXORAINFM01
dsgm		3506			1500
rman12m		1500			1500
			5006 - 3		3000

LXORAINFM02
aedbm		4311			1700
caapmm		3966			1500
edmam		3281			1500
idmm		3794			1500
wccm		4311			1700
wccrptm		4311			1700
			23,974 - 11		9600
			
LXORAINVM01
app4086m	3764			1500
prodm		9449			4120
trmpm		9394			1500
			22,607 - 7		7120
			
LXORAODSM01
blcfdsm		11165			7660
cigfdsm		5355			2608
cnofarm		3524			1500
portalm		3814			1500
wstodsm		3247			1500
			27,105 - 15		14768
			
LXORAODSM02
dsrm		8506 - 4		3300

-- LXORABPAM02 (no DB running)
total mem	10830
free mem	 8402
OS used		 2428

-- ehealth	LXORAINFD01	LXORAENTM01	max
AutoSys		    0			0		0
EndPointMgr	  599			599		599
GGDBProcess	    0			100		100
JAVA		 2512			1476	2512
OraEM13c	   68			66		68
sysedge		   51			51		51
Veritas		    0			0		0
Total		 3230			2292	3330


############
# cigfdsm  #
# RCI_DSM1 #
# 7/27     #
############

REPLICAT   RCI_DSM1  Last Started 2017-07-27 19:51   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:03:45 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/cigfdsm/ra000000000
                     First Record  RBA 0

2017-07-27 19:51:57  WARNING OGG-01154  SQL error 1403 mapping BLC_EAPP_GTWY.QRTZ_SCHEDULER_STATE to BLC_EAPP_GTWY.QRTZ_SCHEDULER_STATE OCI Error ORA-
01403: no data found, SQL <UPDATE "BLC_EAPP_GTWY"."QRTZ_SCHEDULER_STATE" x SET x."LAST_CHECKIN_TIME" = :a3 WHERE x."INSTANCE_NAME" = :b0>.

-- edit params RCI_DSM1
(add before other table mappings)
INSERTMISSINGUPDATES 
MAP "BLC_EAPP_GTWY"."QRTZ_SCHEDULER_STATE", TARGET "BLC_EAPP_GTWY"."QRTZ_SCHEDULER_STATE";
NOINSERTMISSINGUPDATES 

2017-07-27 19:57:17  WARNING OGG-01154  SQL error 1400 mapping BLC_EAPP_GTWY.QRTZ_SCHEDULER_STATE to BLC_EAPP_GTWY.QRTZ_SCHEDULER_STATE OCI Error ORA-
01400: cannot insert NULL into ("BLC_EAPP_GTWY"."QRTZ_SCHEDULER_STATE"."CHECKIN_INTERVAL") (status = 1400), SQL <INSERT INTO "BLC_EAPP_GTWY"."QRTZ_SCH
EDULER_STATE" ("INSTANCE_NAME","LAST_CHECKIN_TIME") VALUES (:a2,:a3)>.

-- LXORAODSM01
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 INSTANCE_NAME                             NOT NULL VARCHAR2(200)
 LAST_CHECKIN_TIME                         NOT NULL NUMBER(13)
 CHECKIN_INTERVAL                          NOT NULL NUMBER(13)

OWNER                CONSTRAINT_NAME                COLUMN_NAME                    C STATUS
-------------------- ------------------------------ ------------------------------ - --------
BLC_EAPP_GTWY        SYS_C0013520                   INSTANCE_NAME                  P ENABLED
BLC_EAPP_GTWY        SYS_C0012201                   INSTANCE_NAME                  C ENABLED
BLC_EAPP_GTWY        SYS_C0012202                   LAST_CHECKIN_TIME              C ENABLED
BLC_EAPP_GTWY        SYS_C0012203                   CHECKIN_INTERVAL               C ENABLED

ALTER TABLE BLC_EAPP_GTWY.QRTZ_SCHEDULER_STATE DISABLE CONSTRAINT SYS_C0012203;

2017-07-27 20:05:35  WARNING OGG-01154  SQL error 1403 mapping GMS.QRTZ_SCHEDULER_STATE to GMS.QRTZ_SCHEDULER_STATE OCI Error ORA-01403: no data found
, SQL <UPDATE "GMS"."QRTZ_SCHEDULER_STATE" x SET x."SCHED_NAME" = :a4,x."INSTANCE_NAME" = :a5,x."LAST_CHECKIN_TIME" = :a6,x."CHECKIN_INTERVAL" = :a7 W
HERE x."SCHED_NAME" = :b0 AND x."INSTANCE_NAME" = :b1 AND x."LAST_CHECKIN_TIME" = :b2 AND x."CHECKIN_INTERVAL" = :b3 AND ROWNUM = 1>.

-- edit params RCI_DSM1
(add with other INSERTMISSINGUPDATES)
MAP GMS.QRTZ_SCHEDULER_STATE, TARGET GMS.QRTZ_SCHEDULER_STATE;

2017-07-27 20:07:55  WARNING OGG-01154  SQL error 1403 mapping GMS.QRTZ_FIRED_TRIGGERS to GMS.QRTZ_FIRED_TRIGGERS OCI Error ORA-01403: no data found,
SQL <UPDATE "GMS"."QRTZ_FIRED_TRIGGERS" x SET x."INSTANCE_NAME" = :a12,x."FIRED_TIME" = :a13,x."SCHED_TIME" = :a14,x."STATE" = :a15,x."JOB_NAME" = :a1
6,x."JOB_GROUP" = :a17,x."IS_NONCONCURRENT" = :a18,x."REQUESTS_RECOVERY" = :a19 WHERE x."SCHED_NAME" = :b0 AND x."ENTRY_ID" = :b1>.

-- edit params RCI_DSM1
(add with other INSERTMISSINGUPDATES)
MAP GMS.QRTZ_FIRED_TRIGGERS, TARGET GMS.QRTZ_FIRED_TRIGGERS;

2017-07-27 20:09:47  WARNING OGG-01154  SQL error 1400 mapping GMS.QRTZ_FIRED_TRIGGERS to GMS.QRTZ_FIRED_TRIGGERS OCI Error ORA-01400: cannot insert N
ULL into ("GMS"."QRTZ_FIRED_TRIGGERS"."TRIGGER_NAME") (status = 1400), SQL <INSERT INTO "GMS"."QRTZ_FIRED_TRIGGERS" ("SCHED_NAME","ENTRY_ID","INSTANCE
_NAME","FIRED_TIME","SCHED_TIME","STATE","JOB_NAME","JOB_GROUP","IS_NONCONCURRENT","REQUESTS_RECOVERY") VALUES (:a10,:a11,:a12,:a13,:a14,:a15,:a16,:a1
7,:a18,:a19)>.

-- LXORAODSM01
OWNER                CONSTRAINT_NAME                COLUMN_NAME                    C STATUS
-------------------- ------------------------------ ------------------------------ - --------
GMS                  QRTZ_FIRED_TRIGGER_PK          ENTRY_ID                       P ENABLED
GMS                  QRTZ_FIRED_TRIGGER_PK          SCHED_NAME                     P ENABLED
GMS                  SYS_C0011419                   SCHED_NAME                     C ENABLED
GMS                  SYS_C0011420                   ENTRY_ID                       C ENABLED
GMS                  SYS_C0011421                   TRIGGER_NAME                   C ENABLED
GMS                  SYS_C0011422                   TRIGGER_GROUP                  C ENABLED
GMS                  SYS_C0011423                   INSTANCE_NAME                  C ENABLED
GMS                  SYS_C0011424                   FIRED_TIME                     C ENABLED
GMS                  SYS_C0011425                   SCHED_TIME                     C ENABLED
GMS                  SYS_C0011426                   PRIORITY                       C ENABLED
GMS                  SYS_C0011427                   STATE                          C ENABLED

ALTER TABLE GMS.QRTZ_FIRED_TRIGGERS DISABLE CONSTRAINT SYS_C0011421;
ALTER TABLE GMS.QRTZ_FIRED_TRIGGERS DISABLE CONSTRAINT SYS_C0011422;
ALTER TABLE GMS.QRTZ_FIRED_TRIGGERS DISABLE CONSTRAINT SYS_C0011426;

2017-07-27 20:15:40  WARNING OGG-01154  SQL error 1403 mapping BLC_EAPP_GTWY.QRTZ_FIRED_TRIGGERS to BLC_EAPP_GTWY.QRTZ_FIRED_TRIGGERS OCI Error ORA-01
403: no data found, SQL <DELETE FROM "BLC_EAPP_GTWY"."QRTZ_FIRED_TRIGGERS"  WHERE "ENTRY_ID" = :b0>.

-- edit params RCI_DSM1
(add with other INSERTMISSINGUPDATES)
MAP BLC_EAPP_GTWY.QRTZ_FIRED_TRIGGERS, TARGET GMS.QRTZ_FIRED_TRIGGERS;

2017-07-27 20:17:03  INFO    OGG-02756  The definition for table BLC_EAPP_GTWY.QRTZ_FIRED_TRIGGERS is obtained from the trail file.
2017-07-27 20:17:03  INFO    OGG-06511  Using following columns in default map by name: ENTRY_ID, TRIGGER_NAME, TRIGGER_GROUP, INSTANCE_NAME, FIRED_TI
ME, PRIORITY, STATE, JOB_NAME, JOB_GROUP, REQUESTS_RECOVERY.
2017-07-27 20:17:03  ERROR   OGG-00918  Key column SCHED_NAME is missing from map.

-- edit params RCI_DSM1 (wrong above)
(add with other INSERTMISSINGUPDATES)
MAP BLC_EAPP_GTWY.QRTZ_FIRED_TRIGGERS, TARGET BLC_EAPP_GTWY.QRTZ_FIRED_TRIGGERS;

2017-07-27 20:31:58  WARNING OGG-01154  SQL error 1403 mapping BLC_EAPP_GTWY.QRTZ_FIRED_TRIGGERS to BLC_EAPP_GTWY.QRTZ_FIRED_TRIGGERS OCI Error ORA-01
403: no data found, SQL <DELETE FROM "BLC_EAPP_GTWY"."QRTZ_FIRED_TRIGGERS"  WHERE "ENTRY_ID" = :b0>.

-- ./dirrpt/RCI_DSM1.dsc
ENTRY_ID = lxwas85m0215009643441011500964344038
TRIGGER_NAME = filenetHoldingInquiryTrigger
TRIGGER_GROUP = DEFAULT
IS_VOLATILE = 0
INSTANCE_NAME = lxwas85m021500964344101
FIRED_TIME = 1500991680000
PRIORITY = 5
STATE = ACQUIRED
JOB_NAME = NULL
JOB_GROUP = NULL
IS_STATEFUL = 0
REQUESTS_RECOVERY = 0

-- LXORAODSM01
insert into BLC_EAPP_GTWY.QRTZ_FIRED_TRIGGERS
(ENTRY_ID,TRIGGER_NAME ,TRIGGER_GROUP ,IS_VOLATILE ,INSTANCE_NAME ,FIRED_TIME ,PRIORITY ,STATE ,
JOB_NAME ,JOB_GROUP ,IS_STATEFUL ,REQUESTS_RECOVERY )
values
('lxwas85m0215009643441011500964344038','filenetHoldingInquiryTrigger','DEFAULT', 0,'lxwas85m021500964344101',
 1500991680000, 5,'ACQUIRED', NULL, NULL, 0, 0);

 2017-07-27 20:43:24  WARNING OGG-01154  SQL error 1403 mapping GTWY_APP_USER.QRTZ_FIRED_TRIGGERS to GTWY_APP_USER.QRTZ_FIRED_TRIGGERS OCI Error ORA-01
403: no data found, SQL <DELETE FROM "GTWY_APP_USER"."QRTZ_FIRED_TRIGGERS"  WHERE "ENTRY_ID" = :b0>.

-- edit params RCI_DSM1
(add with other INSERTMISSINGUPDATES)
MAP BLC_EAPP_GTWY.QRTZ_FIRED_TRIGGERS, TARGET BLC_EAPP_GTWY.QRTZ_FIRED_TRIGGERS, HANDLECOLLISIONS;

(same error)

-- edit params RCI_DSM1
REPERROR (1403, DISCARD)
(add with other INSERTMISSINGUPDATES)
MAP BLC_EAPP_GTWY.QRTZ_FIRED_TRIGGERS, TARGET BLC_EAPP_GTWY.QRTZ_FIRED_TRIGGERS;

2017-07-27 20:52:48  WARNING OGG-01154  SQL error 1 mapping BLC_EAPP_GTWY.WS_TRXN_LOG to BLC_EAPP_GTWY.WS_TRXN_LOG OCI Error ORA-00001: unique constra
int (BLC_EAPP_GTWY.PK_WS_TRXN_LOG) violated (status = 1), SQL <INSERT INTO "BLC_EAPP_GTWY"."WS_TRXN_LOG" ("WS_TRXN_LOG_ID","WS_TRXN_GRP","OPERATION_NM
","SRC_SYS_ID","USER_ID","WS_TRXN_TYP_ID","WS_TRXN_TIME","PAYLD","CRTD_BY","CRTD_DT","LAST_UPDT_BY","LAST_UPDT_DT") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a
6,:a7,:a8,:a9,:a10,:a11)>.

-- edit params RCI_DSM1
REPERROR (1, DISCARD)


###########
# cigfdsm #
# impdp   #
# 7/28    #
###########

ORA-31685: Object type INDEX:"CORE"."IDX_AGENCY" failed due to insufficient privileges. Failing sql is:
CREATE INDEX "CORE"."IDX_AGENCY" ON "DM_AGT_DIST"."RPT_LAPSE_NOTICE" ("AGENCY") PCTFREE 10 INITRANS 2 MAXTRANS 255 NOLOGGING  STORAGE(INITIAL 81920 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645 PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT) TABLESPACE "ONLINE_IDX_MEDIUM" PARALLEL 4

-- priv not granted in AIX
grant index ON "DM_AGT_DIST"."RPT_LAPSE_NOTICE" to core;
-- run above
revoke index ON "DM_AGT_DIST"."RPT_LAPSE_NOTICE" from core;

ORA-04052: error occurred when looking up remote object PRIVACYKEY.CORPORATE_OPT_OUT@ACXIOM_DBLINK
ORA-00604: error occurred at recursive SQL level 3
ORA-12170: TNS:Connect timeout occurred


ORA_DSGP_DBL needs to be fixed!
  CREATE DATABASE LINK "ORA_DSGM_DBL"
   CONNECT TO "SYSTEM" IDENTIFIED BY VALUES ':1'
   USING '(DESCRIPTION = (ADDRESS_LIST = (ADDRESS= (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = DSGM-pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA= (SID = dsgm)))';

CIGFDSP_PDBL needs to be fixed!
  CREATE PUBLIC DATABASE LINK "CIGFDSP_PDBL"
   USING 'CIGFDSP';

DBL_CIGFDSP_STG needs to be fixed!
  CREATE PUBLIC DATABASE LINK "DBL_CIGFDSP_STG"
   CONNECT TO "COGIVZ" IDENTIFIED BY VALUES ':1'
   USING 'CIGFDSP';

DSGD_DBL needs to be fixed!
  CREATE PUBLIC DATABASE LINK "DSGD_DBL"
   USING '(DESCRIPTION = (ADDRESS_LIST = (ADDRESS= (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = dsgd_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = dsgd)))';

DSGP_DBL needs to be fixed!
  CREATE PUBLIC DATABASE LINK "DSGP_DBL"
   USING '(DESCRIPTION = (ADDRESS_LIST = (ADDRESS= (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = dsgp_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = dsgp)))';

NAP_DBL needs to be fixed!
  CREATE PUBLIC DATABASE LINK "NAP_DBL"
   CONNECT TO "NAP_REPORTING" IDENTIFIED BY VALUES ':1'
   USING 'IDWM';

ACXIOM_DBLINK needs to be fixed!
  CREATE PUBLIC DATABASE LINK "ACXIOM_DBLINK"
   CONNECT TO "PRIV_KEY" IDENTIFIED BY VALUES ':1'
   USING '(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP) (HOST = ccd-prd.conseco.com)(PORT = 1521))) (CONNECT_DATA = (INSTANCE_NAME = prfstgp) (SERVICE_NAME = prfstgp.conway.acxiom.com)))';



############
# abcinfom #
# impdp    #
# 7/28     #
############

ABCINFOM_DBL needs to be fixed!
ABCINFOP_DBL needs to be fixed!
CDSINFOD_DBL needs to be fixed!
CDSINFOM_DBL needs to be fixed!
CDSINFOP_DBL needs to be fixed!
DSGD_DBL needs to be fixed!
DSGP_DBL needs to be fixed!


############
# obieem   #
# POBIEEM1 #
# 7/30     #
############

EXTRACT    POBIEEM1  Last Started 2017-07-28 11:34   Status ABENDED
Checkpoint Lag       00:00:00 (updated 11:45:51 ago)
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/obieem/ea000000009
                     2017-07-29 22:20:29.000000  RBA 13745397

2017-07-29 22:25:47  ERROR   OGG-01232  Receive TCP params error: TCP/IP error 73 (Connection reset by peer), endpoint: lxoggm01:7828.

start POBIEEM1

EXTRACT    POBIEEM1  Last Started 2017-07-30 10:07   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:00:01 ago)
Process ID           8782092
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/obieem/ea000000009
                     2017-07-30 10:07:57.000000  RBA 17126267

					 
############
# obieem   #
# ROBIEEM1 #
# 7/31     #
############

REPLICAT   ROBIEEM1  Last Started 2017-07-31 06:38   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:15 (updated 06:36:24 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/obieem/ra000000010
                     2017-07-31 03:38:57.058284  RBA 69804129

2017-07-31 06:38:03  WARNING OGG-01154  SQL error 1403 mapping OBAW.W_PURCH_RQSTN_LINE_F to OBAW.W_PURCH_RQSTN_LINE_F OCI Error ORA-01403: no data found, SQL <DEL
ETE FROM "OBAW"."W_PURCH_RQSTN_LINE_F"  WHERE "REQUESTOR_WID" = :b0 AND "SUPPLIER_WID" = :b1 AND "PRODUCT_WID" = :b2 AND "INVENTORY_PROD_WID" = :b3 AND "SUPPLIER_
PROD_WID" = :b4 AND "PLANT_LOC_WID" = :b5 AND "INVENTORY_ORG_WID" = :b6 AND "RCPT_LOC_WID" = :b7 AND "STORAGE_LOC_WID" = :b8 AND "RQSTN_ORG_WID" = :b9 AND "OPERAT
ING_UNIT_ORG_WID" = :b10 AND "APPROVAL_STATUS_WID" = :b11 AND "CYCLE_STATUS_WID" = :b12 AND "XACT_TYPE_WID" = :b13 AND "SUBMITTED_ON_DT_WID" = :b14 AND "SUBMITTED
_ON_TM_WID" = :b15 AND "RESUBMITTED_ON_DT_WID" = :b16 AND "RESUBMITTED_ON_TM_WID" = :b17 AND "APPROVED_ON_DT_WID" = :b18 AND "APPROVED_ON_TM_WID" = :b19 AND "ORDE
RED_ON_DT_WID" = :b20 AND "RECEIVED_ON_DT_WID" = :b21 AND "NEEDED_BY_DT_WID" = :b22 AND "NEEDED_BY_TM_WID" = :b23 AND "DUE_ON_DT_WID" = :b24 AND "CREATED_ON_TM_WI
D" = :b25 AND "REQUESTED_QTY" = :b26 AND "UNIT_STD_COST" is NULL AND "UNIT_PRICE" = :b28 AND "LINE_AMT" = :b29 AND "STD_COST_AMT" is NULL AND "UOM_CODE" = :b31 AN
D "PURCH_RQSTN_NUM" = :b32 AND "PURCH_RQSTN_ITEM" = :b33 AND "LINE_TEXT" = :b34 AND "DOC_CURR_CODE" = :b35 AND "LOC_CURR_CODE" = :b36 AND "LOC_EXCHANGE_RATE" = :b
37 AND "GLOBAL1_EXCHANGE_RATE" = :b38 AND "GLOBAL2_EXCHANGE_RATE" = :b39 AND "GLOBAL3_EXCHANGE_RATE" = :b40 AND "CREATED_BY_WID" = :b41 AND "CHANGED_BY_WID" = :b4
2 AND "CREATED_ON_DT" = :b43 AND "CHANGED_ON_DT" = :b44 AND "AUX1_CHANGED_ON_DT" = :b45 AND "AUX2_CHANGED_ON_DT" = :b46 AND "AUX3_CHANGED_ON_DT" is NULL AND "AUX4
_CHANGED_ON_DT" is NULL AND "DELETE_FLG" = :b49 AND "W_INSERT_DT" = :b50 AND "W_UPDATE_DT" = :b51 AND "DATASOURCE_NUM_ID" = :b52 AND "ETL_PROC_WID" = :b53 AND "IN
TEGRATION_ID" = :b54 AND "TENANT_ID" = :b55 AND "X_CUSTOM" = :b56 AND "LINE_TYPE_WID" = :b57 AND "SUPPLIER_ACCOUNT_WID" = :b58 AND "PRIMARY_UOM_CONV_RATE" = :b59
AND "PRIMARY_UOM_CODE" = :b60 AND "STANDARD_UOM_CONV_RATE" = :b61 AND "STANDARD_UOM_CODE" = :b62 AND "URGENT_FLAG" = :b63 AND "CANCELLED_LINE_QTY" is NULL AND "CA
NCELLED_LINE_AMT" is NULL AND "PO_REVISIONS" = :b66 AND "SUBMITTED_ON_DT" = :b67 AND "APPROVED_ON_DT" = :b68 AND "ORDERED_ON_DT" = :b69 AND "RECEIVED_ON_DT" = :b7
0 AND "NEEDED_BY_DT" = :b71 AND "PO_APPROVED_ON_DT" = :b72 AND "PO_APPROVED_ON_DT_WID" = :b73 AND "PO_SUBMIT_ON_DT" = :b74 AND "PO_SUBMIT_ON_DT_WID" = :b75 AND "F
ULFILLMENT_STATUS_WID" = :b76 AND "PO_CREATION_METHOD_WID" = :b77 AND "PO_APPROVED_ON_TM_WID" = :b78 AND "PO_SUBMIT_ON_TM_WID" = :b79 AND ROWNUM = 1>.

-- ROBIEEM1.dsc
REQUESTOR_WID = 10426
SUPPLIER_WID = 1079965
PRODUCT_WID = 10020
INVENTORY_PROD_WID = 0
SUPPLIER_PROD_WID = 0
PLANT_LOC_WID = 920292
INVENTORY_ORG_WID = 11004
RCPT_LOC_WID = 920018
STORAGE_LOC_WID = 0
RQSTN_ORG_WID = 11004
OPERATING_UNIT_ORG_WID = 11004
APPROVAL_STATUS_WID = 109037
CYCLE_STATUS_WID = 109065
XACT_TYPE_WID = 9066
SUBMITTED_ON_DT_WID = 20160422
SUBMITTED_ON_TM_WID = 90501
RESUBMITTED_ON_DT_WID = 0
RESUBMITTED_ON_TM_WID = 0
APPROVED_ON_DT_WID = 20160422
APPROVED_ON_TM_WID = 101013
ORDERED_ON_DT_WID = 20160422
RECEIVED_ON_DT_WID = 20161025
NEEDED_BY_DT_WID = 20160427
NEEDED_BY_TM_WID = 0
DUE_ON_DT_WID = 0
CREATED_ON_TM_WID = 85555
REQUESTED_QTY = 2
UNIT_STD_COST = NULL
UNIT_PRICE = 169
LINE_AMT = 338
STD_COST_AMT = NULL
UOM_CODE = EA
PURCH_RQSTN_NUM = 8869
PURCH_RQSTN_ITEM = 1
LINE_TEXT = Minix X7-208NAV02
DOC_CURR_CODE = USD
LOC_CURR_CODE = USD
LOC_EXCHANGE_RATE = 1
GLOBAL1_EXCHANGE_RATE = 1
GLOBAL2_EXCHANGE_RATE = 1
GLOBAL3_EXCHANGE_RATE = 1
CREATED_BY_WID = 235924
CHANGED_BY_WID = 235924
CREATED_ON_DT = 2016-04-22 08:55:55
CHANGED_ON_DT = 2016-04-26 08:57:06
AUX1_CHANGED_ON_DT = 2016-04-22 10:10:13
AUX2_CHANGED_ON_DT = 2016-10-25 14:54:02
AUX3_CHANGED_ON_DT = NULL
AUX4_CHANGED_ON_DT = NULL
DELETE_FLG = N
W_INSERT_DT = 2017-07-31 03:29:50
W_UPDATE_DT = 2017-07-31 03:29:50
DATASOURCE_NUM_ID = 1000
ETL_PROC_WID = 25024760
INTEGRATION_ID = 147984
TENANT_ID = DEFAULT
X_CUSTOM = 0
LINE_TYPE_WID = 9005
SUPPLIER_ACCOUNT_WID = 397845
PRIMARY_UOM_CONV_RATE = 1
PRIMARY_UOM_CODE = EA
STANDARD_UOM_CONV_RATE = 1
STANDARD_UOM_CODE = EA
URGENT_FLAG = N
CANCELLED_LINE_QTY = NULL
CANCELLED_LINE_AMT = NULL
PO_REVISIONS = 0
SUBMITTED_ON_DT = 2016-04-22 09:05:01
APPROVED_ON_DT = 2016-04-22 10:10:13
ORDERED_ON_DT = 2016-04-22 10:19:44
RECEIVED_ON_DT = 2016-10-25 14:54:02
NEEDED_BY_DT = 2016-04-27 00:00:00
PO_APPROVED_ON_DT = 2016-04-25 11:15:02
PO_APPROVED_ON_DT_WID = 20160425
PO_SUBMIT_ON_DT = 2016-04-25 11:07:47
PO_SUBMIT_ON_DT_WID = 20160425
FULFILLMENT_STATUS_WID = 109008
PO_CREATION_METHOD_WID = 9034
PO_APPROVED_ON_TM_WID = 111502
PO_SUBMIT_ON_TM_WID = 110747

-- LXORAFINDM04
select count(*) from OBAW.W_PURCH_RQSTN_LINE_F where
REQUESTOR_WID = 10426 and
SUPPLIER_WID = 1079965 and
PRODUCT_WID = 10020 and
INVENTORY_PROD_WID = 0 and
SUPPLIER_PROD_WID = 0 and
PLANT_LOC_WID = 920292 and
INVENTORY_ORG_WID = 11004 and
RCPT_LOC_WID = 920018 and
STORAGE_LOC_WID = 0 and
RQSTN_ORG_WID = 11004 and
OPERATING_UNIT_ORG_WID = 11004 and
APPROVAL_STATUS_WID = 109037 and
CYCLE_STATUS_WID = 109065 and
XACT_TYPE_WID = 9066 and
SUBMITTED_ON_DT_WID = 20160422 and
SUBMITTED_ON_TM_WID = 90501 and
RESUBMITTED_ON_DT_WID = 0 and
RESUBMITTED_ON_TM_WID = 0 and
APPROVED_ON_DT_WID = 20160422 and
APPROVED_ON_TM_WID = 101013 and
ORDERED_ON_DT_WID = 20160422 and
RECEIVED_ON_DT_WID = 20161025 and
NEEDED_BY_DT_WID = 20160427 and
NEEDED_BY_TM_WID = 0 and
DUE_ON_DT_WID = 0 and
CREATED_ON_TM_WID = 85555 and
REQUESTED_QTY = 2 and
UNIT_STD_COST is NULL and
UNIT_PRICE = 169 and
LINE_AMT = 338 and
STD_COST_AMT is NULL and
UOM_CODE = 'EA' and
PURCH_RQSTN_NUM = 8869 and
PURCH_RQSTN_ITEM = 1 and
LINE_TEXT = 'Minix X7-208NAV02' and
DOC_CURR_CODE = 'USD' and
LOC_CURR_CODE = 'USD' and
LOC_EXCHANGE_RATE = 1 and
GLOBAL1_EXCHANGE_RATE = 1 and
GLOBAL2_EXCHANGE_RATE = 1 and
GLOBAL3_EXCHANGE_RATE = 1 and
CREATED_BY_WID = 235924 and
CHANGED_BY_WID = 235924 and
CREATED_ON_DT = to_date('2016-04-22 08:55:55','YYYY-MM-DD HH24:MI:SS') and
CHANGED_ON_DT = to_date('2016-04-26 08:57:06','YYYY-MM-DD HH24:MI:SS') and
AUX1_CHANGED_ON_DT = to_date('2016-04-22 10:10:13','YYYY-MM-DD HH24:MI:SS') and
AUX2_CHANGED_ON_DT = to_date('2016-10-25 14:54:02','YYYY-MM-DD HH24:MI:SS') and
AUX3_CHANGED_ON_DT is NULL and
AUX4_CHANGED_ON_DT is NULL and
DELETE_FLG = 'N' and
W_INSERT_DT = to_date('2017-07-31 03:29:50','YYYY-MM-DD HH24:MI:SS') and
W_UPDATE_DT = to_date('2017-07-31 03:29:50','YYYY-MM-DD HH24:MI:SS') and
DATASOURCE_NUM_ID = 1000 and
ETL_PROC_WID = 25024760 and
INTEGRATION_ID = 147984 and
TENANT_ID = 'DEFAULT' and
X_CUSTOM = 0 and
LINE_TYPE_WID = 9005 and
SUPPLIER_ACCOUNT_WID = 397845 and
PRIMARY_UOM_CONV_RATE = 1 and
PRIMARY_UOM_CODE = 'EA' and
STANDARD_UOM_CONV_RATE = 1 and
STANDARD_UOM_CODE = 'EA' and
URGENT_FLAG = 'N' and
CANCELLED_LINE_QTY is NULL and
CANCELLED_LINE_AMT is NULL and
PO_REVISIONS = 0 and
SUBMITTED_ON_DT = to_date('2016-04-22 09:05:01','YYYY-MM-DD HH24:MI:SS') and
APPROVED_ON_DT = to_date('2016-04-22 10:10:13','YYYY-MM-DD HH24:MI:SS') and
ORDERED_ON_DT = to_date('2016-04-22 10:19:44','YYYY-MM-DD HH24:MI:SS') and
RECEIVED_ON_DT = to_date('2016-10-25 14:54:02','YYYY-MM-DD HH24:MI:SS') and
NEEDED_BY_DT = to_date('2016-04-27 00:00:00','YYYY-MM-DD HH24:MI:SS') and
PO_APPROVED_ON_DT = to_date('2016-04-25 11:15:02','YYYY-MM-DD HH24:MI:SS') and
PO_APPROVED_ON_DT_WID = 20160425 and
PO_SUBMIT_ON_DT = to_date('2016-04-25 11:07:47','YYYY-MM-DD HH24:MI:SS') and
PO_SUBMIT_ON_DT_WID = 20160425 and
FULFILLMENT_STATUS_WID = 109008 and
PO_CREATION_METHOD_WID = 9034 and
PO_APPROVED_ON_TM_WID = 111502 and
PO_SUBMIT_ON_TM_WID = 110747;
0

insert into OBAW.W_PURCH_RQSTN_LINE_F
(REQUESTOR_WID ,SUPPLIER_WID ,PRODUCT_WID ,INVENTORY_PROD_WID , SUPPLIER_PROD_WID , PLANT_LOC_WID , INVENTORY_ORG_WID , RCPT_LOC_WID , 
STORAGE_LOC_WID , RQSTN_ORG_WID , OPERATING_UNIT_ORG_WID , APPROVAL_STATUS_WID , CYCLE_STATUS_WID , XACT_TYPE_WID , SUBMITTED_ON_DT_WID , 
SUBMITTED_ON_TM_WID , RESUBMITTED_ON_DT_WID , RESUBMITTED_ON_TM_WID , APPROVED_ON_DT_WID , APPROVED_ON_TM_WID , ORDERED_ON_DT_WID , 
RECEIVED_ON_DT_WID , NEEDED_BY_DT_WID , NEEDED_BY_TM_WID , DUE_ON_DT_WID , CREATED_ON_TM_WID , REQUESTED_QTY , UNIT_STD_COST , UNIT_PRICE , 
LINE_AMT , STD_COST_AMT , UOM_CODE , PURCH_RQSTN_NUM , PURCH_RQSTN_ITEM , LINE_TEXT , DOC_CURR_CODE , LOC_CURR_CODE , LOC_EXCHANGE_RATE , 
GLOBAL1_EXCHANGE_RATE , GLOBAL2_EXCHANGE_RATE , GLOBAL3_EXCHANGE_RATE , CREATED_BY_WID , CHANGED_BY_WID , CREATED_ON_DT , CHANGED_ON_DT , 
AUX1_CHANGED_ON_DT , AUX2_CHANGED_ON_DT , AUX3_CHANGED_ON_DT , AUX4_CHANGED_ON_DT , DELETE_FLG , W_INSERT_DT , W_UPDATE_DT , DATASOURCE_NUM_ID , 
ETL_PROC_WID , INTEGRATION_ID , TENANT_ID , X_CUSTOM , LINE_TYPE_WID , SUPPLIER_ACCOUNT_WID , PRIMARY_UOM_CONV_RATE , PRIMARY_UOM_CODE , 
STANDARD_UOM_CONV_RATE , STANDARD_UOM_CODE , URGENT_FLAG , CANCELLED_LINE_QTY , CANCELLED_LINE_AMT , PO_REVISIONS , SUBMITTED_ON_DT , 
APPROVED_ON_DT , ORDERED_ON_DT , RECEIVED_ON_DT , NEEDED_BY_DT , PO_APPROVED_ON_DT , PO_APPROVED_ON_DT_WID , PO_SUBMIT_ON_DT , 
PO_SUBMIT_ON_DT_WID , FULFILLMENT_STATUS_WID , PO_CREATION_METHOD_WID , PO_APPROVED_ON_TM_WID , PO_SUBMIT_ON_TM_WID) 
values
( 10426 , 1079965 , 10020 ,0 ,0 ,920292 ,11004 ,920018 ,0 ,11004 ,11004 ,109037 ,109065 ,9066 ,20160422 ,90501 ,0 ,0 ,20160422 ,101013 ,20160422 ,
20161025 ,20160427 ,0 ,0 ,85555 ,2 ,NULL ,169 ,338 ,NULL ,'EA' ,8869 ,1 ,'Minix X7-208NAV02' ,'USD' ,'USD' ,1 ,1 ,1 ,1 ,235924 ,235924 ,
to_date('2016-04-22 08:55:55','YYYY-MM-DD HH24:MI:SS') ,to_date('2016-04-26 08:57:06','YYYY-MM-DD HH24:MI:SS') ,
to_date('2016-04-22 10:10:13','YYYY-MM-DD HH24:MI:SS') ,to_date('2016-10-25 14:54:02','YYYY-MM-DD HH24:MI:SS') ,
NULL ,NULL ,'N' ,to_date('2017-07-31 03:29:50','YYYY-MM-DD HH24:MI:SS') ,to_date('2017-07-31 03:29:50','YYYY-MM-DD HH24:MI:SS') ,
1000 ,25024760 ,147984 ,'DEFAULT' ,0 ,9005 ,397845 ,1 ,'EA' ,1 ,'EA' ,'N' ,NULL ,NULL ,0 ,
to_date('2016-04-22 09:05:01','YYYY-MM-DD HH24:MI:SS') ,to_date('2016-04-22 10:10:13','YYYY-MM-DD HH24:MI:SS') ,
to_date('2016-04-22 10:19:44','YYYY-MM-DD HH24:MI:SS') ,to_date('2016-10-25 14:54:02','YYYY-MM-DD HH24:MI:SS') ,
to_date('2016-04-27 00:00:00','YYYY-MM-DD HH24:MI:SS') ,to_date('2016-04-25 11:15:02','YYYY-MM-DD HH24:MI:SS') ,
20160425 ,to_date('2016-04-25 11:07:47','YYYY-MM-DD HH24:MI:SS') ,20160425 ,109008 ,9034 ,111502 ,110747);

-- ggsci
start ROBIEEM1
(same error)

-- edit params ROBIEEM1
REPERROR (1403, DISCARD)
(add before other table mappings)
INSERTMISSINGUPDATES 
MAP OBAW.W_PURCH_RQSTN_LINE_F, TARGET OBAW.W_PURCH_RQSTN_LINE_F;
NOINSERTMISSINGUPDATES 

REPLICAT   ROBIEEM1  Last Started 2017-07-31 10:42   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           10012
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/obieem/ra000000010
                     2017-07-31 10:43:08.975772  RBA 75494380

					 
############
# dsrm     #
# EDSRM1   #
# uxoram01 #
# 8/1      #
############

-- log files not being deleted
RMAN-08137: WARNING: archived log not deleted, needed for standby or upstream capture process

-- uxoram01
SELECT CAPTURE_NAME, CAPTURE_TYPE, STATUS, to_char(REQUIRED_CHECKPOINT_SCN,'999999999999999')as REQ_SCN ,to_char(OLDEST_SCN,'999999999999999')as OLDEST_SCN FROM DBA_CAPTURE;
CAPTURE_NAME                   CAPTURE_TY STATUS   REQ_SCN          OLDEST_SCN
------------------------------ ---------- -------- ---------------- ----------------
OGG$CAP_EDSRM1                 LOCAL      DISABLED   10947464504813   10947464504813

col MIN_REQUIRED_CAPTURE_CHANGE# format 99999999999990
select MIN_REQUIRED_CAPTURE_CHANGE# from V$DATABASE;
MIN_REQUIRED_CAPTURE_CHANGE#
----------------------------
              10947464499835

-- ggsci
DBLOGIN USERID GGS@DSRM
add extract EDSRM1, integrated tranlog, begin now
add exttrail /nomove/app/oracle/ggate/12c/1/dirdat/dsrm/ea, extract EDSRM1, megabytes 1000
register extract EDSRM1 database
OGG-08241  ERROR: This EXTRACT EDSRM1 is already registered with the database.
unregister extract EDSRM1 database
OGG-01750  Successfully unregistered EXTRACT EDSRM1 from database.

-- rman
rman target / catalog rman@rman11m
DELETE ARCHIVELOG ALL BACKED UP 1 TIMES TO DEVICE TYPE DISK;


############
# dsrm     #
# uxoram01 #
# 8/4      #
############

-- during script
Starting "SYS"."SYS_EXPORT_SCHEMA_03":  "/******** AS SYSDBA" flashback_scn=10947706502910 parfile=/oragg/datapump/dsrm/expdp_dsrm.par 
ORA-31693: Table data object "CURE_CORE"."POC_OBJ_ATTR_VAL":"SYS_P4305"."SYS_SUBP9282" failed to load/unload and is being skipped                                 due to error:
ORA-02354: error in exporting/importing data
ORA-01466: unable to read data - table definition has changed
(for lots & lots of tables)

-- get SCN
set numf 99999999999990
select CURRENT_SCN from v$database;
10947732591063

-- kill and re-run export
expdp \"/ as sysdba\" flashback_scn=10947732591063 parfile=/oragg/datapump/dsrm/expdp_dsrm.par

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm.log | grep ORA-31693 > /oragg/datapump/dsrm/ora31693_dsrm_aug06.txt
cp /oragg/datapump/dsrm/ora31693_dsrm_aug06.txt /oragg/datapump/dsrm/expdp_dsrm_tables.par
cd /oragg/datapump/dsrm

-- export metadata
expdp \"/ as sysdba\" parfile=/oragg/datapump/dsrm/expdp_metadata_dsrm.par


##########
# dsrm   #
# EDSRM1 #
# 8/6    #
##########

2017-08-06 16:03:40  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File NA, THREAD 1, SEQUENCE 996724, SCN 0x000009f4f6411744. Read Position SCN: 2548.4131595494 (10947708265702)).

mkdir /oragg/arch/dsrm

rman target / catalog rman@rman11m
run
{
 set archivelog destination to '/oragg/arch/dsrm';
 restore archivelog from sequence 996724;
}

RMAN-06025: no backup of archived log for thread 1 with sequence 999845 and starting SCN of 10947736745080 found to restore
RMAN-06025: no backup of archived log for thread 1 with sequence 999844 and starting SCN of 10947736743691 found to restore

list BACKUP OF ARCHIVELOG SEQUENCE BETWEEN 999844 and 999845;
specification does not match any backup in the repository


###########
# fdlzm   #
# PFDLZM1 #
# 8/6     #
###########

EXTRACT    PFDLZM1   Last Started 2017-08-06 13:32   Status ABENDED
Checkpoint Lag       00:00:00 (updated 46:58:34 ago)
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/fdlzm/ea000000000
                     2017-08-04 17:42:34.000000  RBA 801754770

2017-08-06 13:32:05  ERROR   OGG-01224  TCP/IP error 79 (Connection refused), endpoint: lxoggm01:7919.

start PFDLZM1

-- /nomove/app/oracle/ggate/12c/1/dirdat/fdlzm
-rw-r-----    1 oracle   dba       999999765 Aug  5 02:27 ea000000000
-rw-r-----    1 oracle   dba       999999835 Aug  5 02:34 ea000000001
-rw-r-----    1 oracle   dba       999999305 Aug  5 02:53 ea000000002
-rw-r-----    1 oracle   dba       999999163 Aug  5 02:58 ea000000003
-rw-r-----    1 oracle   dba       999999667 Aug  5 03:05 ea000000004
-rw-r-----    1 oracle   dba       999999416 Aug  5 03:15 ea000000005
-rw-r-----    1 oracle   dba       999999357 Aug  5 03:26 ea000000006
-rw-r-----    1 oracle   dba       999999212 Aug  5 03:34 ea000000007
-rw-r-----    1 oracle   dba       999999036 Aug  5 03:42 ea000000008
-rw-r-----    1 oracle   dba       999999764 Aug  5 03:49 ea000000009
-rw-r-----    1 oracle   dba       999999696 Aug  5 03:53 ea000000010
-rw-r-----    1 oracle   dba       110803654 Aug  6 13:02 ea000000011
-rw-r-----    1 oracle   dba          721013 Aug  6 16:43 ea000000012

-- 5 min later (same RBA)
EXTRACT    PFDLZM1   Last Started 2017-08-06 16:42   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:08:26 ago)
Process ID           39190742
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/fdlzm/ea000000000
                     2017-08-04 17:42:34.000000  RBA 801754770


stop PFDLZM1
start PFDLZM1

2017-08-06 16:56:51  ERROR   OGG-01232  Receive TCP params error: TCP/IP error 73 (Connection reset by peer), endpoint: lxoggm01:7829.

2017-08-06 17:19:22  ERROR   OGG-01232  Receive TCP params error: TCP/IP error 73 (Connection reset by peer), endpoint: lxoggm01:7829.

2017-08-06 18:37:50  ERROR   OGG-01232  Receive TCP params error: TCP/IP error 73 (Connection reset by peer), endpoint: lxoggm01:7830.

EXTRACT    PFDLZM1   Last Started 2017-08-06 19:53   Status RUNNING
Checkpoint Lag       49:11:44 (updated 00:10:37 ago)
Process ID           8651206
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/fdlzm/ea000000002
                     2017-08-04 21:12:35.000000  RBA 289425039


############
# dsrm     #
# uxoram01 #
# 8/7      #
############

-- during script
Export: Release 11.2.0.4.0 - Production on Sun Aug 6 18:43:38 2017
(stopped 8/7 around 10:00 - 16+ hours)

-- /oragg/datapump/dsrm/expdp_dsrm.par
PARALLEL=4

-- sqlplus
set lines 150 pages 200
select owner, count(*) from dba_objects 
where object_type='TABLE' and LAST_DDL_TIME>(sysdate-1) and owner not in ('SYS','SYSTEM','DBSNMP')
group by owner order by 1;
OWNER                            COUNT(*)
------------------------------ ----------
CURE_CORE                              12
CURE_QUEUE                             77

select owner, count(*) from dba_tables where owner in ('CURE_CORE','CURE_QUEUE') group by owner order by 1;
OWNER                            COUNT(*)
------------------------------ ----------
CURE_CORE                             110
CURE_QUEUE                            275

cp /oragg/datapump/dsrm/expdp_dsrm.par /oragg/datapump/dsrm/expdp_schemas_dsrm.par
-- /oragg/datapump/dsrm/expdp_schemas_dsrm.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=dsrm_schemas_%U.dmp
LOGFILE=dsrm_schemas.log
PARALLEL=4
METRICS=Y
EXCLUDE=STATISTICS
SCHEMAS=CURE_CORE,CURE_QUEUE

-- get SCN
set numf 99999999999990
select CURRENT_SCN from v$database;
10947774441565

-- kill and export schemas
expdp \"/ as sysdba\" flashback_scn=10947774441565 parfile=/oragg/datapump/dsrm/expdp_schemas_dsrm.par


expdp \"/ as sysdba\" flashback_scn=10947774441565 parfile=/oragg/datapump/dsrm/expdp_dsrm.par

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm.log | grep ORA-31693 > /oragg/datapump/dsrm/ora31693_dsrm_aug06.txt
cp /oragg/datapump/dsrm/ora31693_dsrm_aug06.txt /oragg/datapump/dsrm/expdp_dsrm_tables.par
cd /oragg/datapump/dsrm

-- export metadata
expdp \"/ as sysdba\" parfile=/oragg/datapump/dsrm/expdp_metadata_dsrm.par

-- archive logs filling up
-rw-r-----    1 oracle   dba        49911296 Aug  8 07:52 1_1005811_849781502.dbf
...
-rw-r-----    1 oracle   dba        49484800 Aug  8 08:09 1_1005985_849781502.dbf
(174 logs around 49 MB each - 8.6 GB - in 17 minutes)


############
# trecscm  #
# RTR_SCM1 #
# 8/8      #
############

REPLICAT   RTR_SCM1  Last Started 2017-08-08 11:44   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 03:53:06 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/trecscm/ra000000000
                     First Record  RBA 0

2017-08-08 11:44:44  WARNING OGG-01154  SQL error 1403 mapping TRECS.QRTZ_CALENDARS to TRECS.QRTZ_CALENDARS OCI Error ORA-01403: no data found (status = 1403), SQ
L <SELECT x."CALENDAR" FROM "TRECS"."QRTZ_CALENDARS" x WHERE x."CALENDAR_NAME" = :b0 FOR UPDATE >.

-- ./dirrpt/RTR_SCM1.dsc
OCI Error ORA-01403: no data found (status = 1403), SQL <SELECT x."CALENDAR" FROM "TRECS"."QRTZ_CALENDARS" x WHERE x."CALENDAR_NAME" = :b0 FOR UPDATE >
CALENDAR_NAME = -|-SYSTEM_CALENDAR;:;America/New_York
CALENDAR = (LOB)

-- uxoram01/
select count(*) from TRECS.QRTZ_CALENDARS;
AIX		6
Linux	0
(failed to export)

 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 CALENDAR_NAME                             NOT NULL VARCHAR2(200)
 CALENDAR                                  NOT NULL BLOB

-- edit params RTR_SCM1
MAPEXCLUDE TRECS.QRTZ_CALENDARS;

REPLICAT   RTR_SCM1  Last Started 2017-08-08 15:52   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           23698
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/trecscm/ra000000000
                     2017-08-08 15:52:38.861486  RBA 30320010

					 
###################################
# Capture processes still running #
# 8/10                            #
###################################

SELECT CAPTURE_NAME FROM DBA_CAPTURE;

-- ggsci
DBLOGIN USERID GGS@${dbname} PASSWORD $vGGSPwd 
add extract ${gg_extract}, integrated tranlog, begin now
unregister extract ${gg_extract} database
delete extract ${gg_extract}
info all

###############
# LXORAODST01 #
# memory      #
# 8/10        #
###############

-- listener down
-- lots in listener log
10-AUG-2017 14:39:07 * <unknown connect data> * 12537
TNS-12537: TNS:connection closed
 TNS-12560: TNS:protocol adapter error
  TNS-00507: Connection closed
   Linux Error: 115: Operation now in progress

-- alert log
Fatal NI connect error 12170.

  VERSION INFORMATION:
	TNS for Linux: Version 11.2.0.4.0 - Production
	Oracle Bequeath NT Protocol Adapter for Linux: Version 11.2.0.4.0 - Production
	TCP/IP NT Protocol Adapter for Linux: Version 11.2.0.4.0 - Production
  Time: 08-AUG-2017 16:09:57
  Tracing not turned on.
  Tns error struct:
    ns main err code: 12535
    
TNS-12535: TNS:operation timed out
    ns secondary err code: 12560
    nt main err code: 505
    
TNS-00505: Operation timed out
    nt secondary err code: 110
    nt OS err code: 0
  Client address: (ADDRESS=(PROTOCOL=tcp)(HOST=192.168.85.51)(PORT=62162))
Tue Aug 08 16:09:57 2017
...
Wed Aug 09 03:31:20 2017
ORA-04031: unable to allocate 65560 bytes of shared memory ("large pool","unknown object","large pool","PX msg pool")
...
Tue Aug 08 06:28:58 2017
ALTER SYSTEM SET sga_max_size='1200M' SCOPE=SPFILE;
...
Thu Aug 10 11:56:57 2017
SMCO started with pid=29, OS id=51757 
GoldenGate CAPTURE CP01 for OGG$CAP_ECI_DST2 with pid=27, OS id=51753 is in combined capture and apply mode.

-- SDT 187444 / CO 55507 / VM reboot (8/6)
db      old     new SGA
------- ----    -------
blcfdsi	5530	2760
blcfdst	3506	1000
cigfdst	3395	904
cnofart	3649	1125
dsrt	6005	1125
portali	3335	852
wstodst	3362	875

-- adrci
(only cigfdst show ORA-04031 error)

-- cigfdst
select name, DISPLAY_VALUE from v$parameter where type=6 order by 1;
NAME                                               DISPLAY_VALUE
-------------------------------------------------- ---------------
pga_aggregate_target                               920M
result_cache_max_size                              6240K
sga_max_size                                       1200M
sga_target                                         1200M
shared_pool_reserved_size                          31M
shared_pool_size                                   608M
streams_pool_size                                  512M

select name, DISPLAY_VALUE, UPDATE_COMMENT from v$spparameter 
where name in ('pga_aggregate_target','result_cache_max_size','sga_max_size','sga_target','shared_pool_reserved_size','shared_pool_size','streams_pool_size')
order by 1;
NAME                                               DISPLAY_VALUE
-------------------------------------------------- ---------------
pga_aggregate_target                               920M
result_cache_max_size
sga_max_size                                       1200M
sga_target                                         1200M
shared_pool_reserved_size
shared_pool_size                                   600M
streams_pool_size                                  512M

SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- ---------------
SGA    DEFAULT buffer cache            16       16       16 STATIC
       java pool                       16       16       16 STATIC
       large pool                      32       32       32 STATIC
       shared pool                    608      608      608 STATIC
       streams pool                   512      512      512 STATIC
******                           -------- -------- --------
TOTAL                               1,184    1,184    1,184

SELECT CAPTURE_NAME, STATUS FROM DBA_CAPTURE;
CAPTURE_NAME                   STATUS
------------------------------ --------
OGG$CAP_ECI_DST2               ENABLED

select APPLY_NAME, STATUS from DBA_APPLY;
APPLY_NAME                     STATUS
------------------------------ --------
OGG$ECI_DST2                   ENABLED
OGG$RCI_DST1                   DISABLED

select value from v$parameter where name='streams_pool_size';
536870912

set lines 150 pages 200
col value format a20
select da.APPLY_NAME, dc.CAPTURE_NAME, vp.value from v$parameter vp, DBA_CAPTURE dc, DBA_APPLY da where vp.name='streams_pool_size';

-- dsgd (lxorainfd01)
cd /app/oracle/product/ggate/12c/1
./ggsci
DBLOGIN USERID GGS@cdsgd
add extract EDSGD1, integrated tranlog, begin now
info EDSGD1
unregister extract EDSGD1 database
delete extract EDSGD1

(no rows selected)


##########
# dsrm   #
# EDSRM1 #
# expdp  #
# 8/9    #
##########

-- info
EXTRACT    EDSRM1    Last Started 2017-08-08 17:45   Status RUNNING
Checkpoint Lag       15:25:41 (updated 00:00:02 ago)
Process ID           22544478
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-08 23:17:32
                     SCN 2548.4271457291 (10947848127499)

-- report
2017-08-08 23:05:09  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/dsrm/ea000000004.
            19045388 records processed as of 2017-08-08 23:09:46 (rate 986,delta 3276)
            19960178 records processed as of 2017-08-08 23:14:46 (rate 1018,delta 3049)
            21050769 records processed as of 2017-08-08 23:19:46 (rate 1057,delta 3634)

2017-08-09 05:15:03  INFO    OGG-06509  Using the following key columns for source table CURE_QUEUE.CCF_C3_POC: CCF_ID.
            61499931 records processed as of 2017-08-09 05:19:52 (rate 1481,delta 2404)

-- expdp_schema_dsrm.par
PARALLEL=4

-- get SCN
set numf 99999999999990
select CURRENT_SCN from v$database;
10947868829043

-- kill and export schemas
expdp \"/ as sysdba\" flashback_scn=10947868829043 parfile=/oragg/datapump/dsrm/expdp_schema_dsrm.par
Job "SYS"."SYS_EXPORT_SCHEMA_03" completed with 509 error(s) at Thu Aug 10 14:28:59 2017 elapsed 0 23:33:57

-- export remaining schemas
expdp \"/ as sysdba\" flashback_scn=10947868829043 parfile=/oragg/datapump/dsrm/expdp_dsrm.par
Job "SYS"."SYS_EXPORT_SCHEMA_03" completed with 23 error(s) at Thu Aug 10 16:50:19 2017 elapsed 0 01:49:54

-- export metadata
expdp \"/ as sysdba\" parfile=/oragg/datapump/dsrm/expdp_metadata_dsrm.par



###########
# cnofdwm #
# 8/10    #
###########

UAT4M_DBL needs to be fixed!
UAT1M_DBL needs to be fixed!
SIT1T_DBL needs to be fixed!	OK
FDLZX_DBL needs to be fixed!	OK
DSGP_DBL needs to be fixed!		OK
DSGD_DBL needs to be fixed!		OK
CNOFDWX_DBL needs to be fixed!	OK
CNOFDWT_DBL needs to be fixed!	OK
CNOFDWD_DBL needs to be fixed!	OK


OBJECT_TYPE         OBJECT_NAME                              AIX     LINUX
------------------- ---------------------------------------- ------- -------
PROCEDURE           DATA_MART_PT.SYNC_TEXT_INDEX             VALID   INVALID
TRIGGER             CFGMGR_WEB.ALTERSESS_TRIG                VALID   INVALID


################
# listener log #
################

-- /app/oracle/scripts/cron
script_setup.sh
listner_log_rotate.sh

-- lxora12cinfs02
cd /app/oracle/product/diag/tnslsnr/LXORA12CINFS02/listener/trace
-rw-r-----. 1 oracle dba 7002838 Aug 11 15:52 listener.log

./listner_log_rotate.sh
-rw-r-----. 1 oracle dba 973 Aug 11 16:01 listener.log


#########
# hubm  #
# impdp #
# 8/14  #
#########

TABLE                                             AIX        LINUX          DIFFERENCE
---------------------------------------- ------------ ------------ -------------------
MQADM.FULL_MESSAGE_LOG                      3,388,494    3,389,722                1228
MQADM.HTTP_HEADER_LOG                      26,078,173   26,079,862                1689
MQADM.HUB_FULL_MESSAGE_LOG                    716,502      716,846                 344
MQADM.HUB_TRANSACTION_LOG                     306,366      306,429                  63
MQADM.STATUS_LOG                            6,525,341    6,525,702                 361
MQADM.TRANSACTION_LOG                         847,234      847,680                 446
MQADM.WS_SERVICES_MESSAGE_LOG                  55,580       55,582                   2


#########
# fnp8m #
# impdp #
#########

2017-08-15 12:46:55.372000 -04:00
ORA-1652: unable to extend temp segment by 128 in tablespace                 TEMP

  ID FILE_NAME                                                    TS                           MB      MAXMB AUT
---- ------------------------------------------------------------ -------------------- ---------- ---------- ---
   2 /database/fnp8m01/oradata/ecmclientdstemp01.dbf              ECMCLIENTDSTEMP             200        200 NO
   3 /database/fnp8m01/oradata/petemp_ts.dbf                      PETEMP_TS                   400        400 NO
   1 /database/fnp8m01/oradata/temp01.dbf                         TEMP                        500        500 NO
                                                                                       ---------- ----------
TOTA                                                                                        1,100      1,100

ALTER DATABASE TEMPFILE 1 RESIZE 5000M;

2017-08-15 17:54:59.737000 -04:00
ALTER DATABASE TEMPFILE 1 RESIZE 5000M
Completed: ALTER DATABASE TEMPFILE 1 RESIZE 5000M
statement in resumable session 'SYSTEM.SYS_IMPORT_FULL_01.1' was resumed


############
# bpat     #
# DB2 link #
# 8/21     #
############

-- from app team
ORA-04052: error occurred when looking up remote object A3CNOSD.W08U999S@AWD10SIT_DBL
ORA-00604: error occurred at recursive SQL level 1
ORA-28545: error diagnosed by Net8 when connecting to an agent
Unable to retrieve text of NETWORK/NCR message 65535
ORA-02063: preceding 2 lines from AWD10SIT_DBL.

-- my test
select sysdate from dual@AWD10SIT_DBL
                         *
ERROR at line 1:
ORA-28500: connection from ORACLE to a non-Oracle system returned this message:
[unixODBC][IBM][CLI Driver] SQL30081N  A communication error has been detected. Communication protocol being used: "TCP/IP".  Communication API being
used: "SOCKETS".  Location where the error was detected: "170.40.82.26".  Communication function detecting the error: "connect".  Protocol specific
error code(s): "110", "*", "*".  SQLSTATE=08001
{08001,NativeErr = -30081}
ORA-02063: preceding 3 lines from AWD10SIT_DBL

-- dba_db_links
PUBLIC
AWD10SIT_DBL
A3CNOSDTAE
(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=bpad_pkg.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=awd10sit)) (HS=OK))
04/28/2017

-- lsnrctl status
service not shown


###########
# prodm   #
# RPRODM1 #
# 8/22    #
###########

REPLICAT   RPRODM1   Last Started 2017-08-22 08:55   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 07:02:39 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prodm/ra000000000
                     First Record  RBA 0

2017-08-22 08:56:17  WARNING OGG-01154  SQL error 1 mapping SP_RATINGX.CIQRATINGOBJECTDETAIL to PRODM.SP_RATINGX.CIQRATINGOBJECTDETAIL OCI Error ORA-00001: unique
 constraint (SP_RATINGX.PK_CIQRATINGOBJECTDETAIL) violated (status = 1), SQL <INSERT INTO "SP_RATINGX"."CIQRATINGOBJECTDETAIL" ("RATINGOBJECTKEY","OBJECTSYMBOLVAL
UE","OBJECTID","OBJECTTYPEID","DATAVENDORID","ORGDEBTTYPEID","RATINGTYPEID") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6)>.

edit params RPRODM1
REPERROR (1,DISCARD)
start RPRODM1

REPLICAT   RPRODM1   Last Started 2017-08-22 10:40   Status ABENDED
INTEGRATED
Checkpoint Lag       24:26:22 (updated 00:11:05 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prodm/ra000000000
                     2017-08-21 10:19:54.975664  RBA 59321430

2017-08-22 10:46:17  WARNING OGG-01154  SQL error 6550 mapping AUDITOR.AUDITID to PRODM.AUDITOR.AUDITID.
2017-08-22 10:46:17  ERROR   OGG-01296  Error mapping from AUDITOR.AUDITID to PRODM.AUDITOR.AUDITID.

-- ./dirrpt/RPRODM1.dsc
Aborting transaction on /app/oracle/product/ggate/12c/1/dirdat/prodm/ra beginning at seqno 0 rba 59321430
                         error at seqno 0 rba 59321430
Problem replicating AUDITOR.AUDITID to PRODM.AUDITOR.AUDITID
Mapping problem with compressed update record (target format)...
*
No columns were available
*

-- edit params RPRODM1
MAP AUDITOR.AUDITID, TARGET PRODM.AUDITOR.AUDITID, COLMAP (USEDEFAULTS);

-- ggsci
start RPRODM1

REPLICAT   RPRODM1   Last Started 2017-08-22 11:08   Status ABENDED
INTEGRATED
Checkpoint Lag       24:26:22 (updated 00:26:30 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prodm/ra000000000
                     2017-08-21 10:19:54.975664  RBA 59321430

-- uxm33
SEQUENCE

-- ggsci (uxm33)
dblogin userid ggs@prodm
flush sequence AUDITOR.AUDITID

-- edit params RPRODM1
(remove earlier entry)

-- lxorainvm01
alter session set container=prodm;
@sequence.sql

-- ggsci
start RPRODM1

REPLICAT   RPRODM1   Last Started 2017-08-22 11:31   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:01 ago)
Process ID           10939
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prodm/ra000000000
                     2017-08-22 11:31:06.246803  RBA 59322851


###########
# trmpm   #
# RTRMPM1 #
# 8/22    #
###########

REPLICAT   RTRMPM1   Last Started 2017-08-22 03:34   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:20 (updated 01:27:13 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/trmpm/ra000000000
                     2017-08-22 09:13:33.038328  RBA 2077049

2017-08-22 09:13:54  ERROR   OGG-00199  Table TRMPM.CCMTRADE.CAM_PRICE_TMP2 does not exist in target database.

-- expdp/impdp logs show the tables was migrated

-- uxm33
DBMS_METADATA.GET_DDL('TABLE','CAM_PRICE_TMP2','CCMTRADE')
(too long to copy)

-- lxorainvm01
paste create table statement

-- ggsci
start RTRMPM1

REPLICAT   RTRMPM1   Last Started 2017-08-22 10:55   Status ABENDED
INTEGRATED
Checkpoint Lag       01:44:08 (updated 00:11:19 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/trmpm/ra000000000
                     2017-08-22 09:13:33.038328  RBA 2077049

2017-08-22 10:57:50  WARNING OGG-01154  SQL error 1403 mapping CCMTRADE.CAM_PRICE_TMP2 to TRMPM.CCMTRADE.CAM_PRICE_TMP2 OCI Error ORA-01403: no data found, SQL <U
PDATE "CCMTRADE"."CAM_PRICE_TMP2" x SET x."CUSIP" = :a2,x."RECORD_DATE" = :a3 WHERE x."CUSIP" = :b0 AND x."RECORD_DATE" = :b1>.

-- edit params RTRMPM1
INSERTMISSINGUPDATES 
MAP CCMTRADE.CAM_PRICE_TMP2, TARGET CCMTRADE.CAM_PRICE_TMP2;
NOINSERTMISSINGUPDATES 

REPLICAT   RTRMPM1   Last Started 2017-08-22 11:12   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:15:41 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/trmpm/ra000000000
                     2017-08-22 11:16:07.797675  RBA 121182727

2017-08-22 11:18:47  WARNING OGG-00869  Table TRMPM.CCMTRADE.SEC_PRICE_TMP2 does not exist.

-- uxm33
DBMS_METADATA.GET_DDL('TABLE','SEC_PRICE_TMP2','CCMTRADE')
(too big)

-- lxorainvm01
paste create table statement

-- ggsci
start RTRMPM1

2017-08-22 11:41:19  WARNING OGG-01154  SQL error 1403 mapping CCMTRADE.SEC_PRICE_TMP2 to TRMPM.CCMTRADE.SEC_PRICE_TMP2 OCI Error ORA-01403: no data found, SQL <U
PDATE "CCMTRADE"."SEC_PRICE_TMP2" x SET x."CUSIP" = :a3,x."RECORD_DATE" = :a4,x."PRICESRC" = :a5 WHERE x."CUSIP" = :b0 AND x."RECORD_DATE" = :b1 AND x."PRICESRC"
= :b2>.

-- edit params RTRMPM1
INSERTMISSINGUPDATES 
MAP CCMTRADE.SEC_PRICE_TMP2, TARGET CCMTRADE.SEC_PRICE_TMP2;

REPLICAT   RTRMPM1   Last Started 2017-08-22 11:54   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:35 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/trmpm/ra000000000
                     2017-08-22 11:59:37.084465  RBA 375692117

2017-08-22 11:59:39  WARNING OGG-00869  Table TRMPM.CCMTRADE.RESTRICT_HOLD_PRICE_TMP2 does not exist.

-- uxm33
select table_name from dba_tables where owner='CCMTRADE' and table_name like '%TMP%' order by 1;
65 rows selected.

-- lxorainvm01
62 rows selected.

-- missing tables
DIRTY_PRICE_TMP2
KEY_RATE_PRICE_TMP2
RESTRICT_HOLD_PRICE_TMP2

-- edit params RTRMPM1
INSERTMISSINGUPDATES 
MAP CCMTRADE.DIRTY_PRICE_TMP2, TARGET CCMTRADE.DIRTY_PRICE_TMP2;
MAP CCMTRADE.KEY_RATE_PRICE_TMP2, TARGET CCMTRADE.KEY_RATE_PRICE_TMP2;
MAP CCMTRADE.RESTRICT_HOLD_PRICE_TMP2, TARGET CCMTRADE.RESTRICT_HOLD_PRICE_TMP2;

REPLICAT   RTRMPM1   Last Started 2017-08-22 12:08   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:01 ago)
Process ID           12925
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/trmpm/ra000000000
                     2017-08-22 09:49:11.186676  RBA 614756809

					 
##########
# idwm   #
# RIDWM1 #
# 8/22   #
##########

REPLICAT   RIDWM1    Last Started 2017-08-18 07:37   Status RUNNING
INTEGRATED
Checkpoint Lag       115:42:08 (updated 57:41:56 ago)
Process ID           8829
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/idwm/ra000000023
                     2017-08-15 11:53:07.560692  RBA 702471168

dblogin userid ggs@idwm
lag replicat RIDWM1
ERROR: sending message to REPLICAT RIDWM1 (Timeout waiting for message).

-- lxoggm01
SEND REPLICAT group, STATUS

REPLICAT   RIDWM1    Last Started 2017-08-18 07:37   Status RUNNING
INTEGRATED
Checkpoint Lag       115:41:59 (updated 00:03:29 ago)
Process ID           8829
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/idwm/ra000000023
                     2017-08-17 22:07:40.820539  RBA 702472530

-- some space cleared on /oraggrep

REPLICAT   RIDWM1    Last Started 2017-08-18 07:37   Status RUNNING
INTEGRATED
Checkpoint Lag       174:03:05 (updated 00:06:05 ago)
Process ID           8829
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/idwm/ra000000027
                     2017-08-15 11:59:57.267049  RBA 821699100
					 
lag replicat RIDWM1
Last record lag 626585 seconds.
Low watermark lag: 626586.
High watermark lag: 626584.
Low watermark position: 10947926440642.
High watermark position: 10947926440642.


###########
# prodm   #
# RPRODM1 #
# 8/22    #
###########

REPLICAT   RPRODM1   Last Started 2017-08-22 18:48   Status ABENDED
INTEGRATED
Checkpoint Lag       30:51:02 (updated 01:55:59 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prodm/ra000000004
                     2017-08-21 10:46:51.202102  RBA 215860610

2017-08-22 18:48:37  WARNING OGG-01154  SQL error 4098 mapping CCMDAILY.HOLDINGS to PRODM.CCMDAILY.HOLDINGS OCI Error ORA-04098: trigger 'AUDITOR.DAILY_HOLD_INS_TG' 
is invalid and failed re-validation (status = 4098), SQL <INSERT INTO "CCMDAILY"."HOLDINGS" ...

-- trigger is listed in /database/cprodm_admn01/scripts/8_enable_triggers_prodm.sql

-- lxorainvm01
ALTER TRIGGER "AUDITOR".DAILY_HOLD_INS_TG DISABLE;

start RPRODM1

-- import log stops after data import
@/database/cprodm_admn01/scripts/8_disable_triggers_prodm.sql
@/database/cprodm_admn01/scripts/revoke_sys_privs_prodm.sql
@$ORACLE_HOME/rdbms/admin/utlrp.sql

REPLICAT   RPRODM1   Last Started 2017-08-22 19:42   Status RUNNING
INTEGRATED
Checkpoint Lag       32:44:30 (updated 00:00:03 ago)
Process ID           5364
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prodm/ra000000004
                     2017-08-21 11:06:46.213504  RBA 427530338

					 
############
# infgix8m #
# RIN_X8M1 #
# 8/22     #
############

info RIN_X8M1 showch

REPLICAT   RIN_X8M1  Last Started 2017-08-21 21:04   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:08 (updated 18:08:41 ago)
Process ID           27789
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/infgix8m/ra000000000
                     2017-08-22 02:23:57.960397  RBA 31557157

Read Checkpoint #1

  GGS Log Trail

  Startup Checkpoint (starting position in the data source):
    Sequence #: 0
    RBA: 0
    Timestamp: Not Available
    Extract Trail: /app/oracle/product/ggate/11g/1/dirdat/infgix8m/ra
    Seqno Length: 9

  Current Checkpoint (position of last record read in the data source):
    Sequence #: 0
    RBA: 31557157
    Timestamp: 2017-08-22 02:23:57.960397
    Extract Trail: /app/oracle/product/ggate/11g/1/dirdat/infgix8m/ra
    Seqno Length: 9

-- view report
2017-08-22 00:04:40  INFO    OGG-06510  Using the following key columns for target table IGASSURE.UP_BNK_S_INTF_LZ_D_W_975042996: ID.

               89522 records processed as of 2017-08-22 00:08:36 (rate 8,delta 36)

-- ./logdump
open /app/oracle/product/ggate/11g/1/dirdat/infgix8m/ra000000000
ghdr on
detail data
pos 31557157
n

2017/08/22 02:23:36.009.092 Insert               Len   209 RBA 31557429
Name: IGASSURE.FIREDTRIGGERS  (TDR Index: 5)
2017/08/22 02:23:37.009.092 GGSUnifiedUpdate     Len   153 RBA 31557718
Name: IGINSIGHT.TRIGGERS  (TDR Index: 1)
2017/08/22 02:23:37.009.092 Insert               Len   209 RBA 31557990
Name: IGINSIGHT.FIREDTRIGGERS  (TDR Index: 2)

-- ./ggsci
stop RIN_X8M1

REPLICAT   RIN_X8M1  Last Started 2017-08-21 21:04   Status STOPPED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:05 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/infgix8m/ra000000000
                     2017-08-22 20:47:52.836255  RBA 31566378

-- ./logdump
open /app/oracle/product/ggate/11g/1/dirdat/infgix8m/ra000000000
ghdr on
detail data
pos 31566378
n

2017/08/22 02:24:06.008.190 Delete               Len   209 RBA 31566650
Name: IGASSURE.FIREDTRIGGERS  (TDR Index: 5)
2017/08/22 02:24:06.008.190 GGSUnifiedUpdate     Len   153 RBA 31566939
Name: IGASSURE.TRIGGERS  (TDR Index: 6)
2017/08/22 02:24:06.008.190 Insert               Len   209 RBA 31567211
Name: IGASSURE.FIREDTRIGGERS  (TDR Index: 5)
(end but no EOF)

-- ggsci
stop RIN_X8M1
alter replicat RIN_X8M1 extseqno 2 extrba 0

2017-08-22 20:56:12  INFO    OGG-06594  Replicat RIN_X8M1 has been altered through GGSCI. Even the start up position might be updated, duplicate suppression remains active in next startup. To override duplicate suppression, start RIN_X8M1 with NOFILTERDUPTRANSACTIONS option.
REPLICAT (Integrated) altered.

start RIN_X8M1

REPLICAT   RIN_X8M1  Last Started 2017-08-22 20:56   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:11 ago)
Process ID           12077
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/infgix8m/ra000000002
                     2017-08-22 20:56:55.587448  RBA 4697

					 
###########
# trmpm   #
# ETRMPM1 #
# 8/22    #
###########

GGSCI (uxm33) 13> info ETRMPM1

EXTRACT    ETRMPM1   Last Started 2017-08-22 12:28   Status RUNNING
Checkpoint Lag       11:52:28 (updated 00:00:03 ago)
Process ID           61997228
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-22 09:14:55
                     SCN 2549.184520761 (10948056158265)

-- report
2017-08-22 20:38:29  INFO    OGG-01021  Command received from GGSCI: STATS  latest table GGTEST.OBJECT_COUNT_AIX.

2017-08-22 20:50:59  INFO    OGG-01971  The previous message, 'INFO OGG-01021', repeated 24 times.

2017-08-22 21:00:59  INFO    OGG-01971  The previous message, 'INFO OGG-01021', repeated 54 times.

-- ggsci
stop ETRMPM1
start ETRMPM1

EXTRACT    ETRMPM1   Last Started 2017-08-22 12:28   Status STOPPED
Checkpoint Lag       11:52:28 (updated 00:05:24 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-22 09:14:55
                     SCN 2549.184520761 (10948056158265)

-- report
2017-08-22 21:12:31  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File NA, THREAD 1, SEQUENCE 89513, SCN 0x000009f50aff7e87. Read Position SCN: 2549.184520761 (10948056158265)).
 
-- rman
rman target / catalog rman@rman11m
restore archivelog from sequence 89513;

-- ggsci
start ETRMPM1

EXTRACT    ETRMPM1   Last Started 2017-08-22 21:22   Status RUNNING
Checkpoint Lag       12:07:27 (updated 00:00:05 ago)
Process ID           4194756
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-22 09:14:55
                     SCN 2549.184520761 (10948056158265)

EXTRACT    ETRMPM1   Last Started 2017-08-22 21:22   Status RUNNING
Checkpoint Lag       13:48:39 (updated 00:00:04 ago)
Process ID           4194756
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-22 09:34:16
                     SCN 2549.184740691 (10948056378195)

stop ETRMPM1
start ETRMPM1

EXTRACT    ETRMPM1   Last Started 2017-08-22 21:22   Status STOPPED
Checkpoint Lag       13:48:39 (updated 00:22:08 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-22 09:34:16
                     SCN 2549.184740691 (10948056378195)

2017-08-22 23:34:58  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File NA, THREAD 1, SEQUENCE 89516, SCN 0x000009f50b02e7e8. Read Position SCN: 2549.184740691 (10948056378195)).

-- rman
rman target / catalog rman@rman11m
restore archivelog from sequence 89516;

-- ggsci
start ETRMPM1

EXTRACT    ETRMPM1   Last Started 2017-08-22 23:52   Status RUNNING
Checkpoint Lag       13:48:39 (updated 00:32:02 ago)
Process ID           58720454
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-22 09:34:16
                     SCN 2549.184740691 (10948056378195)


##################
# prodm          #
# post-migration #
# 8/23           #
##################

-- uxm33
 AUDITOR
    CREATE ANY PROCEDURE
    CREATE ANY TRIGGER
    CREATE TABLE
	
-- lxorainvm01
 AUDITOR
    CREATE ANY PROCEDURE
    CREATE ANY TRIGGER
    CREATE TABLE

-- idevt (uxs33)
create user AUDITOR identified by This1Works;
grant CREATE ANY PROCEDURE to AUDITOR;
grant CREATE ANY TRIGGER to AUDITOR;
grant CREATE TABLE to AUDITOR;

sqlplus auditor
ERROR:
ORA-01045: user AUDITOR lacks CREATE SESSION privilege; logon denied

grant create session to auditor;
select spare4 from user$ where name='AUDITOR';
SPARE4
--------------------------------------------------------------------------------
S:B42DB10FE26A5616554788F975BB7368C0DE8B504608CBAA84B6D25E05CB

alter user auditor identified by Passw0rd;

conn auditor/Passw0rd
Connected.

conn / as sysdba
alter user auditor identified by values 'S:B42DB10FE26A5616554788F975BB7368C0DE8B504608CBAA84B6D25E05CB';

conn auditor/This1Works
Connected

-- uxm33
select spare4 from user$ where name='CCM_PKG';
SPARE4
--------------------------------------------------------------------------------

select username,password from dba_users where username='CCM_PKG';
USERNAME                       PASSWORD
------------------------------ ------------------------------
CCM_PKG



-- lxorainvm01
@/database/cprodm_admn01/scripts/6_create_grants_prodm.sql
@/database/cprodm_admn01/scripts/revoke_sys_privs_prodm.sql

-- data verification
truncate table ggtest.priv_count_linux;
insert into ggtest.priv_count_linux
select distinct grantee, owner, table_name, privilege
from dba_tab_privs
where grantee not in 
('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS\$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS\$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB\$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN')
and grantee not in 
('ADM_PARALLEL_EXECUTE_TASK','APEX_ADMINISTRATOR_ROLE','APEX_GRANTS_FOR_NEW_USERS_ROLE','AQ_ADMINISTRATOR_ROLE','AQ_USER_ROLE','AUDIT_ADMIN','AUDIT_VIEWER','AUTHENTICATEDUSER','CAPTURE_ADMIN','CDB_DBA','CONNECT','CSW_USR_ROLE','CTXAPP','DATAPUMP_EXP_FULL_DATABASE','DATAPUMP_IMP_FULL_DATABASE','DBA','DBFS_ROLE','DELETE_CATALOG_ROLE','DV_ACCTMGR','DV_ADMIN','DV_AUDIT_CLEANUP','DV_DATAPUMP_NETWORK_LINK','DV_GOLDENGATE_ADMIN','DV_GOLDENGATE_REDO_ACCESS','DV_MONITOR','DV_OWNER','DV_PATCH_ADMIN','DV_PUBLIC','DV_REALM_OWNER','DV_REALM_RESOURCE','DV_SECANALYST','DV_STREAMS_ADMIN','DV_XSTREAM_ADMIN','EJBCLIENT','EM_EXPRESS_ALL','EM_EXPRESS_BASIC','EXECUTE_CATALOG_ROLE','EXP_FULL_DATABASE','GATHER_SYSTEM_STATISTICS','GDS_CATALOG_SELECT','GLOBAL_AQ_USER_ROLE','GSMADMIN_ROLE','GSMUSER_ROLE','GSM_POOLADMIN_ROLE','HS_ADMIN_EXECUTE_ROLE','HS_ADMIN_ROLE','HS_ADMIN_SELECT_ROLE','IMP_FULL_DATABASE','JAVADEBUGPRIV','JAVAIDPRIV','JAVASYSPRIV','JAVAUSERPRIV','JAVA_ADMIN','JAVA_DEPLOY','JMXSERVER','LBAC_DBA','LOGSTDBY_ADMINISTRATOR','OEM_ADVISOR','OEM_MONITOR','OLAP_DBA','OLAP_USER','OLAP_XS_ADMIN','OPTIMIZER_PROCESSING_RATE','ORDADMIN','PDB_DBA','PROVISIONER','RECOVERY_CATALOG_OWNER','RECOVERY_CATALOG_USER','RESOURCE','SCHEDULER_ADMIN','SELECT_CATALOG_ROLE','SPATIAL_CSW_ADMIN','SPATIAL_WFS_ADMIN','WFS_USR_ROLE','WM_ADMIN_ROLE','XDBADMIN','XDB_SET_INVOKER','XDB_WEBSERVICES','XDB_WEBSERVICES_OVER_HTTP','XDB_WEBSERVICES_WITH_PUBLIC','XS_CACHE_ADMIN','XS_NAMESPACE_ADMIN','XS_RESOURCE','XS_SESSION_ADMIN','PUBLIC')
and owner not in 
('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS\$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS\$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB\$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN')
UNION
select distinct grantee, 'n/a', 'n/a', privilege
from dba_sys_privs
where grantee not in 
('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS\$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS\$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB\$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN')
and grantee not in 
('ADM_PARALLEL_EXECUTE_TASK','APEX_ADMINISTRATOR_ROLE','APEX_GRANTS_FOR_NEW_USERS_ROLE','AQ_ADMINISTRATOR_ROLE','AQ_USER_ROLE','AUDIT_ADMIN','AUDIT_VIEWER','AUTHENTICATEDUSER','CAPTURE_ADMIN','CDB_DBA','CONNECT','CSW_USR_ROLE','CTXAPP','DATAPUMP_EXP_FULL_DATABASE','DATAPUMP_IMP_FULL_DATABASE','DBA','DBFS_ROLE','DELETE_CATALOG_ROLE','DV_ACCTMGR','DV_ADMIN','DV_AUDIT_CLEANUP','DV_DATAPUMP_NETWORK_LINK','DV_GOLDENGATE_ADMIN','DV_GOLDENGATE_REDO_ACCESS','DV_MONITOR','DV_OWNER','DV_PATCH_ADMIN','DV_PUBLIC','DV_REALM_OWNER','DV_REALM_RESOURCE','DV_SECANALYST','DV_STREAMS_ADMIN','DV_XSTREAM_ADMIN','EJBCLIENT','EM_EXPRESS_ALL','EM_EXPRESS_BASIC','EXECUTE_CATALOG_ROLE','EXP_FULL_DATABASE','GATHER_SYSTEM_STATISTICS','GDS_CATALOG_SELECT','GLOBAL_AQ_USER_ROLE','GSMADMIN_ROLE','GSMUSER_ROLE','GSM_POOLADMIN_ROLE','HS_ADMIN_EXECUTE_ROLE','HS_ADMIN_ROLE','HS_ADMIN_SELECT_ROLE','IMP_FULL_DATABASE','JAVADEBUGPRIV','JAVAIDPRIV','JAVASYSPRIV','JAVAUSERPRIV','JAVA_ADMIN','JAVA_DEPLOY','JMXSERVER','LBAC_DBA','LOGSTDBY_ADMINISTRATOR','OEM_ADVISOR','OEM_MONITOR','OLAP_DBA','OLAP_USER','OLAP_XS_ADMIN','OPTIMIZER_PROCESSING_RATE','ORDADMIN','PDB_DBA','PROVISIONER','RECOVERY_CATALOG_OWNER','RECOVERY_CATALOG_USER','RESOURCE','SCHEDULER_ADMIN','SELECT_CATALOG_ROLE','SPATIAL_CSW_ADMIN','SPATIAL_WFS_ADMIN','WFS_USR_ROLE','WM_ADMIN_ROLE','XDBADMIN','XDB_SET_INVOKER','XDB_WEBSERVICES','XDB_WEBSERVICES_OVER_HTTP','XDB_WEBSERVICES_WITH_PUBLIC','XS_CACHE_ADMIN','XS_NAMESPACE_ADMIN','XS_RESOURCE','XS_SESSION_ADMIN','PUBLIC');
commit;

-- insert Linux role counts
truncate table ggtest.role_count_linux;
insert into ggtest.role_count_linux
select distinct granted_role, grantee, admin_option, default_role
from dba_role_privs
where grantee not in 
('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS\$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS\$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB\$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN')
and grantee not in 
('ADM_PARALLEL_EXECUTE_TASK','APEX_ADMINISTRATOR_ROLE','APEX_GRANTS_FOR_NEW_USERS_ROLE','AQ_ADMINISTRATOR_ROLE','AQ_USER_ROLE','AUDIT_ADMIN','AUDIT_VIEWER','AUTHENTICATEDUSER','CAPTURE_ADMIN','CDB_DBA','CONNECT','CSW_USR_ROLE','CTXAPP','DATAPUMP_EXP_FULL_DATABASE','DATAPUMP_IMP_FULL_DATABASE','DBA','DBFS_ROLE','DELETE_CATALOG_ROLE','DV_ACCTMGR','DV_ADMIN','DV_AUDIT_CLEANUP','DV_DATAPUMP_NETWORK_LINK','DV_GOLDENGATE_ADMIN','DV_GOLDENGATE_REDO_ACCESS','DV_MONITOR','DV_OWNER','DV_PATCH_ADMIN','DV_PUBLIC','DV_REALM_OWNER','DV_REALM_RESOURCE','DV_SECANALYST','DV_STREAMS_ADMIN','DV_XSTREAM_ADMIN','EJBCLIENT','EM_EXPRESS_ALL','EM_EXPRESS_BASIC','EXECUTE_CATALOG_ROLE','EXP_FULL_DATABASE','GATHER_SYSTEM_STATISTICS','GDS_CATALOG_SELECT','GLOBAL_AQ_USER_ROLE','GSMADMIN_ROLE','GSMUSER_ROLE','GSM_POOLADMIN_ROLE','HS_ADMIN_EXECUTE_ROLE','HS_ADMIN_ROLE','HS_ADMIN_SELECT_ROLE','IMP_FULL_DATABASE','JAVADEBUGPRIV','JAVAIDPRIV','JAVASYSPRIV','JAVAUSERPRIV','JAVA_ADMIN','JAVA_DEPLOY','JMXSERVER','LBAC_DBA','LOGSTDBY_ADMINISTRATOR','OEM_ADVISOR','OEM_MONITOR','OLAP_DBA','OLAP_USER','OLAP_XS_ADMIN','OPTIMIZER_PROCESSING_RATE','ORDADMIN','PDB_DBA','PROVISIONER','RECOVERY_CATALOG_OWNER','RECOVERY_CATALOG_USER','RESOURCE','SCHEDULER_ADMIN','SELECT_CATALOG_ROLE','SPATIAL_CSW_ADMIN','SPATIAL_WFS_ADMIN','WFS_USR_ROLE','WM_ADMIN_ROLE','XDBADMIN','XDB_SET_INVOKER','XDB_WEBSERVICES','XDB_WEBSERVICES_OVER_HTTP','XDB_WEBSERVICES_WITH_PUBLIC','XS_CACHE_ADMIN','XS_NAMESPACE_ADMIN','XS_RESOURCE','XS_SESSION_ADMIN','PUBLIC');
commit;

set lines 150 pages 200
col "AIX_PRIVILEGE" format a48
col "LINUX_PRIVILEGE" format a48
select NVL(aix.grantee,lx.grantee) "GRANTEE", 
NVL2(aix.privilege,
	CASE aix.owner
		WHEN 'n/a' THEN aix.privilege
		ELSE aix.privilege||' on '||aix.owner||'.'||aix.table_name
	END
	,'-') "AIX_PRIVILEGE", 
NVL2(lx.privilege,
	CASE lx.owner
		WHEN 'n/a' THEN lx.privilege
		ELSE lx.privilege||' on '||lx.owner||'.'||lx.table_name
	END
	,'-') "LINUX_PRIVILEGE"
from ggtest.priv_count_linux lx full outer join ggtest.priv_count_aix aix
	on aix.grantee=lx.grantee and aix.owner=lx.owner and aix.table_name=lx.table_name and aix.privilege=lx.privilege
where lx.grantee is null or aix.grantee is null
and lx.privilege not in ('SET CONTAINER','CREATE SESSION','SELECT ANY DICTIONARY')
order by 1,2;

-- Role comparison
select NVL(aix.grantee,lx.grantee) "GRANTEE", aix.granted_role "AIX_ROLE", lx.granted_role "LINUX_ROLE"
from ggtest.role_count_linux lx full outer join ggtest.role_count_aix aix
	on aix.grantee=lx.grantee and aix.granted_role=lx.granted_role
where lx.grantee is null or aix.grantee is null
order by 1,2;

-- lxorainvm01
ALTER SESSION SET CURRENT_SCHEMA = ccm_pkg;
select  case when instance_name in ('prodd','trmpd') then 'Develop'
  when  instance_name in ('prodm','trmpm') then 'Beta'
  else ' ' end instance_name from v$instance;



############
# dsrm     #
# uxoram01 #
# 8/22     #
############

-- during script
ORA-31693: Table data object "CURE_CORE"."PTY_OBJ_ATTR_VAL":"SYS_P4020"."SYS_SUBP9617" failed to load/unload and is being skipped due to error:
ORA-02354: error in exporting/importing data
ORA-01466: unable to read data - table definition has changed

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm.log | grep ORA-31693 | sort > /oragg/datapump/dsrm/ora31693_dsrm_aug22.txt
cp /oragg/datapump/dsrm/ora31693_dsrm_aug22.txt /oragg/datapump/dsrm/dsrm_tables.par
(305 tables/partitions)

-- Options:
1. export/import during cutover
	a. get cleanest possible data
	b. could take hours
2. export/import after migration / before cutover
	a. likely to have lots of replicat errors (how to handle???)

-- get SCN
set numf 99999999999990
select CURRENT_SCN from v$database;
10948080611013

-- re-run export
expdp \"/ as sysdba\" flashback_scn=10948080611013 parfile=/oragg/datapump/dsrm/dsrm_tables.par

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm_tables.log | grep ORA-31693 | sort > /oragg/datapump/dsrm/ora31693_dsrm_aug23.txt
cp /oragg/datapump/dsrm/ora31693_dsrm_aug23.txt /oragg/datapump/dsrm/dsrm_tables2.par
(50 tables/partitions)


*** lxoraodsm01 ***
chown oracle:dba -R /oragg/datapump/dsrm
chmod -R 777 /oragg/datapump/dsrm
cp /database/cdsrm_admn01/scripts/impdp_dsrm.par /database/cdsrm_admn01/scripts/impdp_dsrm_tables.par

-- /database/cdsrm_admn01/scripts/impdp_dsrm_tables.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=dsrm_tables_%U.dmp
LOGFILE=impdp_dsrm_tables.log
TABLE_EXISTS_ACTION=REPLACE
PARALLEL=4
CLUSTER=Y
METRICS=Y
TRANSFORM=TABLE_COMPRESSION_CLAUSE:"COMPRESS FOR OLTP"
LOGTIME=ALL

$ORACLE_HOME/bin/impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAODSM02.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=dsrm)))\" parfile=/database/cdsrm_admn01/scripts/impdp_dsrm_tables.par


##########
# dsrm   #
# EDSRM1 #
# 8/23   #
##########

EXTRACT    EDSRM1    Last Started 2017-08-21 18:55   Status RUNNING
Checkpoint Lag       39:14:49 (updated 00:00:07 ago)
Process ID           26542542
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-21 23:44:15
                     SCN 2549.200884059 (10948072521563)

stop EDSRM1
start EDSRM1

EXTRACT    EDSRM1    Last Started 2017-08-21 18:55   Status STOPPED
Checkpoint Lag       39:14:49 (updated 01:36:00 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-21 23:44:15
                     SCN 2549.200884059 (10948072521563)

2017-08-23 15:02:59  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File NA, THREAD 1, SEQUENCE 1044945, SCN 0x000009f50bf77bb3. Read Position SCN: 2549.200884059 (10948072521563)).

-- rman
rman target / catalog rman@rman11m
run
{
 set archivelog destination to '/oragg/arch/dsrm';
 restore archivelog from sequence 1044945;
}

start

EXTRACT    EDSRM1    Last Started 2017-08-23 19:18   Status RUNNING
Checkpoint Lag       45:01:49 (updated 00:00:02 ago)
Process ID           51118452
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-22 00:00:12
                     SCN 2549.201015909 (10948072653413)


##########
# dsrm   #
# RDSRM1 #
# 8/23   #
##########

REPLICAT   RDSRM1    Last Started 2017-08-23 14:57   Status ABENDED
INTEGRATED
Checkpoint Lag       43:15:53 (updated 04:21:09 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000002
                     2017-08-21 19:47:08.833384  RBA 469012328

2017-08-23 15:03:03  WARNING OGG-01154  SQL error 1403 mapping CURE_QUEUE.PEL_PPLUS_AGT to DSRM.CURE_QUEUE.PEL_PPLUS_AGT OCI Error ORA-01403: no data
found, SQL <UPDATE "CURE_QUEUE"."PEL_PPLUS_AGT" 

-- edit params RDSRM1
INSERTMISSINGUPDATES 
MAP "CURE_QUEUE"."PEL_PPLUS_AGT", TARGET "CURE_QUEUE"."PEL_PPLUS_AGT";
NOINSERTMISSINGUPDATES 

REPLICAT   RDSRM1    Last Started 2017-08-23 19:26   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:01:36 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000002
                     2017-08-23 19:27:16.101552  RBA 469042748

2017-08-23 19:27:22  WARNING OGG-01154  SQL error 1403 mapping CURE_QUEUE.PEL_PPLUS_PTY to DSRM.CURE_QUEUE.PEL_PPLUS_PTY OCI Error ORA-01403: no data
found, SQL <UPDATE "CURE_QUEUE"."PEL_PPLUS_PTY"

-- edit params RDSRM1
(add to above)
MAP "CURE_QUEUE"."PEL_PPLUS_PTY", TARGET "CURE_QUEUE"."PEL_PPLUS_PTY";

REPLICAT   RDSRM1    Last Started 2017-08-23 19:30   Status ABENDED
INTEGRATED
Checkpoint Lag       47:36:32 (updated 00:02:56 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000002
                     2017-08-21 19:54:23.960295  RBA 551680819

2017-08-23 19:30:56  WARNING OGG-01154  SQL error 1403 mapping CURE_QUEUE.PEL_PPLUS_POC to DSRM.CURE_QUEUE.PEL_PPLUS_POC OCI Error ORA-01403: no data
found, SQL <UPDATE "CURE_QUEUE"."PEL_PPLUS_POC" 

-- edit params RDSRM1
(add to above)
MAP "CURE_QUEUE"."PEL_PPLUS_POC", TARGET "CURE_QUEUE"."PEL_PPLUS_POC";

REPLICAT   RDSRM1    Last Started 2017-08-23 19:35   Status RUNNING
INTEGRATED
Checkpoint Lag       47:14:59 (updated 02:21:53 ago)
Process ID           27513
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000002
                     2017-08-21 20:20:50.021988  RBA 688217884

					 
###############
# prodm       #
# date format #
# 8/29        #
###############

-- prodd
select RESTRICT_DATE as RESTRICT_DATE,TRUNC(sysdate) as LOAD_DATE,RELEASE_DATE as RELEASE_DATE FROM deposits@MCAMRALINK; 
RESTRICT_D LOAD_DATE  RELEASE_DA
---------- ---------- ----------
01/21/2005 08/29/2017 01/24/2005
09/06/2012 08/29/2017 09/06/2017

-- prodm
RESTRICT_DATE           LOAD_DATE  RELEASE_DATE
----------------------- ---------- -----------------------
2005-01-21 00:00:00.000 08/29/2017 2005-01-24 00:00:00.000
2012-09-06 00:00:00.000 08/29/2017 2017-09-06 00:00:00.000

select parameter,value from NLS_DATABASE_PARAMETERS where parameter='NLS_DATE_FORMAT';
select parameter,value from NLS_INSTANCE_PARAMETERS where parameter='NLS_DATE_FORMAT';
select parameter,value from NLS_SESSION_PARAMETERS where parameter='NLS_DATE_FORMAT';
MM/DD/YYYY

-- parameters
sho parameter nls_date_format
select parameter,value from v$nls_parameters where parameter='NLS_DATE_FORMAT';

DB		nls_date_format	v$nls_parameters	link SID			odbc.ini
------	---------------	----------------	-------------------	-------------------
cprodd	MM/DD/YYYY		MM/DD/YYYY			
prodd	MM/DD/YYYY		MM/DD/YYYY			sqlprod4086tomcamra	NTS8R2P12/Camra4086
prodm	MM/DD/YYYY		MM/DD/YYYY			sqlprod4086tomcamra	NTS8R2P12/Camra4086

-- uxm33
> ls -lrt /move/ODBC_Progress/Connect64forODBC71/odbc*
Aug  4 2016  /move/ODBC_Progress/Connect64forODBC71/odbcinst.ini_original_08042016
Aug  4 2016  /move/ODBC_Progress/Connect64forODBC71/odbcinst.ini
Aug  4 2016  /move/ODBC_Progress/Connect64forODBC71/odbc.sh
Aug  4 2016  /move/ODBC_Progress/Connect64forODBC71/odbc.ini_original_08042016
Aug  4 2016  /move/ODBC_Progress/Connect64forODBC71/odbc.csh
Jan  5 2017  /move/ODBC_Progress/Connect64forODBC71/odbc.ini_01052016
Feb 17 2017  /move/ODBC_Progress/Connect64forODBC71/odbc.ini_bkp17022017
Mar  6 02:05 /move/ODBC_Progress/Connect64forODBC71/odbc.ini_bkp06032017
Mar  7 23:56 /move/ODBC_Progress/Connect64forODBC71/odbc.ini_bkp07032017
Mar 21 08:07 /move/ODBC_Progress/Connect64forODBC71/odbc.ini_bkp21032017
Apr  9 09:02 /move/ODBC_Progress/Connect64forODBC71/odbc.ini_bkp09042017
Jul 13 03:43 /move/ODBC_Progress/Connect64forODBC71/odbc.ini_bkp0713201			* no entry for sqlprod4086tomcamra
Aug 22 06:37 /move/ODBC_Progress/Connect64forODBC71/odbc.ini

-- prodm
alter session set nls_date_format='MM/DD/YYYY';
select RESTRICT_DATE as RESTRICT_DATE,TRUNC(sysdate) as LOAD_DATE,RELEASE_DATE as RELEASE_DATE FROM deposits@MCAMRALINK; 
RESTRICT_DATE           LOAD_DATE  RELEASE_DATE
----------------------- ---------- -----------------------
2005-01-21 00:00:00.000 08/29/2017 2005-01-24 00:00:00.000
2012-09-06 00:00:00.000 08/29/2017 2017-09-06 00:00:00.000

select to_char(RESTRICT_DATE,'MM/DD/YYYY') as RESTRICT_DATE,TRUNC(sysdate) as LOAD_DATE,RELEASE_DATE as RELEASE_DATE FROM deposits@MCAMRALINK; 
               *
ERROR at line 1:
ORA-01722: invalid number

-- NTS8R2P12/Camra4086
 Column Name	Data Type
 -------------	---------
 RESTRICT_DATE	datetime
 RELEASE_DATE	datetime
 
RESTRICT_DATE			RELEASE_DATE
-----------------------	-----------------------
2005-01-21 00:00:00.000	2005-01-24 00:00:00.000
2012-09-06 00:00:00.000	2017-09-06 00:00:00.000

dbo.PRICING
 Column Name	Data Type
 -------------	---------
 PRICE_DATE		datetime
 SYSTEM_DATE	datetime
 
-- prodm
select RESTRICT_DATE as RESTRICT_DATE,TRUNC(sysdate) as LOAD_DATE,RELEASE_DATE as RELEASE_DATE FROM deposits@CAMRALINK;
RESTRICT_DATE           LOAD_DATE  RELEASE_DATE
----------------------- ---------- -----------------------
1994-04-11 00:00:00.000 08/29/2017 2023-02-15 00:00:00.000

select PRICE_DATE, TRUNC(sysdate) as LOAD_DATE, SYSTEM_DATE FROM pricing@MCAMRALINK where rownum<2;
PRICE_DATE              LOAD_DATE  SYSTEM_DATE
----------------------- ---------- -----------------------
2006-09-15 00:00:00.000 08/29/2017 2006-09-15 00:00:00.000

select PRICE_DATE, TRUNC(sysdate) as LOAD_DATE, SYSTEM_DATE FROM pricing@CAMRALINK where rownum<2;
PRICE_DATE              LOAD_DATE  SYSTEM_DATE
----------------------- ---------- -----------------------
2014-04-30 00:00:00.000 08/29/2017 2014-05-07 00:00:00.000

-- MOS
Bug 12730731  NLS_DATE_FORMAT does not work with HS (Doc ID 12730731.8)
The fix for 12730731 is first included in	
12.1.0.1 (Base Release)
11.2.0.4 (Server Patch Set)

-- uxm33
Patch  24491261     : applied on Sun Jun 25 02:58:28 EDT 2017
Patch  24315821     : applied on Sun Feb 26 04:36:28 EST 2017	* OJVM PATCH SET UPDATE 11.2.0.4.161018
Patch  24006111     : applied on Sun Feb 26 04:02:33 EST 2017	* DATABASE PATCH SET UPDATE 11.2.0.4.161018
Patch  18759589     : applied on Sun Jul 24 03:21:08 EDT 2016

-- uxp33
Patch  24491261     : applied on Sun Jul 30 04:22:53 EDT 2017
Patch  22674697     : applied on Sun Aug 28 03:19:44 EDT 2016	* OJVM PATCH SET UPDATE 11.2.0.4.160419
Patch  22502456     : applied on Sun Aug 28 02:46:27 EDT 2016	* DATABASE PATCH SET UPDATE 11.2.0.4.160419
Patch  18759589     : applied on Sun Aug 28 02:41:19 EDT 2016

-- prod (uxp33)
select PRICE_DATE, TRUNC(sysdate) as LOAD_DATE, SYSTEM_DATE FROM pricing@MCAMRALINK where rownum<2;
PRICE_DATE LOAD_DATE  SYSTEM_DAT
---------- ---------- ----------
09/15/2006 08/29/2017 09/15/2006

select PRICE_DATE, TRUNC(sysdate) as LOAD_DATE, SYSTEM_DATE FROM pricing@CAMRALINK where rownum<2;
PRICE_DATE LOAD_DATE  SYSTEM_DAT
---------- ---------- ----------
04/30/2014 08/29/2017 05/07/2014

-- trmpm
PUBLIC
CAMRALINK
CAMRA4086
(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=uxm33.conseco.com)(PORT=1521))(CONNECT_DATA=(SID=trmpmtocamramainuat))(HS=OK))
09/24/2015

PUBLIC
CAMRARUNTIME
CAMRA4086
(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=uxm33.conseco.com)(PORT=1521))(CONNECT_DATA=(SID=trmpmtocamramainprod))(HS=OK))
09/16/2013

PUBLIC
MCAMRALINK
CAMRA4086
(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=uxm33.conseco.com)(PORT=1521))(CONNECT_DATA=(SID=trmpmtomcamra4086prod))(HS=OK))
09/16/2013


select PRICE_DATE, TRUNC(sysdate) as LOAD_DATE, SYSTEM_DATE FROM pricing@CAMRALINK where rownum<2;
PRICE_DATE LOAD_DATE  SYSTEM_DAT
---------- ---------- ----------
04/30/2014 08/29/2017 05/07/2014

select PRICE_DATE, TRUNC(sysdate) as LOAD_DATE, SYSTEM_DATE FROM pricing@CAMRARUNTIME where rownum<2;
ORA-28500: connection from ORACLE to a non-Oracle system returned this message:
[DataDirect][ODBC SQL Server Wire Protocol driver]Connection refused. Verify Host Name and Port Number. {08001}

select PRICE_DATE, TRUNC(sysdate) as LOAD_DATE, SYSTEM_DATE FROM pricing@MCAMRALINK where rownum<2;
ORA-28500: connection from ORACLE to a non-Oracle system returned this message:
[DataDirect][ODBC SQL Server Wire Protocol driver]Connection refused. Verify Host Name and Port Number. {08001}


-- /move/ODBC_Progress/Connect64forODBC71/odbc.ini (uxm33)
MCAMRALINK (prodm)		CAMRARUNTIME (prodm)	CAMRALINK (prodm)		CAMRALINK (trmpm)		CAMRARUNTIME (trmpm)	MCAMRALINK (trmpm)
[SQLPROD4086TOMCAMRA]	[PRODMTOCAMRAMAINPROD]	[SQLPROD4086TOCAMRA]	[TRMPMTOCAMRAMAINUAT]	[TRMPMTOCAMRAMAINPROD]	[TRMPMTOMCAMRA4086PROD]
Database=Camra4086		Database=CamraMain		Database=CamraMain		Database=CamraMain		Database=CamraMain		Database=Camra4086
HostName=NTS8R2P12		HostName=NTS8R2P12		HostName=NTS8R2P12		HostName=NTS8UAT03								HostName=NTS5CAMRAP01
LogonID=Camra4086		LogonID=Camra4086		LogonID=Camra4086		LogonID=Camra4086		
YYYY-MM-DD				MM/DD/YYYY				YYYY-MM-DD

(all for HostName=NTS8R2P12)
[PRODMTOCAMRAMAINUAT]
[PRODMTOMCAMRA4086PROD]

-- prodm
select OWNER,DB_LINK,USERNAME,CREATED,HOST from dba_db_links order by 2;
------------------------------------------------------------------------------------------------------------------------------------------------------
PUBLIC                         CAMRALINK                      CAMRA4086                      07/13/2017
(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=uxm33.conseco.com)(PORT=1521))(CONNECT_DATA=(SID=sqlprod4086tocamra))(HS=OK))

PUBLIC                         CAMRARUNTIME                   CAMRA4086                      09/08/2011
PRODMTOCAMRAMAINPROD

PUBLIC                         MCAMRALINK                     CAMRA4086                      07/13/2017
(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=uxm33.conseco.com)(PORT=1521))(CONNECT_DATA=(SID=sqlprod4086tomcamra))(HS=OK))

select RESTRICT_DATE as RESTRICT_DATE,TRUNC(sysdate) as LOAD_DATE,RELEASE_DATE as RELEASE_DATE FROM deposits@CAMRALINK where rownum=1;
RESTRICT_DATE           LOAD_DATE  RELEASE_DATE
----------------------- ---------- -----------------------
1994-04-11 00:00:00.000 08/29/2017 2023-02-15 00:00:00.000

select RESTRICT_DATE as RESTRICT_DATE,TRUNC(sysdate) as LOAD_DATE,RELEASE_DATE as RELEASE_DATE FROM deposits@CAMRARUNTIME where rownum=1;
RESTRICT_D LOAD_DATE  RELEASE_DA
---------- ---------- ----------
04/11/1994 08/29/2017 02/15/2023

select RESTRICT_DATE as RESTRICT_DATE,TRUNC(sysdate) as LOAD_DATE,RELEASE_DATE as RELEASE_DATE FROM deposits@MCAMRALINK where rownum=1;
RESTRICT_DATE           LOAD_DATE  RELEASE_DATE
----------------------- ---------- -----------------------
2005-01-21 00:00:00.000 08/29/2017 2005-01-24 00:00:00.000

-- uxm33
tnsping PRODMTOCAMRAMAINPROD
Attempting to contact (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxm33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=prodmtocamramainprod)) (HS=OK))
OK (0 msec)

-- initsqlprod4086tocamra.ora
HS_FDS_CONNECT_INFO = SQLPROD4086TOCAMRA
HS_FDS_TRACE_LEVEL = 0
HS_FDS_SHAREABLE_NAME = /move/ODBC_Progress/Connect64forODBC71/lib/odbc.so
HS_FDS_TRACE_FILE_NAME = /move/ODBC_Progress/Connect64forODBC71/sqlprod4086tocamra.out
HS_FDS_TIMESTAMP_MAPPING=char
set ODBCINI=/move/ODBC_Progress/Connect64forODBC71/odbc.ini
set LIBPATH=/move/ODBC_Progress/Connect64forODBC71/lib

-- initsqlprod4086tomcamra.ora
HS_FDS_CONNECT_INFO = SQLPROD4086TOMCAMRA
HS_FDS_TRACE_LEVEL = 0
HS_FDS_SHAREABLE_NAME = /move/ODBC_Progress/Connect64forODBC71/lib/odbc.so
HS_FDS_TRACE_FILE_NAME = /move/ODBC_Progress/Connect64forODBC71/sqlprod4086tomcamra.out
HS_FDS_TIMESTAMP_MAPPING=char
set ODBCINI=/move/ODBC_Progress/Connect64forODBC71/odbc.ini
set LIBPATH=/move/ODBC_Progress/Connect64forODBC71/lib

-- initprodmtocamramainprod.ora
HS_FDS_CONNECT_INFO = PRODMTOCAMRAMAINPROD
HS_FDS_TRACE_LEVEL = 0
HS_FDS_SHAREABLE_NAME = /move/ODBC_Progress/Connect64forODBC71/lib/odbc.so
HS_FDS_TRACE_FILE_NAME = /move/ODBC_Progress/Connect64forODBC71/prodmtocamramainprod.out
set ODBCINI=/move/ODBC_Progress/Connect64forODBC71/odbc.ini
set LIBPATH=/move/ODBC_Progress/Connect64forODBC71/lib


##########
# dsrm   #
# EDSRM1 #
# 8/30   #
##########

GGSCI (uxoram01) 3> info EDSRM1

EXTRACT    EDSRM1    Last Started 2017-08-28 16:30   Status RUNNING
Checkpoint Lag       34:21:56 (updated 00:00:03 ago)
Process ID           60555294
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-28 23:38:35
                     SCN 2549.463829241 (10948335466745)

-- report
2017-08-29 05:35:19 (last entry)

stop EDSRM1
start EDSRM1

EXTRACT    EDSRM1    Last Started 2017-08-28 16:30   Status STOPPED
Checkpoint Lag       34:23:53 (updated 00:59:06 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-28 23:38:35
                     SCN 2549.463829241 (10948335466745)

2017-08-30 10:06:17  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File NA, THREAD 1, SEQUENCE 1065131, SCN 0x000009f51ba28ad6. Read Position SCN: 2549.463829241 (10948335466745)).

-- uxoram01
df -g /move/dsrm_arch01
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
/dev/dsrm_arch01lv    190.00    185.29    3%      111     1% /move/dsrm_arch01

df -g /oragg
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
v_blc_d_oragg.nfs.conseco.stg:/v_blc_d_oragg   4075.52   1779.32   57%     1981     1% /oragg

-- RMAN
rman target / catalog rman@rman11m
run
{
 set archivelog destination to '/oragg/arch/dsrm';
 restore archivelog from sequence 1065131;
}

-- uxoram01
df -g /oragg
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
v_blc_d_oragg.nfs.conseco.stg:/v_blc_d_oragg   4075.52   2543.41   38%     8688     1% /oragg

-- ggsci
start EDSRM1

EXTRACT    EDSRM1    Last Started 2017-08-30 16:14   Status RUNNING
Checkpoint Lag       41:15:38 (updated 00:00:09 ago)
Process ID           52887714
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-28 23:46:09
                     SCN 2549.463855136 (10948335492640)

-- for SR
SEND extract EDSRM1, LOGSTATS
send EDSRM1 showtrans 
send EDSRM1 status 
### Run it twice with 2 mins interval 
send EDSRM1 status 

2) Take a couple of pstack outputs 
sh> pstack 52887714 - isssue this 3 times with 30 seconds difference and get the outputs pasted to a notepad and upload 

3)send EDSRM1 trace ./trace_0830.out --- Start a trace of the extract process. The trace file will be created in the current directory. 
wait for 4 minutes 
send EDSRM1 trace off 

-- 8/31
df -g /move/dsrm_arch01
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
/dev/dsrm_arch01lv    190.00    156.84   18%      733     1% /move/dsrm_arch01

EXTRACT    EDSRM1    Last Started 2017-08-30 16:14   Status RUNNING
Checkpoint Lag       55:52:00 (updated 00:00:04 ago)
Process ID           52887714
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-29 01:10:25
                     SCN 2549.465127493 (10948336764997)


 
###########
# bpad    #
# DB link #
# 8/30    #
###########

-- LXORABPAD01
select sysdate from dual@AWD10SIT_DBL;
                         *
ERROR at line 1:
ORA-28500: connection from ORACLE to a non-Oracle system returned this message:
[unixODBC][IBM][CLI Driver] SQL30081N  A communication error has been detected.
Communication protocol being used: "TCP/IP".  Communication API being used:
"SOCKETS".  Location where the error was detected: "170.40.82.26".
Communication function detecting the error: "connect".  Protocol specific error
code(s): "110", "*", "*".  SQLSTATE=08001
{08001,NativeErr = -30081}
ORA-02063: preceding 3 lines from AWD10SIT_DBL

PUBLIC
AWD10SIT_DBL
A3CNOSDTAE
(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=lxorabpad01.conseco.ad)(PORT=1521)) (CONNECT_DATA=(SID=awd10sit)) (HS=OK))
15-AUG-17

select sysdate from dual@AWD10PROD_DBL;
                         *
ERROR at line 1:
ORA-28500: connection from ORACLE to a non-Oracle system returned this message:
[unixODBC][Driver Manager]Data source name not found, and no default driver
specified {IM002}
ORA-02063: preceding 2 lines from AWD10PROD_DBL

PUBLIC
AWD10PROD_DBL
A3CNOPDTAE
(DESCRIPTION=(ADDRESS=(PROTOCOL=tcp)(HOST=lxorabpad01.conseco.ad)(PORT=1521)) (CONNECT_DATA=(SID=awd10prod)) (HS=OK))
15-AUG-17


-- lsnrctl status
Service "awd10sit" has 1 instance(s).
  Instance "awd10sit", status UNKNOWN, has 1 handler(s) for this service...
Service "awd10prod" has 1 instance(s).
  Instance "awd10prod", status UNKNOWN, has 1 handler(s) for this service...

  
-- /app/oracle/product/gateway/12c/1/hs/admin/initawd10sit.ora
HS_FDS_CONNECT_INFO = DB2DSTAWD10SIT
HS_FDS_TRACE_LEVEL = 0
HS_FDS_TRACE_FILE_NAME = /app/oracle/product/gateway/12c/1/hs/admin/
HS_FDS_SHAREABLE_NAME = /usr/lib64/libodbc.so

set ODBCINI=/etc/odbc.ini	--> set ODBCINI=/opt/ibm/db2/V11.1/dsdriver/cfg/db2cli.ini


-- /app/oracle/product/gateway/12c/1/hs/admin/initawd10prod.ora
(does not exist)


-- /opt/ibm/db2/V11.1/dsdriver/cfg/db2cli.ini
[DB2DSTAWD10SIT]
dbalias=A3CNOSD
hostname=awda3con.dstcorp.net
database=A3CNOSD
port=50000
uid=A3CNOSDTAE
pwd=xxxxxx
autocommit=0


-- lsnrctl
lsnrctl stop
lsnrctl start

Service "awd10prod" has 1 instance(s).
  Instance "awd10prod", status UNKNOWN, has 1 handler(s) for this service...
Service "awd10sit" has 1 instance(s).
  Instance "awd10sit", status UNKNOWN, has 1 handler(s) for this service...

  
-- http://www-01.ibm.com/support/docview.wss?uid=swg21164785
Error#		110
Short Name	ETIMEDOUT 
			Connection timeout
Action Plan	Connection has reached the network timeout limit and is terminated by network 
			Timeout by tcpip layer 
			TCPIP has its own timeout value, if the open connection stayed too long, TCPIP will force the connection off. 
			Usually this is network issue 
			Check TCPIP's KEEPALIVE setting 
			see note1 

Note 1: From DB2 manual explained more what KEEPALIVE does and how we use it. 
DB2 uses TCP/IP's connection KEEPALIVE option to detect if there is a connection failure. This option transmits a message periodically to determine if the partner is still alive. If the partner fails to respond to this message, the connection is considered to be broken, and an error is returned. 

(advised ITDBA to open ticket with Unix)


##########
# dsrm   #
# EDSRM1 #
# 9/1    #
##########

-- cleaned up
-- start manually
dblogin userid GGS@dsrm
ADD SCHEMATRANDATA "AIM_RM"
ADD SCHEMATRANDATA "AIM_RM_P"
ADD SCHEMATRANDATA "AIM_RM_PT"
ADD SCHEMATRANDATA "CLIENT"
ADD SCHEMATRANDATA "CURE_CORE"
ADD SCHEMATRANDATA "CURE_METADATA"
ADD SCHEMATRANDATA "CURE_QUEUE"
ADD SCHEMATRANDATA "CURE_REF"
ADD SCHEMATRANDATA "CURE_SUBSCRPT"
ADD SCHEMATRANDATA "DNC"
ADD SCHEMATRANDATA "ENTPRS_REF_LIB"
ADD SCHEMATRANDATA "GGTEST"
ADD SCHEMATRANDATA "INF_USER"

add extract EDSRM1, integrated tranlog, begin now
add exttrail /nomove/app/oracle/ggate/12c/1/dirdat/dsrm/ea, extract EDSRM1, megabytes 1000
add extract PDSRM1, exttrailsource /nomove/app/oracle/ggate/12c/1/dirdat/dsrm/ea
add rmttrail /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra, extract PDSRM1, megabytes 1000
register extract EDSRM1 database

start extract EDSRM1
info EDSRM1

-- 8/31 morning
EXTRACT    EDSRM1    Last Started 2017-08-31 15:37   Status RUNNING
Checkpoint Lag       01:15:38 (updated 00:00:05 ago)
Process ID           55574582
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-31 14:24:56
                     SCN 2549.522851673 (10948394489177)

start extract PDSRM1
info PDSRM1

-- 8/31 evening
EXTRACT    EDSRM1    Last Started 2017-08-31 15:37   Status RUNNING
Checkpoint Lag       00:37:56 (updated 00:00:11 ago)
Process ID           55574582
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-31 17:37:56
                     SCN 2549.523312191 (10948394949695)

-- 9/1 morning
EXTRACT    EDSRM1    Last Started 2017-08-31 15:37   Status RUNNING
Checkpoint Lag       09:46:00 (updated 00:00:09 ago)
Process ID           55574582
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-08-31 23:09:58
                     SCN 2549.527794706 (10948399432210)

					 
############
# trecscm  #
# RTR_SCM2 #
# 9/11     #
############

REPLICAT   RTR_SCM2  Last Started 2017-08-11 01:34   Status ABENDED
INTEGRATED
Checkpoint Lag       48:00:25 (updated 754:29:06 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/trecscm/RR/ra000000007
                     2017-08-09 06:25:23.725754  RBA 382487147

2017-08-11 06:25:52  WARNING OGG-01154  SQL error 1403 mapping TRECS.QRTZ_FIRED_TRIGGERS to TRECS.QRTZ_FIRED_TRIGGERS OCI Error ORA-01403: no data found, SQL <DELETE FROM "TRECS"."QRTZ_FIRED_TRIGGERS"  WHERE "ENTRY_ID" = :b0>.

-- uxoram01
cd /nomove/app/oracle/ggate/12c/1
@sequence.sql

edit params RTR_SCM2
REPERROR (1403,DISCARD)
start RTR_SCM2

REPLICAT   RTR_SCM2  Last Started 2017-09-11 17:01   Status RUNNING
INTEGRATED
Checkpoint Lag       787:59:32 (updated 00:00:00 ago)
Process ID           30413
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/trecscm/RR/ra000000007
                     2017-08-09 21:02:36.296884  RBA 385418261


tail -n 50 ggserr.log | grep Lag
-- ggserr.log


###############
# idw         #
# date format #
###############

7/6
SQLLDR
dat file	1/1/1901
result 12c	1/1/2001
result 11g	1/1/1901

7/18
change NLS_DATE_FORMAT

7/19
a.paid_to_date >= TO_CHAR(ADD_MONTHS('30-JUN-2017',-3),'YYYYMMDD')
                  *
ORA-01843: not a valid month

7/20
idwd 11g sqlplus
a.paid_to_date >= TO_CHAR(ADD_MONTHS('30-JUN-2017',-3),'YYYYMMDD')
(good)

idwd 12c sqlplus
a.paid_to_date >= TO_CHAR(ADD_MONTHS('30-JUN-2017',-3),'YYYYMMDD')
                  *
ORA-01843: not a valid month

7/21
change NLS_DATE_FORMAT

7/24
idwd		07/24/2017
idwp		24-JUL-2017

7/28
check .profile

7/31
SQLLDR working with format as DD-MON-YYYY

9/25
Oracle says coding issue

9/25 - Nishore
idwp		DD-MON-RR	Toad
			DD-MON-YYYY	sqlplus 11g
idwd		DD-MON-RR	Toad
			MM/DD/YYYY	sqlplus 12c

9/28
idwd		MM/DD/YYYY
cidwd		MM/DD/YYYY
idwt		DD-MON-YYYY
cidwt		DD-MON-YYYY
idwm		DD-MON-YYYY
idwp		DD-MON-YYYY


#########
# prodm #
# impdp #
# 9/28  #
#########

09/28/2017 15:11:23.505: ORA-39171: Job is experiencing a resumable wait.
Resumable error: ORA-01536: space quota exceeded for tablespace 'USRTMP'
09/28/2017 15:11:23.506: Resumable stmt: ALTER TABLE "CCMTKC"."HOLDINGS" ADD CONSTRAINT "PK_HOLDINGS" PRIMARY KEY ("PORTFOLIO_ID", "HOLD_NO", "DB_CODE") USING INDEX (CREATE UNIQUE INDEX "CCMTKC"."PK_HOLDINGS" ON "CCMTKC"."HOLDINGS" ("PORTFOLIO_ID", "HOLD_NO", "DB_CODE") PCTFREE 10 INITRANS 2 MAXTRANS 255 NOLOGGING  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645 PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT) TABLESPACE "USRTMP" )  ENABLE

-- quota for CCMTKC
TABLESPACE_NAME                        MB     MAX MB
------------------------------ ---------- ----------
USERS                                   0 -9.537E-07
USRTMP                                 30         30

alter user CCMTKC quota 100m on USRTMP;

09/28/2017 15:28:24.289: ORA-39171: Job is experiencing a resumable wait.
Resumable error: ORA-01536: space quota exceeded for tablespace 'USRTMP'
09/28/2017 15:28:24.290: Resumable stmt: ALTER TABLE "CINSZ9"."BROKER" ADD CONSTRAINT "PK_BROKER" PRIMARY KEY ("BROKER") USING INDEX (CREATE UNIQUE INDEX "CINSZ9"."PK_BROKER" ON "CINSZ9"."BROKER" ("BROKER") PCTFREE 10 INITRANS 2 MAXTRANS 255 NOLOGGING  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645 PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT) TABLESPACE "USRTMP" )  ENABLE

TABLESPACE_NAME                        MB     MAX MB
------------------------------ ---------- ----------
USERS                                   0         50
USRTMP                                 30         30

alter user CINSZ9 quota 100m on USRTMP;


###########
# prodm   #
# RPRODM1 #
# 9/28    #
###########

REPLICAT   RPRODM1   Last Started 2017-09-28 17:29   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:55 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prodm/ra000000000
                     2017-09-28 17:33:44.869915  RBA 1839734

2017-09-28 17:33:48  WARNING OGG-01154  SQL error 1 mapping CCMPROD.CODE_RELEASE_INFO to CCMPROD.CODE_RELEASE_INFO OCI Error ORA-00001: unique constraint (CCMPROD
.PK_CODE_RELEASE_INFO) violated (status = 1), SQL <INSERT INTO "CCMPROD"."CODE_RELEASE_INFO" ("MODULE","RELEASE_TAG","RELEASE_DATE","RELEASE_USER","ACTION","HOSTN
AME","REMOVED_TAG") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6)>.

-- sh more dirrpt/RPRODM1.dsc
MODULE = Compliance
RELEASE_TAG = 1-21
RELEASE_DATE = 2017-09-28 11:52:37
RELEASE_USER = cnov5b
ACTION = install
HOSTNAME = LX4086OVERNIGHT
REMOVED_TAG = 1-19

-- uxs33
OWNER                CONSTRAINT_NAME                COLUMN_NAME                    C STATUS
-------------------- ------------------------------ ------------------------------ - --------
CCMPROD              PK_CODE_RELEASE_INFO           RELEASE_TAG                    P ENABLED
CCMPROD              PK_CODE_RELEASE_INFO           RELEASE_DATE                   P ENABLED
CCMPROD              PK_CODE_RELEASE_INFO           MODULE                         P ENABLED
CCMPROD              CH_ACTION                      ACTION                         C ENABLED
CCMPROD              CK_HOSTNAME                    HOSTNAME                       C ENABLED
CCMPROD              CK_RELEASE_USER                RELEASE_USER                   C ENABLED

set lines 150 pages 200
select * from "CCMPROD"."CODE_RELEASE_INFO"
where MODULE = 'Compliance'
and RELEASE_TAG = '1-21'
and RELEASE_DATE = to_date('2017-09-28 11:52:37','YYYY-MM-DD HH24:MI:SS');
MODULE                    RELEASE_TAG               RELEASE_DA RELEASE_US ACTION     HOSTNAME                       REMOVED_TAG
------------------------- ------------------------- ---------- ---------- ---------- ------------------------------ -------------------------
Compliance                1-21                      09/28/2017 cnov5b     install    LX4086OVERNIGHT                1-19

-- lxorainvm01
no rows selected

INSERT INTO "CCMPROD"."CODE_RELEASE_INFO" ("MODULE","RELEASE_TAG","RELEASE_DATE","RELEASE_USER","ACTION","HOSTNAME","REMOVED_TAG") 
VALUES ('Compliance', '1-21', to_date('2017-09-28 11:52:37','YYYY-MM-DD HH24:MI:SS'), 'cnov5b', 'install', 'LX4086OVERNIGHT', '1-19');
commit;

** same error **

delete from "CCMPROD"."CODE_RELEASE_INFO"
where MODULE = 'Compliance'
and RELEASE_TAG = '1-21'
and RELEASE_DATE = to_date('2017-09-28 11:52:37','YYYY-MM-DD HH24:MI:SS');
commit;

** same error **

select * from "CCMPROD"."CODE_RELEASE_INFO"
where 
MODULE = 'Compliance' and 
RELEASE_TAG = '1-21' and 
RELEASE_DATE = to_date('2017-09-28 11:52:37','YYYY-MM-DD HH24:MI:SS');

-- ggsci
edit params RPRODM1
REPERROR (1,DISCARD)
start RPRODM1

REPLICAT   RPRODM1   Last Started 2017-09-28 17:58   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:01 ago)
Process ID           7280
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prodm/ra000000000
                     2017-09-28 17:58:49.350231  RBA 1845546

REPLICAT   RPRODM1   Last Started 2017-09-28 17:58   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:03:38 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prodm/ra000000000
                     2017-09-28 17:58:49.350231  RBA 1845546

2017-09-28 17:58:50  WARNING OGG-01154  SQL error 1403 mapping CCMPROD.SERVICE_MAP to CCMPROD.SERVICE_MAP OCI Error ORA-01403: no data found, SQL <DELETE FROM "CC
MPROD"."SERVICE_MAP"  WHERE "CUSIP" = :b0 AND "SERVICE_ID" = :b1>.

-- ggsci
edit params RPRODM1
REPERROR (1403,DISCARD)
INSERTMISSINGUPDATES
start RPRODM1

REPLICAT   RPRODM1   Last Started 2017-09-28 18:07   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:01 ago)
Process ID           7327
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prodm/ra000000000
                     2017-09-28 18:07:49.310343  RBA 1975144


##########
# hubm   #
# PHUBM1 #
# 9/29   #
##########

EXTRACT    PHUBM1    Last Started 2017-09-29 14:15   Status ABENDED
Checkpoint Lag       00:00:00 (updated 00:19:41 ago)
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/hubm/ea000000015
                     2017-09-28 19:29:00.000000  RBA 974716478

2017-09-29 14:21:18  ERROR   OGG-01232  Receive TCP params error: TCP/IP error 73 (Connection reset by peer), endpoint: lxoggm01:7824.


##########
# hubm   #
# RHUBM1 #
# 9/29   #
##########

REPLICAT   RHUBM1    Last Started 2017-09-28 17:08   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:09 ago)
Process ID           6576
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/hubm/ra000000000
                     2017-09-29 14:39:05.568071  RBA 0

-- no errors reported
stop RHUBM1
start RHUBM1

ls -l /app/oracle/product/ggate/12c/1/dirdat/hubm
-rw-r-----. 1 oracle dba 999999820 Sep 22 08:42 ra000000081
-rw-r-----. 1 oracle dba 999999995 Sep 22 21:54 ra000000082
-rw-r-----. 1 oracle dba 999999825 Sep 23 05:29 ra000000083
-rw-r-----. 1 oracle dba 999999935 Sep 23 22:50 ra000000084
-rw-r-----. 1 oracle dba 999999893 Sep 24 09:59 ra000000085
-rw-r-----. 1 oracle dba 999999958 Sep 24 22:15 ra000000086
-rw-r-----. 1 oracle dba 999999154 Sep 25 06:52 ra000000087
-rw-r-----. 1 oracle dba 999994078 Sep 25 17:37 ra000000088
-rw-r-----. 1 oracle dba 999999879 Sep 26 01:44 ra000000089
-rw-r-----. 1 oracle dba 999999734 Sep 26 12:11 ra000000090
-rw-r-----. 1 oracle dba 999999921 Sep 27 00:19 ra000000091
-rw-r-----. 1 oracle dba 999999315 Sep 27 09:35 ra000000092
-rw-r-----. 1 oracle dba 999992703 Sep 27 23:36 ra000000093
-rw-r-----. 1 oracle dba 999999974 Sep 28 06:56 ra000000094
-rw-r-----. 1 oracle dba 974716539 Sep 29 14:15 ra000000095
-rw-r-----. 1 oracle dba       912 Sep 29 14:38 ra000000096
-rw-r-----. 1 oracle dba       912 Sep 29 14:42 ra000000097
-rw-r-----. 1 oracle dba 324794176 Sep 29 14:43 ra000000098

stop RHUBM1
delete RHUBM1

-- uxoram02
stop PHUBM1
delete PHUBM1

-- lxoggm01
rm /oraggrep/hubm/ra*

-- uxoram02
DBLOGIN USERID GGS@HUBM PASSWORD M00nl1ght
add extract PHUBM1, exttrailsource /nomove/app/oracle/ggate/12c/1/dirdat/hubm/ea
add rmttrail /app/oracle/product/ggate/12c/1/dirdat/hubm/ra, extract PHUBM1, megabytes 1000
start PHUBM1

EXTRACT    PHUBM1    Last Started 2017-09-29 14:54   Status RUNNING
Checkpoint Lag       194:10:50 (updated 00:00:00 ago)
Process ID           22544558
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/hubm/ea000000000
                     2017-09-21 12:43:45.000000  RBA 64981893

-- lxoggm01
ll /oraggrep/hubm
-rw-r-----. 1 oracle dba 132016182 Sep 29 14:54 ra000000000

DBLOGIN USERID ggs@hubm PASSWORD M00nl1ght
add replicat RHUBM1, INTEGRATED , exttrail /app/oracle/product/ggate/12c/1/dirdat/hubm/ra
start RHUBM1

REPLICAT   RHUBM1    Last Started 2017-09-29 14:56   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:27 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/hubm/ra000000000
                     2017-09-29 14:56:21.210643  RBA 2384

2017-09-29 14:56:28  WARNING OGG-01154  SQL error 1 mapping MQADM.STATUS_LOG to HUBM.MQADM.STATUS_LOG OCI Error ORA-00001: unique constraint (MQADM.STATUS_LOG_PK)
 violated (status = 1), SQL <INSERT INTO "MQADM"."STATUS_LOG" ("HUB_MESSAGE_ID","STATUS_TIMESTAMP","IDENTITY_CODE","LOG_POINT","STATE","LOG_TIMESTAMP") VALUES (:a
0,:a1,:a2,:a3,:a4,:a5)>.

./ggsci
edit params RHUBM1
REPERROR (1,DISCARD)

REPLICAT   RHUBM1    Last Started 2017-09-29 14:59   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           19247
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/hubm/ra000000000
                     2017-09-29 14:59:27.415987  RBA 222173

					 
###########
# prodm   #
# expdp   #
# 10/5    #
###########

expdp \"/ as sysdba\" parfile=/oragg/datapump/prodm/expdp_metadata_prodm.par

Processing object type DATABASE_EXPORT/SCHEMA/POST_SCHEMA/PROCACT_SCHEMA
ORA-39126: Worker unexpected fatal error in KUPW$WORKER.FETCH_XML_OBJECTS [PROCACT_SCHEMA:"GGS"]
ORA-01690: sort area size too small


-- Data Pump Export (expdp) aborts with "ORA-01690: sort area size too small" (Doc ID 1911968.1)
1. Upgrade to 12.1.0.2.0 (or 12.2. once this has been released)

or

2. Apply Patch:17605620.
Please use My Oracle Support to check availability of Patch:17605620, otherwise contact Oracle Global Support.

or

3. Use the workaround
A possible workaround could be to increase PGA_AGGREGATE_TARGET.


##########
# dsrm   #
# RDSRM1 #
# 10/8   #
##########

REPLICAT   RDSRM1    Last Started 2017-10-07 13:00   Status ABENDED
INTEGRATED
Checkpoint Lag       33:39:48 (updated 27:48:21 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000076
                     2017-10-06 06:31:13.436666  RBA 603157678

2017-10-07 16:11:19  WARNING OGG-01154  SQL error 1403 mapping CURE_QUEUE.PEL_LIFEPRO_CIK_POLICY to DSRM.CURE_QUEUE.PEL_LIFEPRO_CIK_POLICY OCI Error O
RA-01403: no data found, SQL <UPDATE "CURE_QUEUE"."PEL_LIFEPRO_CIK_POLICY" x SET x."OBJ_ATTR_VAL_ID" = :a13,x."INFO_SYS_ID" = :a14,x."OBJ_ID" = :a15,x
."ATTR_ID" = :a16,x."OBJ_ATTR_VAL_TXT" = :a17,x."VALID_VAL_CD" = :a18,x."VAL_EDIT_CD" = :a19,x."EFF_FROM_DT" = :a20,x."EFF_TO_DT" = :a21,x."INSRT_DTM"
 = :a22,x."INSRT_SRC_NM" = :a23,x."LAST_UPDT_DTM" = :a24,x."LAST_UPDT_SRC_NM" = :a25 WHERE x."OBJ_ATTR_VAL_ID" = :b0 AND x."INFO_SYS_ID" = :b1 AND x."

edit params RDSRM1
-- after all other MAP statements
INSERTMISSINGUPDATES
MAP CURE_QUEUE.PEL_LIFEPRO_CIK_POLICY, TARGET CURE_QUEUE.PEL_LIFEPRO_CIK_POLICY;

-- same error
MAP CURE_QUEUE.PEL_LIFEPRO_CIK_POLICY, TARGET DSRM.CURE_QUEUE.PEL_LIFEPRO_CIK_POLICY;

-- same error
(move INSERTMISSINGUPDATES before MAP statements and remove table name)

REPLICAT   RDSRM1    Last Started 2017-10-08 20:13   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:15 ago)
Process ID           10207
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000076
                     2017-10-08 20:14:17.574727  RBA 685711017


############
# dsrm     #
# uxoram01 #
# 10/9     #
############

-- during script
ORA-31693: Table data object "CURE_CORE"."PTY_OBJ_ATTR_VAL":"SYS_P4020"."SYS_SUBP9617" failed to load/unload and is being skipped due to error:
ORA-02354: error in exporting/importing data
ORA-01466: unable to read data - table definition has changed

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm.log | grep ORA-31693 | sort > /oragg/datapump/dsrm/ora31693_dsrm_oct09.txt
cp /oragg/datapump/dsrm/ora31693_dsrm_oct09.txt /oragg/datapump/dsrm/dsrm_tables.par
(305 tables/partitions)

cd /move/dsrm_adm01/scripts
vi RDSRM1.prm
(add tables with MAPEXCLUDE)

mv Linux_setup_dsrm.tar Linux_setup_dsrm.tar.orig
tar -cvf Linux_setup_dsrm.tar *dsrm* RDSRM1.prm
scp Linux_setup_dsrm.tar lxoggm01:/tmp

-- Options:
1. export/import during cutover
	a. get cleanest possible data
	b. could take hours
2. export/import after migration / before cutover
	a. likely to have lots of replicat errors (how to handle???)

-- get SCN
set numf 99999999999990
select CURRENT_SCN from v$database;
10948080611013

-- re-run export
expdp \"/ as sysdba\" flashback_scn=10948080611013 parfile=/oragg/datapump/dsrm/dsrm_tables.par

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm_tables.log | grep ORA-31693 | sort > /oragg/datapump/dsrm/ora31693_dsrm_aug23.txt
cp /oragg/datapump/dsrm/ora31693_dsrm_aug23.txt /oragg/datapump/dsrm/dsrm_tables2.par
(50 tables/partitions)


*** lxoraodsm01 ***
chown oracle:dba -R /oragg/datapump/dsrm
chmod -R 777 /oragg/datapump/dsrm
cp /database/cdsrm_admn01/scripts/impdp_dsrm.par /database/cdsrm_admn01/scripts/impdp_dsrm_tables.par

-- /database/cdsrm_admn01/scripts/impdp_dsrm_tables.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=dsrm_tables_%U.dmp
LOGFILE=impdp_dsrm_tables.log
TABLE_EXISTS_ACTION=REPLACE
PARALLEL=4
CLUSTER=Y
METRICS=Y
TRANSFORM=TABLE_COMPRESSION_CLAUSE:"COMPRESS FOR OLTP"
LOGTIME=ALL

$ORACLE_HOME/bin/impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAODSM02.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=dsrm)))\" parfile=/database/cdsrm_admn01/scripts/impdp_dsrm_tables.par


##########
# dsrm   #
# RDSRM1 #
# 10/10  #
##########

REPLICAT   RDSRM1    Last Started 2017-10-10 12:14   Status ABENDED
INTEGRATED
Checkpoint Lag       20:32:26 (updated 00:09:22 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000089
                     2017-10-09 20:38:18.414301  RBA 193565383

2017-10-10 17:10:47  WARNING OGG-01154  SQL error 1403 mapping CURE_QUEUE.PEL_QSEARCH_PARTY to DSRM.CURE_QUEUE.PEL_QSEARCH_PARTY OCI Error ORA-01403: no data foun
d, SQL <UPDATE "CURE_QUEUE"."PEL_QSEARCH_PARTY" x SET x."OBJ_ATTR_VAL_ID" = :a13,x."INFO_SYS_ID" = :a14,x."OBJ_ID" = :a15,x."ATTR_ID" = :a16,x."OBJ_ATTR_VAL_TXT"
= :a17,x."VALID_VAL_CD" = :a18,x."VAL_EDIT_CD" = :a19,x."EFF_FROM_DT" = :a20,x."EFF_TO_DT" = :a21,x."INSRT_DTM" = :a22,x."INSRT_SRC_NM" = :a23,x."LAST_UPDT_DTM" =
 :a24,x."LAST_UPDT_SRC_NM" = :a25 WHERE x."OBJ_ATTR_VAL_ID" = :b0 AND x."INFO_SYS_ID" = :b1 AND x."OBJ_ID" = :b2 AND x."ATTR_ID" = :b3 AND x."OBJ_ATTR_VAL_TXT" =
:b4 AND x."VALID_VAL_CD" = :b5 AND x."VAL_EDIT_CD" is NULL AND x."EFF_FROM_DT" = :b7 AND x."EFF_TO_DT" is NULL AND x."INSRT_DTM" = :b9 AND x."INSRT_SRC_NM" = :b10
 AND x."LAST_UPDT_DTM" is NULL AND x."LAST_UPDT_SRC_NM" is NULL AND ROWNUM = 1>.

-- edit params RDSRM1
INSERTMISSINGUPDATES

REPLICAT   RDSRM1    Last Started 2017-10-10 17:23   Status RUNNING
INTEGRATED
Checkpoint Lag       19:43:58 (updated 00:00:03 ago)
Process ID           26247
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000091
                     2017-10-09 21:47:18.039050  RBA 531863336


###########
# trmpm   #
# ETRMPM2 #
# 10/13   #
###########

EXTRACT    ETRMPM2   Initialized   2017-10-11 01:10   Status STARTING
Checkpoint Lag       00:00:00 (updated 59:04:41 ago)
Process ID           122042
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-10-11 01:10:57
                     SCN 0.0 (0)
(starting for over an hour)

SEND EXTRACT ETRMPM2, FORCESTOP
ERROR: EXTRACT ETRMPM2 is initializing, please try the command later.

KILL EXTRACT ETRMPM2

EXTRACT    ETRMPM2   Initialized   2017-10-11 01:10   Status STOPPED
Checkpoint Lag       00:00:00 (updated 60:13:26 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-10-11 01:10:57
                     SCN 0.0 (0)

start ETRMPM2

-- find valid SCN numbers for registering
SELECT first_change#
   FROM v$archived_log 
   WHERE dictionary_begin = 'YES' AND 
      standby_dest = 'NO' AND
      name IS NOT NULL AND 
      status = 'A';
no rows selected

-- stop replication

DBLOGIN USERID GGS@ctrmpm PASSWORD M00nl1ght
add extract ETRMPM2, integrated tranlog, begin now
add exttrail /app/oracle/product/ggate/12c/1/dirdat/trmpm/RR/ea, extract ETRMPM2, megabytes 1000
register extract ETRMPM2 database CONTAINER (trmpm) SCN 10949540788627
start extract ETRMPM2

-- view report
2017-10-13 14:03:07  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File <unknown>. Read Position SCN: Unknown).

-- alert log
Wed Oct 11 01:11:53 2017
LOGMINER: End   mining logfile for session 1 thread 1 sequence 11, /database/ctrmpm_arch01/arch/1_11_956938646.dbf

-- rman
rman target /
run
{
 set archivelog destination to '/oragg/arch/trmpm';
 restore archivelog from sequence 11;
}

start extract ETRMPM2
(still not starting)
KILL EXTRACT ETRMPM2

-- new extract
cp ./dirprm/ETRMPM2.prm ./dirprm/ETRMPM3.prm
cp ./dirprm/ETRMPM2_DDL.inc ./dirprm/ETRMPM3_DDL.inc
cp ./dirprm/PTRMPM2.prm ./dirprm/PTRMPM3.prm

DBLOGIN USERID GGS@ctrmpm PASSWORD M00nl1ght
add extract ETRMPM3, integrated tranlog, begin now
add exttrail /app/oracle/product/ggate/12c/1/dirdat/trmpm/RR/ea, extract ETRMPM3, megabytes 1000
add extract PTRMPM3, exttrailsource /app/oracle/product/ggate/12c/1/dirdat/trmpm/RR/ea
add rmttrail /app/oracle/product/ggate/12c/1/dirdat/trmpm/RR/ra, extract PTRMPM3, megabytes 1000
register extract ETRMPM3 database CONTAINER (trmpm)
start extract ETRMPM3
start PTRMPM3

-- old extract
stop PTRMPM2
unregister extract ETRMPM2 database

-- datapump (CO 58428)
col current_scn format 999999999999999
select LTRIM(TO_CHAR(current_scn)) current_scn from v$database;
10949600945497

expdp \"sys@trmpm as sysdba\" flashback_scn=10949600945497 parfile=/oragg/datapump/trmpm/expdp_trmpm_RR.par

Dump file set for SYS.SYS_EXPORT_SCHEMA_01 is:
  /oragg/datapump/trmpm/trmpm_RR_01.dmp
  /oragg/datapump/trmpm/trmpm_RR_02.dmp
  /oragg/datapump/trmpm/trmpm_RR_03.dmp
  /oragg/datapump/trmpm/trmpm_RR_04.dmp
Job "SYS"."SYS_EXPORT_SCHEMA_01" successfully completed at Fri Oct 13 15:28:33 2017 elapsed 0 00:03:30


#########
# prodm #
# impdp #
# 10/15  #
#########

09/28/2017 15:11:23.505: ORA-39171: Job is experiencing a resumable wait.
Resumable error: ORA-01536: space quota exceeded for tablespace 'USRTMP'
09/28/2017 15:11:23.506: Resumable stmt: ALTER TABLE "CCMTKC"."HOLDINGS" ADD CONSTRAINT "PK_HOLDINGS" PRIMARY KEY ("PORTFOLIO_ID", "HOLD_NO", "DB_CODE") USING INDEX (CREATE UNIQUE INDEX "CCMTKC"."PK_HOLDINGS" ON "CCMTKC"."HOLDINGS" ("PORTFOLIO_ID", "HOLD_NO", "DB_CODE") PCTFREE 10 INITRANS 2 MAXTRANS 255 NOLOGGING  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645 PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT) TABLESPACE "USRTMP" )  ENABLE

-- quota for CCMTKC
TABLESPACE_NAME                        MB     MAX MB
------------------------------ ---------- ----------
USERS                                   0 -9.537E-07
USRTMP                                 30         30

alter user CCMTKC quota 100m on USRTMP;

09/28/2017 15:28:24.289: ORA-39171: Job is experiencing a resumable wait.
Resumable error: ORA-01536: space quota exceeded for tablespace 'USRTMP'
09/28/2017 15:28:24.290: Resumable stmt: ALTER TABLE "CINSZ9"."BROKER" ADD CONSTRAINT "PK_BROKER" PRIMARY KEY ("BROKER") USING INDEX (CREATE UNIQUE INDEX "CINSZ9"."PK_BROKER" ON "CINSZ9"."BROKER" ("BROKER") PCTFREE 10 INITRANS 2 MAXTRANS 255 NOLOGGING  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645 PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT) TABLESPACE "USRTMP" )  ENABLE

TABLESPACE_NAME                        MB     MAX MB
------------------------------ ---------- ----------
USERS                                   0         50
USRTMP                                 30         30

alter user CINSZ9 quota 100m on USRTMP;


###########
# prodm   #
# PPRODM1 #
###########

STOP PPRODM1
delete extract PPRODM1
add extract PPRODM1, exttrailsource /nomove/app/oracle/ggate/12c/1/dirdat/prodm/ea
add rmttrail /app/oracle/product/ggate/12c/1/dirdat/prodm/ra, extract PPRODM1, megabytes 1000
start extract PPRODM1

###############
# prodm       #
# post-import #
# 10/15       #
###############

-- DB links - AIX
Public link LPLINK is broken!
LMS is working
Link ORA_DSGM_DBL owned by OPS$ORACLE is broken!
Link ORA_DSGD_DBL owned by OPS$ORACLE is broken!
TRRUNTIME is working
MCAMRALINK is working
DSGP_DBL is working
Link ORA_DSGP_DBL owned by OPS$ORACLE is broken!
DSGD_DBL is working
CAMRALINK is working
PRODLINK is working
TRADELINK is working
LMSRUNTIME is working
CAMRARUNTIME is working
PMRUNTIME is working

-- DB links - Linux
Public link PRODLINK needs to be fixed!
Public link TRRUNTIME needs to be fixed!
Public link CAMRARUNTIME needs to be fixed!
Public link LMS needs to be fixed!
Public link LPLINK needs to be fixed!			-- not needed per Mark Ullom (10/6)

DROP PUBLIC DATABASE LINK "LPLINK";

DROP PUBLIC DATABASE LINK "PRODLINK";
CREATE PUBLIC DATABASE LINK "PRODLINK"
   CONNECT TO "DBLINK" IDENTIFIED BY &what_pwd
   USING 'PRODM';
   
DROP PUBLIC DATABASE LINK "TRRUNTIME";
CREATE PUBLIC DATABASE LINK "TRRUNTIME"
   CONNECT TO "DBLINK_READONLY" IDENTIFIED BY &what_pwd
   USING 'TRMP';
   
cd /nomove/app/oracle/gateway/11g/6/hs/admin
scp init<SID>.ora <Linux-VM>:/app/oracle/product/gateway/12c/1/hs/admin
more /move/ODBC_Progress/Connect64forODBC71/odbc.ini
vim /etc/odbc.ini

* CAMRARUNTIME has this in tnsnames on uxm33
* (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxm33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=prodmtocamramainprod)) (HS=OK))
DROP PUBLIC DATABASE LINK "CAMRARUNTIME";
CREATE PUBLIC DATABASE LINK "CAMRARUNTIME"
   CONNECT TO "CAMRA4086" IDENTIFIED BY "&what_pwd"
   USING '(DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=LXORAINVM01.conseco.ad)(PORT=1521)) (CONNECT_DATA=(SID=prodmtocamramainprod)) (HS=OK))';

* LMS has this in tnsnames
* (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxm33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=orauattolmsv10uat)) (HS=OK))
DROP PUBLIC DATABASE LINK "LMS";
CREATE PUBLIC DATABASE LINK "LMS"
   CONNECT TO "lms4086data" IDENTIFIED BY &what_pwd
   USING '(DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=LXORAINVM01.conseco.ad)(PORT=1521)) (CONNECT_DATA=(SID=orauattolmsv10uat)) (HS=OK))';

* LMSRUNTIME has this in tnsnames
* (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=uxm33.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=orauattolmsv10prod)) (HS=OK))
DROP PUBLIC DATABASE LINK "LMSRUNTIME";
CREATE PUBLIC DATABASE LINK "LMSRUNTIME"
   CONNECT TO "lms4086data" IDENTIFIED BY &what_pwd
   USING '(DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=LXORAINVM01.conseco.ad)(PORT=1521)) (CONNECT_DATA=(SID=orauattolmsv10prod)) (HS=OK))';

   
-- random errors
GRANT INDEX ON "CCMPROD".HOLD_PRICE TO "CCMSTAGE"
                         *
ERROR at line 1:
ORA-00942: table or view does not exist 

SQL> GRANT INDEX ON "CCMPROD".HOLD_PRICE TO "CCMSTAGE";
Grant succeeded.


  CREATE OR REPLACE PUBLIC SYNONYM "P" FOR "PLVQS"."P"
*
ERROR at line 1:
ORA-65040: operation not allowed from within a pluggable database 

SQL> select * from dba_users where username='PLVQS';
no rows selected	- same in AIX and Linux
SQL> select owner, object_name, object_type from dba_objects where object_name='P';
OWNER                          OBJECT_NAME                    OBJECT_TYPE
------------------------------ ------------------------------ -----------------------
PUBLIC                         P                              SYNONYM		- same in AIX and Linux
APEX_040200                    P                              PROCEDURE		- only in Linux


ORA-31685: Object type INDEX:"AUTODDL"."PREV_Q_QUARTER_MV_IDX" failed due to insufficient privileges. Failing sql is:
CREATE INDEX "AUTODDL"."PREV_Q_QUARTER_MV_IDX" ON "CCM_PKG"."QUARTER_MV" ("PREV_Q_END_RECORD_DATE") 

select table_owner, table_name, status from dba_indexes where owner='AUTODDL' and index_name='PREV_Q_QUARTER_MV_IDX';
TABLE_OWNER                    TABLE_NAME                     STATUS
------------------------------ ------------------------------ --------
CCM_PKG                        QUARTER_MV                     VALID		- only in AIX

set long 10000000
select DBMS_METADATA.GET_DDL('INDEX','PREV_Q_QUARTER_MV_IDX','AUTODDL') from dual;

CREATE INDEX "AUTODDL"."PREV_Q_QUARTER_MV_IDX" ON "CCM_PKG"."QUARTER_MV" ("PREV_Q_END_RECORD_DATE");
Index created.


GRANTEE                        AIX_PRIVILEGE                                    LINUX_PRIVILEGE
------------------------------ ------------------------------------------------ ------------------------------------------------
CCM_PKG                        -                                                SELECT on CCMPROD.EL_AVER_PERIODS_TBL


-- AUTODDL/DML roles
select username, profile, common, ORACLE_MAINTAINED from dba_users where username in ('AUTODDL','AUTODML') order by 1;
USERNAME                       PROFILE              COM O
------------------------------ -------------------- --- -
AUTODDL                        APP_PROFILE          YES N
AUTODML                        APP_PROFILE          YES N

select role from dba_roles where role like 'AUTO%' order by 1;
ROLE
------------------------------
AUTODDL_ADMIN
AUTODML_ADMIN
AUTOMATED_REPORTS
select role, common, oracle_maintained from dba_roles where role like 'AUTO%' order by 1;
ROLE                           COM O
------------------------------ --- -
AUTODDL_ADMIN                  NO  N
AUTODML_ADMIN                  NO  N
AUTOMATED_REPORTS              NO  N
(CDB)
ROLE                           COM O
------------------------------ --- -
AUTODDL_ADMIN                  YES Y
AUTODML_ADMIN                  YES Y

alter session set container=cdb$root;
alter session set "_oracle_script"=true;
drop role AUTODDL_ADMIN;
drop role AUTODML_ADMIN;
alter session set "_oracle_script"=false;
alter session set container=prodm;
drop role AUTODDL_ADMIN;
drop role AUTODML_ADMIN;
alter session set container=cdb$root;

(run commands from create_audotddl_role_and_id.sql and
ALTER USER AUTODDL DEFAULT ROLE AUTODDL_ADMIN container=all;
ALTER USER AUTODML DEFAULT ROLE AUTODML_ADMIN container=all;

select grantee, granted_role, default_role from dba_role_privs where grantee in ('AUTODDL','AUTODML') order by 1,2;
GRANTEE                        GRANTED_ROLE                   DEF
------------------------------ ------------------------------ ---
AUTODDL                        AUTODDL_ADMIN                  YES
AUTODML                        AUTODML_ADMIN                  YES
select con_id, grantee, granted_role, default_role, common from cdb_role_privs where grantee in ('AUTODDL','AUTODML') order by 1,2,3;
    CON_ID GRANTEE                        GRANTED_ROLE                   DEF COM
---------- ------------------------------ ------------------------------ --- ---
         1 AUTODDL                        AUTODDL_ADMIN                  YES YES
         1 AUTODDL                        CONNECT                        NO  YES
         1 AUTODML                        AUTODML_ADMIN                  YES YES
         1 AUTODML                        CONNECT                        NO  YES
         3 AUTODDL                        AUTODDL_ADMIN                  YES YES
         3 AUTODDL                        CONNECT                        NO  YES
         3 AUTODML                        AUTODML_ADMIN                  YES YES
         3 AUTODML                        CONNECT                        NO  YES


-- refresh groups (no errors in import log)
select rowner, rname, refgroup, job, broken from DBA_REFRESH order by 1,2;
ROWNER                         RNAME                            REFGROUP        JOB B
------------------------------ ------------------------------ ---------- ---------- -
CAIRO                          COMP_LOB_PRICE_MVIEW                    1       1605 Y
CAIRO                          CRE_SUMMARY_MVIEW                       2       2169 Y
CAIRO                          PRICE_CHANGE_MVIEW                      3       1977 Y
CAIRO                          RATING_CHANGE_UNION_MVIEW               4       1390 Y
CAIRO                          RATING_WATCH_MVIEW                      5       1416 Y
CAIRO                          RATING_WATCH_UNION_MVIEW                6       1666 Y
CAIROSTAGE                     BENCHMARK_RATES_VIEW                    7       2866 N
CAIROSTAGE                     CRE_SUMMARY_MVIEW                       8       2191 Y
CAIROSTAGE                     TOTAL_RISK_AGGREGATION                  9       2867 Y
(AIX/Linux differ by refgroup & job, other details match)


-- recompile
@$ORACLE_HOME/rdbms/admin/utlrp.sql

set lines 150 pages 0
set echo off
set feedback off
spool /app/oracle/scripts/12cupgrade/logs/prodm_compile_triggers.sql
select 'alter TRIGGER '||owner||'.'||object_name||' compile;' from dba_objects where object_type='TRIGGER' and status='INVALID' order by owner, object_name;
spool off
set feedback on
@/app/oracle/scripts/12cupgrade/logs/prodm_compile_triggers.sql

set feedback off
spool /app/oracle/scripts/12cupgrade/logs/prodm_compile_views.sql
select 'alter VIEW '||owner||'.'||object_name||' compile;' from dba_objects where object_type='VIEW' and status='INVALID' order by owner, object_name;
spool off
set feedback on
@/app/oracle/scripts/12cupgrade/logs/prodm_compile_views.sql

-- privs (aix)
select * from dba_triggers where owner='AUDITOR' and trigger_name='WEB_CAIRO_SION_INS_TG';
AUDITOR                        WEB_CAIRO_SION_INS_TG          AFTER EACH ROW
INSERT
CCMWEB                         TABLE            CAIRO_SESSIONS

REFERENCING NEW AS NEW OLD AS OLD

ENABLED
web_cairo_sion_ins_tg
after insert on ccmweb.cairo_sessions
for each row
PL/SQL      declare                                                                          NO      NO  NO  NO  NO  NO  YES NO
            cursor my_session_cur is select * from v$session
              where audsid = useren


SQL> select status from dba_objects where owner='AUDITOR' and object_name='WEB_CAIRO_SION_INS_TG';

STATUS
-------
VALID

User, its roles and privileges
------------------------------------------------------------------------------------------------------------------------------------------------------
  AUDITOR
    CREATE ANY PROCEDURE
    CREATE ANY TRIGGER
    CREATE TABLE
    EXECUTE on SYS.DBMS_LOCK
    INDEX on CCMDAILY.PORT_COVENANT
    INDEX on CCMPROD.FAS157_LEVEL_LOOKUP
    SELECT on CCMEOM.CREDIT_FAMILY_PARENT
    SELECT on CCMEOM.CREDIT_FAMILY_RATING
    SELECT on CCMEOM.PORT_PRICE
    SELECT on EOMHIST.CREDIT_FAMILY_RATING
    SELECT on EOMHIST.PORT_PRICE
	
GRANTEE                        PRIVILEGE                                          VIA
------------------------------ -------------------------------------------------- -------------------------
APPQOSSYS                      SELECT ON SYS.V_$SESSION                           SYS
AUTODDL                        SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
AUTODML                        SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
AWR_USER                       SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
CCMSTAGE                       SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
CCMWEB                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
CDPJLO                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
CDPK2F                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
CDPTM2                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
CIN1SA                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
CING1A                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
CINK1S                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
CNOZK7                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
COG71S                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
COGH4O                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
COGKUO                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
COGLG1                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
COGOTA                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
COGQ5C                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
COGSPV                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
COGUGJ                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
COGY0L                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
COGZX6                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
CUWPJK                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
DBAQUEST                       SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
DBAQUEST                       SELECT ON SYS.V_$SESSION                           SYS
DBLINK                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
DBSNMP                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
GGS                            SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
GGS                            SELECT ON SYS.V_$SESSION                           SYS
OPS$ORACLE                     SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
ORACLE_OCM                     SELECT ON SYS.V_$SESSION                           SYS
ORA_QUALYS_DB                  SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
SP_HIST                        SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
SP_RATINGX                     SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
SQLTUNE                        SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
SYS                            SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
SYS                            SELECT ON SYS.V_$SESSION                           SQLEXPLOR_USER role
SYSTEM                         SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role
SYSTEM                         SELECT ON SYS.V_$SESSION                           SQLEXPLOR_USER role
SYSTEM                         SELECT ON SYS.V_$SESSION                           SYS
UIMMONITOR                     SELECT ON SYS.V_$SESSION                           SELECT_CATALOG_ROLE role

-- forgot to include container clause
set lines 150 pages 0
set echo off
set feedback off
spool /nomove/app/oracle/scripts/12cupgrade/logs/prodm_public_grants_revoke.sql
select 'revoke '||privilege||' on '||owner||'.'||table_name||' from public;'
from dba_tab_privs
where grantee='PUBLIC'
order by owner, table_name, privilege;
spool off

scp /nomove/app/oracle/scripts/12cupgrade/logs/prodm_public_grants_revoke.sql lxorainvm01:/app/oracle/scripts/12cupgrade/logs
@/app/oracle/scripts/12cupgrade/logs/prodm_public_grants_revoke.sql

-- grant privs
set lines 150 pages 0
set echo off
set feedback off
spool /nomove/app/oracle/scripts/12cupgrade/logs/prodm_public_grants_cdb.sql
select 'grant '||privilege||' on '||owner||'.'||table_name||' to public container=all;'
from dba_tab_privs
where grantee='PUBLIC' and owner in ('ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS')
order by owner, table_name, privilege;
spool off
spool /nomove/app/oracle/scripts/12cupgrade/logs/prodm_public_grants_pdb.sql
select 'grant '||privilege||' on '||owner||'.'||table_name||' to public;'
from dba_tab_privs
where grantee='PUBLIC' and owner not in ('ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS')
order by owner, table_name, privilege;
spool off

scp /nomove/app/oracle/scripts/12cupgrade/logs/prodm_public_grants_cdb.sql lxorainvm01:/app/oracle/scripts/12cupgrade/logs
scp /nomove/app/oracle/scripts/12cupgrade/logs/prodm_public_grants_pdb.sql lxorainvm01:/app/oracle/scripts/12cupgrade/logs

-- linux
alter session set container=cdb$root;
@/app/oracle/scripts/12cupgrade/logs/prodm_public_grants_cdb.sql

col grantee format a30
col "PRIVILEGE" format a90
select grantee, privilege||' on '||owner||'.'||table_name "PRIVILEGE"
from dba_tab_privs
where grantee='PUBLIC'
order by owner, table_name, privilege;

alter session set container=prodm;
@/app/oracle/scripts/12cupgrade/logs/prodm_public_grants_pdb.sql

grant user_role to public;

-- recompile
@$ORACLE_HOME/rdbms/admin/utlrp.sql

-- grant sys privs
set lines 150 pages 0
set echo off
set feedback off
spool /nomove/app/oracle/scripts/12cupgrade/logs/prodm_public_grants_sys.sql
select 'grant '||privilege||' to public container=all;'
from dba_sys_privs
where grantee='PUBLIC'
order by privilege;

scp /nomove/app/oracle/scripts/12cupgrade/logs/prodm_public_grants_sys.sql lxorainvm01:/app/oracle/scripts/12cupgrade/logs

-- linux
alter session set container=cdb$root;
@/app/oracle/scripts/12cupgrade/logs/prodm_public_grants_sys.sql


-- public checks
col owner format a30
col table_name format a30
col object_type format a30
SELECT dtp.OWNER, dtp.TABLE_NAME, dtp.PRIVILEGE, ob.object_type
SELECT dtp.OWNER, count(*)
FROM dba_tab_privs dtp, dba_objects ob
WHERE dtp.owner=ob.owner and dtp.table_name=ob.object_name
AND dtp.grantee='PUBLIC'
--AND dtp.owner        IN ('SYSTEM','SYS')
--AND ob.object_type not in ('PACKAGE BODY','TYPE BODY','JAVA CLASS','JAVA RESOURCE','TYPE')
AND ob.object_type in ('TABLE','VIEW','PACKAGE','PROCEDURE','FUNCTION')
group by dtp.owner order by 1;
AND ob.object_name!='IMPDP_STATS'
ORDER BY dtp.owner, dtp.table_name, dtp.privilege ;

SELECT dtp.OWNER, ob.object_type, count(*)
FROM dba_tab_privs dtp, dba_objects ob
WHERE dtp.owner=ob.owner and dtp.table_name=ob.object_name
AND dtp.grantee='PUBLIC'
AND dtp.owner        IN ('SYS')
AND ob.object_type in ('TABLE','VIEW','PACKAGE','PROCEDURE','FUNCTION')
group by dtp.owner, ob.object_type order by 1,2;

SELECT dtp.OWNER, dtp.TABLE_NAME, dtp.PRIVILEGE, ob.object_type
FROM dba_tab_privs dtp, dba_objects ob
WHERE dtp.owner=ob.owner and dtp.table_name=ob.object_name
AND dtp.grantee='PUBLIC'
AND dtp.owner        IN ('SYS') and ob.object_type='VIEW'
order by 1,2,3;

SELECT dtp.OWNER, dtp.TABLE_NAME, dtp.PRIVILEGE, ob.object_type
FROM dba_tab_privs dtp, dba_objects ob
WHERE dtp.owner=ob.owner and dtp.table_name=ob.object_name
AND dtp.grantee='PUBLIC'
AND ob.object_type in ('TABLE','PACKAGE','PROCEDURE','FUNCTION')
ORDER BY dtp.owner, dtp.table_name, dtp.privilege ;

set lines 200 pages 0
set echo off
set feedback off
set trimspool on
col owner format a30
col table_name format a30
col object_type format a30
spool /app/oracle/scripts/12cupgrade/logs/public_check_12c.sql
spool /app/oracle/scripts/12cupgrade/logs/public_check_11g.sql
select 'set lines 150 pages 200' from dual;
select 'col owner format a30' from dual;
select 'col table_name format a30' from dual;
select 'col object_type format a30' from dual;
select 'SELECT dtp.OWNER, dtp.TABLE_NAME, dtp.PRIVILEGE, ob.object_type' from dual;
select 'FROM dba_tab_privs dtp, dba_objects ob' from dual;
select 'WHERE dtp.owner=ob.owner and dtp.table_name=ob.object_name' from dual;
select 'AND dtp.grantee=''PUBLIC''' from dual;
select 'AND ob.object_type in (''TABLE'',''PACKAGE'',''PROCEDURE'',''FUNCTION'')' from dual;
select 'AND dtp.TABLE_NAME not in (' from dual;
SELECT ''''||dtp.TABLE_NAME||''','
FROM dba_tab_privs dtp, dba_objects ob
WHERE dtp.owner=ob.owner and dtp.table_name=ob.object_name
AND dtp.grantee='PUBLIC'
AND ob.object_type in ('TABLE','PACKAGE','PROCEDURE','FUNCTION')
ORDER BY 1;
select ') ORDER BY dtp.owner, dtp.table_name, dtp.privilege ;' from dual;
spool off

! vim /app/oracle/scripts/12cupgrade/logs/public_check_11g.sql
! vim /app/oracle/scripts/12cupgrade/logs/public_check_12c.sql

scp /app/oracle/scripts/12cupgrade/logs/public_check_11g.sql uxp33:/nomove/app/oracle/scripts
scp /app/oracle/scripts/12cupgrade/logs/public_check_11g.sql uxp34:/nomove/app/oracle/scripts
scp /app/oracle/scripts/12cupgrade/logs/public_check_11g.sql uxorap01:/nomove/app/oracle/scripts
scp /app/oracle/scripts/12cupgrade/logs/public_check_11g.sql uxorap02:/nomove/app/oracle/scripts

@/nomove/app/oracle/scripts/public_check_11g.sql

-- sys privs
select privilege from dba_sys_privs where grantee='PUBLIC' order by 1;



-- line 1774
SELECT 'grant '|| dsp.privilege ||' to "'|| dsp.grantee || '" ' ||
  (CASE
    WHEN dsp.admin_option = 'YES'
    THEN 'WITH admin OPTION'
    ELSE NULL
  END)
  || ';' "STMT"
FROM dba_sys_privs dsp
WHERE (dsp.grantee, dsp.privilege) NOT IN
	(select dr.role, sp.privilege
	 from dba_sys_privs sp, dba_roles dr
	 where sp.grantee=dr.role and sp.privilege='UNLIMITED TABLESPACE')
AND dsp.GRANTEE='PUBLIC'
UNION
SELECT 'grant '|| drp.granted_role || ' to "'|| drp.grantee || '" '||
  (CASE
    WHEN drp.admin_option = 'YES'
    THEN 'WITH ADMIN OPTION'
    ELSE NULL
  END)
  || ';' 
FROM dba_role_privs drp
WHERE drp.GRANTEE NOT IN ($vExcludeUsers)
AND drp.GRANTEE NOT IN ($vExcludeRoles)
UNION
SELECT 'grant '|| sp.privilege || ' to "'|| rp.grantee || '" '||
  (CASE
    WHEN sp.admin_option = 'YES'
    THEN 'WITH ADMIN OPTION'
    ELSE NULL
  END)
  || ';' 
from dba_sys_privs sp, dba_roles dr, dba_role_privs rp, dba_users du
where sp.grantee=dr.role and rp.granted_role=dr.role and du.username=rp.grantee
and sp.privilege='UNLIMITED TABLESPACE'
and rp.grantee not in ($vExcludeUsers);


dba_dependencies


################
# PUBLIC privs #
# 10/25        #
################

/*--- not available in 11g 
-- check privilege usage (test)
-- idevt (uxs33)
exec DBMS_PRIVILEGE_CAPTURE.GENERATE_RESULT ('PRIV_CHECK_OCT25');

from DBA_UNUSED_PRIVS
*/


#############
# prodm     #
# ORA-00979 #
# 10/19     #
#############

create or replace view ccmeom.pricing_review_base_view
ORA-00979:not a GROUP BY expression
-- also happens when I run select statement on its own
-- does NOT happen on prodd

-- workaround
alter session set "_simple_view_merging"=false;

-- check parameters
set lines 150 pages 200
col con_id format 990
col name format a40
col value format a40
col default_value format a40
spool params_prodm.log
select con_id, name, value, default_value
from v$parameter
where isdefault='FALSE'
order by 2,1;

select name, value
from v$parameter
where isdefault='FALSE'
order by 1,2;

-- check hidden paramters
set linesize 150 pages 200
col Parameter format a50
col Session_Value format a20
col Instance_Value format a20
SELECT a.ksppinm "Parameter",
       b.ksppstvl "Session_Value",
       c.ksppstvl "Instance_Value"
FROM   x$ksppi a,
       x$ksppcv b,
       x$ksppsv c
WHERE  a.indx = b.indx
AND    a.indx = c.indx
AND    a.ksppinm LIKE '/_%' escape '/'
ORDER BY 1;


############
# dsrm     #
# uxoram01 #
# 10/27    #
############

-- during script
ORA-31693: Table data object "CURE_CORE"."PTY_OBJ_ATTR_VAL":"SYS_P4020"."SYS_SUBP9617" failed to load/unload and is being skipped due to error:
ORA-02354: error in exporting/importing data
ORA-01466: unable to read data - table definition has changed

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm.log | grep ORA-31693 | sort > /oragg/datapump/dsrm/ora31693_dsrm_oct27.txt
cp /oragg/datapump/dsrm/expdp_dsrm.par /oragg/datapump/dsrm/dsrm_tables.par
(47 tables)

-- exclude from replicat
cd /move/dsrm_adm01/scripts
vi RDSRM1.prm
(add tables with MAPEXCLUDE)

mv Linux_setup_dsrm.tar Linux_setup_dsrm.tar.orig
tar -cvf Linux_setup_dsrm.tar *dsrm* RDSRM1.prm
scp Linux_setup_dsrm.tar lxoggm01:/tmp

-- exclude from extract
cd /nomove/app/oracle/ggate/12c/1
./ggsci
stop EDSRM1
edit params EDSRM1
(add tables with TABLEEXCLUDE)
start EDSRM1

-- Options:
1. export/import during cutover
	a. get cleanest possible data
	b. could take hours
2. export/import after migration / before cutover
	a. likely to have lots of replicat errors (how to handle???)

-- get SCN
set numf 99999999999990
select CURRENT_SCN from v$database;
10948080611013

-- re-run export
expdp \"/ as sysdba\" flashback_scn=10948080611013 parfile=/oragg/datapump/dsrm/dsrm_tables.par

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm_tables.log | grep ORA-31693 | sort > /oragg/datapump/dsrm/ora31693_dsrm_aug23.txt
cp /oragg/datapump/dsrm/ora31693_dsrm_aug23.txt /oragg/datapump/dsrm/dsrm_tables2.par
(50 tables/partitions)


*** lxoraodsm01 ***
chown oracle:dba -R /oragg/datapump/dsrm
chmod -R 777 /oragg/datapump/dsrm
cp /database/cdsrm_admn01/scripts/impdp_dsrm.par /database/cdsrm_admn01/scripts/impdp_dsrm_tables.par

-- /database/cdsrm_admn01/scripts/impdp_dsrm_tables.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=dsrm_tables_%U.dmp
LOGFILE=impdp_dsrm_tables.log
TABLE_EXISTS_ACTION=REPLACE
PARALLEL=4
CLUSTER=Y
METRICS=Y
TRANSFORM=TABLE_COMPRESSION_CLAUSE:"COMPRESS FOR OLTP"
LOGTIME=ALL

$ORACLE_HOME/bin/impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAODSM02.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=dsrm)))\" parfile=/database/cdsrm_admn01/scripts/impdp_dsrm_tables.par


##########
# dsrm   #
# RDSRM1 #
# 10/29  #
##########

REPLICAT   RDSRM1    Last Started 2017-10-28 10:24   Status ABENDED
INTEGRATED
Checkpoint Lag       36:30:55 (updated 21:36:49 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000021
                     2017-10-27 00:14:48.343993  RBA 780873722

2017-10-28 12:45:45  WARNING OGG-01154  SQL error 1403 mapping CURE_QUEUE.PEL_SHARP_BLC_PARTY to DSRM.CURE_QUEUE.PEL_SHARP_BLC_PARTY OCI Error ORA-014
03: no data found, SQL <UPDATE "CURE_QUEUE"."PEL_SHARP_BLC_PARTY" x SET x."OBJ_ATTR_VAL_ID" = :a13,x."INFO_SYS_ID" = :a14,x."OBJ_ID" = :a15,x."ATTR_ID
" = :a16,x."OBJ_ATTR_VAL_TXT" = :a17,x."VALID_VAL_CD" = :a18,x."VAL_EDIT_CD" = :a19,x."EFF_FROM_DT" = :a20,x."EFF_TO_DT" = :a21,x."INSRT_DTM" = :a22,x
."INSRT_SRC_NM" = :a23,x."LAST_UPDT_DTM" = :a24,x."LAST_UPDT_SRC_NM" = :a25 WHERE x."OBJ_ATTR_VAL_ID" = :b0 AND x."INFO_SYS_ID" = :b1 AND x."OBJ_ID" =
 :b2 AND x."ATTR_ID" = :b3 AND x."OBJ_ATTR_VAL_TXT" = :b4 AND x."VALID_VAL_CD" = :b5 AND x."VAL_EDIT_CD" is NULL AND x."EFF_FROM_DT" = :b7 AND x."EFF_
TO_DT" is NULL AND x."INSRT_DTM" = :b9 AND x."INSRT_SRC_NM" = :b10 AND x."LAST_UPDT_DTM" is NULL AND x."LAST_UPDT_SRC_NM" is NULL AND ROWNUM = 1>.

-- dsrm.log (expdp)
. . exported "CURE_QUEUE"."PEL_SHARP_BLC_PARTY":"SYS_P9956"  554.4 MB 8266133 rows
. . exported "CURE_QUEUE"."PEL_SHARP_BLC_PARTY":"SYS_P9955"  6.333 MB   67206 rows
. . exported "CURE_QUEUE"."PEL_SHARP_BLC_PARTY":"SP_2016"  1.502 MB   15501 rows

-- impdp_dsrm.log
10/27/2017 16:13:43.859: . . imported "CURE_QUEUE"."PEL_SHARP_BLC_PARTY":"SYS_P9956"  554.4 MB 8266133 rows in 35 seconds
10/27/2017 16:24:11.425: . . imported "CURE_QUEUE"."PEL_SHARP_BLC_PARTY":"SYS_P9955"  6.333 MB   67206 rows in 1 seconds
10/27/2017 16:24:23.846: . . imported "CURE_QUEUE"."PEL_SHARP_BLC_PARTY":"SP_2016"  1.502 MB   15501 rows in 0 seconds

-- edit params RDSRM1
INSERTMISSINGUPDATES

REPLICAT   RDSRM1    Last Started 2017-10-29 10:25   Status RUNNING
INTEGRATED
Checkpoint Lag       56:50:29 (updated 00:00:15 ago)
Process ID           15975
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000023
                     2017-10-27 01:37:01.906777  RBA 307885384

					 
##########
# dsrm   #
# RDSRM1 #
# 11/2   #
##########

REPLICAT   RDSRM1    Last Started 2017-11-01 16:55   Status ABENDED
INTEGRATED
Checkpoint Lag       64:04:38 (updated 00:42:11 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000293
                     2017-10-30 15:58:13.533091  RBA 535848192

2017-11-02 08:03:12  ERROR   OGG-00664  OCI Error Flushing database inbound server, 'OGG$RDSRM1' (status = 26804-ORA-26804: Apply "OGG$RDSRM1" is disabled.).

start RDSRM1

REPLICAT   RDSRM1    Last Started 2017-11-02 09:09   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:08 ago)
Process ID           31582
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000293
                     2017-11-02 09:09:09.000906  RBA 538698876

					 
###########
# prodm   #
# RPRODM2 #
# 11/2    #
###########

REPLICAT   RPRODM2   Last Started 2017-10-19 03:16   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 329:02:13 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/prodm/RR/ra000000001
                     2017-10-19 18:00:25.302508  RBA 451817469

-- no error in report file
start RPRODM2

-- LXOGGM01
> ls -l /app/oracle/product/ggate/11g/1/dirdat/prodm/RR/ra00000*
-rw-r-----. 1 oracle dba 999999897 Oct 19 15:45 /app/oracle/product/ggate/11g/1/dirdat/prodm/RR/ra000000000
-rw-r-----. 1 oracle dba 451817469 Oct 20 02:24 /app/oracle/product/ggate/11g/1/dirdat/prodm/RR/ra000000001
-rw-r-----. 1 oracle dba       922 Oct 20 02:24 /app/oracle/product/ggate/11g/1/dirdat/prodm/RR/ra000000002

-- LXORAINVM01
> ll /oragg/trail/prodm/RR
total 1423380
-rw-r-----. 1 oracle dba 999999832 Oct 19 15:45 ea000000000
-rw-r-----. 1 oracle dba 451817404 Oct 19 17:33 ea000000001

-- report file
2017-11-02 11:07:53  INFO    OGG-02232  Switching to next trail file /app/oracle/product/ggate/11g/1/dirdat/prodm/RR/ra000000002 at 2017-11-02 11:07:53.703607 due to EOF. with current RBA 451817469.
2017-11-02 11:07:53  INFO    OGG-01020  Processed extract process RESTART_ABEND record at seq 2, rba 860 (aborted 0 records).


###########
# prodm   #
# EPRODM2 #
# 11/2    #
###########

EXTRACT    EPRODM2   Last Started 2017-10-19 03:09   Status ABENDED
Checkpoint Lag       00:00:05 (updated 332:17:55 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-10-19 18:00:56
                     SCN 2549.1849503826 (10949721141330)

2017-11-02 13:28:57  ERROR   OGG-00664  OCI Error during OCIServerAttach (status = 12154-ORA-12154: TNS:could not resolve the connect identifier specified).

-- tnsnames entry missing
start EPRODM2

2017-11-02 15:06:04  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File <unknown>. Read Position SCN: 2549.1849503826 (10949721141330)).

-- alert log
(nothing indicating a log file)

-- rman
rman target /
run
{
 set archivelog destination to '/oragg/arch/trmpm';
 restore archivelog from sequence 11;
}


#########
# prodm #
# prodd #
# ODBC  #
# 10/30 #
#########

-- from Linux (works from uxm33)
select distinct
	lk.cusip,
	l.PROP_CODE,
	l.RELATED_IPD,
	sum(l.SQUARE_FEET) as SQUARE_FEET ,
	c.cusip as issuer_id,
	rtrim(substr(max(c.DESCRIPTION),0,39)) as DESCRIPTION
from loan_mast_lookup lk,
	lms_LEASMAST l,
	lms_IPTROLES r,
	lms_CARDINDX c,
	lms_LOANCOLL lc,
    CCMEOM.SECURITIES_TMP s
where (l.EXPIRATION_DATE>=' 10/26/2017' or rtrim(l.EXPIRATION_DATE) is null) and
	rtrim(l.RELATED_IPD) =rtrim(r.SHORT_NAME)  and
	rtrim(r.ROLE)='PROP_TENANT' and
	rtrim(l.MAJOR_TENANT) ='Y' and
	rtrim(r.SHORT_NAME) =rtrim(c.SHORT_NAME) and
	rtrim(lc.CODE) = rtrim(l.prop_code) and
	rtrim(lk.loan) = rtrim(lc.loan)  and
	s.cusip = rtrim(lk.cusip) and
	rtrim(c.cusip) is not null and
    rtrim(l.PROP_CODE) is not null and
	rtrim(l.SQUARE_FEET)is not null
group by  l.PROP_CODE, lk.cusip,  l.RELATED_IPD,  c.cusip;

ERROR at line 19:
ORA-28500: connection from ORACLE to a non-Oracle system returned this message:
[Microsoft][ODBC Driver 13 for SQL Server]String data, right truncation
{01004}[Microsoft][ODBC Driver 13 for SQL Server]String data, right truncation
{01004}[Microsoft][ODBC Driver 13 for SQL Server]String data, right truncation
{01004}[Microsoft][ODBC Driver 13 for SQL Server]String data, right truncation
{01004}[Microsoft][ODBC Driver 13 for SQL Server]String data, right truncation
{01004}
ORA-02063: preceding 2 lines from LMSRUNTIME

-- without rtrim
select distinct
	lk.cusip,
	l.PROP_CODE,
	l.RELATED_IPD,
	sum(l.SQUARE_FEET) as SQUARE_FEET ,
	c.cusip as issuer_id,
	(substr(max(c.DESCRIPTION),0,39)) as DESCRIPTION
from loan_mast_lookup lk,
	lms_LEASMAST l,
	lms_IPTROLES r,
	lms_CARDINDX c,
	lms_LOANCOLL lc,
    CCMEOM.SECURITIES_TMP s
where (l.EXPIRATION_DATE>=' 10/26/2017' or (l.EXPIRATION_DATE) is null) and
	(l.RELATED_IPD) =(r.SHORT_NAME)  and
	(r.ROLE)='PROP_TENANT' and
	(l.MAJOR_TENANT) ='Y' and
	(r.SHORT_NAME) =(c.SHORT_NAME) and
	(lc.CODE) = (l.prop_code) and
	(lk.loan) = (lc.loan)  and
	s.cusip = (lk.cusip) and
	(c.cusip) is not null and
    (l.PROP_CODE) is not null and
	(l.SQUARE_FEET)is not null
group by  l.PROP_CODE, lk.cusip,  l.RELATED_IPD,  c.cusip;
95 rows selected.

-- DB link definition (prodm)
PUBLIC
LMSRUNTIME
lms4086data
orauattolmsv10prod
02/18/2017

-- DB link definition (prodd)
PUBLIC
LMSRUNTIME
lms4086data
(DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=lxorainvd01.conseco.ad)(PORT=1521)) (CONNECT_DATA=(SID=orauttolmsv10prod)) (HS=OK))
06/12/2017

/*--- AIX settings (uxm33) ---*/
-- /nomove/app/oracle/gateway/11g/6/hs/admin/initorauattolmsv10prod.ora
HS_FDS_CONNECT_INFO = ORAUATTOLMSV10PROD
HS_FDS_TRACE_LEVEL = 0
HS_FDS_SHAREABLE_NAME = /move/ODBC_Progress/Connect64forODBC71/lib/odbc.so
HS_FDS_TRACE_FILE_NAME = /move/ODBC_Progress/Connect64forODBC71/orauattolmsv10prod.out
set ODBCINI=/move/ODBC_Progress/Connect64forODBC71/odbc.ini
set LIBPATH=/move/ODBC_Progress/Connect64forODBC71/lib

-- /move/ODBC_Progress/Connect64forODBC71/odbc.ini
[ORAUATTOLMSV10PROD]
QEWSD=2455828
Driver=/move/ODBC_Progress/Connect64forODBC71/lib/ddsqls27.so
Description=DataDirect 7.1 SQL Server Wire Protocol
Database=LMS
HostName=NTS14FINP01
LogonID=LMS4086Data

/*--- Linux settings ---*/


-- /etc/odbc.ini (prodm)
[ORAUATTOLMSV10PROD]
Driver=ODBC Driver 13 for SQL Server
Description=MSSQL Server
Server=NTS14FINP01
Database=LMS
LogonID=LMS4086Data

-- /app/oracle/product/gateway/12c/1/hs/admin/initorauttolmsv10prod.ora (prodd)
HS_FDS_CONNECT_INFO = ORAUTTOLMSV10PROD
HS_FDS_TRACE_LEVEL = 0
HS_FDS_TRACE_FILE_NAME = orauttolmsv10prod.trc
HS_FDS_SHAREABLE_NAME = /usr/lib64/libodbc.so		-- ODBC driver
set ODBCINI=/etc/odbc.ini
set LIBPATH=/usr/lib64

-- /etc/odbc.ini (prodd)
[ORAUTTOLMSV10PROD]
Driver=ODBC Driver 13 for SQL Server
Description=MSSQL Server
Trace=No
Server=NTS8UAT03
Database=LMS
LogonID=LMS4086Data
Password=Pas_4rds
Port=1433

-- /etc/odbcinst.ini (prodd)
[ODBC Driver 13 for SQL Server]
Description=Microsoft ODBC Driver 13 for SQL Server
Driver=/opt/microsoft/msodbcsql/lib64/libmsodbcsql-13.1.so.9.1
UsageCount=1

-- edit file (prodd)
cp /app/oracle/product/gateway/12c/1/hs/admin/initorauttolmsv10prod.ora /app/oracle/product/gateway/12c/1/hs/admin/initorauttolmsv10prod.ora.20170420
(same error)

-- prodd
select l.RELATED_IPD||'.', rtrim(l.RELATED_IPD) from lms_LEASMAST l 
where l.RELATED_IPD!=rtrim(l.RELATED_IPD);
743 rows selected.

select distinct
	l.PROP_CODE
	,l.RELATED_IPD
--	,lk.cusip
	,sum(l.SQUARE_FEET) as SQUARE_FEET 
	,c.cusip as issuer_id
--	,rtrim(substr(max(c.DESCRIPTION),0,39)) as DESCRIPTION
from lms_LEASMAST l
--	,loan_mast_lookup lk
	,lms_IPTROLES r
	,lms_CARDINDX c
--	,lms_LOANCOLL lc
--    ,CCMEOM.SECURITIES_TMP s
where 
	(l.EXPIRATION_DATE>=' 10/26/2017' or rtrim(l.EXPIRATION_DATE) is null) and
	rtrim(l.RELATED_IPD) =rtrim(r.SHORT_NAME)  and
	rtrim(r.ROLE)='PROP_TENANT' and
	rtrim(l.MAJOR_TENANT) ='Y' and
	rtrim(r.SHORT_NAME) =rtrim(c.SHORT_NAME) and
--	rtrim(lc.CODE) = rtrim(l.prop_code) and
--	rtrim(lk.loan) = rtrim(lc.loan)  and
--	s.cusip = rtrim(lk.cusip) and
	rtrim(c.cusip) is not null and
    rtrim(l.PROP_CODE) is not null and
	rtrim(l.SQUARE_FEET)is not null
group by  l.PROP_CODE,  l.RELATED_IPD,  c.cusip
, lk.cusip;

select c.cusip, rtrim(c.cusip)
from lms_CARDINDX c
where c.cusip!=rtrim(c.cusip);
329 rows selected.

select c.cusip, rtrim(c.cusip), r.SHORT_NAME, rtrim(r.SHORT_NAME)
from lms_CARDINDX c,lms_IPTROLES r
where rtrim(r.SHORT_NAME) =rtrim(c.SHORT_NAME);
ERROR:
ORA-28500: connection from ORACLE to a non-Oracle system returned this message:
...
9945 rows selected.

select distinct
	l.PROP_CODE
	,l.RELATED_IPD
--	,lk.cusip
	,sum(l.SQUARE_FEET) as SQUARE_FEET 
--	,c.cusip as issuer_id
--	,rtrim(substr(max(c.DESCRIPTION),0,39)) as DESCRIPTION
from lms_LEASMAST l
--	,loan_mast_lookup lk
	,lms_IPTROLES r
--	,lms_CARDINDX c
--	,lms_LOANCOLL lc
--  ,CCMEOM.SECURITIES_TMP s
where 
	(l.EXPIRATION_DATE>=' 10/26/2017' or rtrim(l.EXPIRATION_DATE) is null) and
	rtrim(l.RELATED_IPD) =rtrim(r.SHORT_NAME)  and
	rtrim(r.ROLE)='PROP_TENANT' and
	rtrim(l.MAJOR_TENANT) ='Y' and
--	rtrim(r.SHORT_NAME) =rtrim(c.SHORT_NAME) and
--	rtrim(lc.CODE) = rtrim(l.prop_code) and
--	rtrim(lk.loan) = rtrim(lc.loan)  and
--	s.cusip = rtrim(lk.cusip) and
--	rtrim(c.cusip) is not null and
    rtrim(l.PROP_CODE) is not null and
	rtrim(l.SQUARE_FEET)is not null
group by  l.PROP_CODE,  l.RELATED_IPD;
392 rows selected.

select distinct
	l.PROP_CODE
	,l.RELATED_IPD
	,lk.cusip
	,sum(l.SQUARE_FEET) as SQUARE_FEET 
--	,c.cusip as issuer_id
--	,rtrim(substr(max(c.DESCRIPTION),0,39)) as DESCRIPTION
from lms_LEASMAST l
	,loan_mast_lookup lk
	,lms_IPTROLES r
--	,lms_CARDINDX c
	,lms_LOANCOLL lc
	,CCMEOM.SECURITIES_TMP s
where 
	(l.EXPIRATION_DATE>=' 10/26/2017' or rtrim(l.EXPIRATION_DATE) is null) and
	rtrim(l.RELATED_IPD) =rtrim(r.SHORT_NAME)  and
	rtrim(r.ROLE)='PROP_TENANT' and
	rtrim(l.MAJOR_TENANT) ='Y' and
--	rtrim(r.SHORT_NAME) =rtrim(c.SHORT_NAME) and
	rtrim(lc.CODE) = rtrim(l.prop_code) and
	rtrim(lk.loan) = rtrim(lc.loan)  and
	s.cusip = rtrim(lk.cusip) and
--	rtrim(c.cusip) is not null and
    rtrim(l.PROP_CODE) is not null and
	rtrim(l.SQUARE_FEET)is not null
group by  l.PROP_CODE,  l.RELATED_IPD, lk.cusip;
95 rows selected.

select distinct
	c.cusip as issuer_id
--	,l.PROP_CODE
--	,l.RELATED_IPD
--	,lk.cusip
--	,sum(l.SQUARE_FEET) as SQUARE_FEET 
	,rtrim(substr(max(c.DESCRIPTION),0,39)) as DESCRIPTION
from lms_CARDINDX c
--	,loan_mast_lookup lk
--	,lms_IPTROLES r
--	,lms_LEASMAST l
--	,lms_LOANCOLL lc
--	,CCMEOM.SECURITIES_TMP s
where 
--	(l.EXPIRATION_DATE>=' 10/26/2017' or rtrim(l.EXPIRATION_DATE) is null) and
--	rtrim(l.RELATED_IPD) =rtrim(r.SHORT_NAME)  and
--	rtrim(r.ROLE)='PROP_TENANT' and
--	rtrim(l.MAJOR_TENANT) ='Y' and
--	rtrim(r.SHORT_NAME) =rtrim(c.SHORT_NAME) and
--	rtrim(lc.CODE) = rtrim(l.prop_code) and
--	rtrim(lk.loan) = rtrim(lc.loan)  and
--	s.cusip = rtrim(lk.cusip) and
	rtrim(c.cusip) is not null --and
--	rtrim(l.PROP_CODE) is not null and
--	rtrim(l.SQUARE_FEET)is not null
group by  c.cusip;
ERROR at line 23:
ORA-28500: connection from ORACLE to a non-Oracle system returned this message:

select distinct
	c.cusip as issuer_id
--	,l.PROP_CODE
--	,l.RELATED_IPD
--	,lk.cusip
--	,sum(l.SQUARE_FEET) as SQUARE_FEET 
--	,rtrim(substr(max(c.DESCRIPTION),0,39)) as DESCRIPTION
from lms_CARDINDX c
--	,loan_mast_lookup lk
--	,lms_IPTROLES r
--	,lms_LEASMAST l
--	,lms_LOANCOLL lc
--	,CCMEOM.SECURITIES_TMP s
where 
--	(l.EXPIRATION_DATE>=' 10/26/2017' or rtrim(l.EXPIRATION_DATE) is null) and
--	rtrim(l.RELATED_IPD) =rtrim(r.SHORT_NAME)  and
--	rtrim(r.ROLE)='PROP_TENANT' and
--	rtrim(l.MAJOR_TENANT) ='Y' and
--	rtrim(r.SHORT_NAME) =rtrim(c.SHORT_NAME) and
--	rtrim(lc.CODE) = rtrim(l.prop_code) and
--	rtrim(lk.loan) = rtrim(lc.loan)  and
--	s.cusip = rtrim(lk.cusip) and
	rtrim(c.cusip) is not null --and
--	rtrim(l.PROP_CODE) is not null and
--	rtrim(l.SQUARE_FEET)is not null
;
316 rows selected.

select c.cusip as issuer_id
from lms_CARDINDX c
where rtrim(c.cusip) is not null;
335 rows selected.

select c.cusip as issuer_id, c.DESCRIPTION
from lms_CARDINDX c
where rtrim(c.cusip) is not null;
ISSUER_ID DESCRIPTION
--------- ------------------------------------------------------------
BIMBO     BIMBO BAKERY
NVR       NVR INC
TSA       THE SPORTS AUTHORITY
OMX       OFFICE MAX
CBEND     CONT. BENEFIT DESIGN
ERROR:
ORA-28500: connection from ORACLE to a non-Oracle system returned this message:
[Microsoft][ODBC Driver 13 for SQL Server]String data, right truncation
225 rows selected.



###########
# dsrm    #
# EDSRM1  #
# 11/4    #
###########

EXTRACT    EDSRM1    Last Started 2017-10-28 10:36   Status ABENDED
Checkpoint Lag       00:00:02 (updated 09:08:46 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-11-04 03:39:16
                     SCN 2549.2281389961 (10950153027465)

-- tail -n 50 ./dirrpt/EDSRM1.rpt
ERROR: Manager not currently running.

EXTRACT    EDSRM1    Last Started 2017-11-04 12:52   Status RUNNING
Checkpoint Lag       09:17:14 (updated 00:00:09 ago)
Process ID           56885448
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-11-04 03:39:16
                     SCN 2549.2281389961 (10950153027465)


###########
# dsrm    #
# EDSRM1  #
# 11/4    #
###########

2017-11-10 08:50:52  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File NA, THREAD 1, SEQUENCE 1166574, SCN 0x000009f58b194101. Read Position SCN: 2549.2334694177 (10950206331681)).

rman target /
restore archivelog from sequence 1166574;

run
{
 set archivelog destination to '/oragg/arch/dsrm';
 restore archivelog from sequence 1166574;
}

############
# dsrm     #
# uxoram01 #
# 11/18    #
############

-- during script
ORA-31693: Table data object "CURE_CORE"."PTY_OBJ_ATTR_VAL":"SYS_P4020"."SYS_SUBP9617" failed to load/unload and is being skipped due to error:
ORA-02354: error in exporting/importing data
ORA-01466: unable to read data - table definition has changed

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm.log | grep ORA-31693 | sort > /oragg/datapump/dsrm/ora31693_dsrm_nov18.txt
cp /oragg/datapump/dsrm/expdp_dsrm.par /oragg/datapump/dsrm/dsrm_tables.par
(26 tables)

-- exclude from extract (uxoram01)
cd /nomove/app/oracle/ggate/12c/1
stop EDSRM1
ERROR: sending message to EXTRACT EDSRM1 (Timeout waiting for message).

send extract EDSRM1, FORCESTOP
ERROR: sending message to EXTRACT EDSRM1 (Timeout waiting for message).

kill extract EDSRM1
edit params EDSRM1
(add tables with TABLEEXCLUDE)

2017-11-18 19:25:27  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File NA, THREAD 1, SEQUENCE 1168205, SCN 0x000009f59c81fe09. Read Position SCN: 2549.2626102011 (10950497739515)).

rman target / catalog rman@rman11m
run
{
 set archivelog destination to '/oragg/arch/dsrm';
 restore archivelog from sequence 1168205;
}

EXTRACT    EDSRM1    Last Started 2017-11-18 19:31   Status RUNNING
Checkpoint Lag       25:51:17 (updated 00:00:08 ago)
Process ID           22544528
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-11-17 17:49:18
                     SCN 2549.2626250004 (10950497887508)


EXTRACT    PDSRM1    Last Started 2017-11-17 10:38   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:00:11 ago)
Process ID           24904148
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/dsrm/ea000000032
                     2017-11-17 16:13:59.000000  RBA 182537946

-- exclude from replicat
stop RDSRM1
edit params RDSRM1
(add tables with MAPEXCLUDE)

REPLICAT   RDSRM1    Last Started 2017-11-18 19:20   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:58 ago)
Process ID           24793
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000002
                     2017-11-18 19:21:13.222386  RBA 355404053

-- last trail file
-rw-r-----. 1 oracle dba 182539280 Nov 17 18:59 ra000000032

> df -h /oraggrep
Filesystem                          Size  Used Avail Use% Mounted on
/dev/mapper/oraggrepvg-oraggrep_lv  1.0T   72G  952G   8% /oraggrep

-- 11/19 10:06
EXTRACT    EDSRM1    Last Started 2017-11-18 19:31   Status RUNNING
Checkpoint Lag       37:57:20 (updated 00:12:24 ago)
Process ID           22544528
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2017-11-17 19:56:10
                     SCN 2549.2627202306 (10950498839810)

EXTRACT    PDSRM1    Last Started 2017-11-17 10:38   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:13:05 ago)
Process ID           24904148
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/dsrm/ea000000093
                     2017-11-17 19:56:06.000000  RBA 658267532

REPLICAT   RDSRM1    Last Started 2017-11-18 19:20   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:14:01 ago)
Process ID           24793
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000092
                     2017-11-17 19:57:08.853459  RBA 835559337


					 
					 
					 
/*--- during cutover ---*/
-- /database/cdsrm_admn01/scripts/impdp_dsrm_tables.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=dsrm_tables_%U.dmp
LOGFILE=impdp_dsrm_tables.log
TABLE_EXISTS_ACTION=REPLACE
PARALLEL=4
CLUSTER=Y
METRICS=Y
TRANSFORM=TABLE_COMPRESSION_CLAUSE:"COMPRESS FOR OLTP"
LOGTIME=ALL

-- get SCN
set numf 99999999999990
select CURRENT_SCN from v$database;
10948080611013

-- re-run export
expdp \"/ as sysdba\" flashback_scn=10948080611013 parfile=/oragg/datapump/dsrm/dsrm_tables.par


$ORACLE_HOME/bin/impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAODSM02.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=dsrm)))\" parfile=/database/cdsrm_admn01/scripts/impdp_dsrm_tables.par


############
# dsrm     #
# RDSRM1   #
# 12/9     #
############

REPLICAT   RDSRM1    Last Started 2017-12-08 23:48   Status ABENDED
INTEGRATED
Checkpoint Lag       24:08:47 (updated 13:14:52 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000002
                     2017-12-07 23:40:51.990421  RBA 887507282

2017-12-08 23:49:50  WARNING OGG-01154  SQL error 6550 mapping CURE_CORE.OBJ_ID_SEQ to DSRM.CURE_CORE.OBJ_ID_SEQ.

-- LXORAODSM02
@/app/oracle/scripts/12cupgrade/sequence_auto.sql

REPLICAT   RDSRM1    Last Started 2017-12-09 13:08   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:18 ago)
Process ID           21549
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000003
                     2017-12-09 13:09:04.322094  RBA 881188829


#############
# lag alert #
# ent_tools #
# 12/14     #
#############

*** parameters
LAGREPORT		Sets an interval for reporting lag time to the error log.
LAGINFO			Specifies a lag threshold at which an informational message is reported to the error log.
LAGCRITICAL		Specifies a lag threshold that is considered critical and generates a warning to the error log.

*** uxoram01: params (changed per Oracle, not restarted after change)
--LAGREPORTHOURS 1
LAGREPORTMINUTES 20
--LAGINFOHOURS 10
LAGCRITICALMINUTES 5

*** uxoram01: ggserr.log
2017-12-14 06:42:23  INFO    OGG-00948  Oracle GoldenGate Manager for Oracle, mgr.prm:  Lag for EXTRACT EDSRM1 is 11:53:05 (checkpoint updated 00:00:01 ago). 
(no WARNINGs)

*** lxoggm01: 12c params
LAGINFOHOURS 10
LAGREPORTHOURS 1

*** lxoggm01: 12c ggserr.log
2017-06-19 17:32:58  INFO    OGG-00948  Oracle GoldenGate Manager for Oracle, mgr.prm:  Lag for REPLICAT RDO_KRT1 is 10:40:02 (checkpoint updated 07:14:50 ago).
(no WARNINGs)

*** lxoggm01: 11g params
--LAGINFOHOURS 10
LAGINFOMINUTES 10
--LAGREPORTHOURS 1
LAGREPORTMINUTES 10
--LAGCRITICALMINUTES 10
--LAGCRITICALHOURS 783
LAGCRITICALHOURS 4

*** lxoggm01: 11g ggserr.log
2017-10-06 08:05:25  INFO    OGG-00948  Oracle GoldenGate Manager for Oracle, mgr.prm:  Lag for REPLICAT RBL_AVM2 is 00:25:44 (checkpoint updated 02:44:42 ago).
2017-10-06 22:46:27  WARNING OGG-00947  Oracle GoldenGate Manager for Oracle, mgr.prm:  Lag for REPLICAT RBL_AVM2 is 05:38:58 (checkpoint updated 00:09:41 ago).



!!! add to install script !!!


############
# dsrm     #
# uxoram01 #
# 12/13    #
############

-- during script
ORA-31693: Table data object "CURE_CORE"."PTY_OBJ_ATTR_VAL":"SYS_P4020"."SYS_SUBP9617" failed to load/unload and is being skipped due to error:
ORA-02354: error in exporting/importing data
ORA-01466: unable to read data - table definition has changed

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm.log | grep ORA-31693 | sort > /oragg/datapump/dsrm/ora31693_dsrm_dec13.txt
cp /oragg/datapump/dsrm/expdp_dsrm.par /oragg/datapump/dsrm/dsrm_tables.par
(10 tables)

-- exclude from replicat (uxoram01)
cd /move/dsrm_adm01/scripts
cp RDSRM1.prm RDSRM1.prm.orig
mv Linux_setup_dsrm.tar Linux_setup_dsrm.tar.orig
vi RDSRM1.prm
(add MAPEXCLUDE for failed tables)

tar -cvf Linux_setup_dsrm.tar *dsrm* RDSRM1.prm
scp Linux_setup_dsrm.tar lxoggm01:/tmp


############
# dsrm     #
# RDSRM1   #
# 12/16    #
############

REPLICAT   RDSRM1    Last Started 2017-12-16 12:39   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:11:22 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000000
                     2017-12-16 12:39:52.229918  RBA 441457089

2017-12-16 12:39:57  WARNING OGG-01154  SQL error 2291 mapping CURE_METADATA.INFO_FLOW_CMPNT_STATS to DSRM.CURE_METADATA.INFO_FLOW_CMPNT_STATS OCI Error
ORA-02291: integrity constraint (CURE_METADATA.SYS_C0013880) violated - parent key not found (status = 2291), SQL <INSERT INTO "CURE_METADATA"."INFO_FLOW
_CMPNT_STATS" ("INFO_FLOW_CMPNT_STATS_ID","INFO_FLOW_STATS_ID","CMPNT_NM","STRT_DTM","END_DTM","DUR_SECNDS_CNT","ROW_CNT","INSRT_DTM","INSRT_SRC_NM","LAS
T_UPDT_DTM","LAST_UPDT_SRC_NM") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10)>.

-- ./dirrpt/RDSRM1.dsc
INFO_FLOW_CMPNT_STATS_ID = 239422
INFO_FLOW_STATS_ID = 117696
CMPNT_NM = PEL_OLD_ORA_STATS
STRT_DTM = 2017-12-15 02:36:07
END_DTM = 2017-12-15 02:36:16
DUR_SECNDS_CNT = 9
ROW_CNT = NULL
INSRT_SRC_NM = INFO_FLOW_STATS.LOG_INFO_FLOW_CMPNT
LAST_UPDT_DTM = NULL
LAST_UPDT_SRC_NM = NULL

-- ggsci
edit params RDSRM1
HANDLECOLLISIONS

-- lxoraodsm02
set long 40
col table_name format a30
col constraint_name format a30
col column_name format a30
col R_OWNER format a30
col R_CONSTRAINT_NAME format a30
select dc.table_name, col.column_name, dc.constraint_type, dc.status, dc.R_OWNER, dc.R_CONSTRAINT_NAME
from dba_constraints dc join dba_cons_columns col
  on dc.constraint_name = col.constraint_name
where dc.constraint_name='&what_constraint'
order by dc.constraint_type desc, dc.constraint_name asc;
TABLE_NAME                     COLUMN_NAME                    C STATUS   R_OWNER                        R_CONSTRAINT_NAME
------------------------------ ------------------------------ - -------- ------------------------------ ------------------------------
INFO_FLOW_CMPNT_STATS          INFO_FLOW_STATS_ID             R ENABLED  CURE_METADATA                  INFO_FLOW_STATS_PK

TABLE_NAME                     COLUMN_NAME                    C STATUS   R_OWNER                        R_CONSTRAINT_NAME
------------------------------ ------------------------------ - -------- ------------------------------ ------------------------------
INFO_FLOW_STATS                INFO_FLOW_STATS_ID             P ENABLED

-- uxoram01
select * from CURE_METADATA.INFO_FLOW_STATS
where INFO_FLOW_STATS_ID=117696;
INFO_FLOW_STATS_ID=117696
INF_FLDR_NM='EDM_CURe_Project'
INF_WRKFLW_NM='wf_CONTRIB_BLC_ISSUE_PARTY'
INF_WRKFLW_RUN_ID=3922107
INF_SESSN_NM='s_m_PEL_OBJ_ATTR_VAL'
INFO_SYS_ID=41
SRC_TBL_NM='CURE_QUEUE.CCF_BLC_ISSUE_PARTY'
PEL_TBL_NM='CURE_QUEUE.PEL_BLC_ISSUE_PARTY'
TGT_TBL_NM='CURE_CORE.PTY_OBJ_ATTR_VAL'
INFO_FLOW_STRT_DTM=to_date('12/15/2017','MM/DD/YYYY')
INFO_FLOW_END_DTM=to_date('12/15/2017','MM/DD/YYYY')
INFO_FLOW_DUR_SECND_CNT=341
INSRT_DTM=to_date('12/15/2017','MM/DD/YYYY')
INSRT_SRC_NM='INFO_FLOW_STATS.LOG_INFO_FLOW_START'
LAST_UPDT_DTM=to_date('12/15/2017','MM/DD/YYYY')
LAST_UPDT_SRC_NM='INFO_FLOW_STATS.LOG_INFO_FLOW_END'

-- lxoraodsm02
insert into CURE_METADATA.INFO_FLOW_STATS
(INFO_FLOW_STATS_ID, INF_FLDR_NM, INF_WRKFLW_NM, INF_WRKFLW_RUN_ID, INF_SESSN_NM, INFO_SYS_ID, SRC_TBL_NM, PEL_TBL_NM, TGT_TBL_NM, INFO_FLOW_STRT_DTM, INFO_FLOW_END_DTM, INFO_FLOW_DUR_SECND_CNT, INSRT_DTM, INSRT_SRC_NM, LAST_UPDT_DTM, LAST_UPDT_SRC_NM)
values
(117696,'EDM_CURe_Project','wf_CONTRIB_BLC_ISSUE_PARTY',3922107,'s_m_PEL_OBJ_ATTR_VAL',41,'CURE_QUEUE.CCF_BLC_ISSUE_PARTY','CURE_QUEUE.PEL_BLC_ISSUE_PARTY',
'CURE_CORE.PTY_OBJ_ATTR_VAL',to_date('12/15/2017','MM/DD/YYYY'),to_date('12/15/2017','MM/DD/YYYY'),341,to_date('12/15/2017','MM/DD/YYYY'),
'INFO_FLOW_STATS.LOG_INFO_FLOW_START',to_date('12/15/2017','MM/DD/YYYY'),'INFO_FLOW_STATS.LOG_INFO_FLOW_END');
commit;

REPLICAT   RDSRM1    Last Started 2017-12-16 13:31   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:02:21 ago)
Process ID           15504
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000000
                     2017-12-16 13:31:52.260883  RBA 441602777

REPLICAT   RDSRM1    Last Started 2017-12-16 13:31   Status ABENDED
INTEGRATED
Checkpoint Lag       35:00:40 (updated 02:23:34 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000007
                     2017-12-15 02:47:00.974958  RBA 670054115

2017-12-16 13:51:27  WARNING OGG-01154  SQL error 2291 mapping CURE_METADATA.INFO_FLOW_CMPNT_STATS to DSRM.CURE_METADATA.INFO_FLOW_CMPNT_STATS OCI Error
ORA-02291: integrity constraint (CURE_METADATA.SYS_C0013880) violated - parent key not found (status = 2291), SQL <INSERT INTO "CURE_METADATA"."INFO_FLOW
_CMPNT_STATS" ("INFO_FLOW_CMPNT_STATS_ID","INFO_FLOW_STATS_ID","CMPNT_NM","STRT_DTM","END_DTM","DUR_SECNDS_CNT","ROW_CNT","INSRT_DTM","INSRT_SRC_NM","LAS
T_UPDT_DTM","LAST_UPDT_SRC_NM") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10)>.

-- ggsci
edit params RDSRM1
MAPEXCLUDE CURE_METADATA.INFO_FLOW_CMPNT_STATS

-- last trail file
-rw-r-----. 1 oracle dba 972969179 Dec 16 05:23 ra000000505

REPLICAT   RDSRM1    Last Started 2017-12-16 16:13   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:04 ago)
Process ID           24102
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000008
                     2017-12-16 16:14:48.402784  RBA 610068319

REPLICAT   RDSRM1    Last Started 2017-12-16 13:31   Status ABENDED
INTEGRATED
Checkpoint Lag       35:00:40 (updated 02:23:34 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000007
                     2017-12-15 02:47:00.974958  RBA 670054115

REPLICAT   RDSRM1    Last Started 2017-12-16 16:13   Status RUNNING
INTEGRATED
Checkpoint Lag       41:49:04 (updated 00:32:31 ago)
Process ID           24102
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000009
                     2017-12-15 03:33:37.891899  RBA 360574980


############
# dsrm     #
# uxoram01 #
# 12/20    #
############

-- during script
ORA-31693: Table data object "CURE_CORE"."PTY_OBJ_ATTR_VAL":"SYS_P4020"."SYS_SUBP9617" failed to load/unload and is being skipped due to error:
ORA-02354: error in exporting/importing data
ORA-01466: unable to read data - table definition has changed

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm.log | grep ORA-31693 | sort > /oragg/datapump/dsrm/ora31693_dsrm_dec20.txt
cp /oragg/datapump/dsrm/expdp_dsrm.par /oragg/datapump/dsrm/dsrm_tables.par
(10 tables)

-- exclude from replicat (uxoram01)
cd /move/dsrm_adm01/scripts
cp RDSRM1.prm RDSRM1.prm.orig
mv Linux_setup_dsrm.tar Linux_setup_dsrm.tar.orig
vi RDSRM1.prm
(add MAPEXCLUDE for failed tables)

tar -cvf Linux_setup_dsrm.tar *dsrm* RDSRM1.prm
scp Linux_setup_dsrm.tar lxoggm01:/tmp


############
# dsrm     #
# RDSRM1   #
# 12/20    #
############

REPLICAT   RDSRM1    Last Started 2017-12-20 11:31   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:01:14 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000000
                     2017-12-20 11:31:57.913930  RBA 2026

2017-12-20 11:32:08  WARNING OGG-01154  SQL error 6550 mapping CURE_QUEUE.SEQ_CURE_QUEUE_ID to DSRM.CURE_QUEUE.SEQ_CURE_QUEUE_ID.
(started before import finished; sequence script not run yet)

-- lxoraodsm02
alter session set container=dsrm;
@sequence.sql

REPLICAT   RDSRM1    Last Started 2017-12-20 11:40   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:02 ago)
Process ID           28929
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000000
                     2017-12-20 11:40:43.497097  RBA 5678

-- 13:15
REPLICAT   RDSRM1    Last Started 2017-12-20 11:40   Status RUNNING
INTEGRATED
Checkpoint Lag       17:05:48 (updated 00:10:16 ago)
Process ID           28929
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000122
                     2017-12-19 19:59:06.621373  RBA 36526575


############
# dsrm     #
# PDSRM1   #
# 12/22    #
############

EXTRACT    PDSRM1    Last Started 2017-12-22 07:07   Status ABENDED
Checkpoint Lag       00:00:00 (updated 03:53:32 ago)
Log Read Checkpoint  File /move/dsrm01/trail/ea000001099
                     2017-12-21 16:51:50.000000  RBA 551235550

/oraggrep on LXOGGM01 is full


############
# dsrm     #
# PDSRM1   #
# 12/24    #
############

EXTRACT    PDSRM1    Last Started 2017-12-23 14:07   Status ABENDED
Checkpoint Lag       53:22:38 (updated 13:17:35 ago)
Log Read Checkpoint  File /move/dsrm01/trail/ea000001063
                     2017-12-21 15:15:40.000000  RBA 117525737

> df -h /oraggrep
Filesystem                          Size  Used Avail Use% Mounted on
/dev/mapper/oraggrepvg-oraggrep_lv  1.0T  1.0T   20K 100% /oraggrep

> df -h /oraggrep
Filesystem                          Size  Used Avail Use% Mounted on
/dev/mapper/oraggrepvg-oraggrep_lv  1.0T   93G  932G   9% /oraggrep

-- 12/26
> df -h /oraggrep
Filesystem                          Size  Used Avail Use% Mounted on
/dev/mapper/oraggrepvg-oraggrep_lv  1.0T  943G   81G  93% /oraggrep
(oracle@LXOGGM01:none-/oraggrep/dsrm)>

-- added purge to replicat mgr
> df -h /oraggrep
Filesystem                          Size  Used Avail Use% Mounted on
/dev/mapper/oraggrepvg-oraggrep_lv  1.0T  574G  450G  57% /oraggrep



############
# dsrm     #
# uxoram01 #
# 12/25    #
############

-- during script
ORA-31693: Table data object "CURE_CORE"."PTY_OBJ_ATTR_VAL":"SYS_P4020"."SYS_SUBP9617" failed to load/unload and is being skipped due to error:
ORA-02354: error in exporting/importing data
ORA-01466: unable to read data - table definition has changed

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm.log | grep ORA-31693 | sort > /oragg/datapump/dsrm/ora31693_dsrm_dec25.txt
(24 tables)

-- exclude from replicat (uxoram01)
cd /move/dsrm_adm01/scripts
cp RDSRM1.prm RDSRM1.prm.orig
mv Linux_setup_dsrm.tar Linux_setup_dsrm.tar.orig
vi RDSRM1.prm
(add MAPEXCLUDE for failed tables)
(add BATCHSQL)
( add PURGEOLDEXTRACTS)

tar -cvf Linux_setup_dsrm.tar *dsrm* RDSRM1.prm
scp Linux_setup_dsrm.tar lxoggm01:/tmp


############
# dsrm     #
# RDSRM1   #
# 1/8      #
############

2018-01-08 19:52:53  ERROR   OGG-00446  Checkpoint table ggs.ggs_checkpoint does not exist. Create this table with the ADD CHECKPOINTTABLE command in GGSCI.

-- ggsci
dblogin userid ggs@dsrm
add checkpointtable ggs.ggs_checkpoint
ORA-00955: name is already used by an existing object 

dblogin userid ggs@cdsrm
ORA-12154: TNS:could not resolve the connect identifier specified.

start RDSRM1

REPLICAT   RDSRM1    Last Started 2018-01-08 20:02   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:01:10 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000000
                     First Record  RBA 0

2018-01-08 20:02:27  WARNING OGG-01154  SQL error 1 mapping CURE_CORE.RLTSHP_PTY_POC to DSRM.CURE_CORE.RLTSHP_PTY_POC OCI Error ORA-00001: unique constra
int (CURE_CORE.RLTSHP_PTY_POC_PK) violated (status = 1), SQL <INSERT INTO "CURE_CORE"."RLTSHP_PTY_POC" ("OBJ_ID","SUBJ_OBJ_ID","RLTD_SUBJ_OBJ_ID","SUBJ_A
REA_ID","RLTD_SUBJ_AREA_ID","RLTSHP_TYP_ID","INFO_SYS_ID","EFF_FROM_DT","EFF_TO_DT","INSRT_DTM","INSRT_SRC_NM","LAST_UPDT_DTM","LAST_UPDT_SRC_NM") VALUES
 (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10,:a11,:a12)>.

select count(*) from CURE_CORE.RLTSHP_PTY_POC;
AIX		252,236,757
Linux	252,230,819

-- AIX
OWNER                CONSTRAINT_NAME                COLUMN_NAME                    C STATUS
-------------------- ------------------------------ ------------------------------ - --------
CURE_CORE            RLTSHP_PTY_POC_PK              OBJ_ID                         P ENABLED
CURE_CORE            SYS_C0033190                   OBJ_ID                         C ENABLED

-- Linux
OWNER                CONSTRAINT_NAME                COLUMN_NAME                    C STATUS
-------------------- ------------------------------ ------------------------------ - --------
CURE_CORE            RLTSHP_PTY_POC_PK              OBJ_ID                         P ENABLED
CURE_CORE            SYS_C0011183                   OBJ_ID                         C ENABLED

-- ./dirrpt/RDSRM1.dsc
OBJ_ID = 113258386100
SUBJ_OBJ_ID = 113258360695
RLTD_SUBJ_OBJ_ID = 113258363961
SUBJ_AREA_ID = 7
RLTD_SUBJ_AREA_ID = 6
RLTSHP_TYP_ID = 49
INFO_SYS_ID = 20
EFF_FROM_DT = 2018-01-06 16:15:51
EFF_TO_DT = NULL
INSRT_DTM = 2018-01-06 16:15:51
INSRT_SRC_NM = m_RELAT
LAST_UPDT_DTM = NULL
LAST_UPDT_SRC_NM = NULL

select count(*) from CURE_CORE.RLTSHP_PTY_POC where OBJ_ID = 113258386100;
AIX		1
Linux	1

-- Linux
delete from CURE_CORE.RLTSHP_PTY_POC where OBJ_ID = 113258386100;
commit;

2018-01-08 20:12:41  WARNING OGG-01154  SQL error 1 mapping CURE_CORE.RLTSHP_PTY_POC to DSRM.CURE_CORE.RLTSHP_PTY_POC OCI Error ORA-00001: unique constra
int (CURE_CORE.RLTSHP_PTY_POC_PK) violated (status = 1), SQL <INSERT INTO "CURE_CORE"."RLTSHP_PTY_POC" ("OBJ_ID","SUBJ_OBJ_ID","RLTD_SUBJ_OBJ_ID","SUBJ_A
REA_ID","RLTD_SUBJ_AREA_ID","RLTSHP_TYP_ID","INFO_SYS_ID","EFF_FROM_DT","EFF_TO_DT","INSRT_DTM","INSRT_SRC_NM","LAST_UPDT_DTM","LAST_UPDT_SRC_NM") VALUES
 (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10,:a11,:a12)>.

-- edit params RDSRM1 
MAPEXCLUDE CURE_CORE.RLTSHP_PTY_POC

2018-01-08 20:17:01  WARNING OGG-01154  SQL error 1 mapping CURE_QUEUE.CCF_V1T_APP_PTY_APP_CVG to DSRM.CURE_QUEUE.CCF_V1T_APP_PTY_APP_CVG OCI Error ORA-0
0001: unique constraint (CURE_QUEUE.CCF_V1T_APP_PTY_APP_CVG_PK) violated (status = 1), SQL <INSERT INTO "CURE_QUEUE"."CCF_V1T_APP_PTY_APP_CVG" ("CCF_ID",
"ADMIN_SYSTM_NAME","SBJCT_AREA_NAME","OBJCT_ID","SOURC_BUSNS_KEY","ATTRB_NAME","ATTRB_VALUE","VALID_VALUE_IND","KEY_HASH","VALUE_HASH","INSRT_SOURC","INS
RT_TIMESTAMP") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10,:a11)>.

-- edit params RDSRM1 
MAPEXCLUDE CURE_QUEUE.CCF_V1T_APP_PTY_APP_CVG

2018-01-08 22:20:21  WARNING OGG-01154  SQL error 1 mapping CURE_CORE.APP_PTY_APP_CVG to DSRM.CURE_CORE.APP_PTY_APP_CVG OCI Error ORA-00001: unique const
raint (CURE_CORE.APP_PTY_APP_CVG_PK) violated (status = 1), SQL <INSERT INTO "CURE_CORE"."APP_PTY_APP_CVG" ("OBJ_ID","SUBJ_OBJ_ID","RLTD_SUBJ_OBJ_ID","SU
BJ_AREA_ID","RLTD_SUBJ_AREA_ID","RLTSHP_TYP_ID","INFO_SYS_ID","EFF_FROM_DT","EFF_TO_DT","INSRT_DTM","INSRT_SRC_NM","LAST_UPDT_DTM","LAST_UPDT_SRC_NM") VA
LUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10,:a11,:a12)>.

OWNER                CONSTRAINT_NAME                COLUMN_NAME                    C STATUS
-------------------- ------------------------------ ------------------------------ - --------
CURE_CORE            APP_PTY_APP_CVG_PK             OBJ_ID                         P ENABLED
CURE_CORE            SYS_C0012058                   OBJ_ID                         C ENABLED

-- ./dirrpt/RDSRM1.dsc
OBJ_ID = 113258388899
OBJ_ID = 113258388900

delete from CURE_CORE.APP_PTY_APP_CVG where OBJ_ID = 113258388899;
delete from CURE_CORE.APP_PTY_APP_CVG where OBJ_ID = 113258388900;

-- expdp Jan 7 09:27:24 2018
-- /oraggrep
-rw-r-----. 1 oracle dba 999999784 Jan  6 23:43 ra000000159
-rw-r-----. 1 oracle dba 999999717 Jan  7 00:21 ra000000160
-rw-r-----. 1 oracle dba 999999861 Jan  7 00:23 ra000000161
-rw-r-----. 1 oracle dba 999999764 Jan  7 00:24 ra000000162
-rw-r-----. 1 oracle dba 999999856 Jan  7 00:30 ra000000163
-rw-r-----. 1 oracle dba 999999893 Jan  7 13:18 ra000000164

alter replicat rdsrm1 extseqno 159 extrba 0
start replicat RDSRM1 aftercsn 10952250681553

REPLICAT   RDSRM1    Last Started 2018-01-08 22:43   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:01 ago)
Process ID           23617
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000159
                     2018-01-08 22:43:56.635824  RBA 906886004

REPLICAT   RDSRM1    Last Started 2018-01-08 22:43   Status RUNNING
INTEGRATED
Checkpoint Lag       27:08:38 (updated 00:00:43 ago)
Process ID           23617
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/ra000000183
                     2018-01-07 19:39:48.267944  RBA 136676127




############
# dsrm     #
# uxoram01 #
# 1/7      #
############

-- during script
ORA-31693: Table data object "CURE_CORE"."PTY_OBJ_ATTR_VAL":"SYS_P4020"."SYS_SUBP9617" failed to load/unload and is being skipped due to error:
ORA-02354: error in exporting/importing data
ORA-01466: unable to read data - table definition has changed

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm.log | grep ORA-31693 | sort > /oragg/datapump/dsrm/ora31693_dsrm_jan07.txt
( tables)

-- exclude from replicat (uxoram01)
cd /move/dsrm_adm01/scripts
cp RDSRM1.prm RDSRM1.prm.orig
mv Linux_setup_dsrm.tar Linux_setup_dsrm.tar.orig
vi RDSRM1.prm
(add MAPEXCLUDE for failed tables)

tar -cvf Linux_setup_dsrm.tar *dsrm* RDSRM1.prm
scp Linux_setup_dsrm.tar lxoggm01:/tmp

-- edit dsrm_tables.par


############
# dsrm     #
# uxoram01 #
# 1/15     #
############

-- during script
ORA-31693: Table data object "CURE_CORE"."PTY_OBJ_ATTR_VAL":"SYS_P4020"."SYS_SUBP9617" failed to load/unload and is being skipped due to error:
ORA-02354: error in exporting/importing data
ORA-01466: unable to read data - table definition has changed

-- get list of all errors
cat /oragg/datapump/dsrm/dsrm.log | grep ORA-31693 | sort > /oragg/datapump/dsrm/ora31693_dsrm_jan15.txt
(73 tables)

-- exclude from extract
(add TABLEEXCLUDE for failed tables)

-- exclude from replicat (uxoram01)
cd /move/dsrm_adm01/scripts
cp RDSRM1.prm RDSRM1.prm.orig
mv Linux_setup_dsrm.tar Linux_setup_dsrm.tar.orig
vi RDSRM1.prm
(add MAPEXCLUDE for failed tables)

tar -cvf Linux_setup_dsrm.tar *dsrm* RDSRM1.prm
scp Linux_setup_dsrm.tar lxoggm01:/tmp


############
# dsrm     #
# cleanup  #
# 1/18     #
############

*** during Linux build ***
ORA-01920: user name 'IDMUNX' conflicts with another user or role name

(results from role/priv query on both sides)
2395 rows selected

*** public grants ***
grant EXECUTE on SYS.DBMS_ASH_INTERNAL to public;
grant EXECUTE on SYS.DBMS_OFFLINE_RGT to public;
grant EXECUTE on SYS.DBMS_REPUTIL to public;
grant EXECUTE on SYS.DBMS_REPUTIL2 to public;
grant EXECUTE on XDB.DBMS_XDBREPOS to public;
grant USE on SYS.ORA$BASE to public;
ORA-00942: table or view does not exist

*** database links ***
-- AIX
Link ORA_DSGM_DBL owned by OPS$ORACLE is broken!
Link ORA_DSGD_DBL owned by OPS$ORACLE is broken!
DSGP_DBL is working
Link ORA_DSGP_DBL owned by OPS$ORACLE is broken!
DSGD_DBL is working
DBLNK_OSCR_DSR is working

-- Linux
Public link DBLNK_OSCR_DSR needs to be fixed!
Public link DSGP_DBL needs to be fixed!
Public link DSGD_DBL needs to be fixed!

PUBLIC
DBLNK_OSCR_DSR
SLSFR
(DESCRIPTION = (ADDRESS_LIST = (ADDRESS= (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = oscrm-pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = oscrm)))

PUBLIC
DSGD_DBL
(DESCRIPTION = (ADDRESS_LIST = (ADDRESS= (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = dsgd_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = dsgd)))

PUBLIC
DSGP_DBL
(DESCRIPTION = (ADDRESS_LIST = (ADDRESS= (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = dsgp_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = dsgp)))

-- as system
SQL> select sysdate from dual@DBLNK_OSCR_DSR;
SYSDATE
----------
01/18/2018

SQL> select sysdate from dual@DSGD_DBL;
SYSDATE
----------
01/18/2018

SQL> select sysdate from dual@DSGP_DBL;
SYSDATE
----------
01/18/2018

(errors during GGRR_2 script)
NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
global_names                         boolean     TRUE

alter system set global_names=FALSE scope=both;


-- post_build_check_12c.sql
CON_ID OWNER                          TABLE_NAME                     TABLESPACE_NAME
------ ------------------------------ ------------------------------ ------------------------------
     1 SQLTUNE                        SQL_TUNE_STAGING               SYSTEM
     1 SQLTUNE                        SQL_TUNE_TASK_STAGING          SYSTEM
     1 SYSTEM                         SQL_TUNE_STAGING               SYSTEM
     1 SYSTEM                         SQL_TUNE_TASK_STAGING          SYSTEM
     3 SQLTUNE                        SQL_TUNE_STAGING               USERS
     3 SQLTUNE                        SQL_TUNE_TASK_STAGING          USERS

alter user sqltune set container_data=all container=current;

-- profiles
ALTER PROFILE APP_PROFILE LIMIT LOGICAL_READS_PER_CALL DEFAULT
BEGIN
*
ERROR at line 1:
ORA-65066: The specified changes must apply to all containers

col LIMIT format a20
col PROFILE format a12
col "C" format 90
set lines 150 pages 200
select CON_ID "C", PROFILE, RESOURCE_NAME, LIMIT, COMMON "CMN"
from cdb_profiles
where profile in ('DEFAULT','APP_PROFILE','CNO_PROFILE')
order by 1,2,3;



/*--- cutover tasks ---*/

*** drop temp indexes ***
dsrm_all_add_pk.sql (used to create them)

-- AIX
set lines 1000 pages 0
set echo off
set trimspool on
spool /move/dsrm_adm01/scripts/dsrm_all_drop_pk.sql
select 'ALTER TABLE '||owner||'.'||table_name||' DROP CONSTRAINT '||table_name||'_PK;' from dba_tab_cols
where column_name='OBJ_ATTR_VAL_ID' and (owner, table_name) not in (
	select d2.owner, d2.table_name
	from dba_constraints d2
	where d2.constraint_type in ('P','U')
	and d2.owner in ('AIM_RM','AIM_RM_P','AIM_RM_PT','CLIENT','CURE_CORE','CURE_METADATA','CURE_QUEUE','CURE_REF','CURE_SUBSCRPT','DNC','ENTPRS_REF_LIB','INF_USER')
) order by 1;

select 'DROP INDEX '||owner||'.'||table_name||'_PK;' from dba_tab_cols
where column_name='OBJ_ATTR_VAL_ID' and (owner, table_name) not in (
	select d2.owner, d2.table_name
	from dba_constraints d2
	where d2.constraint_type in ('P','U')
	and d2.owner in ('AIM_RM','AIM_RM_P','AIM_RM_PT','CLIENT','CURE_CORE','CURE_METADATA','CURE_QUEUE','CURE_REF','CURE_SUBSCRPT','DNC','ENTPRS_REF_LIB','INF_USER')
) order by 1;
spool off

scp /move/dsrm_adm01/scripts/dsrm_all_drop_pk.sql LXORAODSM02:/database/cdsrm_admn01/scripts

-- Linux
@/database/cdsrm_admn01/scripts/dsrm_all_drop_pk.sql

break on table_name
select table_name, index_name, uniqueness, status, ORPHANED_ENTRIES from dba_indexes where owner='CURE_QUEUE' order by 1,2;

*** index job ***
REBUILD_PK_INDEX_JOB
REBUILD_PART_INDEX_JOB

exec DBMS_SCHEDULER.DROP_JOB ('REBUILD_PK_INDEX_JOB');
exec DBMS_SCHEDULER.DROP_JOB ('REBUILD_PART_INDEX_JOB');

exec DBMS_SCHEDULER.DROP_PROGRAM ('REBUILD_PK_INDEX_PROG');
exec DBMS_SCHEDULER.DROP_PROGRAM ('REBUILD_PART_INDEX_PROG');

exec DBMS_SCHEDULER.DROP_SCHEDULE ('REBUILD_PK_INDEX_SCHED');
exec DBMS_SCHEDULER.DROP_SCHEDULE ('REBUILD_PART_INDEX_SCHED');

*** 3 replicats ***
(added to GGRR2 script)

*** fix excluded sequences ***
MAPEXCLUDE CURE_CORE.OBJ_ID_SEQ



*** change enable DDL ***
alter system set enable_ddl_logging=false;


##########
# dsgp   #
# PDSGP1 #
# 1/18   #
##########

2018-01-18 21:20:26  WARNING OGG-06591  Reading the output trail file /app/oracle/product/ggate/12c/1/dirdat/dsgp/ra000000 encounters an error from posit
ion 0, rescan from the file header to recover.
2018-01-18 21:20:26  ERROR   OGG-01031  There is a problem in network communication, a remote file problem, encryption keys for target and source do not
match (if using ENCRYPT) or an unknown error. (Reply received is Failed resolving output file /app/oracle/product/ggate/12c/1/dirdat/dsgp/ra000000 (error
: 2, No such file or directory)).

-- lxoggp01
mkdir dsgp
mkdir cauimp
mkdir caapmp
mkdir idmp


##########
# dsgp   #
# PDSGP2 #
# 1/19   #
##########

EXTRACT    PDSRM2    Last Started 2018-01-19 10:35   Status ABENDED
Checkpoint Lag       00:00:00 (updated 12:56:26 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/dsrm/RR/ea000000012
                     2018-01-18 21:48:41.307760  RBA 1512

2018-01-19 10:35:26  ERROR   OGG-01224  TCP/IP error 111 (Connection refused), endpoint: lxoggm01:7819.

-- ggserr.log
2018-01-18 21:50:03  WARNING OGG-01223  Oracle GoldenGate Capture for Oracle, PDSRM2.prm:  TCP/IP error 32 (Broken pipe), endpoint: lxoggm01:7820.
2018-01-18 21:50:39  WARNING OGG-01223  Oracle GoldenGate Capture for Oracle, PDSRM2.prm:  TCP/IP error 111 (Connection refused), endpoint: lxoggm01:7820.
2018-01-18 21:52:20  ERROR   OGG-01224  Oracle GoldenGate Capture for Oracle, PDSRM2.prm:  TCP/IP error 111 (Connection refused), endpoint: lxoggm01:7820; retries exceeded.
2018-01-19 10:32:10  ERROR   OGG-01224  Oracle GoldenGate Capture for Oracle, PDSRM2.prm:  TCP/IP error 111 (Connection refused), endpoint: lxoggm01:7819.
2018-01-19 10:35:26  ERROR   OGG-01224  Oracle GoldenGate Capture for Oracle, PDSRM2.prm:  TCP/IP error 111 (Connection refused), endpoint: lxoggm01:7819.

-- param file
-- Use RMTHOST to identify a remote system and the TCP/IP port number on that system where the Manager process is running.
RMTHOST lxoggm01, MGRPORT 7819, TCPBUFSIZE 1000000, TCPFLUSHBYTES 1000000
-- Use RMTTRAIL to specify a remote trail that was created with the ADD RMTTRAIL command in GGSCI.
RMTTRAIL /app/oracle/product/ggate/12c/1/dirdat/dsrm/RR/ra

-- mgr param file
--TCPIP port on which manager listens
port 7819
--Dynamic range of ports that Manager can allocate
DYNAMICPORTLIST  7820-7870

ALTER EXTTRAIL /database/dsrm01/trail/ea, EXTRACT PDSRM2


##########
# dsgp   #
# EDSGP2 #
# 1/19   #
##########

EXTRACT    EDSRM2    Last Started 2018-01-19 10:32   Status ABENDED
Checkpoint Lag       16:24:45 (updated 00:06:43 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-01-18 18:14:07
                     SCN 2550.502723391 (10952669328191)

start EDSRM2

-- 11:06
EXTRACT    EDSRM2    Last Started 2018-01-19 10:57   Status ABENDED
Checkpoint Lag       16:50:00 (updated 00:01:48 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-01-18 18:14:07
                     SCN 2550.502723391 (10952669328191)

-- lxoraodsm02
mkdir /database/dsrm01/dirtmp
mkdir /database/dsrm01/trail

-- edit params
TRANLOGOPTIONS INTEGRATEDPARAMS (max_sga_size 3500, PARALLELISM 3)
TRANLOGOPTIONS _READAHEADCOUNT 30
TRANLOGOPTIONS ASYNCTRANSPROCESSING 600
CACHEMGR CACHESIZE 8GB, CACHEDIRECTORY /database/dsrm01/dirtmp 200GB
ExtTrail /database/dsrm01/trail/ea

2018-01-19 11:14:24  ERROR   OGG-01044  The trail '/database/dsrm01/trail/ea' is not assigned to extract 'EDSRM2'. Assign the trail to the extract with the command "
ADD EXTTRAIL/RMTTRAIL /database/dsrm01/trail/ea, EXTRACT EDSRM2".

ADD EXTTRAIL /database/dsrm01/trail/ea, EXTRACT EDSRM2

-- edit mgr params
PURGEOLDEXTRACTS /database/dsrm01/trail/*, MINKEEPHOURS 12, USECHECKPOINTS

-- 12:14
EXTRACT    EDSRM2    Last Started 2018-01-19 11:16   Status RUNNING
Checkpoint Lag       00:00:10 (updated 00:00:04 ago)
Process ID           14644
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-01-19 12:14:31
                     SCN 2550.504125044 (10952670729844)


###############
# dsrm        #
# performance #
# 1/19        #
###############

-- alert log
2018-01-19 10:40:04.305000 -05:00
WARNING: Heavy swapping observed on system in last 5 mins.
pct of memory swapped in [2.54%] pct of memory swapped out [25.41%].
Please make sure there is no memory pressure and the SGA and PGA
are configured correctly. Look at DBRM trace file for more details.
Errors in file /database/cdsrm_admn01/admin/diag/rdbms/cdsrm/cdsrm/trace/cdsrm_dbrm_2845.trc  (incident=64081) (PDBNAME=CDB$ROOT):


##########
# dsrm   #
# EDSRM2 #
# 1/20   #
##########

EXTRACT    EDSRM2    Last Started 2018-01-19 11:16   Status ABENDED
Checkpoint Lag       02:17:41 (updated 02:24:23 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-01-20 05:06:10
                     SCN 2550.506774516 (10952673379316)

> df -h
/dev/mapper/orahomevg-orahome_lv                                       50G   50G   20K 100% /app/oracle

> du -sm /app/oracle/product/ggate/12c/1/* | sort -n
30691   /app/oracle/product/ggate/12c/1/BR

> mkdir /database/dsrm01/BR
> cd /app/oracle/product/ggate/12c/1/BR
> mv * /database/dsrm01/BR

-- edit params EDSRM2
BR BRDIR /database/dsrm01/BR

-- not starting

select sequence# from v$archived_log where &what_scn between FIRST_CHANGE# and NEXT_CHANGE#-1;
 SEQUENCE#
----------
       687

> ll /database/cdsrm_arch01/arch
-rw-r-----. 1 oracle dba  915662336 Jan 20 14:34 arch1_828_965469829.dbf	-- oldest

> ll /database/dsrm01
-rw-------. 1 oracle dba   864092160 Jan 20 07:27 arch1_579_965469829.dbf	-- newest

> mkdir /database/dsrm01/arch

rman target / catalog rman@rman12m
run
{
 set archivelog destination to '/database/dsrm01/arch';
 restore archivelog from sequence 687;
}


##########
# dsrm   #
# 1/24   #
##########

-- BACKUP_CDSRM_UAT_HOT_ARCHIVELOG_GG
backup archivelog all not backed up;
delete noprompt archivelog all;

Repeat 30 Min
12:48 AM

-- BACKUP_CDSRM_UAT_HOT_ARCHIVELOG
show all;
report schema;
backup archivelog all not backed up delete all input;
delete noprompt force obsolete;
show all;
report schema;


###########
# dsrm    #
# 1/25-26 #
###########

-- listener alert log
19-JAN-2018 10:21:57 * (CONNECT_DATA=(CID=(PROGRAM=JDBC Thin Client)(HOST=__jdbc__)(USER=oracle))(SID=cdsrm)) * (ADDRESS=(PROTOCOL=tcp)(HOST=10.11.172.22)(PORT=9234)) * establish * cdsrm * 12505
19-JAN-2018 10:21:59 * (CONNECT_DATA=(SID=dsrm)(CID=(PROGRAM=JDBC Thin Client)(HOST=__jdbc__)(USER=wsadminm))) * (ADDRESS=(PROTOCOL=tcp)(HOST=10.11.192.75)(PORT=40798)) * establish * dsrm * 12505
TNS-12505: TNS:listener does not currently know of SID given in connect descriptor

> nslookup 10.11.172.22
22.172.11.10.in-addr.arpa       name = dsrm-pkg.conseco.com.

> nslookup 10.11.192.75
75.192.11.10.in-addr.arpa       name = lxwas85m03.conseco.com

-- cdsrm missing from master tnsnames.ora file

-- from VDI (missing cdsrm from tnsnames)
sqlplus ggs@dsrm
*good*

sqlplus ggs@cdsrm
ORA-12154: TNS:could not resolve the connect identifier specified

sqlplus ggs/M00nl1ght@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=dsrm-pkg.conseco.com)(PORT=1521))(CONNECT_DATA=(SID=dsrm)))
*good*

sqlplus ggs/M00nl1ght@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=dsrm-pkg.conseco.com)(PORT=1521))(CONNECT_DATA=(SID=cdsrm)))
*good*

-- alert log
Fatal NI connect error 12537, connecting to:
 (LOCAL=NO)

  VERSION INFORMATION:
TNS for Linux: Version 12.1.0.2.0 - Production
Oracle Bequeath NT Protocol Adapter for Linux: Version 12.1.0.2.0 - Production
TCP/IP NT Protocol Adapter for Linux: Version 12.1.0.2.0 - Production
  Time: 23-JAN-2018 03:20:38
  Tracing not turned on.
  Tns error struct:
    ns main err code: 12537

TNS-12537: TNS:connection closed
    ns secondary err code: 12560
    nt main err code: 0
    nt secondary err code: 0
    nt OS err code: 0
opiodr aborting process unknown ospid (113758) as a result of ORA-609
2018-01-23 03:21:08.793000 -05:00


-- Troubleshooting Guide for ORA-12537 / TNS-12537 TNS:Connection Closed (Doc ID 555609.1)
1. If the error is occurring on a remote oracle installation then verify the following: 
    a.) Is the connection attempted is going to the correct host and port on which the listener is running. 
$ nslookup < hostname >

    b.) Check whether the TCP.VALIDNODE_CHECKING is active on the database server. 
          If active then check whether IP address of the failing client is added in the TCP.INVITED_NODES list (located in the sqlnet.ora file). If not add the same. 

    c.) Check whether the database is running low on processes value or high water mark is reached by querying v$resource_limit.
col resource_name format a30
col LIMIT_VALUE format a15
select RESOURCE_NAME, MAX_UTILIZATION, LIMIT_VALUE from v$resource_limit order by 1;


-- 11g and Newer: ORA-609 TNS-12537 and TNS-12547 or TNS-12170 in DB Alert.log (Doc ID 1116960.1)
CHANGES
If this database has been in operation for a while, it is possible this error has arisen when an increase in the number of connections or workload has increased.

CAUSE
The ORA-609 error is thrown when a client connection of any kind failed to complete or aborted the connection process before the connection/authentication process was complete. 
Very often, this connection abort is due to a timeout.  Beginning with 10gR2, a default value for inbound connect timeout has been set at 60 seconds.  This time limit is often inadequate for the entire connection process to complete.    
When the error is intermittent, it is usually not indicative of a critical problem. It simply means that the server process was timed out before the entire connection process was complete.
If there is no DB Performance issue present and the error is not flooding the alert log, the solution posted to this document would be applicable.

SOLUTION
Try this first!
The simplest solution to this problem is to increase the setting for INBOUND CONNECT TIMEOUT at the server (database) sqlnet.ora.
The default setting for the SQLNET.INBOUND_CONNECT_TIMEOUT parameter is 60 seconds.   When an intermittent ORA-609
is occurring, we generally recommend increasing the setting to 120.
There is NO need to restart either the database or the listener after this change has been made.

Often we find that the 609 is caused by a client that drops the connection before it's completed at the database.  This is especially
true with JDBC thin where an "outbound" connection timer might be in place.


############
# cauimp   #
# ECAUIMP1 #
# 1/27     #
############

EXTRACT    ECAUIMP1  Last Started 2018-01-23 12:13   Status STOPPED
Checkpoint Lag       00:00:01 (updated 30:14:08 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-01-26 12:16:24
                     SCN 2550.1077526267 (10953244131067)

2018-01-27 18:34:34  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File NA, THREAD 1, SEQUENCE 299791, SCN 0x000009f64039bed3. Read Position SCN: 2550.1077526267 (10953244131067)).

> ll /move/cauimp_arch01/arch
-rw-r-----    1 oracle   dba        43904000 Jan 27 18:35 cauimp_arch1_300196_903691419.dbf

mkdir /oragg/arch
mkdir /oragg/arch/cauimp

rman target / catalog rman@rman11p
run
{
 set archivelog destination to '/oragg/arch/cauimp';
 restore archivelog from sequence 299791;
}

2018-01-27 18:51:55  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File NA, THREAD 1, SEQUENCE 299791, SCN 0x000009f64039bed3. Read Position SCN: 2550.1077526267 (10953244131067)).

> ll /oragg/arch/cauimp/*299791*
/oragg/arch/cauimp/*299791* not found


###############
# dsrm        #
# lxoraodsm02 #
# 1/29        #
###############

-- listener.ora (uxp34)
SECURE_REGISTER_LISTENER = (TCP)
INBOUND_CONNECT_TIMEOUT_LISTENER = 120			-- causes ORA-12525; default 60 seconds
SUBSCRIBE_FOR_NODE_DOWN_EVENT_LISTENER=OFF		-- subscribe to Oracle Notification Service (ONS) notifications for downed events; default ON

-- listener.ora (lxoraodsm02)
SECURE_REGISTER_LISTENER = (TCP)
USE_SID_AS_SERVICE_LISTENER=ON

-- sqlnet.ora (uxp34)
NAMES.DIRECTORY_PATH= (TNSNAMES, EZCONNECT)		-- EZCONNECT enables clients to use TCP/IP connect identifier
SSL_VERSION=1.0

-- sqlnet.ora (lxoraodsm02)
NAMES.DIRECTORY_PATH= (TNSNAMES)
SSL_VERSION=1.0
SQLNET.INBOUND_CONNECT_TIMEOUT=120

/*--- memory advisor ---*/
select dbid, max(snap_id) from DBA_HIST_SGA_TARGET_ADVICE group by dbid;
      DBID MAX(SNAP_ID)
---------- ------------
1700291308         2193
1831835203          313

col "SNAP" format a13
WITH mx AS
	-- most recent snapshot
	(select max(a.SNAP_ID) "MAX_SNAP" 
	 from DBA_HIST_SGA_TARGET_ADVICE a, v$database db
	 where a.dbid=db.dbid),
alloc AS
	-- SGA size at most recent snapshot
	(select b.SGA_SIZE
	 from DBA_HIST_SGA_TARGET_ADVICE b, mx
	 where b.SNAP_ID=mx.MAX_SNAP and b.SGA_SIZE_FACTOR=1),
samesga AS
	-- DB time of snapshots with current SGA setting
	(select c.SNAP_ID, c.ESTD_DB_TIME
	 from DBA_HIST_SGA_TARGET_ADVICE c, alloc
	 where c.SGA_SIZE_FACTOR=1 and c.SGA_SIZE=alloc.SGA_SIZE),
btrsnps AS
	-- number of snapshots with 25% increase in SGA and 25% reduction in DB time
	(select d.SNAP_ID, d.ESTD_DB_TIME "BETR", samesga.ESTD_DB_TIME "CURT"
	 from DBA_HIST_SGA_TARGET_ADVICE d, samesga
	 where d.SGA_SIZE_FACTOR=1.25 and samesga.SNAP_ID=d.SNAP_ID
	 and (d.ESTD_DB_TIME/samesga.ESTD_DB_TIME) <= 0.75)
select to_char(hst.BEGIN_INTERVAL_TIME,'MM/DD HH24:MI') "SNAP", b.CURT, b.BETR, ROUND(b.BETR/b.CURT, 2) "IMPR"
from btrsnps b, DBA_HIST_SNAPSHOT hst
where b.SNAP_ID=hst.SNAP_ID
order by hst.BEGIN_INTERVAL_TIME;

select con_id, sga_size, sga_size_factor, estd_db_time, estd_physical_reads
from DBA_HIST_SGA_TARGET_ADVICE
where snap_id=
	(select max(a.SNAP_ID) "MAX_SNAP" 
	 from DBA_HIST_SGA_TARGET_ADVICE a, v$database db
	 where a.dbid=db.dbid)
order by 1,2;
    CON_ID   SGA_SIZE SGA_SIZE_FACTOR ESTD_DB_TIME ESTD_PHYSICAL_READS
---------- ---------- --------------- ------------ -------------------
         0      53248               1      8622157           684056753
         0      59904           1.125      8622157           678173865
         0      66560            1.25      8622157           678173865

select snap_id, sga_size, sga_size_factor, estd_db_time, estd_physical_reads
from DBA_HIST_SGA_TARGET_ADVICE
where snap_id=&what_snap
order by 1,2;

   SNAP_ID   SGA_SIZE SGA_SIZE_FACTOR ESTD_DB_TIME ESTD_PHYSICAL_READS
---------- ---------- --------------- ------------ -------------------
       300      53248               1      8398579           615536966
       300      59904           1.125      8398579           610181794

   SNAP_ID   SGA_SIZE SGA_SIZE_FACTOR ESTD_DB_TIME ESTD_PHYSICAL_READS
---------- ---------- --------------- ------------ -------------------
       292      53248               1      8367587           612219718
       292      59904           1.125      8367587           606832184
	   
select to_char(snp.BEGIN_INTERVAL_TIME,'MM/DD HH24:MI') "SNAP", adv.sga_size, adv.sga_size_factor, adv.estd_db_time, adv.estd_physical_reads
from DBA_HIST_SGA_TARGET_ADVICE adv, DBA_HIST_SNAPSHOT snp
where adv.snap_id=snp.snap_id
and snp.BEGIN_INTERVAL_TIME between to_timestamp('&what_start','YYYYMMDD HH24MI') and to_timestamp('&what_end','YYYYMMDD HH24MI')
order by 1,2;

SNAP            SGA_SIZE SGA_SIZE_FACTOR ESTD_DB_TIME ESTD_PHYSICAL_READS
------------- ---------- --------------- ------------ -------------------
01/29 13:00        53248               1      8388289           614374143
01/29 13:00        59904           1.125      8388289           609029088

SNAP            SGA_SIZE SGA_SIZE_FACTOR ESTD_DB_TIME ESTD_PHYSICAL_READS
------------- ---------- --------------- ------------ -------------------
01/29 05:00         6656            .125      8007345           608265234
01/29 05:00        13312             .25      9096589          1106556114
01/29 05:00        19968            .375      8626346           826997412
01/29 05:00        26624              .5      8475108           737217464
01/29 05:00        33280            .625      8349490           662522493
01/29 05:00        39936             .75      8308168           638070230
01/29 05:00        46592            .875      8283375           623289385
01/29 05:00        53248               1      8264367           608265234
01/29 05:00        59904           1.125      8264367           602790847


##########
# trmp   #
# RTRMP1 #
# 2/5    #
##########

REPLICAT   RTRMP1    Last Started 2018-02-05 14:20   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:23:43 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/trmp/ra000000000
                     2018-02-05 14:21:01.525223  RBA 17578367

-- report
2018-02-05 14:21:02  WARNING OGG-00869  Table TRMP.CCMTRADE.LOAN_CUSIP_PAR_TMP does not exist.
2018-02-05 14:21:02  ERROR   OGG-00199  Table TRMP.CCMTRADE.LOAN_CUSIP_PAR_TMP does not exist in target database.

-- DP export
. . exported "CCMTRADE"."LOAN_CUSIP_PAR_TMP"             65.63 KB    1741 rows

-- DP import
02/05/2018 13:19:17.871: . . imported "CCMTRADE"."LOAN_CUSIP_PAR_TMP"             65.63 KB    1741 rows in 0 seconds

-- data verification
TABLE                                             AIX        LINUX          DIFFERENCE
---------------------------------------- ------------ ------------ -------------------
CCMTRADE.LOAN_CUSIP_PAR_TMP                     1,779        1,741                 -38


############
# wstodsp  #
# RWS_DSP1 #
# 2/5      #
############

REPLICAT   RWS_DSP1  Last Started 2018-02-02 20:43   Status RUNNING
INTEGRATED
Checkpoint Lag       00:27:37 (updated 62:29:47 ago)
Process ID           27386
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/wstodsp/ra000000016
                     2018-02-03 03:29:46.334280  RBA 319727983

> sh ls -l /app/oracle/product/ggate/12c/1/dirdat/wstodsp/ra000000*
-rw-r-----. 1 oracle dba 999999748 Feb  3 03:39 /app/oracle/product/ggate/12c/1/dirdat/wstodsp/ra000000016
-rw-r-----. 1 oracle dba 978333776 Feb  3 03:40 /app/oracle/product/ggate/12c/1/dirdat/wstodsp/ra000000017

stop RWS_DSP1
start RWS_DSP1

2018-02-05 18:31:18  INFO    OGG-02232  Switching to next trail file /app/oracle/product/ggate/12c/1/dirdat/wstodsp/ra000000017 at 2018-02-05 18:31:18.79
9899 due to EOF. with current RBA 999999748.


##########
# trmp   #
# RTRMP1 #
# 2/6    #
##########

REPLICAT   RTRMP1    Last Started 2018-02-06 08:55   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:01:13 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/trmp/ra000000003
                     2018-02-06 08:55:10.124048  RBA 807972074

-- report
2018-02-06 08:55:10  ERROR   OGG-00199  Table TRMP.CCMTRADE.CT_STAGESC_SIL0700 does not exist in target database.

-- aix
set lines 1000 pages 1000
set long 10000000
COL "DDL"  FORMAT A1000
select DBMS_METADATA.GET_DDL('TABLE','CT_STAGESC_SIL0700','CCMTRADE') "DDL" from dual;
ORA-31603: object "CT_STAGESC_SIL0700" of type TABLE not found in schema "CCMTRADE"

-- edit params
MAPEXCLUDE CCMTRADE.CT_STAGESC_SIL0700

REPLICAT   RTRMP1    Last Started 2018-02-06 09:13   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           9120
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/trmp/ra000000003
                     2018-02-06 09:13:28.488257  RBA 810510674


##########
# prod   #
# import #
# 2/6    #
##########

-- ORA-02216: tablespace name expected
CREATE TABLESPACE 4086VCNTR DATAFILE '/database/prod01/oradata/4086VCNTR.dbf' SIZE 629145600 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M EXTENT MANAGEMENT LOCAL UNIFORM SIZE 1048576 SEGMENT SPACE MANAGEMENT AUTO
                  *
ERROR at line 1:
ORA-02216: tablespace name expected

vi /database/cprod_admn01/scripts/createts_prod.sql
CREATE TABLESPACE "4086VCNTR" DATAFILE '/database/prod01/oradata/4086VCNTR.dbf' SIZE 629145600 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M EXTENT MANAGEMENT LOCAL UNIFORM SIZE 1048576 SEGMENT SPACE MANAGEMENT AUTO;
ALTER TABLESPACE "4086VCNTR" ADD DATAFILE '/database/prod04/oradata/4086VCNTR2.dbf.dbf' SIZE 15938355200 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M ;


-- ORA-03214: File Size specified is smaller than minimum required
CREATE TABLESPACE USRTMP_ANDY DATAFILE '/database/prod03/oradata/USRTMP_ANDY2.dbf' SIZE 1048576 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M EXTENT MANAGEMENT LOCAL UNIFORM SIZE 1048576 SEGMENT SPACE MANAGEMENT AUTO
*
ERROR at line 1:
ORA-03214: File Size specified is smaller than minimum required

CREATE TABLESPACE USRTMP_ANDY DATAFILE '/database/prod03/oradata/USRTMP_ANDY2.dbf' SIZE 10M AUTOEXTEND ON NEXT 256M MAXSIZE 32000M EXTENT MANAGEMENT LOCAL UNIFORM SIZE 1048576 SEGMENT SPACE MANAGEMENT AUTO;
Tablespace created.

vi /database/cprod_admn01/scripts/createts_prod.sql
(comment out all lines above and including)


-- ORA-03214: File Size specified is smaller than minimum required
ALTER TABLESPACE USRTMP_ANDY ADD DATAFILE '/database/prod03/oradata/USRTMP_ANDY3.dbf' SIZE 1048576 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M
*
ERROR at line 1:
ORA-03214: File Size specified is smaller than minimum required

ALTER TABLESPACE USRTMP_ANDY ADD DATAFILE '/database/prod03/oradata/USRTMP_ANDY3.dbf' SIZE 10M AUTOEXTEND ON NEXT 256M MAXSIZE 32000M;

cp /database/cprod_admn01/scripts/createts_prod.sql /database/cprod_admn01/scripts/createts_prod.sql.old
vi /database/cprod_admn01/scripts/createts_prod.sql

ALTER TABLESPACE USRTMP_ANDY ADD DATAFILE '/database/prod03/oradata/USRTMP_ANDY4.dbf' SIZE 10M AUTOEXTEND ON NEXT 256M MAXSIZE 32000M ;


-- user/role errors related to 4086VCNTR tablespace
CREATE USER "4086VCNTR" IDENTIFIED BY VALUES '5DCAAB72A3140A91' DEFAULT TABLESPACE 4086VCNTR TEMPORARY TABLESPACE TEMP PROFILE APP_PROFILE
                                                                                   *
ERROR at line 1:
ORA-02155: invalid DEFAULT tablespace identifier

alter user "4086VCNTR" quota 52428800 on USERS
           *
ERROR at line 1:
ORA-01918: user '4086VCNTR' does not exist 


alter user "4086VCNTR" quota UNLIMITED on 4086VCNTR
                                          *
ERROR at line 1:
ORA-02156: invalid TEMPORARY tablespace identifier 


alter user "4086VCNTR" quota UNLIMITED on USRTMP
           *
ERROR at line 1:
ORA-01918: user '4086VCNTR' does not exist 

GRANT SELECT on "SYS".DBA_TABLESPACES to "4086VCNTR"     /* grantor SYS*/
                                         *
ERROR at line 1:
ORA-01917: user or role '4086VCNTR' does not exist 


GRANT SELECT on "SYS".DBA_TEMP_FILES to "4086VCNTR"     /* grantor SYS*/
                                        *
ERROR at line 1:
ORA-01917: user or role '4086VCNTR' does not exist 


GRANT EXECUTE on "SYS".DBMS_JOB to "4086VCNTR"     /* grantor SYS*/
                                   *
ERROR at line 1:
ORA-01917: user or role '4086VCNTR' does not exist 


GRANT SELECT on "SYS".DBA_DATA_FILES to "4086VCNTR"     /* grantor SYS*/
                                        *
ERROR at line 1:
ORA-01917: user or role '4086VCNTR' does not exist 

grant CONNECT to "4086VCNTR" 
                 *
ERROR at line 1:
ORA-01917: user or role '4086VCNTR' does not exist 

grant CREATE PROCEDURE to "4086VCNTR" 
                          *
ERROR at line 1:
ORA-01917: user or role '4086VCNTR' does not exist 

grant CREATE SEQUENCE to "4086VCNTR" 
                         *
ERROR at line 1:
ORA-01917: user or role '4086VCNTR' does not exist 

grant CREATE SESSION to "4086VCNTR" 
                        *
ERROR at line 1:
ORA-01917: user or role '4086VCNTR' does not exist 

grant SELECT_CATALOG_ROLE to "4086VCNTR" 
                             *
ERROR at line 1:
ORA-01917: user or role '4086VCNTR' does not exist 

grant UNLIMITED TABLESPACE to "4086VCNTR" 
                              *
ERROR at line 1:
ORA-01917: user or role '4086VCNTR' does not exist 

grant USER_ROLE to "4086VCNTR" 
                   *
ERROR at line 1:
ORA-01917: user or role '4086VCNTR' does not exist 

-- fix
CREATE USER "4086VCNTR" IDENTIFIED BY VALUES '5DCAAB72A3140A91' DEFAULT TABLESPACE "4086VCNTR" TEMPORARY TABLESPACE TEMP PROFILE APP_PROFILE;
alter user "4086VCNTR" quota 52428800 on USERS;
alter user "4086VCNTR" quota UNLIMITED on "4086VCNTR";
alter user "4086VCNTR" quota UNLIMITED on USRTMP;
GRANT SELECT on "SYS".DBA_TABLESPACES to "4086VCNTR"     /* grantor SYS*/;
GRANT SELECT on "SYS".DBA_TEMP_FILES to "4086VCNTR"     /* grantor SYS*/;
GRANT EXECUTE on "SYS".DBMS_JOB to "4086VCNTR"     /* grantor SYS*/;
GRANT SELECT on "SYS".DBA_DATA_FILES to "4086VCNTR"     /* grantor SYS*/;
grant CONNECT to "4086VCNTR" ;
grant CREATE PROCEDURE to "4086VCNTR" ;
grant CREATE SEQUENCE to "4086VCNTR" ;
grant CREATE SESSION to "4086VCNTR" ;
grant SELECT_CATALOG_ROLE to "4086VCNTR" ;
grant UNLIMITED TABLESPACE to "4086VCNTR" ;
grant USER_ROLE to "4086VCNTR" ;


##########
# prod   #
# RPROD1 #
# 2/7    #
##########

REPLICAT   RPROD1    Last Started 2018-02-07 16:09   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:02:22 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prod/ra000000000
                     2018-02-07 16:09:35.361217  RBA 39983

2018-02-07 16:09:38  WARNING OGG-00869  Table PROD.4086VCNTR.VPX_JOB_LOG does not exist.

(nothing from 4086VCNTR exported; need to revise scripts and try this fucker again!)


##########
# prod   #
# import #
# 2/7    #
##########

-- fix later
ORA-02298: cannot validate (CCMPROD.FK_NEW_TRADEBLOTTER_SOFTCOMM) - parent keys not found
ORA-02298: cannot validate (CCMPROD.FK_NEW_TRADEBLOTTER_COMM) - parent keys not found
ORA-02298: cannot validate (CCMPROD.FK_FUTURES_TRANS_COSTS_TB) - parent keys not found
ORA-02298: cannot validate (CCMPROD.FK_FLEX_OPTIONS_TRANS_COSTS_TB) - parent keys not found

(bunch of these)
02/06/2018 16:21:42.012: ORA-39083: Object type TRIGGER:"AUDITOR"."EOM_CFR_TG" failed to create with error:
ORA-00942: table or view does not exist

(bunch of these)
ALTER TRIGGER "CIN1SA".CASHADJ_3_SELL_UPDATE_LOCKDOWN DISABLE
*
ERROR at line 1:
ORA-04080: trigger 'CASHADJ_3_SELL_UPDATE_LOCKDOWN' does not exist

(a shitload of verification errors)

-- DB links
Heterogeneous link LMS_V10_RO needs to be fixed!
select '1' from dual@LMS_V10_RO
                     *
ERROR at line 1:
ORA-01017: invalid username/password; logon denied
[DataDirect][ODBC SQL Server Wire Protocol driver][SQL Server]Login failed for user 'lms4086data'. {28000,NativeErr = 18456}
ORA-02063: preceding 2 lines from LMS_V10_RO

CCMPROD.CCMTEST.WORLD owned by SYSTEM needs to be fixed!
select '1' from dual@CCMPROD.CCMTEST.WORLD
                     *
ERROR at line 1:
ORA-12154: TNS:could not resolve the connect identifier specified

CCMTEST owned by SYSTEM needs to be fixed!
select '1' from dual@CCMTEST
                     *
ERROR at line 1:
ORA-12154: TNS:could not resolve the connect identifier specified

CINMXA.CCMTEST.WORLD owned by SYSTEM needs to be fixed!
select '1' from dual@CINMXA.CCMTEST.WORLD
                     *
ERROR at line 1:
ORA-12154: TNS:could not resolve the connect identifier specified

Now checking for hard-coded links...
Link CAMRALINK is hard-coded to uxp33.conseco.com
 Link LMS is hard-coded to uxp33.conseco.com
 Link LMS_V10_RO is hard-coded to uxp33.conseco.com
 Link MCAMRALINK is hard-coded to uxp33.conseco.com

-- refresh groups
If there were ORA-39083 and ORA-23421 errors in the import, use /database/cprod_admn01/scripts/create_refresh_groups_prod.sql to create them.
You must remove the section with the job number, e.g. 'job=>225'.


##########
# prod   #
# import #
# 2/9    #
##########

CREATE TABLESPACE "USRTMP_ANDY" DATAFILE '/database/prod03/oradata/USRTMP_ANDY2.dbf' SIZE 1048576 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M EXTENT MANAGEMENT LOCAL UNIFORM SIZE 1048576 SEGMENT SPACE MANAGEMENT AUTO
*
ERROR at line 1:
ORA-03214: File Size specified is smaller than minimum required

cp /database/cprod_admn01/scripts/createts_prod.sql /database/cprod_admn01/scripts/createts_prod.sql.original
vi /database/cprod_admn01/scripts/createts_prod.sql

-- during script
ORA-31693: Table data object "CCMPROD"."SERVICE" failed to load/unload and is being skipped due to error:
ORA-02354: error in exporting/importing data
ORA-01466: unable to read data - table definition has changed

-- get list of all errors
cat /oragg/datapump/prod/prod.log | grep ORA-31693 | sort > /oragg/datapump/prod/ora31693_prod_feb09.txt
(156 tables)
cp /oragg/datapump/prod/expdp_prod.par /oragg/datapump/prod/expdp_prod_tables.par

-- exclude from replicat (uxoram01)
cd /move/prod01/scripts
cp RPROD1.prm RPROD1.prm.orig
mv Linux_setup_prod.tar Linux_setup_prod.tar.orig
vi RPROD1.prm
(add MAPEXCLUDE for failed tables)

tar -cvf Linux_setup_prod.tar *prod* RPROD1.prm
scp Linux_setup_prod.tar lxoggp01:/tmp


##########
# prod   #
# RPROD1 #
# 2/9    #
##########

REPLICAT   RPROD1    Last Started 2018-02-09 15:17   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:01:12 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prod/ra000000000
                     2018-02-09 15:17:46.950127  RBA 130173

2018-02-09 15:17:50  WARNING OGG-00869  Table PROD.4086VCNTR.VPX_JOB_LOG does not exist.


##########
# prod   #
# export #
# 2/11   #
##########

-- during export
ORA-31693: Table data object "CCMPROD"."SERVICE" failed to load/unload and is being skipped due to error:
ORA-02354: error in exporting/importing data
ORA-01466: unable to read data - table definition has changed

-- get list of all errors
cat /oragg/datapump/prod/prod.log | grep ORA-31693 | sort > /oragg/datapump/prod/ora31693_prod_feb11.txt
(163 AUDITOR tables failed out of 503 AUDITOR total tables)
(388 tables)

-- exclude from replicat (uxoram01)
cd /move/prod01/scripts
cp RPROD1.prm RPROD1.prm.orig
mv Linux_setup_prod.tar Linux_setup_prod.tar.orig
vi RPROD1.prm
(add MAPEXCLUDE for failed tables)

tar -cvf Linux_setup_prod.tar *prod* RPROD1.prm
scp Linux_setup_prod.tar lxoggp01:/tmp

-- create table export par file
cp /oragg/datapump/prod/expdp_prod.par /oragg/datapump/prod/expdp_prod_tables.par
(edit on laptop)
(more than 4000 characters - 13,000 characters)
(split into 4 par files)


##########
# prod   #
# import #
# 2/6    #
##########

-- ORA-03214: File Size specified is smaller than minimum required
CREATE TABLESPACE USRTMP_ANDY DATAFILE '/database/prod03/oradata/USRTMP_ANDY2.dbf' SIZE 1048576 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M EXTENT MANAGEMENT LOCAL UNIFORM SIZE 1048576 SEGMENT SPACE MANAGEMENT AUTO
*
ERROR at line 1:
ORA-03214: File Size specified is smaller than minimum required

cp /database/cprod_admn01/scripts/createts_prod.sql /database/cprod_admn01/scripts/createts_prod.sql.orig
vi /database/cprod_admn01/scripts/createts_prod.sql

CREATE TABLESPACE USRTMP_ANDY DATAFILE '/database/prod03/oradata/USRTMP_ANDY2.dbf' SIZE 10M AUTOEXTEND ON NEXT 256M MAXSIZE 32000M EXTENT MANAGEMENT LOCAL UNIFORM SIZE 1048576 SEGMENT SPACE MANAGEMENT AUTO;
(add ALTER TABLESPACE lines)
(delete everything above)



2018-02-12 09:25:15  ERROR   OGG-10124  (RPROD1.prm) line 306: Parsing error, value ""CCMDAILY"."TRAC_PRICE_TMP

start replicat RPROD1 aftercsn 10954875668101


##########
# prod   #
# import #
# 2/19   #
##########

grant ALTER SESSION to PUBLIC;
grant CREATE PROCEDURE to PUBLIC;
grant DEBUG ANY PROCEDURE to PUBLIC;
grant DEBUG CONNECT SESSION to PUBLIC;
grant EXECUTE on SYS./11799933_SchemaProtectionDoma    to PUBLIC;
ORA-00911: invalid character
grant EXECUTE on SYS./c8a1ddf0_PolicyTable             to PUBLIC;
ORA-00903: invalid table name
grant EXECUTE on SYS./dbfaa3be_CachedLocaleData        to PUBLIC;
ORA-00903: invalid table name
grant EXECUTE on SYS.DBMS_ASH_INTERNAL                 to PUBLIC;
grant EXECUTE on SYS.DBMS_JVM_EXP_PERMS                to PUBLIC;
grant EXECUTE on SYS.DBMS_OFFLINE_RGT                  to PUBLIC;
grant EXECUTE on SYS.DBMS_REPUTIL                      to PUBLIC;
grant EXECUTE on SYS.DBMS_REPUTIL2                     to PUBLIC;
grant EXECUTE on SYS.DBMS_XRWMV                        to PUBLIC;
grant EXECUTE on SYS.ORACLE_DATAPUMP                   to PUBLIC;
grant EXECUTE on SYS.ORACLE_LOADER                     to PUBLIC;
grant EXECUTE on XDB.DBMS_XDBREPOS                     to PUBLIC;
grant SELECT on SYS.DBA_DEPENDENCIES                   to PUBLIC;
grant SELECT on SYS.DBA_OBJECTS                        to PUBLIC;
grant SELECT on SYS.DBA_SOURCE                         to PUBLIC;
grant SELECT on SYS.DBA_SYNONYMS                       to PUBLIC;
grant SELECT on SYS.GV_$AW_AGGREGATE_OP                to PUBLIC;
grant SELECT on SYS.GV_$AW_ALLOCATE_OP                 to PUBLIC;
grant SELECT on SYS.GV_$AW_CALC                        to PUBLIC;
grant SELECT on SYS.GV_$AW_OLAP                        to PUBLIC;
grant SELECT on SYS.GV_$AW_SESSION_INFO                to PUBLIC;
grant SELECT on SYS.V_$AW_AGGREGATE_OP                 to PUBLIC;
grant SELECT on SYS.V_$AW_ALLOCATE_OP                  to PUBLIC;
grant SELECT on SYS.V_$AW_CALC                         to PUBLIC;
grant SELECT on SYS.V_$AW_OLAP                         to PUBLIC;
grant SELECT on SYS.V_$AW_SESSION_INFO                 to PUBLIC;
grant SELECT on SYS.V_$LOCKED_OBJECT                   to PUBLIC;
grant SELECT on SYS.V_$SESSTAT                         to PUBLIC;
grant SELECT on SYS.V_$STATNAME                        to PUBLIC;
grant SELECT on SYS.V_$SYSSTAT                         to PUBLIC;
grant USE on SYS.ORA$BASE                              to PUBLIC;
ORA-00942: table or view does not exist

select text from dba_source where owner='CCM_PKG' and name='CCM_PRICING' and line between 184 and 224 order by line;
col line format 9990
col text format a135
select line, text from dba_source where owner='CCM_PKG' and name='CCM_PRICING' order by line;

col grantee format a30
select grantee, common from dba_sys_privs where privilege='INHERIT ANY PRIVILEGES' order by 1;
UT-GRANTEE                     COM
------------------------------ ---
APEX_040200                    YES
CTXSYS                         YES
DBSNMP                         YES
MDSYS                          YES
ORACLE_OCM                     YES
ORDPLUGINS                     YES
ORDSYS                         YES
SYS                            YES
WMSYS                          YES
XDB                            YES
(same for PROD)

col owner format a30
col table_name format a30
select grantee, owner, table_name from dba_tab_privs where privilege='INHERIT PRIVILEGES' order by 1,2,3;
UT		160 rows selected.
PROD	217 rows selected.

select grantee, owner, table_name from dba_tab_privs where privilege='INHERIT PRIVILEGES' and grantee='PUBLIC' order by 1,2,3;
UT		149 rows selected.
PROD	205 rows selected.

-- cnozk7
sqlplus cnozk7@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=lxorainvp01.conseco.ad)(PORT=1521))(CONNECT_DATA=(SID=prod)))
@/home/oracle/m2m_detailed_report_test.sql IG
@/home/oracle/m2m_detailed_report_test.sql HY




SELECT Cusip, Ticker, Issuer, COUPON, MATURITY, Final_Marketprice, Final_Source, Prev_Final_Marketprice, Prev_Final_Source,
  Marketprice_Change, MARKETPRICE_PCT_DIFF, ADDITIONAL_INVESTIGATION_REQD, price_criteria, reasonableness_threshold,
  is_marketprice_diff_reasonable, IS_SEC_VENDOR_DIFF_REASONABLE, 
  second_vendor_marketprice, second_vendor_source, second_vendor_mp_diff, second_vendor_mp_diff_pct,
  ccmsectype, eff_duration, rating_bucket, rating_bucket_order, duration_bucket, Duration_Label, ROUND(Par,2) Par,
  M2M_RATING_BUCKET, M2m_Rating_Bucket_Order, Duration_Label AS m2m_Duration_Label, DURATION_LABEL_ORDER, EXCEPTN
FROM
  (SELECT Cusip, Ticker, Issuer, COUPON, MATURITY, Final_Marketprice, Final_Source, Prev_Final_Marketprice, Prev_Final_Source,
    Marketprice_Change, MARKETPRICE_PCT_DIFF, price_criteria, reasonableness_threshold, is_marketprice_diff_reasonable,
    DECODE('IG', 'IG', ADDITIONAL_INVEST_REQD_IG, ADDITIONAL_INVEST_REQD_HY) ADDITIONAL_INVESTIGATION_REQD,
    IS_SEC_VENDOR_DIFF_REASONABLE, NVL(second_vendor_marketprice,0) AS second_vendor_marketprice, second_vendor_source,
    NVL(second_vendor_mp_diff,0)     AS second_vendor_mp_diff, NVL(second_vendor_mp_diff_pct,0) AS second_vendor_mp_diff_pct,
    ccmsectype, eff_duration, rating_bucket, rating_bucket_order, duration_bucket, Duration_Label, Par,
    M2M_RATING_BUCKET, M2m_Rating_Bucket_Order, Duration_Label AS m2m_Duration_Label,
    CCM_PRICING.GETM2MDURATIONLABELORDER(DURATION_LABEL) DURATION_LABEL_ORDER,
    (CASE
      WHEN DECODE('IG', 'IG',Marketprice_Change,MARKETPRICE_PCT_DIFF) >= price_criteria
      and DECODE('IG', 'IG', is_marketprice_diff_reasonable,'NO') ='NO'
	  AND IS_SEC_VENDOR_DIFF_REASONABLE ='NO' 
      THEN 'YES'
      WHEN DECODE('IG', 'IG',Marketprice_Change,MARKETPRICE_PCT_DIFF) >= price_criteria
	  and DECODE('IG', 'IG', is_marketprice_diff_reasonable,'NO') ='NO'
      AND IS_SEC_VENDOR_DIFF_REASONABLE ='YES'
      THEN 'NO'
      ELSE 'NO'
    END) EXCEPTN
  FROM  ccmeom.M2m_Price_Check_View
  WHERE Asofdate               = '01/31/2018'
  AND M2m_Rating_Bucket_Order >= DECODE('IG', 'IG',1, 5)
  AND M2m_Rating_Bucket_Order <= DECODE('IG', 'IG',4, 11)
  )
WHERE EXCEPTN = DECODE('ALL','EXCPT','YES',EXCEPTN)
ORDER BY M2M_rating_bucket_order,  DURATION_LABEL_ORDER,  EXCEPTN, ccmsectype, eff_duration;


##########
# prod   #
# RPROD1 #
# 2/23   #
##########

-- 8:14
REPLICAT   RPROD1    Last Started 2018-02-23 09:14   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 01:56:06 ago)
Process ID           10831
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prod/ra000000087
                     2018-02-23 09:14:55.779053  RBA 39836841

GGSCI (lxoggp01) 3> sh ls -lt /app/oracle/product/ggate/12c/1/dirdat/prod*
-rw-r-----. 1 oracle dba 468078051 Feb 23 11:11 ra000000087

-- 16:27
REPLICAT   RPROD1    Last Started 2018-02-23 09:14   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 07:01:50 ago)
Process ID           10831
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prod/ra000000087
                     2018-02-23 09:14:55.779053  RBA 39836841

GGSCI (lxoggp01) 6> sh ls -lt /app/oracle/product/ggate/12c/1/dirdat/prod
-rw-r-----. 1 oracle dba 997086989 Feb 23 16:16 ra000000087

-- report
2018-02-23 09:14:56  INFO    OGG-06510  Using the following key columns for target table PROD.CCMDAILY.CAM_RATING_TMP: CUSIP, RECORD_DATE.

-- ./logdump
open /app/oracle/product/ggate/12c/1/dirdat/prod/ra000000087
ghdr on
detail data
pos 39836841
n

2018/02/23 07:30:05.002.324 Insert               Len   127 RBA 39836841
Name: CCMPROD.LIABILITY_PRICE_SENSITIVITY  (TDR Index: 28)

2018/02/23 07:30:05.002.324 Insert               Len   128 RBA 39837087
Name: CCMPROD.LIABILITY_PRICE_SENSITIVITY  (TDR Index: 28)

2018/02/23 07:30:05.002.324 Insert               Len   127 RBA 39837295
Name: CCMPROD.LIABILITY_PRICE_SENSITIVITY  (TDR Index: 28)

-- lxorainvp01
set lines 150 pages 200
SELECT s.sid, s.serial# "SER", s.username, s.sql_id
FROM v$session s
WHERE s.username='GGS' and s.sql_id is not null
ORDER BY s.osuser, s.username, s.sid;
       SID        SER USERNAME                       SQL_ID
---------- ---------- ------------------------------ -------------
        25      60426 GGS                            btu0vzcb3xjk4	x16
        50      34118 GGS                            1cks9ujqk80r6	x12
       664       4897 GGS                            bbq7rgvg7nq8m	x3		

SELECT * FROM table (DBMS_XPLAN.DISPLAY_CURSOR('1cks9ujqk80r6'));
Plan hash value: 2289219003
----------------------------------------------------------------------------------------
| Id  | Operation          | Name              | Rows  | Bytes | Cost (%CPU)| Time     |
----------------------------------------------------------------------------------------
|   0 | UPDATE STATEMENT   |                   |       |       |     1 (100)|          |
|   1 |  UPDATE            | CAM_RATING_TMP    |       |       |            |          |
|*  2 |   INDEX UNIQUE SCAN| PK_CAM_RATING_TMP |     1 |    36 |     1   (0)| 00:00:01 |
----------------------------------------------------------------------------------------

SELECT * FROM table (DBMS_XPLAN.DISPLAY_CURSOR('btu0vzcb3xjk4'));
Plan hash value: 2289219003
----------------------------------------------------------------------------------------
| Id  | Operation          | Name              | Rows  | Bytes | Cost (%CPU)| Time     |
----------------------------------------------------------------------------------------
|   0 | UPDATE STATEMENT   |                   |       |       |     1 (100)|          |
|   1 |  UPDATE            | CAM_RATING_TMP    |       |       |            |          |
|*  2 |   INDEX UNIQUE SCAN| PK_CAM_RATING_TMP |     1 |   121 |     1   (0)| 00:00:01 |
----------------------------------------------------------------------------------------

SELECT * FROM table (DBMS_XPLAN.DISPLAY_CURSOR('bbq7rgvg7nq8m'));
Plan hash value: 1286746482
--------------------------------------------------------------------------------------------------
| Id  | Operation                    | Name              | Rows  | Bytes | Cost (%CPU)| Time     |
--------------------------------------------------------------------------------------------------
|   0 | UPDATE STATEMENT             |                   |       |       |     1 (100)|          |
|   1 |  UPDATE                      | CAM_RATING_TMP    |       |       |            |          |
|*  2 |   TABLE ACCESS BY INDEX ROWID| CAM_RATING_TMP    |     1 |   198 |     1   (0)| 00:00:01 |
|*  3 |    INDEX UNIQUE SCAN         | PK_CAM_RATING_TMP |     1 |       |     1   (0)| 00:00:01 |
--------------------------------------------------------------------------------------------------

-- uxp33
select count(*) from CCMDAILY.CAM_RATING_TMP;
  COUNT(*)
----------
      3523

-- ggsci
stop RPROD1
ERROR: sending message to REPLICAT RPROD1 (Timeout waiting for message).

kill RPROD1

-- lxorainvp01
col event format a30
SELECT s.sid, s.serial# "SER", s.sql_id, s.event, s.state, s.SECONDS_IN_WAIT
FROM v$session s
WHERE s.username='GGS' and s.sql_id is not null
ORDER BY s.sid, s.state, s.SECONDS_IN_WAIT;

       SID        SER SQL_ID        EVENT                                                            STATE               SECONDS_IN_WAIT
---------- ---------- ------------- ---------------------------------------------------------------- ------------------- ---------------
        25      60426 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                        1961
        46       6354 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                         239
        50      34118 1cks9ujqk80r6 enq: TX - allocate ITL entry                                     WAITING                        1971
        51      32404 1cks9ujqk80r6 enq: TX - allocate ITL entry                                     WAITING                           4
        52      62741 1cks9ujqk80r6 enq: TX - allocate ITL entry                                     WAITING                          67
        53      46534 1cks9ujqk80r6 enq: TX - allocate ITL entry                                     WAITING                          28
        55      52126 1cks9ujqk80r6 enq: TX - allocate ITL entry                                     WAITING                        1069
        58      44270 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                        1507
        66       7560 1cks9ujqk80r6 enq: TX - allocate ITL entry                                     WAITING                           5
        67      18384 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                         691
        71      40486 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                           4
        73      64577 1cks9ujqk80r6 enq: TX - allocate ITL entry                                     WAITING                           5
        76      23897 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                         243
       640      34327 1cks9ujqk80r6 enq: TX - allocate ITL entry                                     WAITING                        1556
       641      54713 1cks9ujqk80r6 enq: TX - allocate ITL entry                                     WAITING                          14
       651      11461 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                         239
       654      42847 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                        5471
       656      26859 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                       10472
       660      39852 1cks9ujqk80r6 enq: TX - allocate ITL entry                                     WAITING                         643
       663      21846 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                        1971
       664       4897 bbq7rgvg7nq8m enq: TX - allocate ITL entry                                     WAITING                         118
       667      62959 bbq7rgvg7nq8m enq: TX - allocate ITL entry                                     WAITING                          56
       671       2860 bbq7rgvg7nq8m enq: TX - allocate ITL entry                                     WAITING                        1516
       675       2497 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                         118
       678       7104 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                         337
       681      24606 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                        3349
       682      35126 1cks9ujqk80r6 enq: TX - allocate ITL entry                                     WAITING                           4
       684       6817 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                        1961
       692      42791 btu0vzcb3xjk4 enq: TX - allocate ITL entry                                     WAITING                           4
       693      20861 1cks9ujqk80r6 enq: TX - allocate ITL entry                                     WAITING                        7447

alter system kill session '25,60426' immediate;
(no more sessions)

-- edit params RPROD1
MAPEXCLUDE CCMDAILY.CAM_RATING_TMP

start RPROD1

REPLICAT   RPROD1    Last Started 2018-02-23 16:50   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:01 ago)
Process ID           3065
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/prod/ra000000087
                     2018-02-23 16:50:27.716694  RBA 49728245


##########
# trmp   #
# tables #
# 2/23   #
##########

-- get SCN
set numf 99999999999990
select CURRENT_SCN from v$database;
10955369891200

-- uxp33
expdp \"/ as sysdba\" flashback_scn=10955369891200 parfile=/oragg/datapump/trmp/expdp_trmp_tables.par
ORA-39001: invalid argument value
ORA-39195: At least one schema in the TABLE_FILTER does not exist.

cp /oragg/datapump/trmp/expdp_trmp_tables.par /oragg/datapump/trmp/expdp_trmp_tables.par.bkp

select owner, table_name from dba_tables where table_name in
('COMPLIANCE_TRANSACTIONS_RPT','CRE_SUMMARY_MVIEW','LOAN_CUSIP_PAR_TMP','CAM_PRICE_TMP2','KEY_RATE_PRICE_TMP2','SEC_PRICE_TMP2','RESTRICT_HOLD_PRICE_TMP2','CREDIT_FAMILY_PARENT_TMP2','CREDIT_FAMILY_RATING_TMP2','PORT_COVENANT_TMP2','PORT_PRICE_TMP2','BANK_LOAN_SMF_EXTEND_DT_TMP2','SEC_PRICE_TMP')
order by 1,2;
OWNER                          TABLE_NAME
------------------------------ ------------------------------
CCMTRADE                       BANK_LOAN_SMF_EXTEND_DT_TMP2
CCMTRADE                       CAM_PRICE_TMP2
CCMTRADE                       COMPLIANCE_TRANSACTIONS_RPT
CCMTRADE                       CREDIT_FAMILY_PARENT_TMP2
CCMTRADE                       CREDIT_FAMILY_RATING_TMP2
CCMTRADE                       KEY_RATE_PRICE_TMP2
CCMTRADE                       LOAN_CUSIP_PAR_TMP
CCMTRADE                       PORT_COVENANT_TMP2
CCMTRADE                       PORT_PRICE_TMP2
CCMTRADE                       RESTRICT_HOLD_PRICE_TMP2
CCMTRADE                       SEC_PRICE_TMP
CCMTRADE                       SEC_PRICE_TMP2
CIN1SA                         CRE_SUMMARY_MVIEW
13 rows selected.

"CCMTRADE"."COMPLIANCE_TRANSACTIONS_RPT"
"CIN1SA"."CRE_SUMMARY_MVIEW"
"CCMTRADE"."LOAN_CUSIP_PAR_TMP"
"CCMTRADE"."CAM_PRICE_TMP2"
"CCMTRADE"."KEY_RATE_PRICE_TMP2"
"CCMTRADE"."SEC_PRICE_TMP2",
"CCMTRADE"."RESTRICT_HOLD_PRICE_TMP2",
"CCMTRADE"."CREDIT_FAMILY_PARENT_TMP2",
"CCMTRADE"."CREDIT_FAMILY_RATING_TMP2",
"CCMTRADE"."PORT_COVENANT_TMP2",
"CCMTRADE"."PORT_PRICE_TMP2",
"CCMTRADE"."BANK_LOAN_SMF_EXTEND_DT_TMP2",
"CCMTRADE"."SEC_PRICE_TMP"

(removed double-quotes)
expdp \"/ as sysdba\" flashback_scn=10955369891200 parfile=/oragg/datapump/trmp/expdp_trmp_tables.par
Job "SYS"."SYS_EXPORT_TABLE_01" successfully completed at Fri Feb 23 23:08:41 2018 elapsed 0 00:03:14

-- lxorainvp01
sudo su -
chmod 777 /oragg/datapump/trmp/*dmp
exit

$ORACLE_HOME/bin/impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAINVP01.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=trmp)))\" parfile=/database/ctrmp_admn01/scripts/impdp_trmp_tables.par
02/23/2018 23:11:11.894: Job "SYSTEM"."SYS_IMPORT_FULL_01" successfully completed at Fri Feb 23 23:11:11 2018 elapsed 0 00:00:12


###########
# trmp    #
# cutover #
# 2/23    #
###########

Public link TRADELINK.CONSECO.COM needs to be fixed!
select '1' from dual@TRADELINK.CONSECO.COM
                     *
ERROR at line 1:
ORA-28000: the account is locked
ORA-02063: preceding line from TRADELINK.CONSECO.COM

Public link TRADELINK needs to be fixed!
select '1' from dual@TRADELINK
                     *
ERROR at line 1:
ORA-28000: the account is locked
ORA-02063: preceding line from TRADELINK

Public link PRODLINK needs to be fixed!
select '1' from dual@PRODLINK
                     *
ERROR at line 1:
ORA-28000: the account is locked
ORA-02063: preceding line from PRODLINK

Public link CCMPROD needs to be fixed!
select '1' from dual@CCMPROD
                     *
ERROR at line 1:
ORA-28000: the account is locked
ORA-02063: preceding line from CCMPROD

PUBLIC
CCMPROD
DBLINK
(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prod_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = prod)))

Public link PRODLINK.CONSECO.COM needs to be fixed!
select '1' from dual@PRODLINK.CONSECO.COM
                     *
ERROR at line 1:
ORA-28000: the account is locked
ORA-02063: preceding line from PRODLINK.CONSECO.COM

Public link CCMPROD.CONSECO.COM needs to be fixed!
select '1' from dual@CCMPROD.CONSECO.COM
                     *
ERROR at line 1:
ORA-28000: the account is locked
ORA-02063: preceding line from CCMPROD.CONSECO.COM


alter session set container=trmp;
set lines 150 pages 200
select * from dba_db_links where db_link in ('TRADELINK.CONSECO.COM','TRADELINK','PRODLINK','CCMPROD','PRODLINK.CONSECO.COM','CCMPROD.CONSECO.COM') order by db_link;

02/05/2018

PUBLIC
CCMPROD.CONSECO.COM
DBLINK
(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prod_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID =
prod)))
02/05/2018

PUBLIC
PRODLINK
DBLINK
(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prod_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID =
prod)))
02/05/2018

PUBLIC
PRODLINK.CONSECO.COM
DBLINK
(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prod_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID =
prod)))
02/05/2018

PUBLIC
TRADELINK
DBLINK
(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = trmp_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID =
trmp)))
02/05/2018

PUBLIC
TRADELINK.CONSECO.COM
DBLINK
(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prod_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID =
prod)))
02/05/2018

GRANTEE                        AIX_PRIVILEGE                                    LINUX_PRIVILEGE
------------------------------ ------------------------------------------------ ------------------------------------------------
APPCNOTBK                      CREATE SESSION                                   -
APPCNOTBK                      CREATE TABLE                                     -
APPCNOTBK                      CREATE TRIGGER                                   -
APPCNOTBK                      CREATE VIEW                                      -
APPCNOTBK                      EXECUTE ANY PROCEDURE                            -
APPCNOTBK                      SELECT on CCMTRADE.WILTON_HOLD_DIFF              -
CNOTBK                         CREATE SESSION                                   -
CNOTBK                         CREATE TABLE                                     -
CNOTBK                         CREATE TRIGGER                                   -
CNOTBK                         CREATE VIEW                                      -
CNOTBK                         EXECUTE ANY PROCEDURE                            -

grant CREATE SESSION to APPCNOTBK;
grant CREATE TABLE to APPCNOTBK;
grant CREATE TRIGGER to APPCNOTBK;
grant CREATE VIEW to APPCNOTBK;
grant EXECUTE ANY PROCEDURE to APPCNOTBK;
grant SELECT on CCMTRADE.WILTON_HOLD_DIFF to APPCNOTBK;
grant CREATE SESSION to CNOTBK;
grant CREATE TABLE to CNOTBK;
grant CREATE TRIGGER to CNOTBK;
grant CREATE VIEW to CNOTBK;
grant EXECUTE ANY PROCEDURE to CNOTBK;
ORA-01917: user or role 'APPCNOTBK' does not exist
ORA-01917: user or role 'CNOTBK' does not exist

-- uxp33
cp /oragg/datapump/trmp/expdp_trmp.par /oragg/datapump/trmp/expdp_trmp_schemas.par
vi /oragg/datapump/trmp/expdp_trmp_schemas.par
(add APPCNOTBK and CNOTBK)

set numf 99999999999990
select CURRENT_SCN from v$database;
10955369906124

expdp \"/ as sysdba\" flashback_scn=10955369906124 parfile=/oragg/datapump/trmp/expdp_trmp_schemas.par
Job "SYS"."SYS_EXPORT_SCHEMA_01" successfully completed at Sat Feb 24 00:09:16 2018 elapsed 0 00:02:42

-- lxorainvp01
sudo su -
chmod 777 /oragg/datapump/trmp/*dmp
exit

cp /database/ctrmp_admn01/scripts/impdp_trmp.par /database/ctrmp_admn01/scripts/impdp_trmp_schemas.par
vi /database/ctrmp_admn01/scripts/impdp_trmp_schemas.par

$ORACLE_HOME/bin/impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAINVP01.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=trmp)))\" parfile=/database/ctrmp_admn01/scripts/impdp_trmp_schemas.par
02/24/2018 00:12:05.515: Job "SYSTEM"."SYS_IMPORT_FULL_01" completed with 17 error(s) at Sat Feb 24 00:12:05 2018 elapsed 0 00:00:21

User, its roles and privileges
--------------------------------------------------------------------------------
  APPCNOTBK
    CONNECT
      CREATE SESSION
      SET CONTAINER
    TRADE_WILTON_REC_ROLE
      SELECT on CCMTRADE.WILTON_HOLD_DIFF
    USER_ROLE
      CONNECT
        CREATE SESSION
        SET CONTAINER
      CREATE SESSION
      CREATE TABLE
      CREATE TRIGGER
      CREATE VIEW
      EXECUTE ANY PROCEDURE

  CNOTBK
    CONNECT
      CREATE SESSION
      SET CONTAINER
    USER_ROLE
      CONNECT
        CREATE SESSION
        SET CONTAINER
      CREATE SESSION
      CREATE TABLE
      CREATE TRIGGER
      CREATE VIEW
      EXECUTE ANY PROCEDURE

USERNAME                       TABLESPACE                     AIX_QUOTA                                LINUX_QUOTA
------------------------------ ------------------------------ ---------------------------------------- ----------------------------------------
APPCNOTBK                      USRTMP                         UNLIMITED
AUDITOR                        AUDITOR_DATA _ARCH             UNLIMITED
AUDITOR                        TEMP_MOVE                      UNLIMITED
CCMNOTES                       TEMP_MOVE                      UNLIMITED
CCMPROD                        TEMP_MOVE                      UNLIMITED
CCMSTAGE                       TEMP_MOVE                      UNLIMITED
CCMTKC                         TEMP_MOVE                      UNLIMITED
CCMTRADE                       TEMP_MOVE                      UNLIMITED
CCM_PKG                        TEMP_MOVE                      UNLIMITED
CFNJEH                         TEMP_MOVE                      UNLIMITED
CIAQCS                         TEMP_MOVE                      UNLIMITED
CIAYKW                         TEMP_MOVE                      UNLIMITED
CIN7MH                         TEMP_MOVE                      UNLIMITED
CIN8SE                         TEMP_MOVE                      UNLIMITED
CINAS9                         TEMP_MOVE                      UNLIMITED
CINB4H                         TEMP_MOVE                      UNLIMITED
CINERJ                         TEMP_MOVE                      UNLIMITED
CING1A                         TEMP_MOVE                      UNLIMITED
CINJ1H                         TEMP_MOVE                      UNLIMITED
CINJAT                         TEMP_MOVE                      UNLIMITED
CINJBC                         TEMP_MOVE                      UNLIMITED
CINJWK                         TEMP_MOVE                      UNLIMITED
CINK1S                         TEMP_MOVE                      UNLIMITED
CINMXA                         TEMP_MOVE                      UNLIMITED
CINRIM                         TEMP_MOVE                      UNLIMITED
CINSZ9                         TEMP_MOVE                      UNLIMITED
CINXJN                         TEMP_MOVE                      UNLIMITED
CNOTBK                         USRTMP                         UNLIMITED
CPAMH6                         TEMP_MOVE                      UNLIMITED
CPRVM2                         TEMP_MOVE                      UNLIMITED
DBLINK                         TEMP_MOVE                      UNLIMITED
EMANAGE                        TEMP_MOVE                      UNLIMITED
EXAMINER                       TEMP_MOVE                      UNLIMITED
RUNTIMELINK                    TEMP_MOVE                      UNLIMITED
TRADEHIST                      TEMP_MOVE                      UNLIMITED

alter user APPCNOTBK QUOTA UNLIMITED ON USRTMP;
alter user CNOTBK   quota unlimited on  USRTMP   ;
alter user AUDITOR  quota unlimited on  AUDITOR_DATA_ARCH;

alter user AUDITOR  quota unlimited on  TEMP_MOVE;
alter user CCMNOTES quota unlimited on  TEMP_MOVE;
alter user CCMPROD  quota unlimited on  TEMP_MOVE;
alter user CCMSTAGE quota unlimited on  TEMP_MOVE;
alter user CCMTKC   quota unlimited on  TEMP_MOVE;
alter user CCMTRADE quota unlimited on  TEMP_MOVE;
alter user CCM_PKG  quota unlimited on  TEMP_MOVE;
alter user CFNJEH   quota unlimited on  TEMP_MOVE;
alter user CIAQCS   quota unlimited on  TEMP_MOVE;
alter user CIAYKW   quota unlimited on  TEMP_MOVE;
alter user CIN7MH   quota unlimited on  TEMP_MOVE;
alter user CIN8SE   quota unlimited on  TEMP_MOVE;
alter user CINAS9   quota unlimited on  TEMP_MOVE;
alter user CINB4H   quota unlimited on  TEMP_MOVE;
alter user CINERJ   quota unlimited on  TEMP_MOVE;
alter user CING1A   quota unlimited on  TEMP_MOVE;
alter user CINJ1H   quota unlimited on  TEMP_MOVE;
alter user CINJAT   quota unlimited on  TEMP_MOVE;
alter user CINJBC   quota unlimited on  TEMP_MOVE;
alter user CINJWK   quota unlimited on  TEMP_MOVE;
alter user CINK1S   quota unlimited on  TEMP_MOVE;
alter user CINMXA   quota unlimited on  TEMP_MOVE;
alter user CINRIM   quota unlimited on  TEMP_MOVE;
alter user CINSZ9   quota unlimited on  TEMP_MOVE;
alter user CINXJN   quota unlimited on  TEMP_MOVE;
alter user CPAMH6   quota unlimited on  TEMP_MOVE;
alter user CPRVM2   quota unlimited on  TEMP_MOVE;
alter user DBLINK   quota unlimited on  TEMP_MOVE;
alter user EMANAGE  quota unlimited on  TEMP_MOVE;
alter user EXAMINER quota unlimited on  TEMP_MOVE;
alter user RUNTIMELINK quota unlimited on TEMP_MOVE;
alter user TRADEHIST quota unlimited on TEMP_MOVE;
ORA-00959: tablespace 'TEMP_MOVE' does not exist

select TABLESPACE_NAME from dba_tablespaces where TABLESPACE_NAME in ('TEMP_MOVE','"AUDITOR_DATA _ARCH"');
select TABLESPACE_NAME from dba_tablespaces order by 1;

-- HS links
LMS
lms4086data
(DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=trmp_pkg.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=trmptolmsprd)) (HS=OK))

MCAMRALINK
CAMRA4086
(DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=trmp_pkg.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=trmptomcamraprod)) (HS=OK))

CAMRALINK
CAMRA4086
(DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=trmp_pkg.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=trmptocamraprod)) (HS=OK))

PUBLIC LMS_V10_RO    lms4086data       (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=prod_pkg.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=sql2k54086prod)) (HS=OK))             Feb 19, 2018 3:33:05 PM EST
PUBLIC MCAMRALINK   CAMRA4086       (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=prod_pkg.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=sqlprod4086tomcamra)) (HS=OK))            Feb 19, 2018 3:39:06 PM EST
PUBLIC LMS       lms4086data       (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=prod_pkg.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=sql2k54086prod)) (HS=OK))             Feb 19, 2018 3:31:06 PM EST
PUBLIC CAMRALINK       Camra4086          (DESCRIPTION= (ADDRESS=(PROTOCOL=tcp)(HOST=prod_pkg.conseco.com)(PORT=1521)) (CONNECT_DATA=(SID=sqlprod4086tocamra)) (HS=OK))

scp inittrmptolmsprd.ora lxorainvp01:/app/oracle/product/gateway/12c/1/hs/admin
scp inittrmptomcamraprod.ora lxorainvp01:/app/oracle/product/gateway/12c/1/hs/admin
scp inittrmptocamraprod.ora lxorainvp01:/app/oracle/product/gateway/12c/1/hs/admin

scp initsql2k54086prod.ora lxorainvp01:/app/oracle/product/gateway/12c/1/hs/admin
scp initsqlprod4086tomcamra.ora lxorainvp01:/app/oracle/product/gateway/12c/1/hs/admin
scp initsqlprod4086tocamra.ora lxorainvp01:/app/oracle/product/gateway/12c/1/hs/admin

select '1' from dual@lms;			-OK-
select '1' from dual@MCAMRALINK;	-OK-
select '1' from dual@CAMRALINK;		-OK-

select '1' from dual@LMS_V10_RO;	-OK-
select '1' from dual@MCAMRALINK;	-OK-
select '1' from dual@lms;			-OK-
select '1' from dual@CAMRALINK;		-OK-


[ODBC Data Sources]
DB2
[SAMPLE]
Driver=DB2 ODBC Driver
Description=DB2 ODBC Driver
Server=NTDB2UT02.conseco.ad
Database=SAMPLE
Port=50000


-- invalid objects
@$ORACLE_HOME/rdbms/admin/utlrp.sql
(keeps crashing)

alter session set container=trmp;
set lines 150 pages 200
col owner format a30
select owner, status, count(*) from dba_objects where status !='VALID' 
group by owner, status order by 1,2;
OWNER                          STATUS    COUNT(*)
------------------------------ ------- ----------
CCMSTAGE                       INVALID         67
CCMTRADE                       INVALID         13
CCM_PKG                        INVALID          7
CIAYKW                         INVALID         33
CIN7MH                         INVALID         30
CINDRJ                         INVALID         31
CINSZ9                         INVALID         30
EMANAGE                        INVALID         63
PUBLIC                         INVALID          1
TRADEHIST                      INVALID          3

exec dbms_utility.compile_schema( 'CCMSTAGE' ) ;
exec dbms_utility.compile_schema( 'CCMTRADE' ) ;
ORA-03113: end-of-file on communication channel

exec dbms_utility.compile_schema( 'CCM_PKG' ) ;
exec dbms_utility.compile_schema( 'CIAYKW' ) ;
exec dbms_utility.compile_schema( 'CIN7MH' ) ;

OWNER                          STATUS    COUNT(*)
------------------------------ ------- ----------
AUDITOR                        INVALID          1
CCMNOTES                       INVALID          1
CCMSTAGE                       INVALID        102
CCMTRADE                       INVALID        146
CCM_PKG                        INVALID          4
CIAYKW                         INVALID         33
CIN7MH                         INVALID         30
CINDRJ                         INVALID         31
CINSZ9                         INVALID         30
CNO3YU                         INVALID         37
CNO46P                         INVALID         37
CNOADM                         INVALID         37
CNOFA4                         INVALID         37
CNOFO6                         INVALID         35
CNOHT5                         INVALID         37
CNOOBT                         INVALID         37
CNOOES                         INVALID         35
CNOOH5                         INVALID         35
CNOTBK                         INVALID         37
CNOTH5                         INVALID         37
CNOTRD                         INVALID         35
CNOTUQ                         INVALID         19
CNOUV2                         INVALID         35
CNOW5R                         INVALID         36
CNOXIB                         INVALID         37
EMANAGE                        INVALID        117
PUBLIC                         INVALID         21
TRADEHIST                      INVALID         26

exec dbms_utility.compile_schema( 'CCMSTAGE' ) ;


exec dbms_utility.compile_schema( 'CINDRJ' ) ;
exec dbms_utility.compile_schema( 'CINSZ9' ) ;
exec dbms_utility.compile_schema( 'EMANAGE' ) ;
exec dbms_utility.compile_schema( 'TRADEHIST' ) ;

##########
# trmp   #
# RTRMP2 #
# 2/24   #
##########

REPLICAT   RTRMP2    Last Started 2018-02-24 00:55   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:06:06 ago)
Process ID           30853
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/trmp/RR/ra000000000
                     First Record  RBA 0

ls -l /app/oracle/product/ggate/11g/1/dirdat/trmp/RR
total 1164
-rw-r-----. 1 oracle dba 1190729 Feb 24 00:48 ra000000000

-- report
2018-02-24 00:55:33  INFO    OGG-06510  Using the following key columns for target table GGTEST.ROW_COUNT_LINUX: OWNER, TABLE_NAME.

-- ./logdump
open /app/oracle/product/ggate/11g/1/dirdat/trmp/RR/ra000000000
ghdr on
detail data
pos 0
n

2018/02/24 00:47:42.690.672 FileHeader           Len  1506 RBA 0
Name: *FileHeader*

2018/02/24 00:47:42.335.561 Metadata             Len 80 RBA 1514
Name: TRMP

2018/02/24 00:47:42.335.562 Metadata             Len 351 RBA 1649
Name: TRMP.GGTEST.OBJECT_COUNT_LINUX

REPLICAT   RTRMP2    Last Started 2018-02-24 01:16   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:14 ago)
Process ID           32342
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/trmp/RR/ra000000000
                     2018-02-24 01:09:01.323367  RBA 1190306

					 
############
# wstodsp  #
# RWS_DSP2 #
# 2/24     #
############

REPLICAT   RWS_DSP2  Last Started 2018-02-23 21:28   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 03:51:57 ago)
Process ID           18686
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/wstodsp/RR/ra000000000
                     First Record  RBA 0

-- report
2018-02-23 21:29:18  INFO    OGG-06510  Using the following key columns for target table GGTEST.ROW_COUNT_LINUX: OWNER, TABLE_NAME.

ll /app/oracle/product/ggate/11g/1/dirdat/wstodsp/RR/ra000000000
-rw-r-----. 1 oracle dba 68301 Feb 23 21:25 /app/oracle/product/ggate/11g/1/dirdat/wstodsp/RR/ra000000000

-- ./logdump
open /app/oracle/product/ggate/11g/1/dirdat/wstodsp/RR/ra000000000
ghdr on
detail data
pos 0
n

2018/02/23 21:23:17.658.177 FileHeader           Len  1524 RBA 0
Name: *FileHeader*

2018/02/23 21:23:17.123.492 Metadata             Len 86 RBA 1532
Name: WSTODSP

2018/02/23 21:23:17.123.493 Metadata             Len 351 RBA 1676
Name: WSTODSP.GGTEST.OBJECT_COUNT_LINUX

stop RWS_DSP2
start RWS_DSP2

REPLICAT   RWS_DSP2  Last Started 2018-02-24 01:49   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:30 ago)
Process ID           2203
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/wstodsp/RR/ra000000000
                     2018-02-24 01:45:49.070847  RBA 67874

					 
##########
# prod   #
# tables #
# 2/24   #
##########

TABLE                                             AIX        LINUX          DIFFERENCE
---------------------------------------- ------------ ------------ -------------------
4086VCNTR.VPX_DBM_COUNTER_VALUE                   713          902                 189
CAIRO.BENCHMARK_RATES_VIEW                    551,336      551,344                   8
CAIRO.EIA_HEDGE_POS_MVIEW                     106,364      106,200                -164
CAIRO.PRICE_CHANGE_MVIEW                       68,937       68,451                -486
CAIRO.RATING_WATCH_MVIEW                        1,141        1,163                  22
CAIRO.RATING_WATCH_UNION_MVIEW                  1,310        1,332                  22
CAIROSTAGE.BENCHMARK_RATES_VIEW               551,336      551,344                   8
CCMDAILY.LTC_MVIEW_DAILY                       47,561       46,981                -580
CCMPROD.LTC_MVIEW_MP                          511,191      555,891               44700
CCMPROD.LTC_MVIEW_RATING                      677,672      727,085               49413
CCMPROD.S_P                                10,121,307   10,114,961               -6346
CCMPROD.S_P_ISSUER_RATING                     355,318      355,092                -226
CCMPROD.S_P_WATCH                             180,452      180,646                 194
SP_RATINGX.AQ$_ENGINE_QUEUE_986_TAB_L               0            2                   2
SP_RATINGX.AQ$_GUI_QUEUE_982_TAB_L                  0            3                   3
SP_RATINGX.ENGINE_QUEUE_986_TAB                     0            2                   2
SP_RATINGX.GUI_QUEUE_982_TAB                        0            3                   3

-- get SCN
set numf 99999999999990
select CURRENT_SCN from v$database;
10955370004460

-- uxp33
expdp \"/ as sysdba\" flashback_scn=10955370004460 parfile=/oragg/datapump/prod/expdp_prod_tables.par

-- lxorainvp01
sudo su -
chmod 777 /oragg/datapump/prod/*dmp
exit

$ORACLE_HOME/bin/impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAINVP01.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=prod)))\" parfile=/database/cprod_admn01/scripts/impdp_prod_tables.par
02/23/2018 23:11:11.894: Job "SYSTEM"."SYS_IMPORT_FULL_01" successfully completed at Fri Feb 23 23:11:11 2018 elapsed 0 00:00:12

-- mviews
CAIRO.BENCHMARK_RATES_VIEW                    551,336      551,344                   8
CAIRO.EIA_HEDGE_POS_MVIEW                     106,364      106,200                -164
CAIRO.PRICE_CHANGE_MVIEW                       68,937       68,451                -486
CAIRO.RATING_WATCH_MVIEW                        1,141        1,163                  22
CAIRO.RATING_WATCH_UNION_MVIEW                  1,310        1,332                  22
CAIROSTAGE.BENCHMARK_RATES_VIEW               551,336      551,344                   8
CCMDAILY.LTC_MVIEW_DAILY                       47,561       46,981                -580
CCMPROD.LTC_MVIEW_MP                          511,191      555,891               44700
CCMPROD.LTC_MVIEW_RATING                      677,672      727,085               49413

EXECUTE DBMS_MVIEW.REFRESH(LIST=>'CAIRO.BENCHMARK_RATES_VIEW',PARALLELISM=>4);

-- empty AIX tables
truncate table SP_RATINGX.AQ$_ENGINE_QUEUE_986_TAB_L;
truncate table SP_RATINGX.AQ$_GUI_QUEUE_982_TAB_L    ;
truncate table SP_RATINGX.ENGINE_QUEUE_986_TAB        ;
truncate table SP_RATINGX.GUI_QUEUE_982_TAB;

-- db links
CCMPROD.CCMTEST.WORLD owned by SYSTEM needs to be fixed!
select '1' from dual@CCMPROD.CCMTEST.WORLD
                     *
ERROR at line 1:
ORA-12154: TNS:could not resolve the connect identifier specified

CCMTEST owned by SYSTEM needs to be fixed!
select '1' from dual@CCMTEST
                     *
ERROR at line 1:
ORA-12154: TNS:could not resolve the connect identifier specified

CINMXA.CCMTEST.WORLD owned by SYSTEM needs to be fixed!
select '1' from dual@CINMXA.CCMTEST.WORLD
                     *
ERROR at line 1:
ORA-12154: TNS:could not resolve the connect identifier specified

alter session set container=prod;
set lines 150 pages 200
select * from dba_db_links where db_link in ('CCMPROD.CCMTEST.WORLD','CCMTEST','CINMXA.CCMTEST.WORLD');
SYSTEM
CCMPROD.CCMTEST.WORLD
CCMPROD
CCMTEST
02/18/2018

SYSTEM
CCMTEST
CCMPROD
CCMTEST
02/18/2018

SYSTEM
CINMXA.CCMTEST.WORLD
CCMPROD
CCMTEST

-- AIX
Link CINMXA.CCMTEST.WORLD owned by SYSTEM is broken!
Link CCMTEST owned by SYSTEM is broken!
Link CCMPROD.CCMTEST.WORLD owned by SYSTEM is broken!

drop database Link CINMXA.CCMTEST.WORLD;
drop database Link CCMTEST;
drop database Link CCMPROD.CCMTEST.WORLD;


#########
# prod  #
# privs #
# 2/24  #
#########

-- public grants
set lines 1000 pages 0
set trimspool on
spool /move/prod01/scripts/grant_public_tab_privs.sql
select 'grant '||privilege||' on '||owner||'.'||table_name||' to '||grantee||';'
from dba_tab_privs
where grantee='PUBLIC'
and (OWNER,TABLE_NAME) not in (SELECT owner, object_name FROM dba_recyclebin)
order by owner, table_name, privilege;

spool /move/prod01/scripts/grant_public_sys_privs.sql
select 'grant '||privilege||' to '||grantee||';'
from dba_sys_privs
where grantee='PUBLIC'
order by privilege;

spool /move/prod01/scripts/grant_public_roles.sql
select 'grant '||granted_role||' to '||grantee||';'
from dba_role_privs
where grantee='PUBLIC'
order by granted_role;
select 'alter user public default role '||granted_role||';'
from dba_role_privs
where grantee='PUBLIC' and DEFAULT_ROLE='YES'
order by granted_role;

scp /move/prod01/scripts/grant_public_sys_privs.sql lxorainvp01:/database/cprod_admn01/scripts
scp /move/prod01/scripts/grant_public_tab_privs.sql lxorainvp01:/database/cprod_admn01/scripts
scp /move/prod01/scripts/grant_public_roles.sql lxorainvp01:/database/cprod_admn01/scripts

alter session set container=prod;
@/database/cprod_admn01/scripts/grant_public_sys_privs.sql
@/database/cprod_admn01/scripts/grant_public_tab_privs.sql
@/database/cprod_admn01/scripts/grant_public_roles.sql

ggtest.priv_count_aix
ggtest.priv_count_linux
col "AIX_PRIVILEGE" format a48
col "LINUX_PRIVILEGE" format a48
select NVL(aix.grantee,lx.grantee) "GRANTEE", 
NVL2(aix.privilege,
	CASE aix.owner
		WHEN 'n/a' THEN aix.privilege
		ELSE aix.privilege||' on '||aix.owner||'.'||aix.table_name
	END
	,'-') "AIX_PRIVILEGE", 
NVL2(lx.privilege,
	CASE lx.owner
		WHEN 'n/a' THEN lx.privilege
		ELSE lx.privilege||' on '||lx.owner||'.'||lx.table_name
	END
	,'-') "LINUX_PRIVILEGE"
from ggtest.priv_count_linux lx full outer join ggtest.priv_count_aix aix
	on aix.grantee=lx.grantee and aix.owner=lx.owner and aix.table_name=lx.table_name and aix.privilege=lx.privilege
where lx.grantee is null or aix.grantee is null
and lx.privilege not in ('SET CONTAINER','CREATE SESSION','SELECT ANY DICTIONARY')
and (lx.grantee, lx.privilege) not in
	(select b.grantee, b.privilege from ggtest.priv_count_linux b 
	 where b.grantee='AUTODDL_ADMIN' and b.privilege in ('ALTER ANY MATERIALIZED VIEW','GRANT ANY PRIVILEGE','DROP ANY MATERIALIZED VIEW'))
order by 1,2,3;

-- triggers
set lines 1000 pages 0
set trimspool on
spool /database/cprod_admn01/scripts/compile_triggers.sql
select 'alter trigger '||dt.owner||'.'||dt.trigger_name||' compile;'
from dba_triggers dt, dba_objects do
where dt.owner=do.owner and dt.trigger_name=do.object_name
and do.object_type='TRIGGER' and dt.status='ENABLED' and do.status!='VALID'
order by dt.owner, dt.trigger_name;
spool off
1128 rows selected.

@/database/cprod_admn01/scripts/compile_triggers.sql

--select count(*)
select dt.owner, dt.trigger_name, dt.status "TRIG_STAT", do.status "OBJ_STAT"
from dba_triggers dt, dba_objects do
where dt.owner=do.owner and dt.trigger_name=do.object_name
and do.object_type='TRIGGER' and dt.status='ENABLED' and do.status!='VALID'
and dt.owner not in ('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS')
order by 1,2;
34


select dt.owner, dt.trigger_name, dt.status "TRIG_STAT", do.status "OBJ_STAT"
from dba_triggers dt, dba_objects do
where dt.owner=do.owner and dt.trigger_name=do.object_name
and do.object_type='TRIGGER' and dt.owner='CCMPROD' and dt.trigger_name='TRIG_SECR_2';


#########
# trmp  #
# privs #
# 2/24  #
#########

-- public grants
set lines 1000 pages 0
set trimspool on
spool /move/trmp01/scripts/grant_public_tab_privs.sql
select 'grant '||privilege||' on '||owner||'.'||table_name||' to '||grantee||';'
from dba_tab_privs
where grantee='PUBLIC'
and (OWNER,TABLE_NAME) not in (SELECT owner, object_name FROM dba_recyclebin)
order by owner, table_name, privilege;

spool /move/trmp01/scripts/grant_public_sys_privs.sql
select 'grant '||privilege||' to '||grantee||';'
from dba_sys_privs
where grantee='PUBLIC'
order by privilege;

spool /move/trmp01/scripts/grant_public_roles.sql
select 'grant '||granted_role||' to '||grantee||';'
from dba_role_privs
where grantee='PUBLIC'
order by granted_role;
select 'alter user public default role '||granted_role||';'
from dba_role_privs
where grantee='PUBLIC' and DEFAULT_ROLE='YES'
order by granted_role;

scp /move/trmp01/scripts/grant_public_sys_privs.sql lxorainvp01:/database/ctrmp_admn01/scripts
scp /move/trmp01/scripts/grant_public_tab_privs.sql lxorainvp01:/database/ctrmp_admn01/scripts
scp /move/trmp01/scripts/grant_public_roles.sql lxorainvp01:/database/ctrmp_admn01/scripts

alter session set container=trmp;
@/database/ctrmp_admn01/scripts/grant_public_sys_privs.sql
@/database/ctrmp_admn01/scripts/grant_public_tab_privs.sql
@/database/ctrmp_admn01/scripts/grant_public_roles.sql

-- triggers
set lines 1000 pages 0
set trimspool on
spool /database/ctrmp_admn01/scripts/compile_triggers.sql
select 'alter trigger '||dt.owner||'.'||dt.trigger_name||' compile;'
from dba_triggers dt, dba_objects do
where dt.owner=do.owner and dt.trigger_name=do.object_name
and do.object_type='TRIGGER' and dt.status='ENABLED' and do.status!='VALID'
order by dt.owner, dt.trigger_name;
spool off
1 rows selected.

@/database/ctrmp_admn01/scripts/compile_triggers.sql

--select count(*)
select dt.owner, dt.trigger_name, dt.status "TRIG_STAT", do.status "OBJ_STAT"
from dba_triggers dt, dba_objects do
where dt.owner=do.owner and dt.trigger_name=do.object_name
and do.object_type='TRIGGER' and dt.status='ENABLED' and do.status!='VALID'
and dt.owner not in ('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS')
order by 1,2;
no rows selected


set lines 1000 pages 0
set trimspool on
set long 10000000
COL "DDL"  FORMAT A1000
spool /move/prod01/scripts/create_ccmprpod_mviews.sql.txt
select DBMS_METADATA.GET_DDL('MATERIALIZED_VIEW','S_P','CCMPROD') "DDL" from dual;
select DBMS_METADATA.GET_DDL('MATERIALIZED_VIEW','S_P_ISSUER_RATING','CCMPROD') "DDL" from dual;
select DBMS_METADATA.GET_DDL('MATERIALIZED_VIEW','S_P_WATCH','CCMPROD') "DDL" from dual;

vi /move/prod01/scripts/create_ccmprpod_mviews.sql.txt

 
##########
# prod   #
# RPROD2 #
# 2/27   #
##########

REPLICAT   RPROD2    Last Started 2018-02-27 08:24   Status ABENDED
INTEGRATED
Checkpoint Lag       00:04:19 (updated 12:45:06 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/prod/RR/ra000000012
                     2018-02-26 20:37:23.615590  RBA 581316617

-- report
2018-02-27 08:24:12  INFO    OGG-06506  Wildcard MAP resolved (entry prod.CCMDAILY.*): MAP "PROD"."CCMDAILY"."SEC_PRICE", TARGET CCMDAILY."SEC_PRICE".
2018-02-27 08:24:14  INFO    OGG-06510  Using the following key columns for target table CCMDAILY.SEC_PRICE: CUSIP, RECORD_DATE, PRICESRC.
2018-02-27 08:24:15  ERROR   OGG-01296  Error mapping from PROD.CCMDAILY.SEC_PRICE to CCMDAILY.SEC_PRICE.

-- discard
Key column PRICESRC (2) is missing from update on table CCMDAILY.SEC_PRICE
Missing 1 key columns in update for table CCMDAILY.SEC_PRICE.
Current time: 2018-02-27 08:24:15
Aborting transaction on /app/oracle/product/ggate/11g/1/dirdat/prod/RR/ra beginning at seqno 12 rba 581316617
Mapping problem with unified PK update record (target format)...
*
CUSIP = 38106@AA9
RECORD_DATE = 2018-02-26 00:00:00

CUSIP = 38106@AA9
RECORD_DATE = 2018-02-26 00:00:00
PRICESRC = CCMPROD

-- sqlplus
alter session set container=prod;
set lines 150 pages 200
select count(*) from CCMDAILY.SEC_PRICE
where CUSIP = '38106@AA9' and RECORD_DATE = to_date('2018-02-26 00:00:00','YYYY-MM-DD HH24:MI:SS');
Linux	1
AIX		1

select count(*) from CCMDAILY.SEC_PRICE
where CUSIP = '38106@AA9' and RECORD_DATE = to_date('2018-02-26 00:00:00','YYYY-MM-DD HH24:MI:SS') and PRICESRC = 'CCMPROD';
Linux	1
AIX		1

set long 40
col owner format a20
col constraint_name format a30
col column_name format a30
select distinct dc.owner, dc.constraint_name, col.column_name, dc.constraint_type, dc.status
from dba_constraints dc join dba_cons_columns col
  on dc.constraint_name = col.constraint_name
where dc.table_name='SEC_PRICE' and dc.owner='CCMDAILY' and dc.constraint_type='P'
order by dc.constraint_type desc, dc.constraint_name asc, col.column_name;
OWNER                CONSTRAINT_NAME                COLUMN_NAME                    C STATUS
-------------------- ------------------------------ ------------------------------ - --------
CCMDAILY             PK_SEC_PRICE                   CUSIP                          P ENABLED
CCMDAILY             PK_SEC_PRICE                   PRICESRC                       P ENABLED
CCMDAILY             PK_SEC_PRICE                   RECORD_DATE                    P ENABLED
(same on both sides)

select count(*) from CCMDAILY.SEC_PRICE;
Linux	39788
AIX		439

select CUSIP, RECORD_DATE, count(*) from CCMDAILY.SEC_PRICE
group by CUSIP, RECORD_DATE having count(*) > 1;
Linux	2468
AIX		0

-- edit params
MAPEXCLUDE prod.CCMDAILY.SEC_PRICE;
MAP prod.CCMDAILY.SEC_PRICE, KEYCOLS (CUSIP,RECORD_DATE);

REPLICAT   RPROD2    Last Started 2018-02-27 09:52   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           14727
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/prod/RR/ra000000012
                     2018-02-27 09:52:53.538906  RBA 605207038

stop RPROD2
(remove above MAPEXCLUDE from params)
start RPROD2

REPLICAT   RPROD2    Last Started 2018-02-27 09:53   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:02 ago)
Process ID           14808
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/prod/RR/ra000000012
                     2018-02-27 09:54:20.099612  RBA 624995851

-- 11:18
REPLICAT   RPROD2    Last Started 2018-02-27 09:53   Status RUNNING
INTEGRATED
Checkpoint Lag       12:56:31 (updated 01:06:37 ago)
Process ID           14808
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/prod/RR/ra000000013
                     2018-02-26 21:14:54.318487  RBA 332922178

-- report
2018-02-27 10:11:25  INFO    OGG-01407  Setting current schema for DDL operation to [CCMDAILY].
2018-02-27 10:11:25  INFO    OGG-01408  Restoring current schema for DDL operation to [GGS].

-- logdump
open /app/oracle/product/ggate/11g/1/dirdat/prod/RR/ra000000013
ghdr on
detail data
pos 0
n

-- uxp33
set lines 150 pages 200
COLUMN username FORMAT A10
SELECT s.sid, s.serial# "SER", s.username, s.sql_id, s.state, s.seconds_in_wait, s.event
FROM v$session s
WHERE s.username='GGS' --and s.sql_id is not null
ORDER BY s.sql_id, s.state, s.event, s.sid;
  SID    SER USERNAME            SQL_ID        STATE               SECONDS_IN_WAIT EVENT
----- ------ ------------------- ------------- ------------------- --------------- ----------------------------------------------------------------
  647   6129 GGS                               WAITING                           0 SQL*Net message from client
  785   1077 GGS                               WAITING                           1 Streams: waiting for messages
  226   2705 GGS                               WAITING                           2 rdbms ipc message
  310   1919 GGS                               WAITING                           2 rdbms ipc message
  338    837 GGS                               WAITING                           2 rdbms ipc message
  450   2905 GGS                               WAITING                           0 rdbms ipc message
  478   1269 GGS                               WAITING                           2 rdbms ipc message
  897   2319 GGS                               WAITING                           2 rdbms ipc message

stop RPROD2
start RPROD2

REPLICAT   RPROD2    Last Started 2018-02-27 11:35   Status RUNNING
INTEGRATED
Checkpoint Lag       08:48:07 (updated 00:11:33 ago)
Process ID           20398
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/prod/RR/ra000000013
                     2018-02-27 02:47:43.579227  RBA 357978989
(not moving)

SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- ---------------
SGA    DEFAULT buffer cache         3,072    3,072    3,072 INITIALIZING
       java pool                      224      224      224 STATIC
       large pool                      64       64       64 STATIC
       shared pool                  4,416    4,416    4,416 STATIC
       streams pool                 1,408    1,408    1,408 STATIC
******                           -------- -------- --------
TOTAL                               9,184    9,184    9,184

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
streams_pool_size                    big integer 1408M

alter system set streams_pool_size=2000M scope=both;

/*--- 15:56 (hours later) ---*/
REPLICAT   RPROD2    Last Started 2018-02-27 11:35   Status RUNNING
INTEGRATED
Checkpoint Lag       08:48:07 (updated 04:21:30 ago)
Process ID           20398
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/prod/RR/ra000000013
                     2018-02-27 02:47:43.579227  RBA 357978989

-- report
2018-02-27 11:35:50  INFO    OGG-03506  The source database character set, as determined from the trail file, is us7ascii.

-- logdump
open /app/oracle/product/ggate/11g/1/dirdat/prod/RR/ra000000013
ghdr on
detail data
pos 357978989
n

2018/02/27 01:31:30.689.846 Insert               Len   143 RBA 357978989
Name: PROD.4086VCNTR.VPX_PROC_LOG  (TDR Index: 167)

2018/02/27 01:31:31.689.934 Insert               Len    53 RBA 357979250
Name: PROD.4086VCNTR.VPX_DBM_COUNTER_VALUE  (TDR Index: 168)

-- CO 63338 created to add SGA
stop RPROD2

alter system set sga_max_size=10280M scope=spfile;
alter system set sga_target=10280M scope=spfile;
alter system set streams_pool_size=3000M scope=spfile;
shutdown immediate;
startup;

SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- ---------------
SGA    DEFAULT buffer cache         5,792    5,792    5,792 INITIALIZING  27-FEB 16:22:38
       java pool                      224      224      224 STATIC
       large pool                      32        0       32 GROW          27-FEB 16:22:38
       shared pool                  1,152    1,152    1,152 STATIC
       streams pool                 3,008    3,008    3,008 STATIC
******                           -------- -------- --------
TOTAL                              10,208   10,176   10,208

-- 17:31
REPLICAT   RPROD2    Last Started 2018-02-27 16:23   Status RUNNING
INTEGRATED
Checkpoint Lag       13:36:12 (updated 01:06:57 ago)
Process ID           3459
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/prod/RR/ra000000013
                     2018-02-27 02:47:43.579227  RBA 357978989

> sh ls -l /app/oracle/product/ggate/11g/1/dirdat/prod/RR
-rw-r-----. 1 oracle dba 999999902 Feb 26 21:09 ra000000012
-rw-r-----. 1 oracle dba 357981295 Feb 27 01:31 ra000000013


##########
# trmp   #
# RTRMP2 #
# 2/27   #
##########

REPLICAT   RTRMP2    Last Started 2018-02-27 11:01   Status RUNNING
INTEGRATED
Checkpoint Lag       02:52:53 (updated 00:40:22 ago)
Process ID           18576
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/trmp/RR/ra000000009
                     2018-02-27 08:16:37.740010  RBA 285200607

-- report
2018-02-27 11:09:30  INFO    OGG-06506  Wildcard MAP resolved (entry trmp.CCMTRADE.*): MAP "TRMP"."CCMTRADE"."SEC_PRICE_TMP", TARGET CCMTRADE."SEC_PRICE_TMP".
2018-02-27 11:09:30  WARNING OGG-06439  No unique key is defined for table SEC_PRICE_TMP. All viable columns will be used to represent the key, but may not guarantee uniqueness. KEYCOLS may be used to define the key.
2018-02-27 11:09:30  INFO    OGG-02756  The definition for table TRMP.CCMTRADE.SEC_PRICE_TMP is obtained from the trail file.
              473099 records processed as of 2018-02-27 11:18:22 (rate 472,delta 472)
              484396 records processed as of 2018-02-27 11:34:28 (rate 246,delta 11)

stop RTRMP2
kill RTRMP2

-- edit params RTRMP2
MAPEXCLUDE TRMP.CCMTRADE.SEC_PRICE_TMP

-- uxp33
set lines 150 pages 200
COLUMN username FORMAT A10
SELECT s.sid, s.serial# "SER", s.username, s.sql_id, s.state, s.seconds_in_wait, s.event
FROM v$session s
WHERE s.username='GGS' --and s.sql_id is not null
ORDER BY s.sql_id, s.state, s.event, s.sid;
       SID        SER USERNAME   SQL_ID        STATE               SECONDS_IN_WAIT EVENT
---------- ---------- ---------- ------------- ------------------- --------------- ----------------------------------------------------------------
      1009        385 GGS        gjv8z7uyaat10 WAITED SHORT TIME               457 rdbms ipc message

alter system kill session '1009,385' immediate;

-- ggsci
start RTRMP2

       SID        SER USERNAME   SQL_ID        STATE               SECONDS_IN_WAIT EVENT
---------- ---------- ---------- ------------- ------------------- --------------- ----------------------------------------------------------------
       533        839 GGS                      WAITING                           6 Streams: resolve low memory condition

SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- ----------
SGA    DEFAULT buffer cache         1,040    1,040    1,040 INITIALIZING
       java pool                      160      160      160 STATIC
       large pool                      96       96       96 STATIC
       shared pool                  3,120    3,120    3,120 STATIC
       streams pool                   800      800      800 STATIC
******                           -------- -------- --------
TOTAL                               5,216    5,216    5,216

alter system set streams_pool_size=1200M scope=both;

       SID        SER USERNAME   SQL_ID        STATE               SECONDS_IN_WAIT EVENT
---------- ---------- ---------- ------------- ------------------- --------------- ----------------------------------------------------------------
       869        687 GGS        6uw9fzuzuyxcv WAITING                           2 enq: TM - contention
       813        607 GGS        7c87wd42zvp3c WAITING                           2 enq: TM - contention

REPLICAT   RTRMP2    Last Started 2018-02-27 12:00   Status RUNNING
INTEGRATED
Checkpoint Lag       03:17:37 (updated 00:00:02 ago)
Process ID           21739
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/trmp/RR/ra000000010
                     2018-02-27 08:51:06.581535  RBA 183065477

					 
##########
# prod   #
# EPROD2 #
# 2/27   #
##########

EXTRACT    EPROD2    Last Started 2018-02-25 04:24   Status ABENDED
Checkpoint Lag       00:03:24 (updated 15:55:34 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-02-27 01:33:16
                     SCN 2550.3507606847 (10955674211647)

-- report
2018-02-27 00:58:34  INFO    OGG-06509  Using the following key columns for source table PROD.CCMDAILY.PORT_COVENANT: PORTFOLIO_ID, COVENANT_ID, RECORD_DATE.
            10395584 records processed as of 2018-02-27 00:58:34 (rate 64,delta 41)
            10433695 records processed as of 2018-02-27 01:08:27 (rate 64,delta 64)
            10433700 records processed as of 2018-02-27 01:18:39 (rate 64,delta 0)
            10446572 records processed as of 2018-02-27 01:23:43 (rate 64,delta 42)
            10484665 records processed as of 2018-02-27 01:28:54 (rate 64,delta 122)

-- OEM
Feb 27, 2018 7:00:13 AM EST	81% of archive area /database/cprod_arch01/arch is used.	The execution for Corrective Action BACKUP_A

start EPROD2

-- report
2018-02-27 17:38:12  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File <unknown>. Read Position SCN: 2550.3507606847 (10955674211647)).

-- lxorainvp01
select sequence# from v$archived_log where 10955674211647 between FIRST_CHANGE# and NEXT_CHANGE#-1;
 SEQUENCE#
----------
       381

mkdir /oragg/arch/prod

rman target / catalog rman@rman12p
run
{
 set archivelog destination to '/oragg/arch/prod';
 restore archivelog from sequence 300;
}

EXTRACT    EPROD2    Last Started 2018-02-27 18:02   Status RUNNING
Checkpoint Lag       16:30:04 (updated 00:00:02 ago)
Process ID           110012
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-02-27 01:33:16
                     SCN 2550.3507606847 (10955674211647)

					 
##########
# prod   #
# EPROD2 #
# 2/28   #
##########

EXTRACT    EPROD2    Last Started 2018-02-27 18:02   Status ABENDED
Checkpoint Lag       16:59:09 (updated 14:31:42 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-02-27 01:37:11
                     SCN 2550.3507608360 (10955674213160)

-- report
2018-02-27 23:06:55  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File <unknown>. Read Position SCN: 2550.3507608360 (10955674213160)).

-- OEM
Feb 27, 2018 6:58:56 PM EST	81% of archive area /database/cprod_arch01/arch is used.	The execution for Corrective Action BACKUP_A
Feb 28, 2018 1:13:56 AM EST	90% of archive area /database/cprod_arch01/arch is used.	The execution for Corrective Action BACKUP_A

-- alert log (per Doc ID 1633564.1)
no errors like:
LOGMINER: Error 308 encountered
LOGMINER: Encountered error 1291

> ll /oragg/arch/prod
total 0

> ll /database/cprod_arch01/arch
total 15522428
-rw-r-----. 1 oracle dba 446403584 Feb 28 01:15 1_569_968421107.dbf
-rw-r-----. 1 oracle dba 504373248 Feb 28 01:16 1_570_968421107.dbf
...

-- lxorainvp01
select sequence# from v$archived_log where 10955674213160 between FIRST_CHANGE# and NEXT_CHANGE#-1;
 SEQUENCE#
----------
       382

rman target / catalog rman@rman12p
run
{
 set archivelog destination to '/oragg/arch/prod';
 restore archivelog from sequence 300;
}

EXTRACT    EPROD2    Last Started 2018-02-28 09:33   Status RUNNING
Checkpoint Lag       32:00:09 (updated 00:00:01 ago)
Process ID           15999
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-02-27 01:37:11
                     SCN 2550.3507608360 (10955674213160)

> sh df -h /database/cprod_arch01
/dev/mapper/prodvg01-cprod_arch01_lv   35G   15G   18G  46% /database/cprod_arch01

EXTRACT    EPROD2    Last Started 2018-02-28 10:15   Status RUNNING
Checkpoint Lag       32:38:03 (updated 00:00:08 ago)
Process ID           20645
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-02-27 01:37:26
                     SCN 2550.3507609047 (10955674213847)

stop EPROD2

EXTRACT    EPROD2    Last Started 2018-02-28 10:15   Status STOPPED
Checkpoint Lag       32:43:59 (updated 00:00:15 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-02-27 01:37:26
                     SCN 2550.3507609047 (10955674213847)


############################
# RMAN restore parallelism #
# 2/28                     #
############################

/*--- cc3appsd (SB) ---*/
-- archivelog backup
/app/oracle/scripts/Rubrik/rman_rubrik_cc3appsd_archlogs.sh

-- rman
rman target /

-- sqlplus
set lines 150 pages 200
COLUMN username FORMAT A10
col event format a30
SELECT s.sid, px.qcsid, px.req_degree, s.username, s.state, s.seconds_in_wait, s.event
FROM v$session s left outer join V$PX_SESSION px on s.sid=px.sid and s.serial#=px.serial#
WHERE s.program like '%rman%'
ORDER BY px.qcsid, s.sid;

   SID           QCSID      REQ_DEGREE USERNAME   STATE               SECONDS_IN_WAIT EVENT
------ --------------- --------------- ---------- ------------------- --------------- ------------------------------
    29                                 SYS        WAITING                           2 SQL*Net message from client
   612                                 SYS        WAITING                           2 SQL*Net message from client

-- rman
CONFIGURE DEVICE TYPE DISK PARALLELISM 3 BACKUP TYPE TO BACKUPSET;
restore archivelog from sequence 105;

-- sqlplus
   SID           QCSID      REQ_DEGREE USERNAME   STATE               SECONDS_IN_WAIT EVENT
------ --------------- --------------- ---------- ------------------- --------------- ------------------------------
    29                                 SYS        WAITING                           0 SQL*Net message from client
    30                                 SYS        WAITING                           1 RMAN backup & recovery I/O
    31                                 SYS        WAITING                           1 RMAN backup & recovery I/O
   612                                 SYS        WAITING                           3 SQL*Net message from client
   648                                 SYS        WAITING                           1 RMAN backup & recovery I/O

-- archivelog backup
/app/oracle/scripts/Rubrik/rman_rubrik_cc3appsd_archlogs.sh

-- rman
rman target /

-- sqlplus
   SID           QCSID      REQ_DEGREE USERNAME   STATE               SECONDS_IN_WAIT EVENT
------ --------------- --------------- ---------- ------------------- --------------- ------------------------------
   634                                 SYS        WAITING                           3 SQL*Net message from client
   643                                 SYS        WAITING                           3 SQL*Net message from client

-- rman
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO BACKUPSET;
restore archivelog from sequence 105;

-- sqlplus
   SID           QCSID      REQ_DEGREE USERNAME   STATE               SECONDS_IN_WAIT EVENT
------ --------------- --------------- ---------- ------------------- --------------- ------------------------------
    29                                 SYS        WAITING                           0 RMAN backup & recovery I/O
   634                                 SYS        WAITING                           0 SQL*Net message from client
   643                                 SYS        WAITING                           0 SQL*Net message from client

   
############
# harvestp #
# RHA_STP1 #
# 3/6      #
############

REPLICAT   RHA_STP1  Last Started 2018-02-26 13:13   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:07 (updated 12:31:42 ago)
Process ID           12658
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/harvestp/ra000000002
                     2018-03-05 22:55:23.858128  RBA 135306994

-- trail files
-rw-r-----. 1 oracle dba 652699879 Feb 26 04:41 /app/oracle/product/ggate/12c/1/dirdat/harvestp/ra000000000
-rw-r-----. 1 oracle dba       920 Feb 26 04:41 /app/oracle/product/ggate/12c/1/dirdat/harvestp/ra000000001
-rw-r-----. 1 oracle dba 140748206 Mar  6 11:26 /app/oracle/product/ggate/12c/1/dirdat/harvestp/ra000000002

-- lxorainfp02
  SID    SER USERNAME   OSUSER           LOGON_TIME PROGRAM                             Description
----- ------ ---------- ---------------- ---------- ----------------------------------- -------------------------------------------------------
   22   4803 GGS        oracle           03/05/2018 oracle@LXORAINFP02 (AS04)           Waiting 4s for rdbms ipc message
   36  60131 GGS        oracle           03/03/2018 oracle@LXORAINFP02 (AS0A)           Waiting 4s for rdbms ipc message
   37  42649 GGS        oracle           02/26/2018 oracle@LXORAINFP02 (AS08)           Waiting 4s for rdbms ipc message
   41   2631 GGS        oracle           03/02/2018 oracle@LXORAINFP02 (AS03)           Waiting 4s for rdbms ipc message
  629  56226 GGS        oracle           03/05/2018 oracle@LXORAINFP02 (AS09)           Waiting 46158s for library cache pin
  630  43928 GGS        oracle           02/26/2018 replicat@lxoggp01 (TNS V1-V3)       Waiting 1s for REPL Capture/Apply: miscellaneous
  634  48426 GGS        oracle           02/26/2018 oracle@LXORAINFP02 (AS01)           Waiting 0s for REPL Capture/Apply: messages
  645  65394 GGS        oracle           03/01/2018 oracle@LXORAINFP02 (AS07)           Waiting 4s for rdbms ipc message

   BLOCKED SERIAL# OSUSER           BLOCKER BLKR_SER BLKR_OS          BL_MODULE            OBJECT_NAME          LOCKED_M
---------- ------- ---------------- ------- -------- ---------------- -------------------- -------------------- --------
       629   56226 oracle                22     4803 oracle           GoldenGate

-- ggsci
stop RHA_STP1
ERROR: sending message to REPLICAT RHA_STP1 (Timeout waiting for message).

kill RHA_STP1

-- sqlplus
alter system kill session '630,43928';

-- ggsci
start RHA_STP1

REPLICAT   RHA_STP1  Last Started 2018-03-06 11:49   Status RUNNING
INTEGRATED
Checkpoint Lag       11:00:06 (updated 00:00:06 ago)
Process ID           12378
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/harvestp/ra000000002
                     2018-03-06 00:49:58.418347  RBA 140729037

set lines 150 pages 200
COLUMN username FORMAT A10
COLUMN program FORMAT A35
col osuser format a10
col sid format 9990
col "SER" format 99990
col "Description" format a55
ALTER SESSION SET NLS_DATE_FORMAT='MM/DD/RR HH24:MI';
SELECT DISTINCT s.sid, s.serial# "SER", s.username, s.osuser, s.logon_time, s.program,
decode(s.state,'WAITING','Waiting '||s.seconds_in_wait||'s for '||NVL2(s.sql_id, s.sql_id, event),s.sql_id) "Description"
FROM v$session s
WHERE s.username='GGS'
ORDER BY s.logon_time, s.program;
  SID    SER USERNAME   OSUSER     LOGON_TIME     PROGRAM                             Description
----- ------ ---------- ---------- -------------- ----------------------------------- -------------------------------------------------------
   36  17115 GGS        oracle     03/06/18 11:49 replicat@lxoggp01 (TNS V1-V3)       Waiting 0s for SQL*Net message from client
  642  50545 GGS        oracle     03/06/18 11:49 oracle@LXORAINFP02 (AS01)           Waiting 0s for REPL Capture/Apply: messages
  634  52416 GGS        oracle     03/06/18 11:49 oracle@LXORAINFP02 (AS02)           Waiting 2s for rdbms ipc message
  645  54600 GGS        oracle     03/06/18 11:49 oracle@LXORAINFP02 (AS03)           Waiting 2s for rdbms ipc message
   21    860 GGS        oracle     03/06/18 11:49 oracle@LXORAINFP02 (AS04)           Waiting 2s for rdbms ipc message
   25  13849 GGS        oracle     03/06/18 11:49 oracle@LXORAINFP02 (AS05)           Waiting 2s for rdbms ipc message
  639  25004 GGS        oracle     03/06/18 11:49 oracle@LXORAINFP02 (AS06)           Waiting 2s for rdbms ipc message
   23  55448 GGS        oracle     03/06/18 11:49 oracle@LXORAINFP02 (AS07)           Waiting 1s for rdbms ipc message
  630    149 GGS        oracle     03/06/18 11:49 oracle@LXORAINFP02 (AS08)           Waiting 2s for rdbms ipc message
   12  19898 GGS        oracle     03/06/18 11:50 oracle@LXORAINFP02 (AS09)           Waiting 2s for rdbms ipc message

   
###########
# aedbp   #
# RAEDBP1 #
# 3/6     #
###########

REPLICAT   RAEDBP1   Last Started 2018-02-26 04:39   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:07 (updated 21:04:52 ago)
Process ID           17318
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/aedbp/ra000000003
                     2018-03-05 14:53:40.421547  RBA 970794376

-- trail files
-rw-r-----. 1 oracle dba 999999979 Feb 21 06:38 /app/oracle/product/ggate/12c/1/dirdat/aedbp/ra000000000
-rw-r-----. 1 oracle dba 429904761 Feb 26 04:38 /app/oracle/product/ggate/12c/1/dirdat/aedbp/ra000000001
-rw-r-----. 1 oracle dba      1235 Feb 26 04:38 /app/oracle/product/ggate/12c/1/dirdat/aedbp/ra000000002
-rw-r-----. 1 oracle dba 999999929 Mar  5 21:52 /app/oracle/product/ggate/12c/1/dirdat/aedbp/ra000000003
-rw-r-----. 1 oracle dba  78728778 Mar  6 11:58 /app/oracle/product/ggate/12c/1/dirdat/aedbp/ra000000004

set lines 150 pages 200
COLUMN username FORMAT A10
COLUMN program FORMAT A35
col osuser format a10
col sid format 9990
col "SER" format 99990
col "Description" format a55
ALTER SESSION SET NLS_DATE_FORMAT='MM/DD/RR HH24:MI';
SELECT DISTINCT s.sid, s.serial# "SER", s.username, s.osuser, s.logon_time, s.program,
decode(s.state,'WAITING','Waiting '||s.seconds_in_wait||'s for '||NVL2(s.sql_id, s.sql_id, event),s.sql_id) "Description"
FROM v$session s WHERE s.username='GGS' ORDER BY s.logon_time, s.program;
  SID    SER USERNAME   OSUSER     LOGON_TIME     PROGRAM                             Description
----- ------ ---------- ---------- -------------- ----------------------------------- -------------------------------------------------------
  639  25213 GGS        oracle     02/26/18 04:39 replicat@lxoggp01 (TNS V1-V3)       Waiting 0s for REPL Capture/Apply: miscellaneous
   12  28501 GGS        oracle     02/26/18 04:39 oracle@LXORAINFP02 (AS01)           Waiting 0s for REPL Capture/Apply: messages
   32  61328 GGS        oracle     03/05/18 11:45 oracle@LXORAINFP02 (AS09)           Waiting 4s for rdbms ipc message
   37  39377 GGS        oracle     03/05/18 11:59 oracle@LXORAINFP02 (AS0I)           Waiting 4s for rdbms ipc message
   42  38855 GGS        oracle     03/05/18 12:36 oracle@LXORAINFP02 (AS07)           Waiting 2s for rdbms ipc message
  649  22576 GGS        oracle     03/05/18 12:51 oracle@LXORAINFP02 (AS0G)           Waiting 2s for rdbms ipc message
   16  63367 GGS        oracle     03/05/18 12:53 oracle@LXORAINFP02 (AS06)           Waiting 3s for rdbms ipc message
   25  41159 GGS        oracle     03/05/18 14:44 oracle@LXORAINFP02 (AS0H)           Waiting 76539s for library cache pin

stop RAEDBP1
kill RAEDBP1

alter system kill session '639,25213' immediate;

start RAEDBP1

REPLICAT   RAEDBP1   Last Started 2018-03-06 12:03   Status RUNNING
INTEGRATED
Checkpoint Lag       19:49:43 (updated 00:00:03 ago)
Process ID           13213
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/aedbp/ra000000003
                     2018-03-05 16:14:48.020335  RBA 972818701

					 
##########
# wccp   #
# RWCCP1 #
# 3/6    #
##########

REPLICAT   RWCCP1    Last Started 2018-02-26 04:39   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:09 (updated 85:03:55 ago)
Process ID           17331
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/wccp/ra000000002
                     2018-03-02 23:19:36.229848  RBA 306690846

-- trail files


############
# h11epmp  #
# RH1_PMP2 #
# 3/16     #
############

REPLICAT   RH1_PMP2  Last Started 2018-03-16 20:52   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:17:59 ago)
Process ID           11136
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/h11epmp/RR/ra000000000
                     First Record  RBA 0

-- report file from script
2018-03-16 20:42:52  ERROR   OGG-00664  OCI Error during OCIServerAttach (status = 12545-ORA-12545: Connect failed because target host or object does not exist).

tnsping h11epmp
Attempting to contact (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = uxorap01.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SERVICE_NAME = h11epmp)))
OK (10 msec)

-- ggsci
stop RH1_PMP2

REPLICAT   RH1_PMP2  Last Started 2018-03-16 20:52   Status STOPPED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:02 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/h11epmp/RR/ra000000000
                     2018-03-16 20:59:59.355945  RBA 938644

start RH1_PMP2

REPLICAT   RH1_PMP2  Last Started 2018-03-16 21:13   Status RUNNING
INTEGRATED
Checkpoint Lag       00:13:22 (updated 00:12:25 ago)
Process ID           12449
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/h11epmp/RR/ra000000000
                     2018-03-16 20:59:59.355945  RBA 938644

> ls -l /app/oracle/product/ggate/11g/1/dirdat/h11epmp/RR/ra00*
-rw-r-----. 1 oracle dba 939066 Mar 16 20:40 /app/oracle/product/ggate/11g/1/dirdat/h11epmp/RR/ra000000000


############
# cdsinfop #
# 3/19     #
############

set lines 150 pages 200
col owner format a30
col mview_name format a30
select uv.owner, uv.mview_name, uo.status, uo.last_ddl_time
from dba_MVIEWS uv join dba_objects uo on uv.mview_name=uo.object_name
where uo.object_type='MATERIALIZED VIEW'
order by 1,2;

-- uxp34
OWNER                          MVIEW_NAME                     STATUS  LAST_DDL_
------------------------------ ------------------------------ ------- ---------
CDSINFO                        BK                             INVALID 30-JUL-17
CDSINFO                        CDS_SNAPSHOT_BK                INVALID 15-MAR-18
CDSINFO                        CDS_SNAPSHOT_P                 VALID   16-MAR-18
CDSINFO                        P                              INVALID 30-JUL-17


-- lxorafinp04
OWNER                          MVIEW_NAME                     STATUS  LAST_DDL_T
------------------------------ ------------------------------ ------- ----------
CDSINFO                        BK                             INVALID 03/14/2018
CDSINFO                        P                              INVALID 03/14/2018

-- expdp
. . exported "CDSINFO"."CDS_SNAPSHOT_BK"                 1.049 GB 7268604 rows
. . exported "CDSINFO"."CDS_SNAPSHOT_P"                  1.048 GB 7260138 rows
Processing object type SCHEMA_EXPORT/MATERIALIZED_VIEW
     Completed 4 MATERIALIZED_VIEW objects in 34 seconds
	 
-- impdp
03/14/2018 12:59:28.798: . . imported "CDSINFO"."CDS_SNAPSHOT_BK"                 1.049 GB 7268604 rows in 90 seconds
03/14/2018 13:00:20.367: . . imported "CDSINFO"."CDS_SNAPSHOT_P"                  1.048 GB 7260138 rows in 89 seconds
03/14/2018 14:05:41.424: Processing object type SCHEMA_EXPORT/MATERIALIZED_VIEW
03/14/2018 14:05:42.231:      Completed 4 MATERIALIZED_VIEW objects in 1 seconds

-- import log
-- table counts match so the mviews not in diff subquery
TABLE                                             AIX        LINUX          DIFFERENCE MVIEW
---------------------------------------- ------------ ------------ ------------------- -----
.                                                                                      YES
.                                                                                      YES
.                                                                                      YES
.                                                                                      YES

-- GGRR1 log
There are 82 tables.
There are 231 objects.

-- GGRR2 log
There are 86 tables.
There are 235 objects.

TABLE                                             AIX        LINUX          DIFFERENCE
---------------------------------------- ------------ ------------ -------------------
AUDITCDS.T_CDSINFOP_LOGIN_DTLS              1,001,439    1,003,283                1844
CDSINFO.CDS_SNAPSHOT_BK                     7,272,251    7,268,604               -3647
CDSINFO.CDS_SNAPSHOT_P                      7,268,793    7,260,138               -8655

OBJECT_TYPE         OBJECT_NAME                              AIX     LINUX
------------------- ---------------------------------------- ------- -------
MATERIALIZED VIEW   CDSINFO.CDS_SNAPSHOT_P                   VALID   INVALID

-- impdp_cdsinfop_tables.log (no mviews included)
. . imported "CDSINFO"."CDS_SNAPSHOT_BK"                 1.050 GB 7272251 rows
. . imported "CDSINFO"."CDS_SNAPSHOT_P"                  1.049 GB 7268793 rows

-- lxorafinp04
select owner, table_name, status, record_count
from ggtest.row_count_aix
where table_name in ('CDS_SNAPSHOT_BK','CDS_SNAPSHOT_P')
order by 1,2;
OWNER                          TABLE_NAME                                         STATUS   RECORD_COUNT
------------------------------ -------------------------------------------------- -------- ------------
CDSINFO                        CDS_SNAPSHOT_BK                                    VALID         7272251
CDSINFO                        CDS_SNAPSHOT_P                                     VALID         7268793

select owner, table_name, status, record_count
from ggtest.row_count_linux
where table_name in ('CDS_SNAPSHOT_BK','CDS_SNAPSHOT_P')
order by 1,2;
OWNER                          TABLE_NAME                                         STATUS   RECORD_COUNT
------------------------------ -------------------------------------------------- -------- ------------
CDSINFO                        CDS_SNAPSHOT_BK                                    VALID         7272251
CDSINFO                        CDS_SNAPSHOT_P                                     VALID         7268793

col OBJECT_NAME format a30
select * from ggtest.object_count_aix
where OBJECT_NAME in ('CDS_SNAPSHOT_BK','CDS_SNAPSHOT_P')
order by 1,2,3;
OWNER                          OBJECT_NAME                    OBJECT_TYPE         STATUS
------------------------------ ------------------------------ ------------------- -------
CDSINFO                        CDS_SNAPSHOT_BK                MATERIALIZED VIEW   INVALID
CDSINFO                        CDS_SNAPSHOT_BK                TABLE               VALID
CDSINFO                        CDS_SNAPSHOT_P                 MATERIALIZED VIEW   VALID
CDSINFO                        CDS_SNAPSHOT_P                 TABLE               VALID

select * from ggtest.object_count_linux
where OBJECT_NAME in ('CDS_SNAPSHOT_BK','CDS_SNAPSHOT_P')
order by 1,2,3;
OWNER                          OBJECT_NAME                    OBJECT_TYPE         STATUS
------------------------------ ------------------------------ ------------------- -------
CDSINFO                        CDS_SNAPSHOT_BK                TABLE               VALID
CDSINFO                        CDS_SNAPSHOT_P                 TABLE               VALID

col "OBJECT_NAME" format a40
select aix.OBJECT_TYPE, aix.OWNER||'.'||aix.OBJECT_NAME "OBJECT_NAME", aix.STATUS "AIX", lx.STATUS "LINUX"
from ggtest.object_count_linux lx full outer join ggtest.object_count_aix aix
  on aix.OWNER=lx.OWNER and aix.OBJECT_NAME=lx.OBJECT_NAME and aix.OBJECT_TYPE=lx.OBJECT_TYPE
where lx.STATUS!=aix.STATUS and lx.STATUS!='VALID' and lx.owner not in ('GGS','GGTEST')
and aix.OBJECT_NAME in ('CDS_SNAPSHOT_BK','CDS_SNAPSHOT_P')
order by aix.OBJECT_TYPE, aix.OWNER, aix.OBJECT_NAME;


############
# obieep   #
# ROBIEEP1 #
# 3/20     #
############

REPLICAT   ROBIEEP1  Last Started 2018-03-20 09:26   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:05:08 ago)
Process ID           28952
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/obieep/ra000000000
                     2018-03-20 09:59:30.403216  RBA 1830437

-- report
2018-03-20 10:07:06  INFO    OGG-01408  Restoring current schema for DDL operation to [GGS].
                4484 records processed as of 2018-03-20 10:07:06 (rate 1,delta 0)

-- lxorafinp06
set lines 150 pages 200
COLUMN username FORMAT A10
COLUMN program FORMAT A35
col osuser format a10
col sid format 9990
col "SER" format 99990
col "Description" format a55
ALTER SESSION SET NLS_DATE_FORMAT='MM/DD/RR HH24:MI';
SELECT DISTINCT s.sid, s.serial# "SER", s.username, s.osuser, s.logon_time, s.program,
decode(s.state,'WAITING','Waiting '||s.seconds_in_wait||'s for '||NVL2(s.sql_id, s.sql_id, event),s.sql_id) "Description"
FROM v$session s
WHERE s.username='GGS'
ORDER BY s.logon_time, s.program;
  SID    SER USERNAME   OSUSER     LOGON_TIME     PROGRAM                             Description
----- ------ ---------- ---------- -------------- ----------------------------------- -------------------------------------------------------
 1028   5599 GGS        oracle     03/20/18 09:26 replicat@lxoggp01 (TNS V1-V3)       626y9h5y8wu9a
  623   1203 GGS        oracle     03/20/18 09:27 oracle@LXORAFINP06 (AS01)           Waiting 0s for Streams: waiting for messages
  821   1177 GGS        oracle     03/20/18 09:27 oracle@LXORAFINP06 (AS02)           Waiting 1s for rdbms ipc message
  205    421 GGS        oracle     03/20/18 09:27 oracle@LXORAFINP06 (AS03)           Waiting 0s for rdbms ipc message
  421   1127 GGS        oracle     03/20/18 09:27 oracle@LXORAFINP06 (AS04)           Waiting 1s for rdbms ipc message
  829   5251 GGS        oracle     03/20/18 09:27 oracle@LXORAFINP06 (AS06)           Waiting 2s for rdbms ipc message
 1023     49 GGS        oracle     03/20/18 09:27 oracle@LXORAFINP06 (AS07)           Waiting 1s for rdbms ipc message
  415     53 GGS        oracle     03/20/18 10:07 oracle@LXORAFINP06 (AS08)           Waiting 1s for rdbms ipc message

SELECT * FROM table (DBMS_XPLAN.DISPLAY_CURSOR('626y9h5y8wu9a'));
CREATE BITMAP INDEX "OBAW"."W_GL_BALANCE_A_F16" ON
"OBAW"."W_GL_BALANCE_A"(X_ACCOUNT_SEG10_CODE Asc
,X_ACCOUNT_SEG10_ATTRIB Asc) LOCAL /* GOLDENGATE_DDL_REPLICATION */
Plan hash value: 1228394892
-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name               | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------------
|   0 | CREATE INDEX STATEMENT           |                    |       |       |  3210K(100)|          |       |       |
|   1 |  PARTITION RANGE ALL             |                    |   451M|  6024M|            |          |     1 |    10 |
|   2 |   PARTITION RANGE ALL            |                    |   451M|  6024M|            |          |     1 |  LAST |
|   3 |    INDEX BUILD NON UNIQUE (LOCAL)| W_GL_BALANCE_A_F16 |       |       |            |          |     1 |    40 |
|   4 |     BITMAP COMPACTION            |                    |       |       |            |          |       |       |
|   5 |      SORT CREATE INDEX           |                    |   451M|  6024M|            |          |       |       |
|   6 |       BITMAP CONSTRUCTION        |                    |       |       |            |          |       |       |
|   7 |        TABLE ACCESS FULL         | W_GL_BALANCE_A     |   451M|  6024M|  2527K  (1)| 00:04:34 |     1 |    40 |
-----------------------------------------------------------------------------------------------------------------------
Note
-----
   - estimated index size: 51G bytes

SELECT DISTINCT s.sid, s.serial# "SER", s.username, s.osuser, s.logon_time, s.program,
decode(s.state,'WAITING','Waiting '||s.seconds_in_wait||'s for '||NVL2(s.sql_id, s.sql_id, event),s.sql_id) "Description"
FROM v$session s
WHERE s.username='GGS' and s.sql_id is not null
ORDER BY s.logon_time, s.program;
  SID    SER USERNAME   OSUSER     LOGON_TIME     PROGRAM                             Description
----- ------ ---------- ---------- -------------- ----------------------------------- -------------------------------------------------------
 1028   5599 GGS        oracle     03/20/18 09:26 replicat@lxoggp01 (TNS V1-V3)       8ryaq7tb7fqsj

SELECT * FROM table (DBMS_XPLAN.DISPLAY_CURSOR('8ryaq7tb7fqsj'));
CREATE BITMAP INDEX "OBAW"."W_GL_BALANCE_A_F17" ON
"OBAW"."W_GL_BALANCE_A"(X_ACCOUNT_SEG11_CODE Asc
,X_ACCOUNT_SEG11_ATTRIB Asc) LOCAL /* GOLDENGATE_DDL_REPLICATION */
Plan hash value: 69997896
-----------------------------------------------------------------------------------------------------------------------
| Id  | Operation                        | Name               | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-----------------------------------------------------------------------------------------------------------------------
|   0 | CREATE INDEX STATEMENT           |                    |       |       |  3211K(100)|          |       |       |
|   1 |  PARTITION RANGE ALL             |                    |   451M|  6024M|            |          |     1 |    10 |
|   2 |   PARTITION RANGE ALL            |                    |   451M|  6024M|            |          |     1 |  LAST |
|   3 |    INDEX BUILD NON UNIQUE (LOCAL)| W_GL_BALANCE_A_F17 |       |       |            |          |     1 |    40 |
|   4 |     BITMAP COMPACTION            |                    |       |       |            |          |       |       |
|   5 |      SORT CREATE INDEX           |                    |   451M|  6024M|            |          |       |       |
|   6 |       BITMAP CONSTRUCTION        |                    |       |       |            |          |       |       |
|   7 |        TABLE ACCESS FULL         | W_GL_BALANCE_A     |   451M|  6024M|  2528K  (1)| 00:04:34 |     1 |    40 |
-----------------------------------------------------------------------------------------------------------------------
Note
-----
   - estimated index size: 51G bytes

col "Description" format a90
SELECT s.sid, s.serial# "SER", s.username, s.osuser, s.sql_id,
decode(s.state,'WAITING','Waiting '||s.seconds_in_wait||'s for '||NVL2(q.sql_text, q.sql_text, event),q.sql_text) "Description"
FROM v$session s left outer join v$sql q on s.sql_id=q.sql_id
WHERE s.username='GGS' and s.sql_id is not null;
  SID    SER USERNAME   OSUSER     SQL_ID        Description
----- ------ ---------- ---------- ------------- ------------------------------------------------------------------------------------------
 1028   5599 GGS        oracle     00qphzbxcjrj6 Waiting 0s for CREATE BITMAP INDEX "OBAW"."W_GL_BALANCE_A_F15" ON "OBAW"."W_GL_BALANCE_A"(
                                                 X_ACCOUNT_SEG9_CODE Asc  ,X_ACCOUNT_SEG9_ATTRIB Asc) LOCAL /* GOLDENGATE_DDL_REPLICATION *
                                                 /

-- 11:30
REPLICAT   ROBIEEP1  Last Started 2018-03-20 09:26   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:18 ago)
Process ID           28952
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/obieep/ra000000000
                     2018-03-20 11:31:03.656800  RBA 2566644

> sh ls -l /app/oracle/product/ggate/11g/1/dirdat/obieep/ra0*
-rw-r-----. 1 oracle dba 999996008 Mar 19 23:13 /app/oracle/product/ggate/11g/1/dirdat/obieep/ra000000000
...
-rw-r-----. 1 oracle dba 999999609 Mar 20 03:14 /app/oracle/product/ggate/11g/1/dirdat/obieep/ra000000070
-rw-r-----. 1 oracle dba 999999662 Mar 20 07:42 /app/oracle/product/ggate/11g/1/dirdat/obieep/ra000000071
-rw-r-----. 1 oracle dba 937766793 Mar 20 11:31 /app/oracle/product/ggate/11g/1/dirdat/obieep/ra000000072

REPLICAT   ROBIEEP1  Last Started 2018-03-20 09:26   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:03:38 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/obieep/ra000000000
                     2018-03-20 12:01:11.129487  RBA 5721495

-- report
2018-03-20 12:01:12  ERROR   OGG-03521  Invalid character for character set UTF-8 was found while performing character validation of source column ISO_COUNTRY_NAME maps target column ISO_COUNTRY_NAME.

-- edit params
--SETENV (NLS_LAG = "AMERICAN_AMERICA.AL32UTF8")
NOCHARSETCONVERSION

REPLICAT   ROBIEEP1  Last Started 2018-03-20 12:06   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           5601
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/obieep/ra000000000
                     2018-03-20 12:06:38.380138  RBA 6635182

REPLICAT   ROBIEEP1  Last Started 2018-03-20 12:06   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:32 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/obieep/ra000000000
                     2018-03-20 12:06:52.280524  RBA 14832908

-- report
2018-03-20 12:06:54  WARNING OGG-01154  SQL error 1403 mapping OBAW.W_POSITION_DH_BASE_TMP to OBAW.W_POSITION_DH_BASE_TMP OCI Error ORA-01403: no data found, SQL <U
PDATE "OBAW"."W_POSITION_DH_BASE_TMP" x SET x."POSTN_INTEGRATION_ID" = :a6,x."DATASOURCE_NUM_ID" = :a7,x."SCD_TYPE1_FLG" = :a8,x."SCD_TYPE2_FLG" = :a9,x."SCD_TYPE1B
_FLG" = :a10,x."SCD_TYPE2B_FLG" = :a11 WHERE x."POSTN_INTEGRATION_ID" = :b0 AND x."DATASOURCE_NUM_ID" = :b1 AND x."SCD_TYPE1_FLG" = :b2 AND x."SCD_TYPE2_FLG" = :b3
AND x."SCD_TYPE1B_FLG" is NULL AND x."SCD_TYPE2B_FLG" is NULL AND ROWNUM = 1>.

-- edit params ROBIEEP1
MAPEXCLUDE OBAW.W_POSITION_DH_BASE_TMP

REPLICAT   ROBIEEP1  Last Started 2018-03-20 12:11   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           5848
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/obieep/ra000000000
                     2018-03-20 12:11:40.464277  RBA 43314664

2018-03-20 13:31:05  INFO    OGG-02232  Switching to next trail file /app/oracle/product/ggate/11g/1/dirdat/obieep/ra000000054 at 2018-03-20 13:31:05.070649 due to EOF. with current RBA 999999614.
2018-03-20 13:40:49  INFO    OGG-02232  Switching to next trail file /app/oracle/product/ggate/11g/1/dirdat/obieep/ra000000071 at 2018-03-20 13:40:49.978887 due to EOF. with current RBA 999999609.


############
# cdsinfop #
# rollback #
# 3/24     #
############

-- lxorafinp04
info *

EXTRACT    ECD_FOP2  Last Started 2018-03-24 11:48   Status RUNNING
Checkpoint Lag       00:00:09 (updated 00:00:01 ago)
Process ID           15432
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-03-24 18:35:03
                     SCN 2551.47253334 (10956508825430)

EXTRACT    PCD_FOP2  Last Started 2018-03-24 11:48   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:00:09 ago)
Process ID           15459
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/cdsinfop/RR/ea000000006
                     2018-03-24 18:35:02.000000  RBA 60851221

select sequence# from v$archived_log where &what_scn between FIRST_CHANGE# and NEXT_CHANGE#-1;


-- data validation Linux
spool /app/oracle/scripts/12cupgrade/logs/cdsinfop_rollback_20180324.log

truncate table GGTEST.ROW_COUNT_LINUX;
truncate table GGTEST.OBJECT_COUNT_LINUX;
truncate table ggtest.index_count_linux;
truncate table ggtest.constraint_count_linux;

-- insert object info
insert into GGTEST.OBJECT_COUNT_LINUX
select owner, object_name, object_type, status
from DBA_OBJECTS
where object_type not like '%PARTITION%' and owner not in
('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS')
and SUBOBJECT_NAME is null
and (owner, object_name, object_type) not in
(select owner, object_name, object_type from DBA_OBJECTS where owner='PUBLIC' and object_type='SYNONYM');
commit;

-- insert table counts
set serveroutput on
declare
  cursor cf is
    select db.name, ins.host_name,
	  tb.owner, tb.table_name, tb.status
	from DBA_TABLES tb, v$instance ins, v$database db
	where tb.IOT_TYPE is null and owner not in
	('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS')
	and (tb.owner, tb.table_name) not in (select owner, table_name from dba_external_tables);
  record_count number;
  sql_str      varchar2(2000);
  rec cf%rowtype;
begin
  open cf;
  loop
    fetch cf
      into rec;
    exit when cf%notfound;
    sql_str := 'select count(1) from "' || rec.owner || '"."' || rec.table_name || '"';
    execute immediate sql_str into record_count;
--    dbms_output.put_line(rec.owner || ',' || rec.table_name || ',' || rec.status || ',' || record_count);
    insert into GGTEST.ROW_COUNT_LINUX
    values
      (rec.name, rec.host_name, rec.owner, rec.table_name, rec.status, record_count);
      commit;
  end loop;
  close cf;
end;
/

-- insert index info
insert into ggtest.index_count_linux
select OWNER, INDEX_NAME, INDEX_TYPE, TABLE_OWNER, TABLE_NAME, STATUS
from DBA_INDEXES
where owner not in ('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS');
commit;

-- insert constraint info
insert into ggtest.constraint_count_linux
select owner, table_name, constraint_name, constraint_type, status
from dba_constraints
where owner not in ('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS');
commit;

select 'There are '||count(*)||' tables.' from GGTEST.ROW_COUNT_LINUX;
select 'There are '||count(*)||' objects.' from GGTEST.OBJECT_COUNT_LINUX;
select 'There are '||count(*)||' indexes.' from ggtest.index_count_linux;
select 'There are '||count(*)||' constraints.' from ggtest.constraint_count_linux;

select distinct 'FLUSH SEQUENCE '||sequence_owner||'.*'
from dba_sequences 
where sequence_owner not in ('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS')
order by 1;

-----------------------------------------------------------
There are 86 tables.
There are 236 objects.


-- ggsci
stats extract ECD_FOP2 latest table GGTEST.ROW_COUNT_LINUX
stats extract ECD_FOP2 latest table GGTEST.OBJECT_COUNT_LINUX
stats extract PCD_FOP2 latest table GGTEST.ROW_COUNT_LINUX
stats extract PCD_FOP2 latest table GGTEST.OBJECT_COUNT_LINUX

dblogin userid ggs
FLUSH SEQUENCE cdsinfop.CDSINFO.*

EXTRACT    ECD_FOP2  Last Started 2018-03-24 11:48   Status RUNNING
Checkpoint Lag       00:00:09 (updated 00:00:03 ago)
Process ID           15432
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-03-24 19:41:45
                     SCN 2551.47266349 (10956508838445)

EXTRACT    PCD_FOP2  Last Started 2018-03-24 11:48   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:00:07 ago)
Process ID           15459
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/cdsinfop/RR/ea000000006
                     2018-03-24 19:40:01.000000  RBA 60982053

-- sqlplus
select sequence# from v$archived_log where &what_scn between FIRST_CHANGE# and NEXT_CHANGE#-1;
no rows selected

> ls -l /app/oracle/product/ggate/12c/1/dirdat/cdsinfop/RR/ea*

EXTRACT    ECD_FOP2  Last Started 2018-03-24 11:48   Status STOPPED
Checkpoint Lag       00:00:02 (updated 00:00:28 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-03-24 19:47:45
                     SCN 2551.47266853 (10956508838949)

EXTRACT    PCD_FOP2  Last Started 2018-03-24 11:48   Status STOPPED
Checkpoint Lag       00:00:00 (updated 00:00:13 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/cdsinfop/RR/ea000000006
                     2018-03-24 19:45:00.000000  RBA 60983691


-- lxoggp01
REPLICAT   RCD_FOP2  Last Started 2018-03-24 11:49   Status ABENDED
INTEGRATED
Checkpoint Lag       00:04:22 (updated 00:19:14 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/cdsinfop/RR/ra000000009
                     2018-03-24 19:25:24.006461  RBA 60862083

2018-03-24 19:29:59  WARNING OGG-01154  SQL error 1 mapping CDSINFOP.GGTEST.OBJECT_COUNT_LINUX to GGTEST.OBJECT_COUNT_LINUX OCI Error ORA-00001: unique
constraint (GGTEST.OBJECT_COUNT_LINUX_PK) violated (status = 1), SQL <INSERT INTO "GGTEST"."OBJECT_COUNT_LINUX" ("OWNER","OBJECT_NAME","OBJECT_TYPE","ST
ATUS") VALUES (:a0,:a1,:a2,:a3)>.

2018-03-24 19:52:56  WARNING OGG-01154  SQL error 1 mapping CDSINFOP.GGTEST.ROW_COUNT_LINUX to GGTEST.ROW_COUNT_LINUX OCI Error ORA-00001: unique constr
aint (GGTEST.ROW_COUNT_LINUX_PK) violated (status = 1), SQL <INSERT INTO "GGTEST"."ROW_COUNT_LINUX" ("DB_NAME","HOST_NAME","OWNER","TABLE_NAME","STATUS"
,"RECORD_COUNT") VALUES (:a0,:a1,:a2,:a3,:a4,:a5)>.

REPLICAT   RCD_FOP2  Last Started 2018-03-24 19:54   Status STOPPED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/cdsinfop/RR/ra000000009
                     2018-03-24 20:03:50.520274  RBA 60983212

					 
-- AIX
ALTER TABLE GGTEST.OBJECT_COUNT_LINUX DISABLE CONSTRAINT OBJECT_COUNT_LINUX_PK;
ALTER TABLE GGTEST.ROW_COUNT_LINUX DISABLE CONSTRAINT ROW_COUNT_LINUX_PK;


-- data validation AIX
vRowTable="ggtest.row_count_aix"
vObjectTable="ggtest.object_count_aix"
vIndexTable="ggtest.index_count_aix"
vConstraintTable="ggtest.constraint_count_aix"

spool /nomove/app/oracle/scripts/12cupgrade/logs/cdsinfop_rollback_aix_20180324.log
truncate table ggtest.row_count_aix;
truncate table ggtest.object_count_aix;
truncate table ggtest.index_count_aix;
truncate table ggtest.constraint_count_aix;

-- insert object info
insert into GGTEST.object_count_aix
select owner, object_name, object_type, status
from DBA_OBJECTS
where object_type not like '%PARTITION%' and owner not in
('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS')
and SUBOBJECT_NAME is null
and (owner, object_name, object_type) not in
(select owner, object_name, object_type from DBA_OBJECTS where owner='PUBLIC' and object_type='SYNONYM');
commit;

-- insert table counts
set serveroutput on
declare
  cursor cf is
    select db.name, ins.host_name,
	  tb.owner, tb.table_name, tb.status
	from DBA_TABLES tb, v$instance ins, v$database db
	where tb.IOT_TYPE is null and owner not in
	('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS')
	and (tb.owner, tb.table_name) not in (select owner, table_name from dba_external_tables);
  record_count number;
  sql_str      varchar2(2000);
  rec cf%rowtype;
begin
  open cf;
  loop
    fetch cf
      into rec;
    exit when cf%notfound;
    sql_str := 'select count(1) from "' || rec.owner || '"."' || rec.table_name || '"';
    execute immediate sql_str into record_count;
--    dbms_output.put_line(rec.owner || ',' || rec.table_name || ',' || rec.status || ',' || record_count);
    insert into GGTEST.row_count_aix
    values
      (rec.name, rec.host_name, rec.owner, rec.table_name, rec.status, record_count);
      commit;
  end loop;
  close cf;
end;
/

-- insert index info
insert into ggtest.index_count_aix
select OWNER, INDEX_NAME, INDEX_TYPE, TABLE_OWNER, TABLE_NAME, STATUS
from DBA_INDEXES
where owner not in ('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS');
commit;

-- insert constraint info
insert into ggtest.constraint_count_aix
select owner, table_name, constraint_name, constraint_type, status
from dba_constraints
where owner not in ('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS');
commit;

select 'There are '||count(*)||' tables.' from ggtest.row_count_aix;
select 'There are '||count(*)||' objects.' from ggtest.object_count_aix;
select 'There are '||count(*)||' indexes.' from ggtest.index_count_aix;
select 'There are '||count(*)||' constraints.' from ggtest.constraint_count_aix;

There are 286 tables.
There are 1209 objects.
There are 335 indexes.
There are 813 constraints.

-- Table count comparison
col "TABLE" format a40
col "AIX" format 999,999,990
col "LINUX" format 999,999,990
col MVIEW format a5
select diff.OWNER||'.'||diff.TABLE_NAME "TABLE", diff."AIX", diff."LINUX", diff."DIFFERENCE", NVL2(mv.mview_name,'YES',NULL) "MVIEW"
from dba_mviews mv right outer join
	(select NVL(lx.OWNER,aix.OWNER) "OWNER", NVL(lx.TABLE_NAME,aix.TABLE_NAME) "TABLE_NAME", aix.RECORD_COUNT "AIX", lx.RECORD_COUNT "LINUX", lx.RECORD_COUNT-aix.RECORD_COUNT "DIFFERENCE"
	 from ggtest.row_count_linux lx full outer join ggtest.row_count_aix aix
		on aix.OWNER=lx.OWNER and aix.TABLE_NAME=lx.TABLE_NAME
	 where (lx.RECORD_COUNT!=aix.RECORD_COUNT OR lx.RECORD_COUNT IS NULL OR aix.RECORD_COUNT IS NULL)
		and lx.owner not in ('GGS','GGTEST')) diff
	on mv.owner=diff.owner and mv.mview_name=diff."TABLE_NAME"
order by 1;

-- Table status comparison
select lx.OWNER||'.'||lx.TABLE_NAME "TABLE", aix.STATUS "AIX", lx.STATUS "LINUX"
from ggtest.row_count_linux lx full outer join ggtest.row_count_aix aix
  on aix.OWNER=lx.OWNER and aix.TABLE_NAME=lx.TABLE_NAME
where lx.STATUS!=aix.STATUS and lx.owner not in ('GGS','GGTEST')
order by 1;

-- Index count comparison
col "AIX INDEX" format a50
col "LINUX INDEX" format a50
select aix.OWNER||'.'||aix.INDEX_NAME "AIX-INDEX", lx.OWNER||'.'||lx.INDEX_NAME "LX-INDEX"
from ggtest.index_count_linux lx full outer join ggtest.index_count_aix aix
  on aix.OWNER=lx.OWNER and aix.INDEX_NAME=lx.INDEX_NAME
where lx.INDEX_NAME is null and lx.owner not in ('GGS','GGTEST')
order by aix.OWNER, aix.INDEX_NAME, lx.OWNER, lx.INDEX_NAME;

-- Object status comparison
col "OBJECT_NAME" format a40
select lx.OBJECT_TYPE, lx.OWNER||'.'||lx.OBJECT_NAME "OBJECT_NAME", aix.STATUS "AIX", lx.STATUS "LINUX"
from ggtest.object_count_linux lx full outer join ggtest.object_count_aix aix
  on aix.OWNER=lx.OWNER and aix.OBJECT_NAME=lx.OBJECT_NAME and aix.OBJECT_TYPE=lx.OBJECT_TYPE
where lx.STATUS!=aix.STATUS and aix.STATUS!='VALID' OR aix.STATUS is null
--and lx.owner not in ('GGS','GGTEST')
order by aix.OBJECT_TYPE, aix.OWNER, aix.OBJECT_NAME;

-- Constraint comparison
select lx.owner, lx.table_name, lx.constraint_name, lx.constraint_type, aix.STATUS "AIX", lx.STATUS "LINUX"
from ggtest.constraint_count_linux lx full outer join ggtest.constraint_count_aix aix
	on aix.owner=lx.owner and aix.table_name=lx.table_name and aix.constraint_name=lx.constraint_name
where lx.STATUS!=aix.STATUS and lx.owner not in ('GGS','GGTEST')
order by 1;


AUDITCDS.T_CDSINFOP_LOGIN_DTLS              1,021,387    1,012,451      -8936
AUDITCDS.T_CDSINFOP_LOGIN_DTLS              1,021,387    1,001,662     -19725
CDSINFO.AP_BSTRN_DETAIL                   181,379,411  181,082,989    -296422
CDSINFO.AP_BSTRN_HEADER                    60,526,166   60,429,130     -97036
CDSINFO.AP_CHECK_STATUS                   114,571,714  114,384,443    -187271
CDSINFO.AP_DESCRIPTION                     73,367,949   73,261,426    -106523
CDSINFO.AP_REMIT_ADDR                      60,526,166   60,429,130     -97036
CDSINFO.BSTRN_DETAIL                      181,379,411  181,082,989    -296422
CDSINFO.BSTRN_DTL_LOC                      90,130,768   89,951,194    -179574
CDSINFO.BSTRN_HEADER                       60,526,166   60,429,130     -97036
CDSINFO.BU_SETS                            22,760,322   22,659,534    -100788
CDSINFO.BU_SET_DETAILS
CDSINFO.REFRESHDATE_CDSINFO                         6            1         -5
CDSINFO.REFRESHDATE_CDSINFO                         6            1         -5
CDSINFO.REFRESHDATE_CDSINFO_BK                      6            1         -5
CDSINFO.REFRESHDATE_CDSINFO_BK

expdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAFINP04.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=cdsinfop)))\" parfile=/oragg/datapump/cdsinfop/expdp_cdsinfop_rollback.par

DIRECTORY=CNO_MIGRATE
DUMPFILE=cdsinfop_rollback_%U.dmp
LOGFILE=impdp_cdsinfop_rollback.log
PARALLEL=4
METRICS=Y
EXCLUDE=STATISTICS
TABLE_EXISTS_ACTION=REPLACE

impdp \"system@cdsinfop\" parfile=/oragg/datapump/cdsinfop/impdp_cdsinfop_rollback.par

-- MViews
EXEC DBMS_MVIEW.REFRESH(LIST=>'CDSINFO.CDS_SNAPSHOT_BK',PARALLELISM=>2);
ORA-12008: error in materialized view refresh path
ORA-30036: unable to extend segment by 8 in undo tablespace 'UNDO'

EXEC DBMS_MVIEW.REFRESH(LIST=>'CDSINFO.CDS_SNAPSHOT_P',PARALLELISM=>2);
ORA-12008: error in materialized view refresh path
ORA-30036: unable to extend segment by 8 in undo tablespace 'UNDO'


-- linux
alter session set container=cdsinfop;
set lines 1000 pages 0
spool /app/oracle/scripts/12cupgrade/cdsinfop_lock_users.sql
select 'ALTER USER "'||username||'" ACCOUNT LOCK;'
from dba_users
where ACCOUNT_STATUS in ('OPEN','EXPIRED') and USERNAME not in ('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS')
order by 1;
@/app/oracle/scripts/12cupgrade/cdsinfop_lock_users.sql


-- invalid objects
set lines 150 pages 200
col object_name format a30
select owner, object_name, object_type, status
from dba_objects
where object_name in
('CDS_SNAPSHOT_BK',
'CNC_AP_BSTRN_HDR_REJ_VIEW',
'SPU_INS_CDSHIST_AP_DESC',
'SPU_INS_CDSHIST_CK_STATUS',
'SPU_INS_CDSHIST_DETAIL',
'SPU_INS_CDSHIST_DETAIL2',
'SPU_INS_CDSHIST_HEADER',
'SPU_INS_CDSHIST_REMIT_ADDR',
'VIEW_CRS_DAILY_CHECKS')
order by 1,2;

OWNER                          OBJECT_NAME                    OBJECT_TYPE         STATUS
------------------------------ ------------------------------ ------------------- -------
CDSINFO                        CDS_SNAPSHOT_BK                TABLE               VALID
CDSINFO                        CDS_SNAPSHOT_BK                MATERIALIZED VIEW   VALID
CDSINFO                        CNC_AP_BSTRN_HDR_REJ_VIEW      VIEW                INVALID
CDSINFO                        SPU_INS_CDSHIST_AP_DESC        PROCEDURE           INVALID
CDSINFO                        SPU_INS_CDSHIST_CK_STATUS      PROCEDURE           INVALID
CDSINFO                        SPU_INS_CDSHIST_DETAIL         PROCEDURE           INVALID
CDSINFO                        SPU_INS_CDSHIST_DETAIL2        PROCEDURE           INVALID
CDSINFO                        SPU_INS_CDSHIST_HEADER         PROCEDURE           INVALID
CDSINFO                        SPU_INS_CDSHIST_REMIT_ADDR     PROCEDURE           INVALID
CDSINFO                        VIEW_CRS_DAILY_CHECKS          VIEW                INVALID

alter procedure CDSINFO.SPU_INS_CDSHIST_AP_DESC compile;
alter procedure CDSINFO.SPU_INS_CDSHIST_CK_STATUS compile;
alter procedure CDSINFO.SPU_INS_CDSHIST_DETAIL compile;
alter procedure CDSINFO.SPU_INS_CDSHIST_DETAIL2 compile;
alter procedure CDSINFO.SPU_INS_CDSHIST_HEADER compile;
alter procedure CDSINFO.SPU_INS_CDSHIST_REMIT_ADDR compile;
alter view CDSINFO.CNC_AP_BSTRN_HDR_REJ_VIEW compile;
alter view CDSINFO.VIEW_CRS_DAILY_CHECKS compile;

select owner, object_name, object_type, status
from dba_objects
where status!='VALID' order by 1,2,3;

OWNER                          OBJECT_NAME                    OBJECT_TYPE         STATUS
------------------------------ ------------------------------ ------------------- -------
CDSINFO                        BK                             MATERIALIZED VIEW   INVALID
CDSINFO                        P                              MATERIALIZED VIEW   INVALID
CDSINFO                        WEBDBTEST012345678912          PROCEDURE           INVALID
DBAQUEST                       QUEST_FG_EXTENTS_CHECK         PACKAGE BODY        INVALID
DBAQUEST                       QUEST_FG_PKG                   PACKAGE BODY        INVALID
DBAQUEST                       QUEST_IX_HOT_BLOCK_STATS       VIEW                INVALID
DBAQUEST                       QUEST_IX_LATCH_RULE_PAK        PACKAGE BODY        INVALID
NETWEB                         CDSINFOQUERYPKG                PACKAGE BODY        INVALID
NETWEB                         TRANSACTIONQUERYPKG_ARCH_NEW   PACKAGE BODY        INVALID
NETWEB                         TRANSACTIONQUERYPKG_CURR_NEW   PACKAGE BODY        INVALID
PUBLIC                         X$BH                           SYNONYM             INVALID
PUBLIC                         X$KCBWDS                       SYNONYM             INVALID
PUBLIC                         X$KGLLK                        SYNONYM             INVALID
PUBLIC                         X$KSLEI                        SYNONYM             INVALID
SYS                            X_$BH                          VIEW                INVALID
SYS                            X_$KCBWDS                      VIEW                INVALID
SYS                            X_$KGLLK                       VIEW                INVALID
SYS                            X_$KSLEI                       VIEW                INVALID


########
# PROD #
# TRMP #
# 3/29 #
########

-- TRMP (CCMSTAGE schema)
create table trade_blotter_014911 tablespace usrtmp as select * from trade_blotter where blot_pkg.isTradeComplete(blotter_no)='Y'
                                                                     *
ERROR at line 1:
ORA-04045: errors during recompilation/revalidation of CCMTRADE.BLOT_PKG
ORA-04052: error occurred when looking up remote object
CCMTRADE.SECURITIES@TRADELINK
ORA-00604: error occurred at recursive SQL level 2
ORA-12840: cannot access a remote table after parallel/insert direct load txn
ORA-02063: preceding line from TRADELINK

-- PROD (CCMPROD schema)
create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter
where  blot_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';

where  blot_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
                                            *
ERROR at line 3:
ORA-04045: errors during recompilation/revalidation of CCMPROD.BLOT_PKG
ORA-04052: error occurred when looking up remote object
CCMPROD.TRADE_BLOTTER@PRODLINK
ORA-00604: error occurred at recursive SQL level 2
ORA-12840: cannot access a remote table after parallel/insert direct load txn
ORA-02063: preceding line from PRODLINK

-- PROD (DB links)
PUBLIC
PRODLINK
DBLINK
(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = prod_pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = prod)))
02/18/2018


-- PROD objects
col owner format a30
col object_name format a30
select owner, object_name, object_type, status from dba_objects where owner='&what_owner' and object_name='&what_obj' order by 1,2,3;
select owner, object_name, object_type, status from dba_objects where object_name='&what_obj' order by 1,2,3;
OWNER                          OBJECT_NAME                    OBJECT_TYPE             STATUS	reference
------------------------------ ------------------------------ ----------------------- -------
PUBLIC                         BLOT_PKG                       SYNONYM                 VALID
CCMPROD                        BLOT_PKG                       PACKAGE BODY            VALID
CCMPROD                        BLOT_PKG                       PACKAGE                 VALID
CCMPROD                        TRADE_BLOTTER                  TABLE                   VALID		query and CCMPROD.BLOT_PKG.tb_hist_cursor
CCMPROD                        CAM_PRICE                      TABLE                   VALID		CCMPROD.BLOT_PKG.isNonCAMRAHoldDate
CCMPROD                        CAM_PRICE                      TABLE PARTITION         VALID
CCMPROD                        SECURITIES                     TABLE                   VALID		CCMPROD.BLOT_PKG.isNonCAMRAHoldDate
CCMPROD                        NON_CAMRA_SECTYPE              TABLE                   VALID		CCMPROD.BLOT_PKG.isNonCAMRAHolding
PUBLIC                         NON_CAMRA_SECTYPE              SYNONYM                 VALID		CCMPROD.BLOT_PKG.isNonCAMRAHolding


-- PROD queries
select * from ccmprod.trade_blotter
where  blot_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
ORA-06598: insufficient INHERIT PRIVILEGES privilege

select count(*) from ccmprod.trade_blotter;
267870

select distinct cusip from ccmprod.trade_blotter order by 1;
74157 rows selected.

select distinct cusip from ccmprod.trade_blotter 
where last_update_by_date_blot>='12/19/2017'
order by 1;
SA1Q17996
SA1Q18903
...
1296 rows selected.

select max(record_date)
from   ccmprod.cam_price
where  cusip = 'SA1Q17996' ;
02/16/2018

select ccmsecsubtype
from   ccmprod.cam_price
where  cusip = 'SA1Q17996' and
      record_date = '02/16/2018' ;
AOTM								= sbType	= dbCode
	  
select ccmsectype
from   ccmprod.securities
where  cusip = 'SA1Q17996' ;
OPTE 								= sType		= ccmsectype

ccmsecsubtype:='ALL'
allType:='ALL'

select count(*)
from   ccmprod.non_camra_sectype
where  sectype  in ('ALL', 'OPTE' )   and
	subtype  ='ALL';
0												= countNum

select count(*)
from   ccmprod.non_camra_sectype
where  sectype = 'OPTE' and
	subtype  in ('ALL','ALL' );
0												= countNum

select count(*)
from   ccmprod.non_camra_sectype
where  sectype = 'OPTE' and
	subtype = 'ALL';
0												= countNum

select count(*)
from   ccmprod.non_camra_sectype
where  sectype = 'ALL' and
	subtype = 'ALL';
0												= countNum

return 'N'

select * from ccmprod.trade_blotter
where  blot_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';

	   
-- "CCMPROD"."BLOT_PKG" (only mention of prodlink)
cursor tb_hist_cursor( c varchar2 ) is
    select * from ccmprod.trade_blotter@prodlink
    where cusip_alternate = c;


-- ORA-12840: Cannot Access A Remote Table After Parallel/insert Direct Load Txn Compiling A Package (Doc ID 2289797.1)
SYMPTOMS
parallel_max_servers=0
alter session disable parallel dml;
alter session disable parallel query;
alter session disable parallel ddl;
Session altered.

SQL> alter package PKG_MYPKG compile body;
alter package PKG_MYPKG compile body
ERROR at line 1:
ORA-04052: An error occurred while searching for the remote object
ORA-00604: An error occurred in level 1 recursive SQL
ORA-12840: Can not access a remote table after a load transaction
Direct / parallel for insertion

CAUSE
Although parallel_max_servers=0, there was an append hint used in an insert statement called from a trigger

SOLUTION
Remove  /*+ APPEND*/ in any insert statements in the package or any trigger that gets executed when the package / procedure gets called.


-- Master Note for Troubleshooting ORA-04052 ORA-03106 ORA-02063 ORA-00604 (Doc ID 1984678.1)
PROBLEM
4. Permanent or intermittent occurrence of errors during a job or program execution

SOLUTION
Set the hidden database parameter  remote_dependencies_mode  to SIGNATURE in the local database.
Oracle recommends that Parameter: REMOTE_DEPENDENCIES_MODE is set to SIGNATURE when client-side PL/SQL tools are used OR when server-side PL/SQL calls are used across database links.

(PROD)
NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
remote_dependencies_mode             string      TIMESTAMP


/*--- PRODD testing ---*/
alter session set container=prodd;
alter user ccmprod grant connect through system;
connect system[ccmprod]@prodd

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter
where  blot_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
                                            *
ERROR at line 3:
ORA-04045: errors during recompilation/revalidation of CCMPROD.BLOT_PKG
ORA-04052: error occurred when looking up remote object
CCMPROD.TRADE_BLOTTER@PRODLINK
ORA-00604: error occurred at recursive SQL level 2
ORA-12840: cannot access a remote table after parallel/insert direct load txn
ORA-02063: preceding line from PRODLINK

col owner format a30
col object_name format a30
select object_name, object_type, status from user_objects where object_name='BLOT_PKG' order by 1,2,3;
OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_PKG                       PACKAGE                 VALID
BLOT_PKG                       PACKAGE BODY            INVALID

show errors package body ccmprod.BLOT_PKG
No errors.
show errors package ccmprod.BLOT_PKG
No errors.

alter session set remote_dependencies_mode='SIGNATURE';
(same error)

-- create package without db link
@/database/cprodd_admn01/scripts/CCMPROD.BLOT_TEST_PKG.sql
Package created.
Package body created.

select object_name, object_type, status from user_objects where object_name='BLOT_TEST_PKG' order by 1,2,3;
OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_TEST_PKG                  PACKAGE                 VALID
BLOT_TEST_PKG                  PACKAGE BODY            VALID

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter
where  blot_test_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
Table created.

DROP TABLE trade_blotter_015037;

-- create package with db link
@/database/cprodd_admn01/scripts/CCMPROD.BLOT_TEST2_PKG.sql
Package created.
Package body created.

select object_name, object_type, status from user_objects where object_name='BLOT_TEST2_PKG' order by 1,2,3;
OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_TEST2_PKG                 PACKAGE                 VALID
BLOT_TEST2_PKG                 PACKAGE BODY            VALID

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter
where  blot_test2_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
Table created.

DROP TABLE trade_blotter_015037;


-- try to invalidate test package without DB link
set trimspool on
spool /database/cprodd_admn01/scripts/blot_pkg_no_link.log
drop table trade_blotter_kd_test;
create table trade_blotter_kd_test
as select * from trade_blotter;
(replace table name in package DDL)

@/database/cprodd_admn01/scripts/CCMPROD.BLOT_TEST_PKG.sql
Package created.
Package body created.

select object_name, object_type, status from user_objects where object_name='BLOT_TEST_PKG' order by 1,2,3;
OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_TEST_PKG                  PACKAGE                 VALID
BLOT_TEST_PKG                  PACKAGE BODY            VALID

drop table trade_blotter_kd_test;
create table trade_blotter_kd_test
as select * from trade_blotter;

select object_name, object_type, status from user_objects where object_name='BLOT_TEST_PKG' order by 1,2,3;
OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_TEST_PKG                  PACKAGE                 INVALID
BLOT_TEST_PKG                  PACKAGE BODY            INVALID

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter_kd_test
where  blot_test_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
Table created.

DROP TABLE trade_blotter_015037;

drop table trade_blotter_kd_test;
create table trade_blotter_kd_test
as select * from trade_blotter;

select object_name, object_type, status from user_objects where object_name='BLOT_TEST_PKG' order by 1,2,3;
OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_TEST_PKG                  PACKAGE                 INVALID
BLOT_TEST_PKG                  PACKAGE BODY            INVALID

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter_kd_test
where  blot_test_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
ORA-04068: existing state of packages has been discarded
ORA-04061: existing state of package "CCMPROD.BLOT_TEST_PKG" has been
invalidated
ORA-04065: not executed, altered or dropped package "CCMPROD.BLOT_TEST_PKG"

select object_name, object_type, status from user_objects where object_name='BLOT_TEST_PKG' order by 1,2,3;
OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_TEST_PKG                  PACKAGE                 VALID
BLOT_TEST_PKG                  PACKAGE BODY            INVALID

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter_kd_test
where  blot_test_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
Table created.

DROP TABLE trade_blotter_015037;
drop table trade_blotter_kd_test;


-- try to invalidate 2nd test package
set trimspool on
spool /database/cprodd_admn01/scripts/blot_pkg_with_link.log

create table trade_blotter_kd_test
as select * from trade_blotter;

@/database/cprodd_admn01/scripts/CCMPROD.BLOT_TEST2_PKG.sql
Package created.
Package body created.

drop table trade_blotter_kd_test;
create table trade_blotter_kd_test
as select * from trade_blotter;

select object_name, object_type, status from user_objects where object_name='BLOT_TEST2_PKG' order by 1,2,3;
OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_TEST2_PKG                 PACKAGE                 INVALID
BLOT_TEST2_PKG                 PACKAGE BODY            INVALID

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter_kd_test
where  blot_test2_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
                                                  *
ERROR at line 3:
ORA-04045: errors during recompilation/revalidation of CCMPROD.BLOT_TEST2_PKG
ORA-04052: error occurred when looking up remote object
CCMPROD.TRADE_BLOTTER_KD_TEST@PRODLINK
ORA-00604: error occurred at recursive SQL level 2
ORA-12840: cannot access a remote table after parallel/insert direct load txn
ORA-02063: preceding line from PRODLINK

alter package BLOT_TEST2_PKG compile;
alter package BLOT_TEST2_PKG compile body;

select object_name, object_type, status from user_objects where object_name='BLOT_TEST2_PKG' order by 1,2,3;
OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_TEST2_PKG                 PACKAGE                 VALID
BLOT_TEST2_PKG                 PACKAGE BODY            VALID

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter_kd_test
where  blot_test2_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
Table created.

drop table trade_blotter_kd_test;
create table trade_blotter_kd_test
as select * from trade_blotter;

drop table trade_blotter_015037;

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter_kd_test
where  blot_test2_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
ORA-04068: existing state of packages has been discarded
ORA-04061: existing state of package "CCMPROD.BLOT_TEST2_PKG" has been
invalidated
ORA-04065: not executed, altered or dropped package "CCMPROD.BLOT_TEST2_PKG"

select object_name, object_type, status from user_objects where object_name='BLOT_TEST2_PKG' order by 1,2,3;
OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_TEST2_PKG                 PACKAGE                 VALID
BLOT_TEST2_PKG                 PACKAGE BODY            INVALID

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter_kd_test
where  blot_test2_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
ORA-04045: errors during recompilation/revalidation of CCMPROD.BLOT_TEST2_PKG
ORA-04052: error occurred when looking up remote object
CCMPROD.TRADE_BLOTTER_KD_TEST@PRODLINK
ORA-00604: error occurred at recursive SQL level 2
ORA-12840: cannot access a remote table after parallel/insert direct load txn
ORA-02063: preceding line from PRODLINK

alter package BLOT_TEST2_PKG compile;
alter package BLOT_TEST2_PKG compile body;

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter_kd_test
where  blot_test2_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
Table created.

drop table trade_blotter_015037;

drop table trade_blotter_kd_test;
create table trade_blotter_kd_test
as select * from trade_blotter;

select object_name, object_type, status from user_objects where object_name='BLOT_TEST2_PKG' order by 1,2,3;
OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_TEST2_PKG                 PACKAGE                 INVALID
BLOT_TEST2_PKG                 PACKAGE BODY            INVALID

alter session set optimizer_features_enable='11.2.0.4';

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter_kd_test
where  blot_test2_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
ORA-04068: existing state of packages has been discarded
ORA-04061: existing state of package "CCMPROD.BLOT_TEST2_PKG" has been
invalidated
ORA-04065: not executed, altered or dropped package "CCMPROD.BLOT_TEST2_PKG"

select object_name, object_type, status from user_objects where object_name='BLOT_TEST2_PKG' order by 1,2,3;
OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_TEST2_PKG                 PACKAGE                 VALID
BLOT_TEST2_PKG                 PACKAGE BODY            INVALID

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter_kd_test
where  blot_test2_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
ORA-04045: errors during recompilation/revalidation of CCMPROD.BLOT_TEST2_PKG
ORA-04052: error occurred when looking up remote object
CCMPROD.TRADE_BLOTTER_KD_TEST@PRODLINK
ORA-00604: error occurred at recursive SQL level 2
ORA-12840: cannot access a remote table after parallel/insert direct load txn
ORA-02063: preceding line from PRODLINK

OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_TEST2_PKG                 PACKAGE                 VALID
BLOT_TEST2_PKG                 PACKAGE BODY            INVALID

drop table trade_blotter_kd_test;
spool off

create table trade_blotter_kd_test
as select * from trade_blotter;
commit;

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter_kd_test
where  blot_test2_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
(same errors)

select count(*) from trade_blotter_kd_test
where  blot_test2_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';

create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter_kd_test
where  blot_test2_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
      last_update_by_date_blot>='12/19/2017';
select * from trade_blotter_kd_test
              *
ERROR at line 2:
ORA-04045: errors during recompilation/revalidation of CCMPROD.BLOT_TEST2_PKG
ORA-04052: error occurred when looking up remote object
CCMPROD.TRADE_BLOTTER_KD_TEST@PRODLINK
ORA-00604: error occurred at recursive SQL level 2
ORA-12840: cannot access a remote table after parallel/insert direct load txn
ORA-02063: preceding line from PRODLINK

select count(*) from trade_blotter_kd_test
where  blot_test2_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
       last_update_by_date_blot>='12/19/2017';
3

select object_name, object_type, status from user_objects where object_name='BLOT_TEST2_PKG' order by 1,2,3;
OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_TEST2_PKG                 PACKAGE                 VALID
BLOT_TEST2_PKG                 PACKAGE BODY            VALID

drop table trade_blotter_kd_test;
create table trade_blotter_kd_test
as select * from trade_blotter;

OBJECT_NAME                    OBJECT_TYPE             STATUS
------------------------------ ----------------------- -------
BLOT_TEST2_PKG                 PACKAGE                 INVALID
BLOT_TEST2_PKG                 PACKAGE BODY            INVALID

ALTER SESSION SET TRACEFILE_IDENTIFIER='ORA12840';
ALTER SESSION SET EVENTS '10046 trace name context forever, level 12';
create table trade_blotter_015037 tablespace usrtmp as
select * from trade_blotter_kd_test
where  blot_test2_pkg.isNonCAMRAHolding(cusip ) = 'Y' and
      last_update_by_date_blot>='12/19/2017';
ALTER SESSION SET EVENTS '10046 trace name context off';







DROP PACKAGE "CCMPROD"."BLOT_TEST_PKG";
DROP PACKAGE "CCMPROD"."BLOT_TEST2_PKG";
DROP TABLE trade_blotter_015037;

connect system@prodd
alter user ccmprod revoke connect through system;


###########
# edmap   #
# EEDMAP1 #
# 4/6     #
###########

EXTRACT    EEDMAP1   Last Started 2018-04-05 22:06   Status ABENDED
Checkpoint Lag       00:37:15 (updated 10:49:21 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-05 21:28:51
                     SCN 2551.443036791 (10956904608887)

-- report
2018-04-05 22:06:08  ERROR   OGG-01028  Formatting error on: table name OSCR_ARCHIVE.ARC_CNO_FORM__C, rowid AAAULfAAKAAJkThAAE, XID 11.33.149492, position (Seqno 167083, RBA 26656036).

-- GoldenGate Extract Abends: OGG-01028 Formatting Error on: table name xxxx.xxxx rowid , XID nnnn.nn.nnnn, Position (Seqno n, RBA n) (Doc ID 1558791.1)
SYMPTOMS
ERROR OGG-01028 Formatting error on: table name xxxx.xxxx rowid , XID nnnn.nn.nnnn, position (Seqno 2894, RBA 2548796816). 
OCI Detach returned error 3127, ORA-03127: no new operations allowed until the active operation ends.

SOLUTION
Solution is to apply DB patch for bug 15947884.  If the db patch causes conflict, please open SR to database support for a patch on top of your current version.

-- uxorap02
set lines 150 pages 200
select count(*) from OSCR_ARCHIVE.ARC_CNO_FORM__C;
  COUNT(*)
----------
      6425

select object_type, created, last_ddl_time, status, temporary
from dba_objects
where owner='OSCR_ARCHIVE' and object_name='ARC_CNO_FORM__C';
OBJECT_TYPE         CREATED    LAST_DDL_T STATUS  T
------------------- ---------- ---------- ------- -
TABLE               06/25/2016 06/25/2016 VALID   N

select * from OSCR_ARCHIVE.ARC_CNO_FORM__C
where rowid='AAAULfAAKAAJkThAAE';

-- edit params
TABLEEXCLUDE OSCR_ARCHIVE.ARC_CNO_FORM__C;

EXTRACT    EEDMAP1   Last Started 2018-04-06 09:23   Status RUNNING
Checkpoint Lag       11:47:12 (updated 00:00:00 ago)
Process ID           3408796
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-05 21:37:03
                     SCN 2551.443038170 (10956904610266)

					 
########
# trmp #
# 4/9  #
########

-- Svetlana SDT 2105377 
CCM_PKG on TRMP user lost its privileges to drop and create public synonyms

lx4086overnight:~> sqlplus ccmtrade/$PASSWORD_TRADE@trade
SQL> @/ccm/$RUNLEVEL/is/db_structure/create_packages/crt_ccmstd.pks
drop public synonym ccmstd
drop public synonym ccmstd
                    *
ERROR at line 1:
ORA-01031: insufficient privileges


create public synonym ccmstd
create public synonym ccmstd for ccm_pkg.ccmstd
                      *
ERROR at line 1:
ORA-00955: name is already used by an existing object


-- lxorainvp01
set lines 150 pages 200
col grantee format a30
select grantee,privilege from dba_sys_privs
where privilege='CREATE PUBLIC SYNONYM'
order by grantee;
GRANTEE                        PRIVILEGE
------------------------------ ---------------------
APEX_040200                    CREATE PUBLIC SYNONYM
AUTODDL_ADMIN                  CREATE PUBLIC SYNONYM
AUTODDL_ADMIN                  CREATE PUBLIC SYNONYM
CCMTRADE                       CREATE PUBLIC SYNONYM
CTXSYS                         CREATE PUBLIC SYNONYM
DBA                            CREATE PUBLIC SYNONYM
IMP_FULL_DATABASE              CREATE PUBLIC SYNONYM
MDSYS                          CREATE PUBLIC SYNONYM
PKG_COMPILE                    CREATE PUBLIC SYNONYM
QUEST_SPC_APP_PRIV             CREATE PUBLIC SYNONYM
RECOVERY_CATALOG_OWNER         CREATE PUBLIC SYNONYM
SYS                            CREATE PUBLIC SYNONYM
TRADEHIST                      CREATE PUBLIC SYNONYM
TR_ADMIN                       CREATE PUBLIC SYNONYM
WMSYS                          CREATE PUBLIC SYNONYM
XDB                            CREATE PUBLIC SYNONYM

select grantee,privilege from dba_sys_privs
where privilege like '%PUBLIC SYNONYM%' 
and grantee not in ('APEX_040200','AUTODDL_ADMIN','CTXSYS','DBA','IMP_FULL_DATABASE','MDSYS','SYS','WMSYS','XDB')
order by grantee;
GRANTEE                        PRIVILEGE
------------------------------ ----------------------------------------
CCMTRADE                       CREATE PUBLIC SYNONYM
CCM_PKG                        DROP PUBLIC SYNONYM
EMANAGE                        DROP PUBLIC SYNONYM
PKG_COMPILE                    CREATE PUBLIC SYNONYM
QUEST_SPC_APP_PRIV             DROP PUBLIC SYNONYM
QUEST_SPC_APP_PRIV             CREATE PUBLIC SYNONYM
RECOVERY_CATALOG_OWNER         CREATE PUBLIC SYNONYM
TRADEHIST                      CREATE PUBLIC SYNONYM
TR_ADMIN                       CREATE PUBLIC SYNONYM
TR_ADMIN                       DROP PUBLIC SYNONYM

col granted_role format a30
select grantee, granted_role
from dba_role_privs
where grantee='CCMTRADE'
order by 2;
GRANTEE                        GRANTED_ROLE
------------------------------ ------------------------------
CCMTRADE                       CASH_SYSTEM
CCMTRADE                       CCMTRADE_APP
CCMTRADE                       EXP_FULL_DATABASE
CCMTRADE                       USER_ROLE
CCMTRADE                       WEBDB_DEVELOPER


###########
# edmap   #
# REDMAP1 #
# 4/10    #
###########

REPLICAT   REDMAP1   Last Started 2018-04-10 10:07   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 01:59:30 ago)
Process ID           30526
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/edmap/ra000000041
                     2018-04-10 09:56:51.748197  RBA 573365306

> sh ls -lt /app/oracle/product/ggate/12c/1/dirdat/edmap
total 40599004
-rw-r-----. 1 oracle dba 573365306 Apr 10 09:12 ra000000041
-rw-r-----. 1 oracle dba 999998464 Apr  9 23:04 ra000000040

-- uxorap02
EXTRACT    EEDMAP1   Last Started 2018-04-06 09:23   Status RUNNING
Checkpoint Lag       00:00:03 (updated 00:00:00 ago)
Process ID           3408796
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-10 11:59:07
                     SCN 2551.450250623 (10956911822719)

EXTRACT    PEDMAP1   Last Started 2018-04-05 01:33   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:00:01 ago)
Process ID           20775104
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/edmap/ea000000044
                     2018-04-10 09:12:13.000000  RBA 332436324

> sh ls -lt /nomove/app/oracle/ggate/12c/1/dirdat/edmap

total 92849024
-rw-r-----    1 oracle   dba       332436324 Apr 10 09:12 ea000000044
-rw-r-----    1 oracle   dba       999999587 Apr  9 23:12 ea000000043



############
# cigfdsp  #
# ECI_DSP1 #
# 4/10     #
############

EXTRACT    ECI_DSP1  Last Started 2018-04-09 10:29   Status RUNNING
Checkpoint Lag       08:12:38 (updated 00:00:00 ago)
Process ID           8323280
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-10 03:32:02
                     SCN 2551.538157365 (10956999729461)

-- report (last entry)
2018-04-10 03:50:28  INFO    OGG-06509  Using the following key columns for source table STG.S1_LPK_CHBCT:...

-- uxp33
select sequence# from v$archived_log where &what_scn between FIRST_CHANGE# and NEXT_CHANGE#-1;
 SEQUENCE#
----------
   2282733

> ll /move/cigfdsp_arch01/arch
total 10178960
-rw-r-----    1 oracle   dba       244255232 Apr 10 07:46 arch1_2283159_639811471.dbf
-rw-r-----    1 oracle   dba       225517056 Apr 10 07:47 arch1_2283160_639811471.dbf
...

-- OEM
Apr 10, 2018 3:41:50 AM
The execution for Corrective Action BACKUP_A...

Apr 10, 2018 7:26:51 AM
The execution for Corrective Action BACKUP_A...

-- rman (CO 65111)
mkdir /oragg/arch/cigfdsp

show all;
CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;

CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;
old RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters are successfully stored
starting full resync of recovery catalog
full resync complete

run
{
	set archivelog destination to '/oragg/arch/cigfdsp';
	restore archivelog from sequence 2282730;
}
(15:30)
Finished restore at 10-APR-18

CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;

old RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters are successfully stored
released channel: ORA_DISK_1
starting full resync of recovery catalog
full resync complete

-- ggsci
EXTRACT    ECI_DSP1  Last Started 2018-04-09 10:29   Status RUNNING
Checkpoint Lag       10:54:08 (updated 00:00:01 ago)
Process ID           8323280
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-10 03:41:42
                     SCN 2551.538365616 (10956999937712)

-- report (last entry)
2018-04-10 14:36:27  INFO    OGG-06509  Using the following key columns for source table STG.S1_LPK_PCOMCAGNTS:...
...
2018-04-10 15:31:01  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/cigfdsp/ea000000168.

EXTRACT    ECI_DSP1  Last Started 2018-04-09 10:29   Status RUNNING
Checkpoint Lag       11:31:30 (updated 00:00:10 ago)
Process ID           8323280
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-10 04:01:01
                     SCN 2551.538607267 (10957000179363)

					 
############
# documkrp #
# EDO_KRP1 #
# 4/11     #
############

EXTRACT    EDO_KRP1  Last Started 2018-04-08 23:09   Status ABENDED
Checkpoint Lag       43:46:34 (updated 58:27:56 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-07 03:22:42
                     SCN 2551.443426272 (10956904998368)

-- EDO_KRP17.rpt (first log)
2018-04-07 03:21:19  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000022.
            17972742 records processed as of 2018-04-07 03:21:46 (rate 44,delta 185)
2018-04-07 03:22:36  INFO    OGG-06512  Resolving source sequence :ODEE_3.JOBS_JOB_ID_SEQ.
2018-04-07 03:22:50  ERROR   OGG-02077  Extract encountered a read error in the asynchronous reader thread and is abending: Error code 600, error message: ORA-00600: internal error code, arguments: [knlogcPackLobXMLInfo:1], [48220], [203879], [2], [146], [], [], [], [], [], [], [].

-- EDO_KRP16.rpt
2018-04-07 04:23:09  INFO    OGG-01053  Recovery completed for target file /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000024, at RBA 1483.
2018-04-07 04:23:17  ERROR   OGG-02077  Extract encountered a read error in the asynchronous reader thread and is abending: Error code 600, error message: ORA-00600: internal error code, arguments: [knlogcPackLobXMLInfo:1], [48220], [203879], [2], [146], [], [], [], [], [], [], [].

-- EDO_KRP10.rpt
2018-04-08 23:09:23  ERROR   OGG-02077  Extract encountered a read error in the asynchronous reader thread and is abending: Error code 600, error message: ORA-00600: internal error code, arguments: [knlogcPackLobXMLInfo:1], [48220], [203879], [2], [146], [], [], [], [], [], [], []..

-- alert log
Sat Apr 07 03:22:43 2018
Errors in file /move/documkrp_adm01/admin/diag/rdbms/documkrp/documkrp/trace/documkrp_ora_41681296.trc  (incident=552392):
ORA-00600: internal error code, arguments: [knlogcPackLobXMLInfo:1], [48220], [203879], [2], [146], [], [], [], [], [], [], []
Incident details in: /move/documkrp_adm01/admin/diag/rdbms/documkrp/documkrp/incident/incdir_552392/documkrp_ora_41681296_i552392.trc

-- documkrp_ora_41681296_i552392.trc
----- SQL Statement (None) -----
Current SQL information unavailable - no cursor.

sid: 822 ser: 569 trans: 0x0, creator: 0x7000101d333d6a0
oct: 0, prv: 0, sql: 0x0, psql: 0x700010184bf1478, user: 159/GGS
      O/S info: user: oracle, term: , ospid: 17695230
      machine: uxorap02 program: extract@uxorap02 (TNS V1-V3)
      application name: GoldenGate, hash value=2853897589
      action name: OGG$CAP_EDO_KRP1 - Capture, hash value=395600533

Parent Cursor:  sql_id=0yj2970wjbsfv parent=700010192d5f048 maxchild=9 plk=y ppn=n 
Parent Cursor:  sql_id=9zshcv60xux34 parent=7000101bde2d150 maxchild=41 plk=y ppn=n 
Parent Cursor:  sql_id=5hrvvu1r771m5 parent=7000101baf8ed10 maxchild=7 plk=y ppn=n 
Parent Cursor:  sql_id=cc4q59sffgjrp parent=7000101b8758900 maxchild=3 plk=y ppn=n 

INSTANTIATION OBJECT: object=110b927a8
type="PL/SQL"[1] lock=700010106f22e10 pn=0 handle=70001011ce93bb0 lkhandle=70001011ce93bb0 spec=110a1eb00 level=0

INSTANTIATION OBJECT: object=110a1eb00
type="PL/SQL"[1] lock=7000101d855d0d8 pn=0 handle=700010176f04090 lkhandle=700010176f04090 body=110b927a8 level=0
...

----- Dump Cursor sql_id=cc4q59sffgjrp xsc=0x1109c9398 cur=0x1109a1c48 -----
Parent Cursor:  sql_id=cc4q59sffgjrp parent=7000101b8758900 maxchild=3 plk=y ppn=n 
----- Dump Cursor sql_id=5hrvvu1r771m5 xsc=0x110ac9100 cur=0x1109a1d68 -----
Parent Cursor:  sql_id=5hrvvu1r771m5 parent=7000101baf8ed10 maxchild=7 plk=y ppn=n 
----- Dump Cursor sql_id=9zshcv60xux34 xsc=0x110b920b8 cur=0x1109a1cd8 -----

-- OEM
cc4q59sffgjrp	SELECT xs.user_comment FROM sys.xstream$_server xs...
0yj2970wjbsfv	UPDATE sys.streams$_capture_process SET spare5=:1,...
9zshcv60xux34	INSERT INTO sql$ (signature, inuse_features, flags...
5hrvvu1r771m5	SELECT VALUE$ FROM SYS.PROPS$ WHERE NAME = 'OGG_T...

-- OEM activity 4/7 3:07-3:37 AM
3a7x78h81my8d
8cxz410wfgtx2
fdng6sznz0pf4
djbs9gzjzwtp3
4a3ky2zp9ann5
gs3krjxbjhwvq

-- ./logdump
open /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000022
ghdr on
FILTER INCLUDE ANSINAME "ODEE_3"."JOBS_JOB_ID_SEQ"
...
Scanned    700000 records, RBA  894652554, 2018/04/07 03:18:15.000.000
Scanned    710000 records, RBA  912448844, 2018/04/07 03:18:39.000.000
Scanned    720000 records, RBA  946427347, 2018/04/07 03:21:11.000.000

FILTER CLEAR
pos 946427347
n

2018/04/07 03:21:11.000.000 LargeObject          Len  8020 RBA 946427347
Name: ODEE_3.PUBS  (TDR Index: 46)

open /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000024
pos 1483
(no data)

-- uxorap02
set lines 150 pages 200
col object_name format a30
select owner, object_name, object_type from dba_objects
where owner='ODEE_3' and object_name='PUBS'
order by 1,2,3;
OWNER                          OBJECT_NAME                    OBJECT_TYPE
------------------------------ ------------------------------ -------------------
ODEE_3                         PUBS                           TABLE

desc ODEE_3.PUBS
 Name                                                                                Null?    Type
 ----------------------------------------------------------------------------------- -------- --------------------------------------------------------
 BCH_ID                                                                              NOT NULL NUMBER(38)
 PUB_ID                                                                              NOT NULL NUMBER(38)
 PUBBEGINRCP_ID                                                                               NUMBER(38)
 PUBENDRCP_ID                                                                                 NUMBER(38)
 PUBUNIQUE_ID                                                                        NOT NULL NVARCHAR2(47)
 PUBNAME                                                                                      NVARCHAR2(256)
 PUBSEQ                                                                                       NUMBER(10)
 PUBPRTTYPE                                                                                   NVARCHAR2(30)
 PUBPRTEXT                                                                                    NVARCHAR2(6)
 PUBSTATUS                                                                                    NUMBER(10)
 PUBSIGNOFF                                                                                   NVARCHAR2(256)
 PUBSIGNOFFTIME                                                                               TIMESTAMP(6)
 PUBDATATYPE                                                                                  NVARCHAR2(30)
 PUBOUTTYPE                                                                                   NUMBER(10)
 PUBOUTBLOB                                                                                   BLOB


############
# cigfdsp  #
# ECI_DSP1 #
# 4/11     #
############

EXTRACT    ECI_DSP1  Last Started 2018-04-09 10:29   Status RUNNING
Checkpoint Lag       12:42:32 (updated 00:00:09 ago)
Process ID           8323280
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-11 03:32:48
                     SCN 2551.549126187 (10957010698283)

-- report (last entry)
2018-04-11 03:49:00  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/cigfdsp/ea000000287.
           331481734 records processed as of 2018-04-11 03:49:19 (rate 2228,delta 16106)
2018-04-11 03:50:03  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/cigfdsp/ea000000288.

-- OEM
Apr 11, 2018 3:41:52 AM		66% of archive area /move/cigfdsp_arch01/arch is used
Apr 11, 2018 4:11:52 AM		57% of archive area /move/cigfdsp_arch01/arch is used
Apr 11, 2018 10:56:53 AM	41% of archive area /move/cigfdsp_arch01/arch is used

-- uxp33
select sequence# from v$archived_log where &what_scn between FIRST_CHANGE# and NEXT_CHANGE#-1;
 SEQUENCE#
----------
   2283393

> ls -lt /move/cigfdsp_arch01/arch
total 19013880
-rw-r-----    1 oracle   dba       220103168 Apr 11 16:12 arch1_2283900_639811471.dbf
-rw-r-----    1 oracle   dba       223502848 Apr 11 16:06 arch1_2283899_639811471.dbf

> ll /oragg/arch/cigfdsp
total 0

-- rman (CO 65160)
show all;

CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;

old RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters are successfully stored
starting full resync of recovery catalog
full resync complete

run
{
	set archivelog destination to '/oragg/arch/cigfdsp';
	restore archivelog from sequence 2283390;
}

CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;

old RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters are successfully stored
released channel: ORA_DISK_1
starting full resync of recovery catalog
full resync complete

-- CO 65164
JOB_NAME : [BACKUP_ARCHIVELOG_CORRECTIVE_ACTION]
PARAMETERS : [Change threshold from 40%/70% to 70%/85%]


*** 4/12  ***
-- OEM incident
Apr 12, 2018 3:54:56 AM		The archiver hung at time/line number
Apr 12, 2018 4:25:58 AM		84% of archive area /move/cigfdsp01/arch/ is used		The execution for Corrective Action BACKUP_A...


-- last report
2018-04-12 04:30:21  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/cigfdsp/ea000000549.

EXTRACT    ECI_DSP1  Last Started 2018-04-09 10:29   Status RUNNING
Checkpoint Lag       04:10:00 (updated 00:00:00 ago)
Process ID           8323280
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-12 03:34:52
                     SCN 2551.598397108 (10957059969204)

-- uxp33
select sequence# from v$archived_log where &what_scn between FIRST_CHANGE# and NEXT_CHANGE#-1;
 SEQUENCE#
----------
   2284119

> ls -lrt /move/cigfdsp_arch01/arch
-rw-r-----    1 oracle   dba       128786944 Apr 12 05:50 arch1_2284438_639811471.dbf
...
-rw-r-----    1 oracle   dba       132980736 Apr 12 07:50 arch1_2284497_639811471.dbf

> df -g /move/cigfdsp_arch01/arch
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
/dev/cigfdsparch01lv    109.62     97.22   12%       65     1% /move/cigfdsp_arch01

> ls -lrt /move/cigfdsp01/arch
-rw-r-----    1 oracle   dba       223697408 Apr 12 04:27 arch1_2284348_639811471.dbf
...
-rw-r-----    1 oracle   dba       203056640 Apr 12 05:20 arch1_2284437_639811471.dbf

> df -g /move/cigfdsp01/arch
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
/dev/cigfdsp01lv   5128.00    845.45   84%      394     1% /move/cigfdsp01

> ll /oragg/arch/cigfdsp
total 0

-- 8:12 AM
NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
log_archive_dest                     string      /move/cigfdsp_arch01/arch/

> mv /move/cigfdsp_arch01/arch/*dbf /oragg/arch/cigfdsp
(cancelled)

-- rman (CO 65172)
show all;

CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;

old RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters are successfully stored
starting full resync of recovery catalog
full resync complete

run
{
	set archivelog destination to '/oragg/arch/cigfdsp';
	restore archivelog from sequence 2284117;
}

CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;

old RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters are successfully stored
released channel: ORA_DISK_1
starting full resync of recovery catalog
full resync complete

-- report
2018-04-12 10:10:31  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/cigfdsp/ea000000671.
           718952365 records processed as of 2018-04-12 10:10:31 (rate 2786,delta 13750)

EXTRACT    ECI_DSP1  Last Started 2018-04-09 10:29   Status RUNNING
Checkpoint Lag       05:48:03 (updated 00:00:05 ago)
Process ID           8323280
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-12 04:30:50
                     SCN 2551.598701777 (10957060273873)

-- CO 65164
JOB_NAME : [BACKUP_ARCHIVELOG_CORRECTIVE_ACTION]
PARAMETERS : [Change threshold from 70%/85% back to 40%/70% (reverting CO 65164)]


*** 4/12 11:31 ***
-- last report
2018-04-12 10:43:09  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/cigfdsp/ea000000713.

EXTRACT    ECI_DSP1  Last Started 2018-04-09 10:29   Status RUNNING
Checkpoint Lag       06:11:43 (updated 00:00:07 ago)
Process ID           8323280
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-12 05:20:17
                     SCN 2551.598992941 (10957060565037)

-- uxp33
select sequence# from v$archived_log where &what_scn between FIRST_CHANGE# and NEXT_CHANGE#-1;
 SEQUENCE#
----------
   2284438

> ls -lrt /move/cigfdsp_arch01/arch
-rw-r-----    1 oracle   dba       236250112 Apr 12 07:11 arch1_2284479_639811471.dbf
...
-rw-r-----    1 oracle   dba       220323840 Apr 12 11:26 arch1_2284519_639811471.dbf

> ls -lrt /move/cigfdsp01/arch
-rw-r-----    1 oracle   dba       223697408 Apr 12 04:27 arch1_2284348_639811471.dbf
...
-rw-r-----    1 oracle   dba       203056640 Apr 12 05:20 arch1_2284437_639811471.dbf

-- OEM
no CA job

-- rman (CO 65203)
show all;

CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;

old RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters are successfully stored
starting full resync of recovery catalog
full resync complete

run
{
	set archivelog destination to '/oragg/arch/cigfdsp';
	restore archivelog from sequence 2284438;
}

CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;

old RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters are successfully stored
released channel: ORA_DISK_1
starting full resync of recovery catalog
full resync complete

> ll /oragg/arch/cigfdsp
-rw-r-----    1 oracle   dba       248995328 Apr 12 08:30 arch1_2284117_639811471.dbf
...
-rw-r-----    1 oracle   dba       215358976 Apr 12 08:36 arch1_2284347_639811471.dbf
-rw-r-----    1 oracle   dba       128786944 Apr 12 11:37 arch1_2284438_639811471.dbf
...
-rw-r-----    1 oracle   dba       152293376 Apr 12 08:17 arch1_2284479_639811471.dbf

-- rman
list ARCHIVELOG SEQUENCE BETWEEN 2284430 AND 2284440;
Key     Thrd Seq     S Low Time
------- ---- ------- - ---------
776865095 1    2284430 A 12-APR-18
        Name: /move/cigfdsp01/arch/arch1_2284430_639811471.dbf
...
776923087 1    2284438 A 12-APR-18
        Name: /oragg/arch/cigfdsp/arch1_2284438_639811471.dbf
776870006 1    2284438 A 12-APR-18
        Name: /move/cigfdsp_arch01/arch/arch1_2284438_639811471.dbf
776923096 1    2284439 A 12-APR-18
        Name: /oragg/arch/cigfdsp/arch1_2284439_639811471.dbf
776874580 1    2284439 A 12-APR-18
        Name: /move/cigfdsp_arch01/arch/arch1_2284439_639811471.dbf
776923095 1    2284440 A 12-APR-18
        Name: /oragg/arch/cigfdsp/arch1_2284440_639811471.dbf
776874581 1    2284440 A 12-APR-18
        Name: /move/cigfdsp_arch01/arch/arch1_2284440_639811471.dbf

-- ggsci
EXTRACT    ECI_DSP1  Last Started 2018-04-09 10:29   Status RUNNING
Checkpoint Lag       06:46:55 (updated 00:00:02 ago)
Process ID           8323280
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-12 05:20:17
                     SCN 2551.598992941 (10957060565037)

stop ECI_DSP1
start ECI_DSP1

2018-04-12 12:10:41  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File NA, THREAD 1, SEQUENCE 2284058, SCN 0x000009f723a98d0f. Read Position SCN: 2551.598992941 (10957060565037)).

-- rman (CO 65203 cont.)
list ARCHIVELOG SEQUENCE BETWEEN 2284055 AND 2284060;
specification does not match any archived log in the repository

list backup of ARCHIVELOG SEQUENCE BETWEEN 2284055 AND 2284060;
BS Key  Size       Device Type Elapsed Time Completion Time
------- ---------- ----------- ------------ ---------------
527447  1.71G      DISK        00:08:25     12-APR-18
        BP Key: 527447   Status: AVAILABLE  Compressed: YES  Tag: TAG20180412T035030
        Piece Name: /orapbakxiv33/DR/cigfdsp/rman/BK_CIGFDSP_527903_1_973223437

  List of Archived Logs in backup set 527447
  Thrd Seq     Low SCN    Low Time  Next SCN   Next Time
  ---- ------- ---------- --------- ---------- ---------
  1    2284055 10957059883548 12-APR-18 10957059884230 12-APR-18
  1    2284056 10957059884230 12-APR-18 10957059885106 12-APR-18
  1    2284057 10957059885106 12-APR-18 10957059885873 12-APR-18
  1    2284058 10957059885873 12-APR-18 10957059886739 12-APR-18
  1    2284059 10957059886739 12-APR-18 10957059887590 12-APR-18
  1    2284060 10957059887590 12-APR-18 10957059888562 12-APR-18

CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;

old RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters are successfully stored
starting full resync of recovery catalog
full resync complete

run
{
	set archivelog destination to '/oragg/arch/cigfdsp';
	restore archivelog from sequence 2284057;
}

CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;

old RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters:
CONFIGURE DEVICE TYPE DISK PARALLELISM 6 BACKUP TYPE TO COMPRESSED BACKUPSET;
new RMAN configuration parameters are successfully stored
released channel: ORA_DISK_1
starting full resync of recovery catalog
full resync complete

EXTRACT    ECI_DSP1  Last Started 2018-04-12 13:09   Status RUNNING
Checkpoint Lag       08:12:13 (updated 00:00:07 ago)
Process ID           1901398
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-12 05:20:17
                     SCN 2551.598992941 (10957060565037)

-- report
2018-04-12 13:09:10  INFO    OGG-00547  Increasing thread stack size from 196608 to 2097152.


############
# cigfdsp  #
# RCI_DSP1 #
# 4/11     #
############

REPLICAT   RCI_DSP1  Last Started 2018-04-11 03:02   Status ABENDED
INTEGRATED
Checkpoint Lag       13:15:26 (updated 00:45:00 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/cigfdsp/ra000000289
                     2018-04-11 03:32:55.440190  RBA 509335026

-- report
2018-04-11 16:48:33  ERROR   OGG-00664  OCI Error Flushing database inbound server, 'OGG$RCI_DSP1' (status = 26804-ORA-26804: Apply "OGG$RCI_DSP1" is disabled.).
2018-04-11 16:48:33  WARNING OGG-02531  Inbound server OGG$RCI_DSP1 error status ORA-600:ORA-00600: internal error code, arguments: [knacatp_AutoTuneParallelism:1], [5], [], [], [], [], [], [], [], [], [], []

start

REPLICAT   RCI_DSP1  Last Started 2018-04-11 17:39   Status RUNNING
INTEGRATED
Checkpoint Lag       14:07:30 (updated 00:00:11 ago)
Process ID           5908
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/cigfdsp/ra000000290
                     2018-04-11 03:33:12.991685  RBA 890175008


#################
# cigfdsp       #
# archive space #
# 4/12          #
#################

-- before force logging
Max / hour:	 11 GB
Avg / hour:	  2 GB
Max / day:	 50 GB
Avg / day:	 41 GB
Avg / 12hr:	 21 GB

-- after force logging
Max / hour:	 81 GB		= 7.1x bigger
Avg / hour:	  8 GB		= 4.5x bigger
Max / day:	248 GB		= 5.0x bigger
Avg / day:	185 GB		= 4.5x bigger

         Hours to fill
mount-GB avg/hr max/hr
-------- ------ ------
11       1.2    0.2
22       2.4    0.3
33       3.7    0.4
44       4.9    0.6
55       6.1    0.7
66       7.3    0.8
77       8.6    1.0
88       9.8    1.1
50       5.6    0.6
100      11.1   1.3
150      16.7   1.9
200      22.2   2.6

Space required for
Hours @avg @max
----- ---- ----
4      36  312
6      54  468
8      72  624
12    108  
20    180  
24    216  

BACKUP_CIGFDSP_PROD_HOT_ARCHIVELOG_GG
Every 30 minutes

DB			Max hour	Need
-----------	--------	----
blcfdsp		15924		238
fdlzp		24937		368
idwp		46989		676
dsrp		96749		1417
portalp		6984		102

-- 9/11
cigfdsp		15984		1092


############
# documkrp #
# EDO_KRP1 #
# 4/16     #
############

EXTRACT    EDO_KRP1  Last Started 2018-04-16 04:24   Status ABENDED
Checkpoint Lag       04:22:05 (updated 05:16:31 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-16 00:02:56
                     SCN 2551.639495575 (10957101067671)

-- report (4/16 12:06 AM)
2018-04-16 00:06:15  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000004.
2018-04-16 00:06:52  INFO    OGG-06508  Wildcard MAP (TABLE) resolved (entry ODEE_3.*): TABLE "ODEE_3"."RCPSHIST".
2018-04-16 00:06:52  INFO    OGG-06509  Using the following key columns for source table ODEE_3.RCPSHIST: RCP_ID, TRN_ID.2018-04-16 00:06:52  ERROR   OGG-02077  Extract encountered a read error in the asynchronous reader thread and is abending: Error code 600, error message: ORA-00600: internal error code, arguments: [knlogcPackLobXMLInfo:1], [48178], [203911], [1], [146], [], [], [], [], [], [], [].

-- report (4/16 4:14 AM)
2018-04-16 04:14:22  INFO    OGG-01056  Recovery initialization completed for target file /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000005, at RBA 639360658, CSN 10957101067671.
2018-04-16 04:14:23  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000005.
2018-04-16 04:14:34  INFO    OGG-06509  Using the following key columns for source table ODEE_1.RCPS: RCP_ID, TRN_ID.
2018-04-16 04:14:34  INFO    OGG-01054  Recovery completed for target file /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000006, at RBA 1803, CSN 10957101067671.
2018-04-16 04:14:40  ERROR   OGG-02077  Extract encountered a read error in the asynchronous reader thread and is abending: Error code 600, error message: ORA-00600: internal error code, arguments: [knlogcPackLobXMLInfo:1], [48178], [203911], [1], [146], [], [], [], [], [], [], [].

-- report (4/16 4:25 AM)
2018-04-16 04:24:51  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000006.
2018-04-16 04:24:51  INFO    OGG-01053  Recovery completed for target file /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000007, at RBA 1483.
2018-04-16 04:25:06  ERROR   OGG-02077  Extract encountered a read error in the asynchronous reader thread and is abending: Error code 600, error message: ORA-00600: internal error code, arguments: [knlogcPackLobXMLInfo:1], [48178], [203911], [1], [146], [], [], [], [], [], [], [].

-- EDO_KRP1.rpt
2018-04-16 04:25:06  ERROR   OGG-02077  Extract encountered a read error in the asynchronous reader thread and is abending: Error code 600, error message: ORA-00600
: internal error code, arguments: [knlogcPackLobXMLInfo:1], [48178], [203911], [1], [146], [], [], [], [], [], [], [].

> ll /oragg/trail/documkrp
-rw-r-----    1 oracle   dba       999999196 Apr 15 23:59 ea000000000
-rw-r-----    1 oracle   dba       999995939 Apr 16 00:01 ea000000001
-rw-r-----    1 oracle   dba       999997282 Apr 16 00:02 ea000000002
-rw-r-----    1 oracle   dba       999996602 Apr 16 00:04 ea000000003
-rw-r-----    1 oracle   dba       999995890 Apr 16 00:06 ea000000004
-rw-r-----    1 oracle   dba       639360658 Apr 16 04:14 ea000000005
-rw-r-----    1 oracle   dba            1803 Apr 16 04:24 ea000000006
-rw-r-----    1 oracle   dba            1483 Apr 16 09:49 ea000000007
-rw-r-----    1 oracle   dba            1483 Apr 16 09:59 ea000000008
-rw-r-----    1 oracle   dba            1483 Apr 16 09:59 ea000000009

-- sqlplus
desc ODEE_3.RCPSHIST
 Name                                      Null?    Type
 ----------------------------------------- -------- ----------------------------
 RCP_ID                                    NOT NULL NUMBER(38)
...
 RCPOUTBLOB                                         BLOB

-- edit params EDO_KRP1
TABLEEXCLUDE ODEE_3.RCPSHIST

EXTRACT    EDO_KRP1  Last Started 2018-04-16 09:49   Status ABENDED
Checkpoint Lag       09:46:49 (updated 00:07:33 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-16 00:02:56
                     SCN 2551.639495575 (10957101067671)

-- report
2018-04-16 09:49:35  INFO    OGG-01053  Recovery completed for target file /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000008, at RBA 1483.
2018-04-16 09:49:52  ERROR   OGG-02077  Extract encountered a read error in the asynchronous reader thread and is abending: Error code 600, error message: ORA-00600
: internal error code, arguments: [knlogcPackLobXMLInfo:1], [48178], [203911], [1], [146], [], [], [], [], [], [], [].

-- edit params EDO_KRP1
TABLEEXCLUDE ODEE_3.PUBS
(abended again)

-- ./logdump
open /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000004
ghdr on
FILTER INCLUDE ANSINAME "ODEE_3"."RCPSHIST"
n
Scanned     10000 records, RBA   80661804, 2018/04/16 00:02:21.000.000
...
Scanned    130000 records, RBA  951943274, 2018/04/16 00:02:52.000.000
(time doesn't match report file)
(think this means nothing found)

FILTER CLEAR
pos 951943274
n
2018/04/16 00:02:52.000.000 LargeObject          Len  8020 RBA 951943274
Name: ODEE_10.PUBSHIST  (TDR Index: 32)
...

open /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000005
pos 639360658
n
(nothing)

open /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000006
pos 0
n
2018/04/16 04:14:23.507.354 RestartAbend         Len     0 RBA 1740

open /nomove/app/oracle/ggate/12c/1/dirdat/documkrp/ea000000005
FILTER INCLUDE ANSINAME ODEE_1.RCPS
n
2018/04/16 00:01:56.079.963 Metadata             Len 0 RBA 634943383
Name: ODEE_1.RCPS (Ref TDR Index: 13)

n
2018/04/16 00:02:54.000.000 Delete               Len  2113 RBA 634943441
Name: ODEE_1.RCPS  (TDR Index: 16)

FILTER CLEAR
pos 634943441

2018/04/16 00:02:54.000.000 Insert               Len  2123 RBA 634945634
Name: ODEE_1.RCPSHIST  (TDR Index: 15)
...
2018/04/16 00:02:54.000.000 Delete               Len  2113 RBA 635101697
Name: ODEE_1.RCPS  (TDR Index: 16)
(alternating between there 2 tables)

SCANFORENDTRANS
End of Transaction found at RBA 637137045

2018/04/16 00:02:54.000.000 GGSUnifiedUpdate     Len   146 RBA 637139240
Name: ODEE_10.LOCKS  (TDR Index: 9)

2018/04/16 00:02:54.000.000 GGSUnifiedUpdate     Len   146 RBA 637140038
Name: ODEE_2.LOCKS  (TDR Index: 10)
(lots of LOCKS tables owned by different schemas)
...
2018/04/16 00:02:56.000.000 GGSUnifiedUpdate     Len   146 RBA 639360391
Name: ODEE_3.LOCKS  (TDR Index: 12)


-- edit params EDO_KRP1
TABLEEXCLUDE ODEE_1.RCPS

EXTRACT    EDO_KRP1  Last Started 2018-04-16 10:59   Status ABENDED
Checkpoint Lag       10:56:43 (updated 00:00:20 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-16 00:02:56
                     SCN 2551.639495575 (10957101067671)

-- edit params EDO_KRP1
TABLEEXCLUDE ODEE_1.PUBS
TABLEEXCLUDE ODEE_1.RCPS
TABLEEXCLUDE ODEE_1.RCPSHIST
TABLEEXCLUDE ODEE_2.PUBS
TABLEEXCLUDE ODEE_2.RCPS
TABLEEXCLUDE ODEE_2.RCPSHIST
TABLEEXCLUDE ODEE_3.PUBS
TABLEEXCLUDE ODEE_3.RCPS
TABLEEXCLUDE ODEE_3.RCPSHIST
TABLEEXCLUDE ODEE_4.PUBS
TABLEEXCLUDE ODEE_4.RCPS
TABLEEXCLUDE ODEE_4.RCPSHIST
TABLEEXCLUDE ODEE_5.PUBS
TABLEEXCLUDE ODEE_5.RCPS
TABLEEXCLUDE ODEE_5.RCPSHIST
TABLEEXCLUDE ODEE_6.PUBS
TABLEEXCLUDE ODEE_6.RCPS
TABLEEXCLUDE ODEE_6.RCPSHIST
TABLEEXCLUDE ODEE_7.PUBS
TABLEEXCLUDE ODEE_7.RCPS
TABLEEXCLUDE ODEE_7.RCPSHIST
TABLEEXCLUDE ODEE_8.PUBS
TABLEEXCLUDE ODEE_8.RCPS
TABLEEXCLUDE ODEE_8.RCPSHIST
TABLEEXCLUDE ODEE_9.PUBS
TABLEEXCLUDE ODEE_9.RCPS
TABLEEXCLUDE ODEE_9.RCPSHIST
TABLEEXCLUDE ODEE_10.PUBS
TABLEEXCLUDE ODEE_10.RCPS
TABLEEXCLUDE ODEE_10.RCPSHIST

EXTRACT    EDO_KRP1  Last Started 2018-04-16 11:08   Status ABENDED
Checkpoint Lag       11:05:45 (updated 00:00:36 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-04-16 00:02:56
                     SCN 2551.639495575 (10957101067671)

-- sqlplus
set lines 150 pages 200
select owner, table_name from dba_tables where table_name='LOCKS' order by 1;
OWNER                          TABLE_NAME
------------------------------ ------------------------------
ODEE_1                         LOCKS
ODEE_10                        LOCKS
ODEE_2                         LOCKS
ODEE_3                         LOCKS
ODEE_4                         LOCKS
ODEE_5                         LOCKS
ODEE_6                         LOCKS
ODEE_7                         LOCKS
ODEE_8                         LOCKS
ODEE_9                         LOCKS

desc ODEE_1.locks
 Name                                                                                Null?    Type
 ----------------------------------------------------------------------------------- -------- --------------------------------------------------------
 LOCKNAME                                                                            NOT NULL NVARCHAR2(256)
 LOCKED                                                                                       NUMBER(5)
 LASTUPDATETIME                                                                               TIMESTAMP(6)
(others have same structure)

select distinct owner, table_name from dba_lobs where owner not in
('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS')
order by 1,2;
132 rows selected.


############
# padrp    #
# RPADRP2  #
# 4/30     #
############

REPLICAT   RPADRP2   Last Started 2018-04-29 03:36   Status RUNNING
INTEGRATED
Checkpoint Lag       27:18:19 (updated 27:28:25 ago)
Process ID           36388
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/padrp/RR/ra000000000
                     2018-04-28 00:18:15.332674  RBA 222515

> ls -l /app/oracle/product/ggate/11g/1/dirdat/padrp/RR
-rw-r-----. 1 oracle dba 222945 Apr 27 20:57 ra000000000

-- report
2018-04-29 09:46:18  INFO    OGG-01021  Command received from ERROR: Protocol Error.
2018-04-29 09:46:48  INFO    OGG-01022  Unknown 3 bytes message received from [192.168.217.13]:49404:0 - 000000: de ad 00


###########
# blcdwsp #
# 5/11/18 #
###########

-- uxp33
SELECT 'GuardAppEvent:Start', 'GuardAppEventStrValue:C0066250', 'GuardAppEventUserName:cnozk7' from DUAL;

set serveroutput on
exec DBMS_SPM.CREATE_STGTAB_BASELINE ('STGTAB_BASELINE','GGTEST','GGS');

declare
	my_plans	pls_integer;
begin
	my_plans := DBMS_SPM.PACK_STGTAB_BASELINE (
		table_name	=> 'STGTAB_BASELINE',
		table_owner	=> 'GGTEST',
		enabled		=> 'YES',
		accepted	=> 'YES');
	dbms_output.put_line('Plans loaded: '||my_plans);
end;
/
Plans loaded: 4

select count(*) from GGTEST.STGTAB_BASELINE;

EXEC DBMS_SQLTUNE.CREATE_STGTAB_SQLPROF ('PROFILE_STGTAB', 'GGTEST', 'GGS');
EXEC DBMS_SQLTUNE.PACK_STGTAB_SQLPROF (profile_category => '%', staging_table_name => 'PROFILE_STGTAB', staging_schema_owner => 'GGTEST');

select count(*) from GGTEST.PROFILE_STGTAB;
  COUNT(*)
----------
       197

SELECT 'GuardAppEvent:Released' from DUAL;

expdp \"/ as sysdba\" DIRECTORY=CNO_MIGRATE DUMPFILE=STGTAB_BASELINE.dmp LOGFILE=STGTAB_BASELINE_exp.log CONTENT=ALL TABLES=GGTEST.STGTAB_BASELINE,GGTEST.PROFILE_STGTAB


-- lxoradwsp01
sudo su -
chmod 777 /oragg/datapump/blcdwsp/STGTAB_BASELINE.dmp
exit

impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORADWSP01.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=blcdwsp)))\" DIRECTORY=CNO_MIGRATE DUMPFILE=STGTAB_BASELINE.dmp LOGFILE=STGTAB_BASELINE_imp.log CONTENT=ALL

alter session set container=blcdwsp;
set lines 150 pages 200
set serveroutput on

DECLARE
	my_plans	number;
BEGIN
	my_plans := DBMS_SPM.UNPACK_STGTAB_BASELINE(
		table_name	=> 'STGTAB_BASELINE',
		table_owner	=> 'GGTEST'
	);
	dbms_output.put_line('Plans unloaded: '||my_plans);
END;
/
Plans unloaded: 4

select count(*) from dba_sql_plan_baselines where enabled='YES' and accepted='YES' and last_modified>(sysdate-1/24);
  COUNT(*)
----------
         4

EXEC DBMS_SQLTUNE.UNPACK_STGTAB_SQLPROF(replace => TRUE, staging_table_name => 'PROFILE_STGTAB', staging_schema_owner => 'GGTEST');

select count(*) from dba_sql_profiles;
  COUNT(*)
----------
       197

	   
############
# blcdwsp  #
# EBL_WSP2 #
# 5/13     #
############

EXTRACT    EBL_WSP2  Last Started 2018-05-13 02:13   Status ABENDED
Checkpoint Lag       03:19:53 (updated 07:33:17 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-05-12 22:57:36
                     SCN 2552.1817451237 (10962573990629)

-- report
2018-05-13 10:00:20  INFO    OGG-01641  BOUNDED RECOVERY: recovery start position: SeqNo: 329, RBA: 556906160, SCN: 2552.1817360104 (10962573899496), Ti
mestamp: 2018-05-12 19:47:03.000000, Thread: 1.
2018-05-13 10:00:26  INFO    OGG-01055  Recovery initialization completed for target file /app/oracle/product/ggate/12c/1/dirdat/blcdwsp/RR/ea000000114,
 at RBA 1529.
2018-05-13 10:00:26  INFO    OGG-01053  Recovery completed for target file /app/oracle/product/ggate/12c/1/dirdat/blcdwsp/RR/ea000000115, at RBA 1529.
2018-05-13 10:00:26  INFO    OGG-01057  Recovery completed for all targets.


> ls -lrt /oragg/trail/blcdwsp/RR
-rw-r-----. 1 oracle dba 999999900 May 12 14:59 ea000000107
-rw-r-----. 1 oracle dba 764355734 May 12 23:27 ea000000108
-rw-r-----. 1 oracle dba      1529 May 13 01:47 ea000000109
-rw-r-----. 1 oracle dba      1529 May 13 01:54 ea000000110
-rw-r-----. 1 oracle dba      1529 May 13 02:01 ea000000111
-rw-r-----. 1 oracle dba      1529 May 13 02:07 ea000000112
-rw-r-----. 1 oracle dba      1529 May 13 02:13 ea000000113
-rw-r-----. 1 oracle dba      1529 May 13 02:13 ea000000114

select sequence# from v$archived_log where 10962573990629 between FIRST_CHANGE# and NEXT_CHANGE#-1;
 SEQUENCE#
----------
       337

> ls -l /database/Ecblcdwsp/cblcdwsp_arch01/arch
total 140315944
-rw-r-----. 1 oracle dba 1926474752 May 13 01:36 1_325_975802969.dbf
...
-rw-r-----. 1 oracle dba 1924873216 May 13 01:20 1_335_975802969.dbf
-rw-r-----. 1 oracle dba 1945675264 May 13 01:20 1_336_975802969.dbf
-rw-r-----. 1 oracle dba 2028918784 May 13 00:38 1_337_975802969.dbf
-rw-r-----. 1 oracle dba 1676537344 May 13 00:37 1_338_975802969.dbf
...
-rw-r-----. 1 oracle dba  103618560 May 13 08:56 1_398_975802969.dbf


############
# blcdwsp  #
# 5/13     #
############

Session		98
Serial#		17656
Login		5/12 12:07 PM
Module		sqlplus
Parallel	30
SQLID		b592tk3uympmq

Session		106
Serial#		13723
Login		5/13 6AM
Module		dbms_scheduler


############
# RCAAPMP1 #
# caapmp   #
# 5/15     #
############

REPLICAT   RCAAPMP1  Last Started 2018-05-15 08:27   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:32:12 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/caapmp/ra000000000
                     2018-05-15 07:59:50.068167  RBA 1008917

-- report
2018-05-15 08:27:19  WARNING OGG-01154  SQL error 1403 mapping CAAPMDB.APPMAP_VERTICES to CAAPMP.CAAPMDB.APPMAP_VERTICES OCI Error ORA-01403: no data found, SQL <UP
DATE "CAAPMDB"."APPMAP_VERTICES" x SET x."END_TIME" = :a6,x."FORK" = :a7 WHERE x."VERTEX_ID" = :b0 AND x."START_TIME" = :b1>.

-- discard
VERTEX_ID = 36360
START_TIME = 2018-05-15 03:10:33.848000000
END_TIME = 2018-05-16 03:10:33.848000000
FORK = 424000

VERTEX_ID = 36360
START_TIME = 2018-05-15 03:10:33.848000000
END_TIME = 2018-05-16 03:10:33.850000000
FORK = 424000

-- uxorap02
select * from "CAAPMDB"."APPMAP_VERTICES" where VERTEX_ID = 36360 and START_TIME = to_timestamp('2018-05-15 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF');
     36360 15-MAY-18 03.10.33.848000 AM
16-MAY-18 03.10.33.850000 AM                                                    424000
LoginServlet|service
[{"name":"agent","value":"lxwas85p08|WebSphere|WASBFOApp_App","type":"GATHERED"}

-- lxorainfp02
select * from "CAAPMDB"."APPMAP_VERTICES" where VERTEX_ID = 36360 and START_TIME = to_timestamp('2018-05-15 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF');

insert into "CAAPMDB"."APPMAP_VERTICES"
	(VERTEX_ID, START_TIME, END_TIME, FORK)
values
	(36360, to_timestamp('2018-05-15 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF'), to_timestamp('2018-05-16 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF'), 424000);
commit;

-- report
2018-05-15 08:47:23  WARNING OGG-01154  SQL error 1403 mapping CAAPMDB.APPMAP_ATTRIBS to CAAPMP.CAAPMDB.APPMAP_ATTRIBS OCI Error ORA-01403: no data found, SQL <UPDA
TE "CAAPMDB"."APPMAP_ATTRIBS" x SET x."END_TIME" = :a7,x."FORK" = :a8 WHERE x."VERTEX_ID" = :b0 AND x."START_TIME" = :b1 AND x."ATTRIB_NAME" = :b2>.

-- discard
VERTEX_ID = 36360
START_TIME = to_timestamp('2018-05-15 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF')
END_TIME = to_timestamp('2018-05-16 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF')
FORK = 424000
ATTRIB_NAME = 'agent'

VERTEX_ID = 36360
START_TIME = to_timestamp('2018-05-15 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF')
END_TIME = to_timestamp('2018-05-16 03:10:33.850000000','YYYY-MM-DD HH24:MI:SS.FF')
FORK = 424000
ATTRIB_NAME = 'agent'

-- uxorap02
select * from "CAAPMDB"."APPMAP_ATTRIBS" where VERTEX_ID = 36360 and START_TIME = to_timestamp('2018-05-15 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF') and ATTRIB_NAME = 'agent';
     36360 15-MAY-18 03.10.33.848000 AM
16-MAY-18 03.10.33.850000 AM                                                    424000
agent
lxwas85p08|WebSphere|WASBFOApp_App

-- lxorainfp02
select * from "CAAPMDB"."APPMAP_ATTRIBS" where VERTEX_ID = 36360 and START_TIME = to_timestamp('2018-05-15 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF') and ATTRIB_NAME = 'agent';

insert into "CAAPMDB"."APPMAP_ATTRIBS"
	(VERTEX_ID, START_TIME, END_TIME, FORK, ATTRIB_NAME)
values
	(36360, to_timestamp('2018-05-15 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF'), to_timestamp('2018-05-16 03:10:33.850000000','YYYY-MM-DD HH24:MI:SS.FF'), 424000, 'agent');
commit;

-- discard
VERTEX_ID = 36360
START_TIME = to_timestamp('2018-05-15 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF')
END_TIME = to_timestamp('2018-05-16 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF')
FORK = 424000
ATTRIB_NAME = 'agentdomain'

VERTEX_ID = 36360
START_TIME = to_timestamp('2018-05-15 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF')
END_TIME = to_timestamp('2018-05-16 03:10:33.850000000','YYYY-MM-DD HH24:MI:SS.FF')
FORK = 424000
ATTRIB_NAME = 'agentdomain'

-- uxorap02
select * from "CAAPMDB"."APPMAP_ATTRIBS" where VERTEX_ID = 36360 and START_TIME = to_timestamp('2018-05-15 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF') and ATTRIB_NAME = 'agentdomain';
     36360 15-MAY-18 03.10.33.848000 AM
16-MAY-18 03.10.33.850000 AM                                                    424000
agentdomain
SuperDomain/BPA

-- lxorainfp02
select * from "CAAPMDB"."APPMAP_ATTRIBS" where VERTEX_ID = 36360 and START_TIME = to_timestamp('2018-05-15 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF') and ATTRIB_NAME = 'agentdomain';

insert into "CAAPMDB"."APPMAP_ATTRIBS"
	(VERTEX_ID, START_TIME, END_TIME, FORK, ATTRIB_NAME)
values
	(36360, to_timestamp('2018-05-15 03:10:33.848000000','YYYY-MM-DD HH24:MI:SS.FF'), to_timestamp('2018-05-16 03:10:33.850000000','YYYY-MM-DD HH24:MI:SS.FF'), 424000, 'agentdomain');
commit;

-- params
INSERTMISSINGUPDATES
MAP "CAAPMDB"."APPMAP_ATTRIBS", TARGET "CAAPMDB"."APPMAP_ATTRIBS";
MAP "CAAPMDB"."APPMAP_VERTICES", TARGET "CAAPMDB"."APPMAP_VERTICES";

NOINSERTMISSINGUPDATES
(other mapping)

-- start
REPLICAT   RCAAPMP1  Last Started 2018-05-15 09:04   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:01 ago)
Process ID           48565
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/caapmp/ra000000000
                     2018-05-15 09:04:41.231463  RBA 2004067

					 
############
# RCAAPMP1 #
# caapmp   #
# 5/16     #
############

REPLICAT   RCAAPMP1  Last Started 2018-05-15 09:12   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:05 (updated 17:45:48 ago)
Process ID           48990
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/caapmp/ra000000000
                     2018-05-15 15:53:28.745895  RBA 254991619

-- report (last entry)
2018-05-15 15:53:42  INFO    OGG-06513  Resolving target sequence :CAAPMP.CAAPMDB.SQ_APPMAP_VERTICES.

> ls -l /app/oracle/product/ggate/12c/1/dirdat/caapmp
total 405444
-rw-r-----. 1 oracle dba 407691039 May 16 09:40 ra000000000

-- lxorainfp02
alter session set container=caapmp;
set lines 150 pages 200
COLUMN username FORMAT A10
COLUMN program FORMAT A35
col osuser format a10
col sid format 9990
col "SER" format 99990
col "Description" format a55
--col "Description" format a90
ALTER SESSION SET NLS_DATE_FORMAT='MM/DD/RR HH24:MI';
SELECT s.sid, s.serial# "SER", s.username, s.osuser, s.sql_id,
decode(s.state,'WAITING','Waiting '||s.seconds_in_wait||'s for '||NVL2(q.sql_text, q.sql_text, event),q.sql_text) "Description"
FROM v$session s left outer join v$sql q on s.sql_id=q.sql_id
WHERE s.username='GGS' 
--and s.sql_id is not null;

  SID    SER USERNAME   OSUSER     SQL_ID        Description
----- ------ ---------- ---------- ------------- -------------------------------------------------------
    4  48764 GGS        oracle                   Waiting 64282s for library cache pin
  164  46561 GGS        oracle                   Waiting 0s for REPL Capture/Apply: miscellaneous
  464  56151 GGS        oracle                   Waiting 1s for rdbms ipc message
  617   7751 GGS        oracle                   Waiting 1s for REPL Capture/Apply: messages
 1072  59501 GGS        oracle                   Waiting 5s for rdbms ipc message
 1082  21693 GGS        oracle                   Waiting 1s for rdbms ipc message

 
> free -m
              total        used        free      shared  buff/cache   available
Mem:          35018        2553         262       11656       32202       20447
Swap:         17407         115       17292


SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- ---------------
SGA    DEFAULT buffer cache         1,808    1,808    2,384 SHRINK        16-MAY 02:00:25
       Shared IO Pool                 160        0      160 GROW          15-MAY 07:42:41
       java pool                       32       32       32 STATIC
       large pool                      32       32       32 STATIC
       shared pool                  1,024      608    1,024 GROW          16-MAY 02:00:25
       streams pool                   672      672      672 STATIC
******                           -------- -------- --------
TOTAL                               3,728    3,152    4,304

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
sga_max_size                         big integer 3744M
sga_target                           big integer 3744M
shared_pool_size                     big integer 608M

-- ggsci
stop RCAAPMP1
kill RCAAPMP1
mv ./dirpcs/RCAAPMP1.pcr /tmp

-- lxorainfp02
alter session set container=cdb$root;
alter system set sga_max_size=4000M scope=spfile;
alter system set sga_target=4000M scope=spfile;
alter system set shared_pool_size=1000M scope=spfile;
shutdown immediate;
startup;

-- ggsci
start RCAAPMP1

REPLICAT   RCAAPMP1  Last Started 2018-05-16 10:12   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           131040
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/caapmp/ra000000000
                     2018-05-16 10:17:30.921635  RBA 276874880


  SID    SER USERNAME   OSUSER     SQL_ID        Description
----- ------ ---------- ---------- ------------- -------------------------------------------------------
    4  19337 GGS        oracle     81sw680zbca2u /* SQL Analyze(4,0) */ insert into "CAAPMDB"."TS_TRANSE
                                                 TS" select * from "CAAPMDB"."TS_TRANSETS"

SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- --------------
SGA    DEFAULT buffer cache         2,064    2,064    2,064 INITIALIZING
       Shared IO Pool                 160      160      160 STATIC
       java pool                       32       32       32 STATIC
       large pool                      32       32       32 STATIC
       shared pool                  1,024    1,024    1,024 STATIC
       streams pool                   672      672      672 STATIC
******                           -------- -------- --------
TOTAL                               3,984    3,984    3,984


SELECT * FROM table (DBMS_XPLAN.DISPLAY_CURSOR('8ryaq7tb7fqsj'));


############
# RBL_DSP1 #
# blcfdsp  #
# 5/18     #
############

REPLICAT   RBL_DSP1  Last Started 2018-05-18 19:45   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 02:24:24 ago)
Process ID           60076
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/blcfdsp/ra000000012
                     2018-05-18 19:45:59.084038  RBA 596323318

-- report (last entry - 10:11 pm)
2018-05-18 19:45:58  INFO    OGG-03506  The source database character set, as determined from the trail file, is us7ascii.

> ls -l /app/oracle/product/ggate/12c/1/dirdat/blcfdsp
...
-rw-r-----. 1 oracle dba 596332122 May 17 07:07 ra000000012

-- LXORAODSP01
alter session set container=caapmp;
set lines 150 pages 200
COLUMN username FORMAT A10
COLUMN program FORMAT A35
col osuser format a10
col sid format 9990
col "SER" format 99990
col "Description" format a55
--col "Description" format a90
ALTER SESSION SET NLS_DATE_FORMAT='MM/DD/RR HH24:MI';
SELECT s.sid, s.serial# "SER", s.username, s.osuser, s.sql_id,
decode(s.state,'WAITING','Waiting '||s.seconds_in_wait||'s for '||NVL2(q.sql_text, q.sql_text, event),q.sql_text) "Description"
FROM v$session s left outer join v$sql q on s.sql_id=q.sql_id
WHERE s.username='GGS' 
--and s.sql_id is not null;

 
> free -m

-- ggsci
mv ./dirpcs/RCAAPMP1.pcr /tmp

-- lxorainfp02

-- ggsci

SELECT * FROM table (DBMS_XPLAN.DISPLAY_CURSOR('8ryaq7tb7fqsj'));


############
# blcfdsp  #
# EBL_DSP1 #
# 5/18     #
############

EXTRACT    EBL_DSP1  Last Started 2018-05-17 01:46   Status RUNNING
Checkpoint Lag       39:28:12 (updated 00:00:04 ago)
Process ID           26477340
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-05-17 06:47:51
                     SCN 2552.1883372663 (10962639912055)

-- report file
2018-05-17 06:46:24  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/blcfdsp/ea000000011.
            11429156 records processed as of 2018-05-17 06:47:50 (rate 633,delta 6624)
            11430499 records processed as of 2018-05-17 06:52:53 (rate 622,delta 4)
            11430826 records processed as of 2018-05-17 06:58:06 (rate 612,delta 1)
            11430991 records processed as of 2018-05-17 07:03:07 (rate 602,delta 0)

> ls -l /nomove/app/oracle/ggate/12c/1/dirdat/blcfdsp/ea000000011
...
-rw-r-----    1 oracle   dba       999998463 May 17 06:46 ea000000011
-rw-r-----    1 oracle   dba       596332062 May 17 07:07 ea000000012

-- uxp34
select sequence# from v$archived_log where &what_scn between FIRST_CHANGE# and NEXT_CHANGE#-1;
 SEQUENCE#
----------
    420148

> ll /move/blcfdsp_arch01/arch
-rw-r-----    1 oracle   dba       156937728 May 18 06:07 arch1_420943_629464407.dbf
-rw-r-----    1 oracle   dba       178317312 May 18 06:10 arch1_420944_629464407.dbf
...


#############
# bpap      #
# baselines #
#############

dba_sql_plan_baselines

select fixed, count(*) from dba_sql_plan_baselines where enabled='YES' and accepted='YES' group by fixed;
select module, count(*) from dba_sql_plan_baselines where enabled='YES' and accepted='YES' group by module;
JDBC Thin Client                                                      98775

select action, count(*) from dba_sql_plan_baselines where enabled='YES' and accepted='YES' group by action;


declare
	my_plans	pls_integer;
begin
	my_plans := DBMS_SPM.PACK_STGTAB_BASELINE (
		table_name	=> 'STGTAB_BASELINE',
		table_owner	=> 'GGTEST',
		enabled		=> 'YES',
		accepted	=> 'YES',
		module		=> 'JDBC Thin Client');
	dbms_output.put_line('Plans loaded: '||my_plans);
end;
/


############
# bparptp  #
# RBP_PTP2 #
# 5/21     #
############

REPLICAT   RBP_PTP2  Last Started 2018-05-21 01:22   Status ABENDED
INTEGRATED
Checkpoint Lag       06:19:35 (updated 10:59:53 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/bparptp/RR/ra000000000
                     2018-05-20 19:03:26.448256  RBA 133152011

-- report 
2018-05-21 01:23:03  WARNING OGG-01154  SQL error 1 mapping BPARPTP.AWDSLA.CURR_SLA_REPORT to AWDSLA.CURR_SLA_REPORT OCI Error ORA-00001: unique constraint (AWDSLA.
CURR_SLA_REPORT_PK) violated (status = 1), SQL <INSERT INTO "AWDSLA"."CURR_SLA_REPORT" ("CRDATTIM","RECORDCD","SLA_CATEGORY_ID","SLA_CATEGORY_VERSION","SLA_GROUP_ID
","SLA_GROUP_VERSION","BUS_REPORT_CODE","CAL_REPORT_CODE","BUSINESS_AREA","WORK_TYPE","STATUS_CODE","QUEUE_CODE","BUS_DIP_SLA","CAL_DIP_SLA") VALUES (:a0,:a1,:a2,:a
3,:a4,:a5,:a6,:a7,:a8,:a9,:a10,:a11,:a12,:a13)>.

-- edit params
REPERROR (1,DISCARD)

-- report
2018-05-21 12:25:03  WARNING OGG-01154  SQL error 2291 mapping BPARPTP.AWDSLA.WORKITEM_CHANGE_HISTORY to AWDSLA.WORKITEM_CHANGE_HISTORY OCI Error ORA-02291: integri
ty constraint (AWDSLA.WI_CHANGE_HIST_FK_WI_DETAIL) violated - parent key not found (status = 2291), SQL <INSERT INTO "AWDSLA"."WORKITEM_CHANGE_HISTORY" ("YEAR_KEY_C
ODE","CRDATTIM","RECORDCD","WORKITEM_CHANGE_SEQ","CHANGE_DATE","OLD_BUSINESS_AREA","NEW_BUSINESS_AREA","OLD_WORK_TYPE","NEW_WORK_TYPE","BUS_DIP_SLA","CAL_DIP_SLA")
VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10)>.

-- edit params
REPERROR (2291,DISCARD)

-- report
2018-05-21 12:28:36  WARNING OGG-02544  Unhandled error (ORA-26787: The row with key ("CRDATTIM", "RECORDCD", "WORKITEM_CHANGE_SEQ") = (2018-05-18-13.13.14.237120,
T, 1) does not exist in table AWDSLA.WORKITEM_CHANGE_HISTORY
ORA-01403: no data found) while processing the record at SEQNO 0, RBA 285388895 in Integrated mode. REPLICAT will retry in Direct mode.

-- edit params
INSERTMISSINGUPDATES


############
# blcfdsp  #
# EBL_DSP1 #
# 5/30     #
############

-- edit params
CACHEMGR CACHESIZE 8GB, CACHEDIRECTORY /oragg/dirtmp 200GB

-- ggsci
EXTRACT    EBL_DSP1  Last Started 2018-05-30 11:56   Status RUNNING
Checkpoint Lag       10:14:57 (updated 00:00:07 ago)
Process ID           15073424
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-05-30 05:44:25
                     SCN 2553.1197755190 (10966249261878)

-- report
2018-05-30 15:57:40  INFO    OGG-01738  BOUNDED RECOVERY: CHECKPOINT: for object pool 1: p28246378_extr: start=SeqNo: 427366, RBA: 137894832, SCN: 2553.1197582648 (10966249089336), Timestamp: 2018-05-30 05:15:31.000000, end=SeqNo: 427517, RBA: 181894088, SCN: 2553.1197751430 (10966249258118), Timestamp: 2018-05-30 05:43:47.000000, Thread: 1.
              216617 records processed as of 2018-05-30 15:57:50 (rate 41,delta 24)

-- DB params
NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
streams_pool_size                    big integer 2816M
sga_max_size                         big integer 18496M
sga_target                           big integer 18496M

SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- ---------------
SGA    DEFAULT buffer cache         8,128    8,064   11,072 SHRINK        30-MAY 05:35:19
       java pool                      448      448      448 SHRINK        30-APR 21:21:00
       large pool                     448      448      448 STATIC
       shared pool                  6,528    6,208    6,592 GROW          30-MAY 05:35:19
       streams pool                 2,816      192    2,816 GROW          14-MAY 16:05:32
******                           -------- -------- --------
TOTAL                              18,368   15,360   21,376

-- CO 67050
alter system set streams_pool_size=4352M scope=both;

SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- ---------------
SGA    DEFAULT buffer cache         6,592    6,592   11,072 SHRINK        30-MAY 16:16:06
       java pool                      448      448      448 SHRINK        30-APR 21:21:00
       large pool                     448      448      448 STATIC
       shared pool                  6,528    6,208    6,592 GROW          30-MAY 05:35:19
       streams pool                 4,352      192    4,352 GROW          30-MAY 16:16:06
******                           -------- -------- --------
TOTAL                              18,368   13,888   22,912

-- edit params
TRANLOGOPTIONS INTEGRATEDPARAMS (max_sga_size 3500, PARALLELISM 3)
TRANLOGOPTIONS _READAHEADCOUNT 30
TRANLOGOPTIONS ASYNCTRANSPROCESSING 600

-- ggsci
stop
start
kill

2018-05-31 05:09:38  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/blcfdsp/ea000000094.
            48055448 records processed as of 2018-05-31 05:11:11 (rate 1560,delta 1353)

Program     Status      Group       Lag at Chkpt  Time Since Chkpt
EXTRACT     RUNNING     EBL_DSP1    26:32:08      00:00:05


###############
# blcnavp     #
# lxorabpap02 #
# uxp34       #
# 6/11        #
###############

-- SDT 2159609
192.168.193.143, FrontOffice, catchall, WebContainer : 9, 2018/06/11:08.15.39.079, warn, com.navisys.util.SQLStatement, sql exec exceeded threshold: elapsed time 

WITH HIPAA_TABLE AS (
	SELECT RH.RH_REF_NUMBER,  CONCAT(APP.AX_C14_NUMBER, SUBSTR(APP.AX_C14_DATE, LENGTH(APP.AX_C14_DATE)-1, LENGTH(APP.AX_C14_DATE))) AS TRACKING_ID,  
	  RH.RH_REQUIREMENT_ID,  RD.RD_SEQUENCE,  RD.RD_STATUS_ID  
	FROM WORKLOAD.T_WLRH_REQUIREMENT_HEADER RH,  WORKLOAD.T_WLRD_REQUIREMENT_DETAIL RD,  APP.T_APAX_APP_EXTENSIONS APP  
	WHERE RH.RH_HEADER_ID     = RD.RD_HEADER_ID  AND RH.RH_REQUIREMENT_ID IN (4013,4004,4000,4005,4009,4011,4012,4002,233,4003)  
	AND RD.RD_STATUS_ID NOT  IN (17,3)  AND RD.RD_SEQUENCE        =   (
		SELECT MAX(RD_SEQUENCE)   FROM WORKLOAD.T_WLRD_REQUIREMENT_DETAIL RD2   WHERE RD.RD_HEADER_ID = RD2.RD_HEADER_ID   )  
	AND APP.AX_APPLICATION_ID = RH.RH_REF_NUMBER   )  
SELECT *  FROM   (
	SELECT AF_BFO_TRACKING_ID,    AF_TRANSACTION_STATUS,   AF_TRANSACTION_XML  
	FROM WORKLOAD.T_WLAF_AURA_103FAILEDTRANS  
	WHERE AF_BFO_TRACKING_ID NOT IN    (SELECT TRACKING_ID FROM HIPAA_TABLE)   AND AF_TRANSACTION_STATUS IN (100,200,300 )  
	AND AF_BFO_TRACKING_ID IN (
		select  DISTINCT CONCAT(APP1.AX_C14_NUMBER, SUBSTR(APP1.AX_C14_DATE, LENGTH(APP1.AX_C14_DATE)-1, LENGTH(APP1.AX_C14_DATE))) AS BFO_TRACKING_ID  
		from  app.T_APAX_APP_EXTENSIONS APP1    
		where  (
			(select count(*) 
			 from workload.t_wlrh_requirement_header,workload.t_wlrd_requirement_detail 
			 where   rh_ref_number = to_char(APP1.AX_APPLICATION_ID) and rd_header_id = rh_header_id 
			 and rh_detail_sequence = rd_sequence   and rh_requirement_id = 233)> 0)
	) ORDER BY AF_INSERTED_TIME DESC
) WHERE ROWNUM <= 25

-- cutover log
TABLE                                             AIX        LINUX          DIFFERENCE MVIEW
---------------------------------------- ------------ ------------ ------------------- -----
IMAGING.MLOG$_T_IMIG_INBOUND_IMAGE                  0      177,674              177674
IMAGING.MV_INBOUND_IMAGES                      43,483       43,490                   7 YES
SQLTUNE.SQL_TUNE_STAGING                                         0
SQLTUNE.SQL_TUNE_TASK_STAGING                                    0
WORKLOAD.MLOG$_T_WLTB_TASK_BOX_DETA                 0      145,741              145741
WORKLOAD.MLOG$_T_WLTF_TASK_REFERENC                 0      258,172              258172
WORKLOAD.MLOG$_T_WLTH_TASK_BOX_HEAD                 0      318,022              318022
WORKLOAD.MV_TASK_BOX_DETAIL                 1,971,809    1,925,563              -46246 YES
WORKLOAD.MV_TASK_BOX_HEADER                 1,084,903    1,055,112              -29791 YES
WORKLOAD.MV_TASK_REFERENCE                  1,012,242      987,132              -25110 YES
WORKLOAD.USLOG$_MV_TASK_BOX_DETAIL                  0            3                   3
WORKLOAD.USLOG$_MV_TASK_BOX_HEADER                  0            3                   3
WORKLOAD.USLOG$_MV_TASK_REFERENCE                   0           14                  14

-- manual checks
select count(*) from WORKLOAD.T_WLRH_REQUIREMENT_HEADER;
AIX		1005421
Linux	976638

select count(*) from WORKLOAD.T_WLRD_REQUIREMENT_DETAIL;
AIX		2159804
Linux	2089589

select count(*) from APP.T_APAX_APP_EXTENSIONS;
AIX		98386
Linux	95277

select count(*) from WORKLOAD.T_WLAF_AURA_103FAILEDTRANS;
AIX		44046
Linux	44100

col MVIEW format a5
select diff.OWNER||'.'||diff.TABLE_NAME "TABLE", diff."AIX", diff."LINUX", diff."DIFFERENCE", NVL2(mv.mview_name,'YES',NULL) "MVIEW"
from dba_mviews mv right outer join
	(select NVL(lx.OWNER,aix.OWNER) "OWNER", NVL(lx.TABLE_NAME,aix.TABLE_NAME) "TABLE_NAME", aix.RECORD_COUNT "AIX", lx.RECORD_COUNT "LINUX", lx.RECORD_COUNT-aix.RECORD_COUNT "DIFFERENCE"
	 from ggtest.row_count_linux lx full outer join ggtest.row_count_aix aix
		on aix.OWNER=lx.OWNER and aix.TABLE_NAME=lx.TABLE_NAME
	 where aix.TABLE_NAME in ('T_WLRH_REQUIREMENT_HEADER','T_WLRD_REQUIREMENT_DETAIL','T_APAX_APP_EXTENSIONS','T_WLAF_AURA_103FAILEDTRANS')
	) diff
	on mv.owner=diff.owner and mv.mview_name=diff."TABLE_NAME"
order by 1;


COL "DDL"  FORMAT A1000
select DBMS_METADATA.GET_DDL('MATERIALIZED_VIEW','&what_obj','&what_owner') "DDL" from dual;
select DBMS_METADATA.GET_DDL('TABLE','&what_obj','&what_owner') "DDL" from dual;

4n2sfkcd5pax4
-- plan hash 1947944377: 19.14s / execution
-- plan hash 1498769983: 1.10s / execution
SQL_TUNING_1528709892668	SYS	Jun 11, 2018 5:39:21 AM - profile 84.83%
SQL_TUNING_1528700606820	SYS	Jun 11, 2018 3:04:09 AM - profile 83.12%
SYS_AUTO_SQL_TUNING_TASK	SYS	Jun 10, 2018 7:00:09 AM - profile 83%
SYS_AUTO_SQL_TUNING_TASK	SYS	Jun 9, 2018 6:03:34 AM

-- SQL plan baselines
Name                            Fix Acc Pur Ena Created
SQL_PLAN_8jx2dm01v49hv1ea78329	NO	YES	YES	YES	Jun 9, 2018 9:56:02 AM	
SQL_PLAN_8jx2dm01v49hv47f27583	NO	YES	YES	YES	Jun 9, 2018 9:56:02 AM	
SQL_PLAN_8jx2dm01v49hv590d0e5a	NO	YES	YES	YES	Jun 9, 2018 10:05:20 AM	
SQL_PLAN_8jx2dm01v49hv3be65f3b	NO	YES	YES	YES	Jun 9, 2018 9:56:02 AM	
SQL_PLAN_8jx2dm01v49hva440843f	NO	YES	YES	YES	Jun 9, 2018 10:00:20 AM
SQL_PLAN_8jx2dm01v49hvc27f4c75	NO	NO	YES	YES	Jun 10, 2018 8:25:20 PM


select count(*) from IMAGING.MLOG$_T_IMIG_INBOUND_IMAGE;
AIX		0
Linux	146

select count(*) from WORKLOAD.MLOG$_T_WLTB_TASK_BOX_DETA;
AIX		0
Linux	346

select count(*) from WORKLOAD.MLOG$_T_WLTF_TASK_REFERENC;
AIX		0
Linux	717

select count(*) from WORKLOAD.MLOG$_T_WLTH_TASK_BOX_HEAD;
AIX		0
Linux	978

select count(*) from WORKLOAD.USLOG$_MV_TASK_BOX_DETAIL;
AIX		0
Linux	45

select count(*) from WORKLOAD.USLOG$_MV_TASK_BOX_HEADER;
AIX		0
Linux	42

select count(*) from WORKLOAD.USLOG$_MV_TASK_REFERENCE;
AIX		0
Linux	69


###############
# blcfdsp     #
# RBL_DSP1    #
# uxp34       #
# LXORAODSP01 #
#  6/13       #
###############

REPLICAT   RBL_DSP1  Last Started 2018-06-13 11:53   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:09:45 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/blcfdsp/ra000000006
                     2018-06-13 11:53:34.831366  RBA 805307894

-- report
2018-06-13 11:53:38  WARNING OGG-01151  Error mapping from BSPN_MBL.PSPCT to BLCFDSP.BSPN_MBL.PSPCT.
2018-06-13 11:53:38  ERROR   OGG-01296  Error mapping from BSPN_MBL.PSPCT to BLCFDSP.BSPN_MBL.PSPCT.

-- discard
Key column AREA_CODE_2 (47) is missing from update on table BLCFDSP.BSPN_MBL.PSPCT
Key column UMASK_FULL_PHONE_2 (48) is missing from update on table BLCFDSP.BSPN_MBL.PSPCT
Key column MASK_FULL_PHONE_2 (49) is missing from update on table BLCFDSP.BSPN_MBL.PSPCT
Key column DO_NOT_CALL_CODE_2 (50) is missing from update on table BLCFDSP.BSPN_MBL.PSPCT
Key column AREA_CODE_3 (51) is missing from update on table BLCFDSP.BSPN_MBL.PSPCT
Key column UMASK_FULL_PHONE_3 (52) is missing from update on table BLCFDSP.BSPN_MBL.PSPCT
Key column MASK_FULL_PHONE_3 (53) is missing from update on table BLCFDSP.BSPN_MBL.PSPCT
Key column DO_NOT_CALL_CODE_3 (54) is missing from update on table BLCFDSP.BSPN_MBL.PSPCT
Key column T65_DATE (55) is missing from update on table BLCFDSP.BSPN_MBL.PSPCT
Key column FLAG_EXPORT (56) is missing from update on table BLCFDSP.BSPN_MBL.PSPCT
Missing 10 key columns in update for table BLCFDSP.BSPN_MBL.PSPCT.
Current time: 2018-06-13 11:53:38

-- sqlplus
set long 40
col owner format a20
col constraint_name format a30
col column_name format a30
select dc.owner, dc.constraint_name, col.column_name, dc.constraint_type, dc.status
from dba_constraints dc join dba_cons_columns col
  on dc.constraint_name = col.constraint_name
where dc.table_name='PSPCT' and dc.owner='BSPN_MBL'
order by dc.constraint_type desc, dc.constraint_name asc;
no rows selected (AIX or Linux)

-- edit params
MAPEXCLUDE BLCFDSP.BSPN_MBL.PSPCT;
MAP BSPN_MBL.PSPCT, TARGET BLCFDSP.BSPN_MBL.PSPCT, KEYCOLS (

PSPCT_ID, HASH_LOCTN_COMPR_KEY, HSHLD_ID, BRANCH_ID, PREFX_TITLE, FIRST_NAME, MIDLE_NAME, LAST_NAME, SUFX_TITLE, AREA_CODE, UMASK_FULL_PHONE, MASK_FULL_PHONE, GENDR_CODE, MARTL_STAT, DOB_YYYYMM, CUST_CODE, ACTVE_STAT_CODE, SPPRS_CODE, SOURC_CODE, DOB_SOURC_CODE, PRCSS_FILE_ID, LTC_RANK, PO_BOX_CODE, DO_NOT_CALL_CODE, T65_CODE, ADDR_LINE_1, ADDR_LINE_2, CITY, STATE, ZIP, ZIP_PLUS4, LATTD, LNGTD, VENDR_CODE, GEOCD_STAT, RECRD_CREAT_DATE, RECRD_CREAT_BY, RECRD_UPDAT_DATE, RECRD_UPDAT_BY, SPATL_GMTRY, ABTEC_CNSMR_LINK, ABTEC_ADDR_LINK, SERVC_AGENT, CNO_PTY_ID, CNO_PTY_TYP_CD, CNO_ADDR_ID, CNO_HSHLD_ID, FORMER_PTY_ID );

-- 17:14
REPLICAT   RBL_DSP1  Last Started 2018-06-13 14:15   Status RUNNING
INTEGRATED
Checkpoint Lag       10:27:37 (updated 00:16:28 ago)
Process ID           13606
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/blcfdsp/ra000000013
                     2018-06-13 06:29:42.811026  RBA 962766766

-- target
COLUMN username FORMAT A10
COLUMN program FORMAT A35
col osuser format a10
col sid format 9990
col "SER" format 99990
col "Description" format a55
ALTER SESSION SET NLS_DATE_FORMAT='MM/DD/RR HH24:MI';
SELECT DISTINCT s.sid, s.serial# "SER", s.username, s.osuser, s.logon_time, s.program,
decode(s.state,'WAITING','Waiting '||s.seconds_in_wait||'s for '||NVL2(s.sql_id, s.sql_id, event),s.sql_id) "Description"
FROM v$session s
WHERE s.username='GGS' --and s.sql_id is not null
ORDER BY s.logon_time, s.program;
  SID    SER USERNAME   OSUSER     LOGON_TIME     PROGRAM                             Description
----- ------ ---------- ---------- -------------- ----------------------------------- -------------------------------------------------------
  823  17112 GGS        oracle     06/13/18 14:15 oracle@LXORAODSP01 (AS01)           Waiting 0s for REPL Capture/Apply: messages
    9  41838 GGS        oracle     06/13/18 14:15 oracle@LXORAODSP01 (AS04)           Waiting 3s for rdbms ipc message
  150  58545 GGS        oracle     06/13/18 14:15 oracle@LXORAODSP01 (AS05)           Waiting 3s for rdbms ipc message
  420  49040 GGS        oracle     06/13/18 14:15 oracle@LXORAODSP01 (AS06)           Waiting 2s for rdbms ipc message
  558  13024 GGS        oracle     06/13/18 14:15 replicat@lxoggp01 (TNS V1-V3)       Waiting 5s for SQL*Net message from client
  824  49434 GGS        oracle     06/13/18 16:55 oracle@LXORAODSP01 (AS03)           Waiting 3s for rdbms ipc message
  425  27481 GGS        oracle     06/13/18 16:56 oracle@LXORAODSP01 (AS08)           Waiting 3s for rdbms ipc message
  148  19509 GGS        oracle     06/13/18 17:17 oracle@LXORAODSP01 (AS09)           Waiting 3s for rdbms ipc message
 1095  54846 GGS        oracle     06/13/18 17:17 oracle@LXORAODSP01 (AS02)           Waiting 3s for rdbms ipc message
  556  16964 GGS        oracle     06/13/18 17:18 oracle@LXORAODSP01 (AS07)           Waiting 0s for rdbms ipc message


SELECT * FROM table (DBMS_XPLAN.DISPLAY_CURSOR(''));

-- 6/14 14:43
REPLICAT   RBL_DSP1  Last Started 2018-06-14 14:18   Status RUNNING
INTEGRATED
Checkpoint Lag       20:27:45 (updated 00:22:27 ago)
Process ID           92314
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/blcfdsp/ra000000020
                     2018-06-13 17:52:59.736519  RBA 691326698

> sh ls -lrt /app/oracle/product/ggate/12c/1/dirdat/blcfdsp/ra0000*
-rw-r-----. 1 oracle dba  47572222 Jun 14 06:47 /app/oracle/product/ggate/12c/1/dirdat/blcfdsp/ra000000101

-- report
2018-06-14 14:20:44  INFO    OGG-02232  Switching to next trail file /app/oracle/product/ggate/12c/1/dirdat/blcfdsp/ra000000101 at 2018-06-14 14:20:44.748640 due to EOF. with current RBA 999999328.

-- 14:46
REPLICAT   RBL_DSP1  Last Started 2018-06-14 14:18   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           92314
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/blcfdsp/ra000000101
                     2018-06-14 14:46:31.271642  RBA 47602727


############
# blcfdsp  #
# EBL_DSP1 #
# 6/13     #
############

EXTRACT    EBL_DSP1  Last Started 2018-06-12 09:07   Status RUNNING
Checkpoint Lag       00:15:11 (updated 07:35:41 ago)
Process ID           10814110
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-06-13 06:28:54
                     SCN 2554.735736150 (10970082210134)

-- report
2018-06-13 06:44:05  WARNING OGG-01266  cm_mf_write_lower(mf_t *, char *, size_t, size_t *, int *): write: to_write: 1642496  errno: 28 (No space left on device)  c
o_uid: 1084028  /nomove/app/oracle/ggate/12c/1/dirtmp/EBL_DSP1_p10814110_extr_112ba0e48_00022.cm.

-- param (added earlier)
CACHEMGR CACHESIZE 8GB, CACHEDIRECTORY /oragg/dirtmp 200GB

> df -g /nomove/app/oracle/ggate/12c/1
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
/dev/nomovelv    108.50     10.12   91%   921880    24% /nomove

-- ggsci
stop EBL_DSP1
kill EBL_DSP1

mv ./dirpcs/EBL_DSP1.pce /tmp

-- 17:16
EXTRACT    EBL_DSP1  Last Started 2018-06-13 14:57   Status RUNNING
Checkpoint Lag       10:46:24 (updated 00:00:03 ago)
Process ID           21365674
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-06-13 06:29:47
                     SCN 2554.735739705 (10970082213689)

-- 6/14 14:47
EXTRACT    EBL_DSP1  Last Started 2018-06-14 14:45   Status RUNNING
Checkpoint Lag       32:10:23 (updated 00:00:04 ago)
Process ID           52166804
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-06-13 06:36:52
                     SCN 2554.735770062 (10970082244046)

-- last report
2018-06-14 14:46:08  INFO    OGG-06509  Using the following key columns for source table CORE.CLAIM: CMPNY_CODE, POLCY_NUMBR, CLAIM_NUMBR, RECV_DATE.
                 782 records processed as of 2018-06-14 15:05:41 (rate 0,delta 0)
                 863 records processed as of 2018-06-14 15:20:30 (rate 0,delta 0)
                 912 records processed as of 2018-06-14 15:33:30 (rate 0,delta 0)

-- memory
SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- ---------------
SGA    DEFAULT buffer cache         8,576    8,576    8,832 SHRINK        14-JUN 12:52:12
       java pool                      448      448      448 SHRINK        12-JUN 11:23:07
       large pool                     448      448      448 STATIC
       shared pool                  6,528    6,272    6,528 GROW          14-JUN 12:52:12
       streams pool                 4,352    4,352    4,352 STATIC
******                           -------- -------- --------
TOTAL                              20,352   20,096   20,608

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
sga_max_size                         big integer 20G
sga_target                           big integer 20G
streams_pool_size                    big integer 4352M

-- http://www.oracle.com/technetwork/database/availability/maa-gg-performance-1969630.pdf
-- TRANLOGOPTIONS INTEGRATEDPARAMS (max_sga_size 3500, PARALLELISM 3)
In DB set STREAMS_POOL_SIZE = (MAX_SGA_SIZE * # of integrated Extracts) + 25% head room = 3500 * 1 * 1.25 = 4375
In GG set TRANLOGOPTIONS INTEGRATEDPARAMS (_LOGMINER_READ_BUFFERS 256)

-- 6/15 8:50
EXTRACT    EBL_DSP1  Last Started 2018-06-14 14:45   Status STOPPED
Checkpoint Lag       25:44:06 (updated 01:22:26 ago)
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-06-14 05:44:19
                     SCN 2554.765282681 (10970111756665)

-- last report
2018-06-15 07:22:19  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/blcfdsp/ea000000230.
            76082758 records processed as of 2018-06-15 07:24:23 (rate 1270,delta 1349)

-- 6/15 9:50
SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- ---------------
SGA    DEFAULT buffer cache         4,736    4,736    8,832 SHRINK        15-JUN 09:46:59
       java pool                      448      448      448 SHRINK        12-JUN 11:23:07
       large pool                     448      448      448 STATIC
       shared pool                  6,528    6,272    6,528 GROW          14-JUN 12:52:12
       streams pool                 8,192    4,352    8,192 GROW          15-JUN 09:46:59
******                           -------- -------- --------
TOTAL                              20,352   16,256   24,448

NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
streams_pool_size                    big integer 8G

set lines 150 pages 200
alter session set nls_date_format='MM/DD HH24:MI';
set numf 999,999,999,999,990
select cp.capture_name, cp.status, cp.CAPTURED_SCN, db.CURRENT_SCN, (db.CURRENT_SCN-cp.CAPTURED_SCN) "DIFF", cp.START_TIME, cp.STATUS_CHANGE_TIME
from dba_capture cp, v$database db;
CAPTURE_NAME                   STATUS           CAPTURED_SCN          CURRENT_SCN                 DIFF START_TIME  STATUS_CHAN
------------------------------ -------- -------------------- -------------------- -------------------- ----------- -----------
OGG$CAP_EBL_DSP1               ENABLED    10,970,111,587,734   10,970,119,014,604            7,426,870 06/14 05:16 06/15 10:08

select al.sequence#, mx.LAST_LOG, (mx.LAST_LOG-al.sequence#) "LOGS_BEHIND"
from v$archived_log al, dba_capture cp,
  (select max(SEQUENCE#) "LAST_LOG" from v$archived_log) mx
where cp.CAPTURED_SCN between al.FIRST_CHANGE# and al.NEXT_CHANGE#-1;

 SEQUENCE#   LAST_LOG  LOGS_BEHIND
---------- ---------- ----------
    435903     436819        916

> ll /move/blcfdsp_arch01/arch
-rw-r-----    1 oracle   dba         6317056 Jun 15 14:37 arch1_436819_629464407.dbf


EXTRACT    EBL_DSP1  Last Started 2018-06-15 10:08   Status RUNNING
Checkpoint Lag       33:03:39 (updated 00:00:01 ago)
Process ID           10486188
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-06-14 05:47:52
                     SCN 2554.765334599 (10970111808583)

					 
-- Linux (check for I/O for trail files)
iostat -x 30
await: The  average  time  (in  milliseconds) for I/O requests issued to the device to be served. 
       This includes the time spent by the requests in queue and the time spent servicing them.
%util: Percentage  of  elapsed time during which I/O requests were issued to the device (bandwidth 
       utilization for the device). Device saturation occurs when this value is close to 100%.

-- AIX
> df -g /oragg
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
lxnfsp01.conseco.ad:/app/oragg   5998.01   2878.08   53%   258153     1% /oragg

lspv
lspv -l 

lspv | grep oragg

iostat -d 30
Disks:         % tm_act     Kbps      tps    Kb_read   Kb_wrtn
hdisk15           0.4       1.9       0.5          0        56

iostat -D -f /backup_uxs33 30 
%tm_act: bandwidth utilization for the device

-- 16:15 report
2018-06-15 16:15:21  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/blcfdsp/ea000000244.
             9742690 records processed as of 2018-06-15 16:15:34 (rate 1329,delta 9404)


############
# blcfdsp  #
# EBL_DSP1 #
# uxp34    #
# 6/19     #
############

-- 11:14
NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
sga_max_size                         big integer 20G
sga_target                           big integer 20G
streams_pool_size                    big integer 8G

SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- ---------------
SGA    DEFAULT buffer cache         4,992    4,736    8,832 GROW          18-JUN 22:22:18
       java pool                      448      448      448 SHRINK        12-JUN 11:23:07
       large pool                     448      448      448 STATIC
       shared pool                  6,272    6,016    6,528 SHRINK        18-JUN 22:22:18
       streams pool                 8,192    4,352    8,192 GROW          15-JUN 09:46:59
******                           -------- -------- --------
TOTAL                              20,352   16,000   24,448

EXTRACT    EBL_DSP1  Last Started 2018-06-18 18:42   Status RUNNING
Checkpoint Lag       04:20:31 (updated 00:06:36 ago)
Process ID           37355584
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-06-19 06:47:52
                     SCN 2554.809776752 (10970156250736)

-- params
TRANLOGOPTIONS INTEGRATEDPARAMS (max_sga_size 6600, PARALLELISM 3)
(In DB set STREAMS_POOL_SIZE = (MAX_SGA_SIZE * # of integrated Extracts) + 25% head room = 3500 * 1 * 1.25 = 4375)

-- tail -f ./dirrpt/EBL_DSP1.rpt
2018-06-19 10:45:19  INFO    OGG-01971  The previous message, 'WARNING OGG-01027', repeated 1 times.
            11380019 records processed as of 2018-06-19 11:08:20 (rate 192,delta 0)

> df -g /move/blcfdsp*
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
/dev/blcfdparch01lv    238.62    184.47   23%      310     1% /move/blcfdsp_arch01

-- sqlplus 
select al.sequence#
from v$archived_log al, dba_capture cp
where cp.CAPTURED_SCN between al.FIRST_CHANGE# and al.NEXT_CHANGE#-1;
 SEQUENCE#
----------
    438812

-- AWR report
@/nomove/app/oracle/db/11g/6/rdbms/admin/awrrpt.sql

-- healthcheck
set truncate off 
set linesize 900 
set LONG 990000 
set longchunksize 9000
set numwidth 15 
set heading off 
set feedback off 
set trimspool on 
set verify off;
spool /nomove/app/oracle/scripts/12cupgrade/logs/blcfdsp_healthcheck_0619.html
@/nomove/app/oracle/ggate/12c/1/ogg_11204.sql

The WAITING FOR CLIENT REQUESTS state is an indicator to investigate the extract process rather than the logmining server when there are chunks available from capture
The maximum value for _READAHEADCOUNT is 64

ERROR: The parameter 'aq_tm_processes' should not be explicitly set to 10! 
+ With this setting, queue monitoring is disabled for buffered queues. 
+ To resolve this problem, set the value to 1 using: ALTER SYSTEM SET AQ_TM_PROCESSES=1; 

> ls -l /oragg/dirtmp
-rw-r-----    1 oracle   dba      2147024896 Jun 19 06:42 EBL_DSP1_p37355584_extr_1145ebb48_00000.cm
...
-rw-r-----    1 oracle   dba      2139095040 Jun 19 11:05 EBL_DSP1_p37355584_extr_1145ebb48_00047.cm
-rw-r-----    1 oracle   dba      1409417216 Jun 19 11:08 EBL_DSP1_p37355584_extr_1145ebb48_00048.cm
96.9 GB

-- ggsci
SEND extract EBL_DSP1, LOGSTATS 
ERROR: sending message to EXTRACT EBL_DSP1 (Timeout waiting for message).

kill EBL_DSP1
sh mv ./dirpcs/EBL_DSP1.pce /tmp
start EBL_DSP1

EXTRACT    EBL_DSP1  Last Started 2018-06-19 14:41   Status RUNNING
Checkpoint Lag       07:59:24 (updated 00:00:08 ago)
Process ID           20906054
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-06-19 06:47:52
                     SCN 2554.809776752 (10970156250736)

-- tail -f ./dirrpt/EBL_DSP1.rpt
2018-06-19 14:41:44  INFO    OGG-00547  Increasing thread stack size from 196608 to 2097152.
2018-06-19 15:11:45  WARNING OGG-01027  Long Running Transaction: XID 53.17.3730044, Items 0, Extract EBL_DSP1, Redo Thread 1, SCN 2554.809737433 (10970156211417), Redo Seq #438809, Redo RBA 62002120.
2018-06-19 15:44:15  INFO    OGG-01971  The previous message, 'WARNING OGG-01027', repeated 1 times.

> ll /oragg/dirtmp
-rw-r-----    1 oracle   dba      2147024896 Jun 19 14:49 EBL_DSP1_p20906054_extr_1145dde48_00000.cm
...
-rw-r-----    1 oracle   dba       313458688 Jun 19 15:29 EBL_DSP1_p20906054_extr_1145dde48_00012.cm

-- edit params
--CACHEMGR CACHESIZE 8GB, CACHEDIRECTORY /oragg/dirtmp 200GB
CACHEMGR CACHESIZE 8GB, CACHEDIRECTORY /oragg/dirtmp 500GB

-- 16:03
-rw-r-----    1 oracle   dba      1275068416 Jun 19 16:04 EBL_DSP1_p20906054_extr_1145dde48_00022.cm
-- 16:53
-rw-r-----    1 oracle   dba      1266679808 Jun 19 16:53 EBL_DSP1_p20906054_extr_1145dde48_00038.cm




-- I/O test
dd if=/dev/zero of=/oragg/test1 bs=204800

dd if=/dev/zero of=/move/blcfdsp01/arch/test1 bs=204800


dd if=/dev/zero of=/backup_uxs33/test1 bs=1024m count=1
dd if=/dev/zero of=/backup_uxs33/test1 bs=1m count=1
1+0 records in
1+0 records out
dd if=/dev/zero of=/backup_uxs33/test1 bs=1m count=100
100+0 records in
100+0 records out
dd if=/dev/zero of=/backup_uxs33/test1 bs=1m count=1024
1024+0 records in
1024+0 records out
dd if=/dev/zero of=/backup_uxs33/test1 bs=4k count=1
1+0 records in
1+0 records out


iostat -D -f hdisk1 30 
iostat -D -f hdisk1
iostat -D
iostat -f hdisk1
iostat -f /backup_uxs33


############
# blcfdsp  #
# RBL_DSP1 #
#     #
# 6/20     #
############

> ll /oraggrep/blcfdsp
-rw-r-----. 1 oracle dba 280643692 Jun 20 06:38 ra000000006




############
# blcfdsp  #
# EBL_DSP1 #
# uxp34    #
# 6/20     #
############

-- after restart last night
-- 6:32
> ll /nomove/app/oracle/ggate/12c/1/dirdat/blcfdsp/ea000000*
-rw-r-----    1 oracle   dba       280629082 Jun 20 06:23 /nomove/app/oracle/ggate/12c/1/dirdat/blcfdsp/ea000000006

EXTRACT    EBL_DSP1  Last Started 2018-06-20 00:16   Status RUNNING
Checkpoint Lag       01:12:01 (updated 00:00:03 ago)
Process ID           24576156
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-06-20 05:19:16
                     SCN 2554.827982935 (10970174456919)

-- ./dirrpt/EBL_DSP1.rpt
2018-06-20 05:59:16  INFO    OGG-02262  Passthru wildcard MAP (TABLE) resolved (entry CORE.*): TABLE "CORE"."FSR2".
             5291520 records processed as of 2018-06-20 06:21:17 (rate 241,delta 26)
			 5291599 records processed as of 2018-06-20 06:37:24 (rate 231,delta 0)


-- sqlplus 
select al.sequence#
from v$archived_log al, dba_capture cp
where cp.CAPTURED_SCN between al.FIRST_CHANGE# and al.NEXT_CHANGE#-1;
 SEQUENCE#
----------
    439364
	
> df -g /move/blcfdsp*
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
/dev/blcfdparch01lv    238.62    181.25   25%      331     1% /move/blcfdsp_arch01

> ll /move/blcfdsp_arch01/arch
-rw-r-----    1 oracle   dba       183701504 Jun 20 05:11 arch1_439364_629464407.dbf
...
-rw-r-----    1 oracle   dba       176799744 Jun 20 06:18 arch1_439661_629464407.dbf

-- healthcheck
sqlplus /nolog
set truncate off 
set linesize 900 
set LONG 990000 
set longchunksize 9000
set numwidth 15 
set heading off 
set feedback off 
set trimspool on 
set verify off;
spool /nomove/app/oracle/scripts/12cupgrade/logs/blcfdsp_healthcheck_0620.html
@/nomove/app/oracle/ggate/12c/1/ogg_11204.sql







-- mgr.prm
PURGEOLDEXTRACTS /nomove/app/oracle/ggate/12c/1/dirdat/*, MINKEEPDAYS 30, USECHECKPOINTS

> df -g /move/blcfdsp*
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
/dev/blcfdsplv   2021.50    401.44   81%      230     1% /move/blcfdsp01	-> almost no growth over past 4 weeks

-- add 300 GB to 



################
# cnofdwp      #
# table export #
# 9/7          #
################

DATA_MART.DR$XAK8DIM_JOURNAL_TXT_SRCH$I

select owner, table_name, tablespace_name, status from dba_tables where table_name='DR$XAK8DIM_JOURNAL_TXT_SRCH$I';
OWNER                          TABLE_NAME                     TABLESPACE_NAME                STATUS
------------------------------ ------------------------------ ------------------------------ --------
DATA_MART                      DR$XAK8DIM_JOURNAL_TXT_SRCH$I  DATA_MART_DATA                 VALID

OWNER                          OBJECT_NAME                    OBJECT_TYPE         CREATED    STATUS
------------------------------ ------------------------------ ------------------- ---------- -------
DATA_MART                      DR$XAK8DIM_JOURNAL_TXT_SRCH$I  TABLE               03/18/2016 VALID

DDL
--------------------------------------------------------------------------------
  CREATE TABLE "DATA_MART"."DR$XAK8DIM_JOURNAL_TXT_SRCH$I"
   (    "TOKEN_TEXT" VARCHAR2(64) NOT NULL ENABLE,

select count(*) from dba_tables where owner='DATA_MART';
  COUNT(*)
----------
        27

expdp henry/henry TABLES=test\$a DIRECTORY=datapump dumpfile=test.dmp 

-- export table
expdp \"/ as sysdba\" DIRECTORY=CNO_MIGRATE DUMPFILE=cnofdwp_data_mart_%U.dmp LOGFILE=expdp_cnofdwp_data_mart.log PARALLEL=8 METRICS=Y EXCLUDE=STATISTICS TABLES=DATA_MART.DR\$XAK8DIM_JOURNAL_TXT_SRCH\$I
ORA-39166: Object DATA_MART.DR$XAK8DIM_JOURNAL_TXT_SRCH$I was not found.

expdp \"/ as sysdba\" DIRECTORY=CNO_MIGRATE DUMPFILE=cnofdwp_data_mart_%U.dmp LOGFILE=expdp_cnofdwp_data_mart.log PARALLEL=8 METRICS=Y EXCLUDE=STATISTICS TABLES=DATA_MART.\"DR\$XAK8DIM_JOURNAL_TXT_SRCH\$I\"
ORA-39166: Object DATA_MART.DR$XAK8DIM_JOURNAL_TXT_SRCH$I was not found.
rm /oragg/datapump/cnofdwp/cnofdwp_data_mart_01.dmp

expdp \"/ as sysdba\" DIRECTORY=CNO_MIGRATE DUMPFILE=cnofdwp_data_mart_%U.dmp LOGFILE=expdp_cnofdwp_data_mart.log PARALLEL=8 METRICS=Y EXCLUDE=STATISTICS TABLES=\"DATA_MART\".\"DR$XAK8DIM_JOURNAL_TXT_SRCH$I\"
ORA-39195: At least one schema in the TABLE_FILTER does not exist.

expdp \"/ as sysdba\" DIRECTORY=CNO_MIGRATE DUMPFILE=cnofdwp_data_mart_%U.dmp LOGFILE=expdp_cnofdwp_data_mart.log PARALLEL=8 METRICS=Y EXCLUDE=STATISTICS TABLES=\"DATA_MART\".\"DR\$XAK8DIM_JOURNAL_TXT_SRCH\$I\"
ORA-39195: At least one schema in the TABLE_FILTER does not exist.

expdp \"/ as sysdba\" DIRECTORY=CNO_MIGRATE DUMPFILE=cnofdwp_data_mart_%U.dmp LOGFILE=expdp_cnofdwp_data_mart.log PARALLEL=8 METRICS=Y EXCLUDE=STATISTICS TABLES=DATA_MART.DR\\\$XAK8DIM_JOURNAL_TXT_SRCH\\\$I
ORA-06502: PL/SQL: numeric or value error

expdp system/Adm1n_T34m DIRECTORY=CNO_MIGRATE DUMPFILE=cnofdwp_data_mart_%U.dmp LOGFILE=expdp_cnofdwp_data_mart.log PARALLEL=8 METRICS=Y EXCLUDE=STATISTICS TABLES=DATA_MART.DR\$XAK8DIM_JOURNAL_TXT_SRCH\$I CONTENT=DATA_ONLY
ORA-39166: Object DATA_MART.DR$XAK8DIM_JOURNAL_TXT_SRCH$I was not found.
rm /oragg/datapump/cnofdwp/cnofdwp_data_mart_01.dmp


-- CTAS then export
sqlplus ggs/M00nl1ght
create table data_mart_cutover as
select * from DATA_MART.DR$XAK8DIM_JOURNAL_TXT_SRCH$I;

expdp system/Adm1n_T34m DIRECTORY=CNO_MIGRATE DUMPFILE=cnofdwp_data_mart_%U.dmp LOGFILE=expdp_cnofdwp_data_mart.log PARALLEL=8 METRICS=Y EXCLUDE=STATISTICS TABLES=GGS.DATA_MART_CUTOVER CONTENT=ALL
Job "SYSTEM"."SYS_EXPORT_TABLE_01" successfully completed at Sat Sep 8 00:21:17 2018 elapsed 0 00:33:37

vi /oragg/datapump/cnofdwp/impdp_cnofdwp_data_mart.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=cnofdwp_data_mart_%U.dmp
LOGFILE=impdp_cnofdwp_data_mart.log 
TABLE_EXISTS_ACTION=REPLACE
PARALLEL=4
CLUSTER=Y
METRICS=Y
TRANSFORM=TABLE_COMPRESSION_CLAUSE:"COMPRESS FOR OLTP"
LOGTIME=ALL REMAP_SCHEMA=GGS:DATA_MART

impdp \"ggs/M00nl1ght@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAFINP02.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=cnofdwp)))\" parfile=/oragg/datapump/cnofdwp/impdp_cnofdwp_data_mart.par
ORA-12805: parallel query server died unexpectedly
-- removed LOGTIME=ALL REMAP_SCHEMA=GGS:DATA_MART
ORA-12805: parallel query server died unexpectedly
-- removed PARALLEL=4

ALTER TABLESPACE GGS ADD DATAFILE '/database/Ecnofdwp/cnofdwp03/oradata/ggs02.dbf' SIZE 256M AUTOEXTEND ON NEXT 256M MAXSIZE 32000M;

select * from dba_tables where table_name='DATA_MART_CUTOVER';
TABLE                                             AIX        LINUX          DIFFERENCE MVIEW
---------------------------------------- ------------ ------------ ------------------- -----
DATA_MART.DR$XAK8DIM_JOURNAL_TXT_SRCH$I   270,344,691  233,087,064           -37257627

select count(*) from "GGS"."DATA_MART_CUTOVER";
  COUNT(*)
----------
 270344691

ALTER TABLE "GGS"."DATA_MART_CUTOVER" MOVE
TABLESPACE DATA_MART_DATA;


vi /oragg/datapump/cnofdwp/impdp_cnofdwp_data_mart.par
-- add
LOGTIME=ALL
REMAP_SCHEMA=GGS:DATA_MART
REMAP_TABLESPACE=GGS:DATA_MART_DATA

impdp \"ggs/M00nl1ght@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORAFINP02.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=cnofdwp)))\" parfile=/oragg/datapump/cnofdwp/impdp_cnofdwp_data_mart.par
09/08/2018 04:26:30.774: . . imported "DATA_MART"."DATA_MART_CUTOVER"             10.85 GB 270344691 rows in 898 seconds



ALTER TABLE DATA_MART.DR$XAK8DIM_JOURNAL_TXT_SRCH$I RENAME TO DR$XAK8DIM_JOURNAL_TXT_SRC_OLD;
select count(*) from data_mart.DR$XAK8DIM_JOURNAL_TXT_SRC_OLD;
  COUNT(*)
----------
         0

ALTER TABLE DATA_MART.DATA_MART_CUTOVER RENAME TO DR$XAK8DIM_JOURNAL_TXT_SRCH$I;

select count(*) from data_mart.DR$XAK8DIM_JOURNAL_TXT_SRCH$I;
  COUNT(*)
----------
 270344691

set long 10000000
COL "DDL"  FORMAT A1000
select DBMS_METADATA.GET_DDL('TABLE','DR$XAK8DIM_JOURNAL_TXT_SRCH$I','DATA_MART') "DDL" from dual;

ALTER TABLE data_mart.DR$XAK8DIM_JOURNAL_TXT_SRCH$I
MOVE TABLESPACE DATA_MART_DATA
NOCOMPRESS
LOB ("TOKEN_INFO") STORE AS BASICFILE (
  TABLESPACE "DATA_MART_DATA" ENABLE STORAGE IN ROW CHUNK 8192 RETENTION
  NOCACHE LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT))
;

CREATE INDEX DR$XAK8DIM_JOURNAL_TXT_SRCH$X
ON data_mart.DR$XAK8DIM_JOURNAL_TXT_SRCH$I (TOKEN_COUNT,TOKEN_FIRST,TOKEN_LAST,TOKEN_TEXT,TOKEN_TYPE);

-- original export/import
exp system/Adm1n_T34m table=DATA_MART.DR\$XAK8DIM_JOURNAL_TXT_SRCH\$I rows=y compress=n file=/oragg/datapump/cnofdwp/cnofdwp_data_mart_orig_exp.dmp log=/oragg/datapump/cnofdwp/cnofdwp_data_mart_orig_exp.log
exp system/Adm1n_T34m table=\"DATA_MART.DR$XAK8DIM_JOURNAL_TXT_SRCH$I\" rows=y compress=n file=/oragg/datapump/cnofdwp/cnofdwp_data_mart_orig_exp.dmp log=/oragg/datapump/cnofdwp/cnofdwp_data_mart_orig_exp.log


-- insert over DB link
insert into DATA_MART.DR$XAK8DIM_JOURNAL_TXT_SRCH$I select * from DATA_MART.DR$XAK8DIM_JOURNAL_TXT_SRCH$I@test; 


###########
# fdlzp   #
# EFDLZP2 #
# 9/10    #
###########

2018-09-10 12:21:47  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File <unknown>. Read Position SCN: 2554.3555975563 (10972902449547)).

select sequence# from v$archived_log where 10955674211647 between FIRST_CHANGE# and NEXT_CHANGE#-1;
 SEQUENCE#
----------
       381



#############
# bpap      #
# ORA-02019 #
# 9/10      #
#############

-- BPAP
BPA_APPS
FDLZ_DBL
EWM_USER
(DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = fdlzp-pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID =
 fdlzp)))
12/09/2015

-- sysdba
select sysdate from dual@FDLZ_DBL
                         *
ERROR at line 1:
ORA-02019: connection description for remote database not found

-- uxp33
ping fdlzp-pkg.conseco.com
PING fdlzp-pkg.conseco.com (192.168.171.33): 56 data bytes
64 bytes from 192.168.171.33: icmp_seq=0 ttl=63 time=0 ms

> tnsping fdlzp
Attempting to contact (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = fdlzp-pkg.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = fdlzp)))
OK (0 msec)


Getting ORA-2019 After Upgrading Database to 11.2.0.4 (Doc ID 1967705.1)
Hitting Bug 19865662 - ORA-2019 AFTER UPGRADING DATABASE TO 11.2.0.4, which is closed as a duplicate of Bug 19269405 - ORA-2019 ON DBLINK REFERENCE TO REMOTE FUNCTION WHEN IT IS MODIFIED
There are 2 workarounds:
1. Create a public database link instead of a private database link.
2. Set from remote_dependencies_mode=timestamp to remote_dependencies_mode=signature 


#################
# cdsinfop      #
# force logging #
# 9/10          #
#################

SQL> select force_logging from v$database;
FOR
---
NO

-- CO 71184
  MAX_MB ARCH_MOUNT_MB
-------- -------------
  18,277       274,155

-- uxp34
> ! df -g /move/*cdsinfop*
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
/dev/cdsinfoplv    265.50     15.05   95%       86     1% /move/cdsinfop01
/dev/cdsinfopadm01lv      0.62      0.13   80%     3502    10% /move/cdsinfop_adm01
/dev/cdsinfoparch1lv     40.00     30.74   24%       40     1% /move/cdsinfop_arch01
/dev/cdsinfopredo1lv      4.50      2.72   40%       13     1% /move/cdsinfop_redo01
/dev/cdsinfopredo2lv      4.50      2.72   40%       13     1% /move/cdsinfop_redo02

-- Archive Area Used
Sep 10, 2018 9:23:59 AM EDT		44% of archive area /move/cdsinfop_arch01/arch is used.
Sep 10, 2018 9:24:14 AM EDT		The execution for Corrective Action BACKUP_ARCHIVELOG_CORRECTIVE_ACTION failed.
Sep 10, 2018 10:24:00 AM EDT	78% of archive area /move/cdsinfop_arch01/arch is used.
Sep 10, 2018 10:24:16 AM EDT	The execution for Corrective Action BACKUP_ARCHIVELOG_CORRECTIVE_ACTION failed.
Sep 10, 2018 3:54:38 PM EDT		59% of archive area /move/cdsinfop_arch01/arch is used.

-- BACKUP_CDSINFOP_PROD_HOT_ARCHIVELOG_GG
Sep 10, 2018 9:15:06 AM EDT
RMAN-08137: WARNING: archived log not deleted, needed for standby or upstream capture process
archived log file name=/move/cdsinfop_arch01/arch/arch1_319468_680954274.dbf thread=1 sequence=319468
...

-- ggsci
GGSCI (uxp34) 1> info all

Program     Status      Group       Lag at Chkpt  Time Since Chkpt
MANAGER     RUNNING
EXTRACT     RUNNING     ECD_FOP1    00:00:04      00:00:07
EXTRACT     ABENDED     PCD_FOP1    00:35:48      00:53:24

cd /nomove/app/oracle/scripts/12cupgrade
GG_9_cleanup_AIX.sh

GGSCI (uxp34) 1> info *CD_FOP1
No ER groups exist.


###########
# fdlzp   #
# RFDLZP2 #
# 9/10    #
###########

REPLICAT   RFDLZP2   Last Started 2018-09-10 16:20   Status ABENDED
INTEGRATED
Checkpoint Lag       12:13:53 (updated 00:29:06 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzp/RR/ra000000083
                     2018-09-10 05:36:26.501401  RBA 699436854

-- report
2018-09-10 17:50:34  WARNING OGG-02544  Unhandled error (ORA-14400: inserted partition key does not map to any partition
ORA-14400: inserted partition key does not map to any partition) while processing the record at SEQNO 84, RBA 568939668 in Integrated mode. REPLICAT will retry in D
irect mode.

2018-09-10 17:50:34  WARNING OGG-01154  SQL error 14400 mapping FDLZP.FDLZ.TRANS_FPMD_REF_IN_ENT to FDLZ.TRANS_FPMD_REF_IN_ENT OCI Error ORA-14400: inserted partiti
on key does not map to any partition (status = 14400), SQL <INSERT INTO "FDLZ"."TRANS_FPMD_REF_IN_ENT" ("SOURCE_NAME","SOURCE_ENTITY","POLICY_NUMBER","RECONCILIATIO
N_KEY","SOURCE_PRODUCT","LZ_BATCH_ID","UNIQUE_ID","INSERT_DATE","INSERT_BY") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8)>.

-- discard
OCI Error ORA-14400: inserted partition key does not map to any partition (status = 14400), SQL <INSERT INTO "FDLZ"."TRANS_FPMD_REF_IN_ENT" ("SOURCE_NAME","SOURCE_ENTITY","POLICY_NUMBER","RECONCILIATION_KEY","SOURCE_PRODUCT","LZ_BATCH_ID","UNIQUE_ID","INSERT_DATE","INSERT_BY") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8)>
Aborting transaction on /app/oracle/product/ggate/11g/1/dirdat/fdlzp/RR/ra beginning at seqno 84 rba 568559344
                         error at seqno 84 rba 568939668
SOURCE_NAME = MUNICIPAL_ENT
SOURCE_ENTITY = 225
POLICY_NUMBER = 330642729
RECONCILIATION_KEY = NULL
SOURCE_PRODUCT = 1003247
LZ_BATCH_ID = MUNICIPAL2802
UNIQUE_ID = 200057526
INSERT_DATE = 2018-09-10 05:34:45
INSERT_BY = m_TRANS_FPMD_REF_IN_MUNIC

set lines 150 pages 200
col "TABLE" format a40
col "POS" format 90
col partition_name format a30
set long 40
break on "TABLE"
select table_owner||'.'||table_name "TABLE", partition_position "POS", partition_name, high_value 
from dba_tab_partitions where table_name='TRANS_FPMD_REF_IN_ENT' order by "POS";

LINUX                                    POS PARTITION_NAME                 HIGH_VALUE
---------------------------------------- --- ------------------------------ ----------------------------------------
FDLZ.TRANS_FPMD_REF_IN_ENT                 1 TRANS_FPMD_REF_IN_ENT_20180904 TO_DATE(' 2018-09-05 00:00:00', 'SYYYY-M
                                           2 TRANS_FPMD_REF_IN_ENT_20180905 TO_DATE(' 2018-09-06 00:00:00', 'SYYYY-M
                                           3 TRANS_FPMD_REF_IN_ENT_20180906 TO_DATE(' 2018-09-07 00:00:00', 'SYYYY-M
                                           4 TRANS_FPMD_REF_IN_ENT_20180907 TO_DATE(' 2018-09-08 00:00:00', 'SYYYY-M
                                           5 TRANS_FPMD_REF_IN_ENT_20180908 TO_DATE(' 2018-09-09 00:00:00', 'SYYYY-M
                                           6 TRANS_FPMD_REF_IN_ENT_20180909 TO_DATE(' 2018-09-10 00:00:00', 'SYYYY-M
                                           7 TRANS_FPMD_REF_IN_ENT_20180910 TO_DATE(' 2018-09-11 00:00:00', 'SYYYY-M
                                           8 TRANS_FPMD_REF_IN_ENT_20180911 TO_DATE(' 2018-09-12 00:00:00', 'SYYYY-M

AIX                                      POS PARTITION_NAME                 HIGH_VALUE
---------------------------------------- --- ------------------------------ ----------------------------------------
FDLZ.TRANS_FPMD_REF_IN_ENT                 1 TRANS_FPMD_REF_IN_ENT_20180901 TO_DATE(' 2018-09-02 00:00:00', 'SYYYY-M
                                           2 TRANS_FPMD_REF_IN_ENT_20180902 TO_DATE(' 2018-09-03 00:00:00', 'SYYYY-M
                                           3 TRANS_FPMD_REF_IN_ENT_20180903 TO_DATE(' 2018-09-04 00:00:00', 'SYYYY-M
                                           4 TRANS_FPMD_REF_IN_ENT_20180904 TO_DATE(' 2018-09-05 00:00:00', 'SYYYY-M
                                           5 TRANS_FPMD_REF_IN_ENT_20180905 TO_DATE(' 2018-09-06 00:00:00', 'SYYYY-M
                                           6 TRANS_FPMD_REF_IN_ENT_20180906 TO_DATE(' 2018-09-07 00:00:00', 'SYYYY-M
                                           7 TRANS_FPMD_REF_IN_ENT_20180907 TO_DATE(' 2018-09-08 00:00:00', 'SYYYY-M
                                           8 TRANS_FPMD_REF_IN_ENT_20180908 TO_DATE(' 2018-09-09 00:00:00', 'SYYYY-M
                                           9 TRANS_FPMD_REF_IN_ENT_20180909 TO_DATE(' 2018-09-10 00:00:00', 'SYYYY-M

PARTITION "TRANS_FPMD_REF_IN_ENT_20180910"  VALUES LESS THAN (TO_DATE(' 2018-09-11 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN')) SEGMENT CREATION IMMEDIATE
PARTITION "TRANS_FPMD_REF_IN_ENT_20180911"  VALUES LESS THAN (TO_DATE(' 2018-09-12 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN')) SEGMENT CREATION DEFERRED

ALTER TABLE FDLZ.TRANS_FPMD_REF_IN_ENT ADD 
PARTITION "TRANS_FPMD_REF_IN_ENT_20180910"  VALUES LESS THAN (TO_DATE(' 2018-09-11 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN')) SEGMENT CREATION IMMEDIATE;

start RFDLZP2
REPLICAT   RFDLZP2   Last Started 2018-09-10 18:37   Status RUNNING
INTEGRATED
Checkpoint Lag       13:00:33 (updated 00:00:13 ago)
Process ID           16061
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzp/RR/ra000000085
                     2018-09-10 05:38:18.613213  RBA 419283659



#############
# fdlzp     #
# UNDO      #
# ORA-01555 #
# 9/10      #
#############

ORA-01555: snapshot too old

alter session set nls_date_format='DD-MON-YY HH24:MI';
select begin_time
	,ssolderrcnt		ORA_01555_cnt
	,nospaceerrcnt		no_space_cnt
	,txncount			max_num_txns
	,maxquerylen		max_query_len
	,expiredblks		blck_in_expired
from v$undostat
where begin_time > sysdate - 1 and ssolderrcnt > 0
order by begin_time;
BEGIN_TIME      ORA_01555_CNT NO_SPACE_CNT MAX_NUM_TXNS MAX_QUERY_LEN BLCK_IN_EXPIRED
--------------- ------------- ------------ ------------ ------------- ---------------
10-SEP-18 05:00             1            0        58640          1672          557496
10-SEP-18 06:00             1            0        21222          3149         1327248
10-SEP-18 07:40             1            0         8626          2681         1463424
10-SEP-18 08:50             1            0         6967          1495         2372704

cxtm1fstxbtzs
SELECT TOH_TXN_STORAGE.COA_ENTITY, TOH_TXN_STORAGE.COA_ACCOUNT, TOH_TXN_STORAGE.COA_AFFILIATE, TOH_TXN_STORAGE.COA_PRODUCT, TOH_TXN_STORAGE.COA_COST_CENTER, TOH_TXN_STORAGE.COA_PROJECT, TOH_TXN_STORAGE.COA_REINSURANCE_CODE, TOH_TXN_STORAGE.COA_STATE_CODE, TOH_TXN_STORAGE.COA_DISTRIBUTION_CHANNEL, TOH_TXN_STORAGE.COA_SUB_ACCOUNT, TOH_TXN_STORAGE.COA_FUTUREUSE_1, TOH_TXN_STORAGE.COA_FUTUREUSE_2, TOH_TXN_STORAGE.LEDGER, TOH_TXN_STORAGE.LEDGER_ID, TOH_TXN_STORAGE.JE_CATEGORY, TOH_TXN_STORAGE.JE_SOURCE, TOH_TXN_STORAGE.AMOUNT, TOH_TXN_STORAGE.DEBIT_CREDIT_IND, TOH_TXN_STORAGE.CURRENCY, TOH_TXN_STORAGE.BATCH_ID, TOH_TXN_STORAGE.JOURNAL_NAME, TOH_TXN_STORAGE.JOURNAL_LINE_DESCRIPTION, TOH_TXN_STORAGE.PERIOD_NAME, TOH_TXN_STORAGE.EBS_POSTED_DATE, TOH_TXN_STORAGE.EFFECTIVE_DATE, TOH_TXN_STORAGE.JOURNAL_DATE, TOH_TXN_STORAGE.ISSUE_DATE, TOH_TXN_STORAGE.ADMIN_BASE_PLAN_CODE, TOH_TXN_STORAGE.ADMIN_COMPANY_CODE, TOH_TXN_STORAGE.ADMIN_SYSTEM_CODE, TOH_TXN_STORAGE.BRANCH_OFFICE, TOH_TXN_STORAGE.BULK_CODE, TOH_TXN_STORAGE.RECONCILIATION_KEY, TOH_TXN_STORAGE.REINSURANCE_TREATY, TOH_TXN_STORAGE.AGENT_NUMBER, TOH_TXN_STORAGE.POLICY_NUMBER, TOH_TXN_STORAGE.ZIP_CODE, TOH_TXN_STORAGE.POLICY_LINK, TOH_TXN_STORAGE.ISSUE_STATE, TOH_TXN_STORAGE.FAH_UNIQUE_ID, TOH_TXN_STORAGE.OLD_OPERATOR_ID, TOH_TXN_STORAGE.OLD_REF_NUMBER, TOH_TXN_STORAGE.PRODUCT_HIERARCHY, TOH_TXN_STORAGE.ACCOUNT_HIERARCHY, TOH_TXN_STORAGE.INSERT_DATE, TOH_TXN_STORAGE.LZ_BATCH_ID, TOH_TXN_STORAGE.UNIQUE_ID, HEALTH_CASH_EXT_CONTROL.EFFECTIVE_DATE, HEALTH_CASH_EXT_CONTROL.VALUATION_DATE, HEALTH_CASH_EXT_CONTROL.SEND_TO_RDS
FROM
TOH_TXN_STORAGE, HEALTH_CASH_EXT_CONTROL
WHERE
SUBSTR(TO_CHAR(HEALTH_CASH_EXT_CONTROL.EFFECTIVE_DATE,'YYYYMMDD'),1,4) =
SUBSTR(TO_CHAR(TOH_TXN_STORAGE.EFFECTIVE_DATE,'YYYYMMDD'),1,4)
AND
TOH_TXN_STORAGE.EFFECTIVE_DATE <= HEALTH_CASH_EXT_CONTROL.EFFECTIVE_DATE;

-- OEM
Parsing Schema			INF_USER
Plan Hash Value			3459683842
SQL Profile				SYS_SQLPROF_015a8e87bd720001
SQL Plan Baseline		SQL_PLAN_bsg5gvvwbnk25ce369602


select sql_id, plan_hash_value from DBA_HIST_SQL_PLAN where sql_id='cxtm1fstxbtzs';
SQL_ID        PLAN_HASH_VALUE
------------- ---------------
cxtm1fstxbtzs       733917392 - AIX
cxtm1fstxbtzs      3459683842 - Linux


SELECT PLAN_TABLE_OUTPUT FROM TABLE(DBMS_XPLAN.DISPLAY_AWR('cxtm1fstxbtzs',3459683842,NULL,'TYPICAL'))
-------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                           | Name                    | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                    |                         |       |       | 57698 (100)|          |       |       |
|   1 |  NESTED LOOPS                       |                         |       |       |            |          |       |       |
|   2 |   NESTED LOOPS                      |                         |  1844K|   647M| 57698   (1)| 00:00:02 |       |       |
|   3 |    TABLE ACCESS FULL                | HEALTH_CASH_EXT_CONTROL |     1 |    18 |     2   (0)| 00:00:01 |       |       |
|   4 |    INDEX RANGE SCAN                 | TOH_TXN_STORAGE_01      |  1823K|       | 54283   (1)| 00:00:02 |       |       |
|   5 |   TABLE ACCESS BY GLOBAL INDEX ROWID| TOH_TXN_STORAGE         |  1844K|   615M| 57696   (1)| 00:00:02 | ROWID | ROWID |
-------------------------------------------------------------------------------------------------------------------------------
Note
-----
   - automatic DOP: Computed Degree of Parallelism is 1 because of degree limit
   - SQL profile "SYS_SQLPROF_015a8e87bd720001" used for this statement
   
SELECT PLAN_TABLE_OUTPUT FROM TABLE(DBMS_XPLAN.DISPLAY_AWR('cxtm1fstxbtzs',733917392,NULL,'TYPICAL'));
-------------------------------------------------------------------------------------------------------------------------------
| Id  | Operation                           | Name                    | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |
-------------------------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                    |                         |       |       | 99224 (100)|          |       |       |
|   1 |  NESTED LOOPS                       |                         |       |       |            |          |       |       |
|   2 |   NESTED LOOPS                      |                         |   188K|    56M| 99224   (1)| 00:19:51 |       |       |
|   3 |    TABLE ACCESS FULL                | HEALTH_CASH_EXT_CONTROL |     1 |    18 |    13   (0)| 00:00:01 |       |       |
|   4 |    INDEX RANGE SCAN                 | TOH_TXN_STORAGE_01      |   183K|       | 90086   (1)| 00:18:02 |       |       |
|   5 |   TABLE ACCESS BY GLOBAL INDEX ROWID| TOH_TXN_STORAGE         |   188K|    53M| 99211   (1)| 00:19:51 | ROWID | ROWID |
-------------------------------------------------------------------------------------------------------------------------------

alter session set nls_date_format='MM/DD/YY HH24:MI';
select owner, table_name, NUM_ROWS, LAST_ANALYZED
from dba_tables
where table_name in ('TOH_TXN_STORAGE','HEALTH_CASH_EXT_CONTROL')
order by 1,2;
OWNER                          TABLE_NAME                       NUM_ROWS LAST_ANALYZED
------------------------------ ------------------------------ ---------- --------------
FDLZ_RDS                       HEALTH_CASH_EXT_CONTROL                 1 07/25/18 19:19 - AIX
FDLZ_RDS                       HEALTH_CASH_EXT_CONTROL                 1 08/03/18 22:08 - Linux
FDLZ_RDS                       TOH_TXN_STORAGE                 183796303 07/30/18 20:44 - AIX
FDLZ_RDS                       TOH_TXN_STORAGE                 184481903 08/04/18 06:52 - Linux


SQL_HANDLE                     PLAN_NAME                      ORIGIN         ENA ACC FIX AUT MODIFIED EXECUTED
------------------------------ ------------------------------ -------------- --- --- --- --- -------- --------
SQL_bc3cafdef8ba4845           SQL_PLAN_bsg5gvvwbnk25626057db AUTO-CAPTURE   YES NO  NO  YES 09/10/18
SQL_bc3cafdef8ba4845           SQL_PLAN_bsg5gvvwbnk25ce369602 AUTO-CAPTURE   YES YES NO  YES 09/10/18 09/10/18


select to_char(begin_time, 'DD-MON-RR HH24:MI') "BEGIN",
	UNDOBLKS, TXNCOUNT, MAXQUERYLEN, SSOLDERRCNT "ORA-01555", ACTIVEBLKS, tuned_undoretention
from DBA_HIST_UNDOSTAT 
where end_time > (sysdate - 12/24)
order by begin_time;


-- AIX
set lines 150 pages 200
col sql_profile format a30
col "BEGIN_TIME" format a15
select hss.SQL_ID, hss.PLAN_HASH_VALUE, hss.SQL_PROFILE, to_char(min(snp.BEGIN_INTERVAL_TIME),'MM/DD/YY HH24:MI') "BEGIN_TIME",
	DECODE(sum(hss.EXECUTIONS_DELTA),0,0,ROUND(sum(hss.CPU_TIME_DELTA/1000000)/sum(hss.EXECUTIONS_DELTA),2)) "CPU_SEC", 
	DECODE(sum(hss.EXECUTIONS_DELTA),0,0,ROUND(sum(hss.ELAPSED_TIME_DELTA/1000000)/sum(hss.EXECUTIONS_DELTA),2)) "ELAPSED_SEC",
	sum(hss.EXECUTIONS_DELTA) "EXEC"
from DBA_HIST_SQLSTAT hss, DBA_HIST_SNAPSHOT snp
where snp.SNAP_ID=hss.SNAP_ID and hss.SQL_ID='cxtm1fstxbtzs' --and snp.BEGIN_INTERVAL_TIME >= to_date('&what_date','YYYYMMDD')
group by hss.SQL_ID, hss.PLAN_HASH_VALUE, hss.SQL_PROFILE order by 4 asc;
SQL_ID        PLAN_HASH_VALUE SQL_PROFILE                    BEGIN_TIME         CPU_SEC ELAPSED_SEC       EXEC
------------- --------------- ------------------------------ --------------- ---------- ----------- ----------
cxtm1fstxbtzs       733917392 SYS_SQLPROF_015a8e87bd720001   06/11/18 04:00      427.03     3027.27         65 - AIX
cxtm1fstxbtzs      3459683842 SYS_SQLPROF_015a8e87bd720001   09/10/18 04:00      222.28      334.05          4 - Linux

-- undo guarantee
select ins.instance_name, ts.tablespace_name, ts.retention 
from dba_tablespaces ts, v$instance ins
where ts.tablespace_name like '%UNDO%'
order by 1,2;

•	Document 1307334.1 Master Note for ORA-1555 Errors
•	Document 1131474.1 ORA-01555 When Max Query Length Is  Less Than Undo Retention, small or 0 Seconds

-- OEM job UNDO_GUARANTEE_ALLDBS_PROD_AIX.1
abcinfop	 UNDO				NOGUARANTEE
aimrmp		 UNDO				NOGUARANTEE
bpap		 UNDO				NOGUARANTEE
cdsinfop	 UNDO				NOGUARANTEE
cigfdsp 	 UNDO				NOGUARANTEE
cnofdwp 	 UNDO				NOGUARANTEE
custsvcp	 UNDO				NOGUARANTEE
documkrp	 UNDO				NOGUARANTEE
dsrp		 UNDO				NOGUARANTEE
fnp8p		 UNDO				NOGUARANTEE
hubp		 UNDO				NOGUARANTEE
idwp		 UNDO				NOGUARANTEE
infdmp		 UNDO				NOGUARANTEE
infdqp		 UNDO				NOGUARANTEE
infpcp		 UNDO				NOGUARANTEE
p8legalp	 UNDO				NOGUARANTEE
portalp 	 UNDO				NOGUARANTEE


ALTER TABLESPACE &what_ts
  RETENTION NOGUARANTEE;
  
-- GG1 script
select 'ALTER TABLESPACE "'||tbs.TABLESPACE_NAME||'" RETENTION '||tbs.retention||';' "STMT"
from DBA_TABLESPACES tbs
where tbs.TABLESPACE_NAME='UNDO'
order by 1;



#############
# fdlzp     #
# ORA-06502 #
# 9/11      #
#############

-- Doug
The character buffer size issue is coming from when FPMD_CHECK_STATUS procedure is being called at the beginning of the DIT load process.  The procedure is in FDLZ_FPMD on FDLZP.  That same thing is working in 12c in UT through UAT, but failing for some reason in Production now post-upgrade.

The error is showing as:

ORA-06502: PL/SQL: numeric or value error: character string buffer too small
ORA-06512: at line 2


FDLZ_FPMD.FPMD_CHECK_STATUS

alter session set container=fdlzp;
col owner format a30
col object_name format a30
select owner, object_name, object_type from dba_objects where object_name='FPMD_CHECK_STATUS';
OWNER                          OBJECT_NAME                    OBJECT_TYPE
------------------------------ ------------------------------ -----------------------
PUBLIC                         FPMD_CHECK_STATUS              SYNONYM
FDLZ_FPMD                      FPMD_CHECK_STATUS              PROCEDURE

set lines 2000 pages 0
set trimspool on
set long 10000000
COL "DDL"  FORMAT A2000
--spool /tmp/FDLZ_FPMD.FPMD_CHECK_STATUS_AIX.proc
spool /tmp/FDLZ_FPMD.FPMD_CHECK_STATUS.proc
select DBMS_METADATA.GET_DDL('PROCEDURE','FPMD_CHECK_STATUS','FDLZ_FPMD') "DDL" from dual;
spool off
(procedure matches AIX)

set lines 150 pages 200
col REFERENCED_OWNER format a30
col REFERENCED_NAME format a30
col REFERENCED_LINK_NAME format a15
select REFERENCED_OWNER, REFERENCED_NAME, REFERENCED_TYPE, REFERENCED_LINK_NAME
from dba_dependencies
where owner='FDLZ_FPMD' and name='FPMD_CHECK_STATUS'
order by 1,2,3;
REFERENCED_OWNER               REFERENCED_NAME                REFERENCED_TYPE    REFERENCED_LINK
------------------------------ ------------------------------ ------------------ ---------------
FDLZ_FPMD                      FE_REF_TABLE_UPDATE_STATUS     TABLE
FDLZ_FPMD                      PUB_BATCH_CONTROL              TABLE
FDLZ_FPMD                      VALUATION_DATE_TABLE           TABLE
SYS                            DBMS_STANDARD                  PACKAGE
SYS                            STANDARD                       PACKAGE
SYS                            SYS_STUB_FOR_PURITY_ANALYSIS   PACKAGE
(same as AIX)

line 23
select status_flag into v_mass_flag
from fe_ref_table_update_status
where updated_date=(select max(updated_date) from fe_ref_table_update_status);

line 14
select count(1) into v_normal_flag
from pub_batch_control
where process_type != 'RTR' and batch_status='R'; --v_normal_flag=0 means normal loads complete

line 19
select count(1) into v_retro_flag
from pub_batch_control
where process_type= 'RTR' and batch_status='R'; --v_retro_flag=0 means retro loads complete

line 28
Select count(1) into v_valuation_date
from valuation_date_table
where processing_flg='Y';

-- differences
line 23:	STATUS_FLAG VARCHAR2(1) -> v_mass_flag char(1);


set serveroutput on
declare
	v_mass_flag char(1);
begin
	select status_flag into v_mass_flag
	from fe_ref_table_update_status
	where rownum=1;
	dbms_output.put_line('v_mass_flag is '||v_mass_flag);
end;
/
v_mass_flag is N
PL/SQL procedure successfully completed.

declare
	v_mass_flag char(1);
begin
	select status_flag into v_mass_flag
	from fe_ref_table_update_status
	where updated_date=(select max(updated_date) from fe_ref_table_update_status);
	dbms_output.put_line('v_mass_flag is '||v_mass_flag);
end;
/
v_mass_flag is C
PL/SQL procedure successfully completed.





-- SR 3-18295783161
4) Enable and provide ORA-06503 trace as below : 

A. Set the below trace at session level to get trace : 
SQL> alter session set tracefile_identifier='6502'; 
SQL> alter session set events '6502 trace name errorstack level 3'; 

B. Run the code and generate the error. 

C. To close the trace set the following 
SQL> alter session set events '6502 trace name context off'; 

D. Send us the trace file.


###########
# fdlzp   #
# EFDLZP2 #
# 9/12    #
###########

EXTRACT    EFDLZP2   Last Started 2018-09-10 12:58   Status RUNNING
Checkpoint Lag       00:00:08 (updated 15:41:45 ago)
Process ID           123258
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-09-11 17:26:47
                     SCN 2554.3575725743 (10972922199727)

kill EFDLZP2
sh mv ./dirpcs/EFDLZP2.pce /tmp
start EFDLZP2

2018-09-12 09:12:32  ERROR   OGG-00868  Error code 1291, error message: ORA-01291: missing logfile
 (Missing Log File <unknown>. Read Position SCN: 2554.3575725743 (10972922199727)).

select sequence# from v$archived_log where 10972922199727 between FIRST_CHANGE# and NEXT_CHANGE#-1;
 SEQUENCE#
----------
      3531
	  
NAME                                 TYPE        VALUE
------------------------------------ ----------- ------------------------------
log_archive_dest                     string
log_archive_dest_1                   string      LOCATION=/database/cfdlzp_arch01/arch/

> df -h /database/cfdlzp_arch01/arch
Filesystem                              Size  Used Avail Use% Mounted on
/dev/mapper/fdlzpvg01-cfdlzp_arch01_lv  123G   34G   84G  29% /database/cfdlzp_arch01

> ls -lt /database/cfdlzp_arch01/arch/
-rw-r-----. 1 oracle dba 2315055616 Sep 12 09:58 arch1_3450_983178007.dbf
...
-rw-r-----. 1 oracle dba 2305581056 Sep 12 10:15 arch1_3468_983178007.dbf
-rw-r-----. 1 oracle dba 2356001792 Sep 12 10:10 arch1_3471_983178007.dbf


mkdir /oragg/arch/fdlzp

rman target / catalog rman@rman12p

RMAN> show all;
CONFIGURE DEVICE TYPE DISK PARALLELISM 1 BACKUP TYPE TO COPY;

run
{
 set archivelog destination to '/database/fdlzp01/arch';
 restore archivelog from sequence 3454;
}

-- cancelled (lot of logs deleted while away)
CONFIGURE DEVICE TYPE DISK PARALLELISM 2 BACKUP TYPE TO COPY;
run
{
 set archivelog destination to '/database/fdlzp01/arch';
 restore archivelog from sequence 3530;
}
CONFIGURE DEVICE TYPE DISK PARALLELISM 4 BACKUP TYPE TO COPY;


EXTRACT    EFDLZP2   Last Started 2018-09-12 13:54   Status RUNNING
Checkpoint Lag       20:30:42 (updated 00:00:04 ago)
Process ID           89456
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-09-11 17:26:47
                     SCN 2554.3575725743 (10972922199727)

EXTRACT    EFDLZP2   Last Started 2018-09-12 13:54   Status RUNNING
Checkpoint Lag       21:56:45 (updated 00:00:07 ago)
Process ID           89456
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-09-11 17:32:14
                     SCN 2554.3575805708 (10972922279692)

					 
###########
# fdlzp   #
# RFDLZP2 #
# 9/12    #
###########

REPLICAT   RFDLZP2   Last Started 2018-09-12 13:51   Status ABENDED
INTEGRATED
Checkpoint Lag       00:00:00 (updated 01:18:36 ago)
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzp/RR/ra000000313
                     2018-09-12 13:54:42.533093  RBA 980601168

-- report
2018-09-12 13:55:03  WARNING OGG-01154  SQL error 14400 mapping FDLZP.FDLZ_EBS.OUT_PAYMENTS_DETAIL to FDLZ_EBS.OUT_PAYMENTS_DETAIL OCI Error ORA-14400: inserted par
tition key does not map to any partition (status = 14400), SQL <INSERT INTO "FDLZ_EBS"."OUT_PAYMENTS_DETAIL" ("LZ_UNIQUE_ID","HEADER_ID","LZ_BATCH_ID","ATTRIBUTE1",
"INVOICE_NUM","ATTRIBUTE2","LINE_NUMBER","LINE_TYPE_LOOKUP_CODE","DESCRIPTION","ADDITIONAL_DESCRIPTION","AMOUNT","ACCOUNTING_DATE","DIST_CODE_CONCATENATED","PO_NUMB
ER","PO_LINE_NUMBER","PO_SHIPMENT_NUM","PO_UNIT_OF_MEASURE","SHIP_TO_LOCATION_CODE","QUANTITY_INVOICED","UNIT_PRICE","LZ_TIMESTAMP","FUTURE_1","FUTURE_2","FUTURE_3"
,"FUTURE_4","FUTURE_5","FUTURE_6","FUTURE_7","FUTURE_8","FUTURE_9","FUTURE_10") VALUES (:a0,:a1,:a2,:a3,:a4,:a5,:a6,:a7,:a8,:a9,:a10,:a11,:a12,:a13,:a14,:a15,:a16,:
a17,:a18,:a19,:a20,:a21,:a22,:a23,:a24,:a25,:a26,:a27,:a28,:a29,:a30)>.

alter session set container=fdlzp;
set lines 150 pages 200
col "TABLE" format a40
col "POS" format 90
col partition_name format a30
set long 40
break on "TABLE"
select table_owner||'.'||table_name "TABLE", partition_position "POS", partition_name, high_value 
from dba_tab_partitions where table_name='OUT_PAYMENTS_DETAIL' order by "POS";

LINUX                                    POS PARTITION_NAME                 HIGH_VALUE
---------------------------------------- --- ------------------------------ ----------------------------------------
FDLZ_EBS.OUT_PAYMENTS_DETAIL               1 OUT_PAYMENTS_DETAIL_20180905   TO_DATE(' 2018-09-06 00:00:00', 'SYYYY-M
                                           2 OUT_PAYMENTS_DETAIL_20180906   TO_DATE(' 2018-09-07 00:00:00', 'SYYYY-M
                                           3 OUT_PAYMENTS_DETAIL_20180907   TO_DATE(' 2018-09-08 00:00:00', 'SYYYY-M
                                           4 OUT_PAYMENTS_DETAIL_20180908   TO_DATE(' 2018-09-09 00:00:00', 'SYYYY-M
                                           5 OUT_PAYMENTS_DETAIL_20180909   TO_DATE(' 2018-09-10 00:00:00', 'SYYYY-M
                                           6 OUT_PAYMENTS_DETAIL_20180911   TO_DATE(' 2018-09-12 00:00:00', 'SYYYY-M
                                           7 OUT_PAYMENTS_DETAIL_20180912   TO_DATE(' 2018-09-13 00:00:00', 'SYYYY-M
                                           8 OUT_PAYMENTS_DETAIL_20180913   TO_DATE(' 2018-09-14 00:00:00', 'SYYYY-M

AIX                                      POS PARTITION_NAME                 HIGH_VALUE
---------------------------------------- --- ------------------------------ ----------------------------------------
FDLZ_EBS.OUT_PAYMENTS_DETAIL               1 OUT_PAYMENTS_DETAIL_20180901   TO_DATE(' 2018-09-02 00:00:00', 'SYYYY-M
                                           2 OUT_PAYMENTS_DETAIL_20180902   TO_DATE(' 2018-09-03 00:00:00', 'SYYYY-M
                                           3 OUT_PAYMENTS_DETAIL_20180905   TO_DATE(' 2018-09-06 00:00:00', 'SYYYY-M
                                           4 OUT_PAYMENTS_DETAIL_20180906   TO_DATE(' 2018-09-07 00:00:00', 'SYYYY-M
                                           5 OUT_PAYMENTS_DETAIL_20180907   TO_DATE(' 2018-09-08 00:00:00', 'SYYYY-M
                                           6 OUT_PAYMENTS_DETAIL_20180908   TO_DATE(' 2018-09-09 00:00:00', 'SYYYY-M
                                           7 OUT_PAYMENTS_DETAIL_20180909   TO_DATE(' 2018-09-10 00:00:00', 'SYYYY-M

set long 10000000
COL "DDL"  FORMAT A1000
select DBMS_METADATA.GET_DDL('TABLE','OUT_PAYMENTS_DETAIL','FDLZ_EBS') "DDL" from dual;
PARTITION "OUT_PAYMENTS_DETAIL_20180911"  VALUES LESS THAN (TO_DATE(' 2018-09-12 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN')) SEGMENT CREATION IMMEDIATE
PARTITION "OUT_PAYMENTS_DETAIL_20180912"  VALUES LESS THAN (TO_DATE(' 2018-09-13 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN')) SEGMENT CREATION IMMEDIATE
PARTITION "OUT_PAYMENTS_DETAIL_20180913"  VALUES LESS THAN (TO_DATE(' 2018-09-14 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN')) SEGMENT CREATION DEFERRED

ALTER TABLE FDLZ_EBS.OUT_PAYMENTS_DETAIL ADD 
PARTITION "OUT_PAYMENTS_DETAIL_20180911"  VALUES LESS THAN (TO_DATE(' 2018-09-12 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN')) SEGMENT CREATION IMMEDIATE;
ALTER TABLE FDLZ_EBS.OUT_PAYMENTS_DETAIL ADD 
PARTITION "OUT_PAYMENTS_DETAIL_20180912"  VALUES LESS THAN (TO_DATE(' 2018-09-13 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN')) SEGMENT CREATION IMMEDIATE;
ALTER TABLE FDLZ_EBS.OUT_PAYMENTS_DETAIL ADD
PARTITION "OUT_PAYMENTS_DETAIL_20180913"  VALUES LESS THAN (TO_DATE(' 2018-09-14 00:00:00', 'SYYYY-MM-DD HH24:MI:SS', 'NLS_CALENDAR=GREGORIAN')) SEGMENT CREATION DEFERRED;

REPLICAT   RFDLZP2   Last Started 2018-09-12 15:24   Status RUNNING
INTEGRATED
Checkpoint Lag       32:31:40 (updated 00:02:33 ago)
Process ID           67958
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/fdlzp/RR/ra000000314
                     2018-09-11 06:55:29.682462  RBA 955947679

-- MOS Doc ID 1561537.1
-- lxorafinp03
-- ggsci
INFO TRANDATA FDLZP.FDLZ_EBS.OUT_PAYMENTS_DETAIL
2018-09-12 15:56:31  INFO    OGG-06480  Schema level supplemental logging, excluding non-validated keys, is enabled on schema FDLZ_EBS.
2018-09-12 15:56:31  INFO    OGG-01980  Schema level supplemental logging is enabled on schema FDLZ_EBS for all scheduling columns.
ERROR: Does not match any catalog name.


############
# abcinfop #
# RAB_FOP1 #
# 9/16     #
############

REPLICAT   RAB_FOP1  Last Started 2018-09-16 05:29   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 09:18:43 ago)
Process ID           123323
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/abcinfop/ra000000000
                     2018-09-16 05:29:48.233589  RBA 401045069


					 
RCD_FOP1

REPLICAT   RCD_FOP1  Last Started 2018-09-16 05:29   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 09:21:52 ago)
Process ID           123333
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/cdsinfop/ra000000000
                     2018-09-16 05:29:54.574516  RBA 12448

					 
##########
# hubp   #
# RHUBP1 #
# 9/17   #
##########

REPLICAT   RHUBP1    Last Started 2018-09-17 15:58   Status RUNNING
INTEGRATED
Checkpoint Lag       28:27:58 (updated 00:00:00 ago)
Process ID           122305
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/hubp/ra000000003
                     2018-09-16 13:52:34.974257  RBA 157663241

-- report
705530 records processed as of 2018-09-17 18:00:02 (rate 97,delta 96)
731958 records processed as of 2018-09-17 18:05:02 (rate 96,delta 88)
759308 records processed as of 2018-09-17 18:10:02 (rate 96,delta 91)
788302 records processed as of 2018-09-17 18:15:02 (rate 96,delta 96)
817533 records processed as of 2018-09-17 18:20:11 (rate 96,delta 94)

-- LXORABPAP05
SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- ---------------
SGA    DEFAULT buffer cache         2,656    2,656    2,688 SHRINK        17-SEP 06:25:19
       Shared IO Pool                 192      192      192 STATIC
       java pool                       32       32       32 STATIC
       large pool                      32       32       32 STATIC
       shared pool                    752      720      752 GROW          17-SEP 06:25:19
       streams pool                   656      656      656 STATIC
******                           -------- -------- --------
TOTAL                               4,320    4,288    4,352

set truncate off 
set linesize 900 
set LONG 990000 
set longchunksize 9000
set numwidth 15 
set heading off 
set feedback off 
set trimspool on 
set verify off;
spool /app/oracle/scripts/12cupgrade/logs/chubp_target_hc_0917.html
@/app/oracle/scripts/12cupgrade/ogg_12102.sql


############
# documkrp #
# EDO_KRP1 #
# 7/3      #
############

-- extract report
2018-06-29 18:09:58  ERROR   OGG-02077  Extract encountered a read error in the asynchronous reader thread and is abending: Error code 600, error message: ORA-00600: internal error code, arguments: [knlogcPackLobXMLInfo:1], [48488], [203879], [2], [146], [], [], [], [], [], [], [].
(tried to exclude tables with LOBs but still getting error)


*** SR 3-17814631261 : Oracle internal error ORA-600 in Production database
Bug 25953857 - INTEGRATED EXTRACT FAILING WITH ORA-600 [KNLOGCPACKLOBXMLINFO:1], [32768] 
Apply Patch 25953857 


############
# abcinfop #
# PAB_FOP1 #
# 10/12    #
############

-- lxoggp01
> ll /oraggrep/abcinfop
total 2524992
-rw-r-----. 1 oracle dba 762282931 Oct 11 22:26 ra000000362
-rw-r-----. 1 oracle dba      1229 Oct 12 00:41 ra000000363
-rw-r-----. 1 oracle dba 999999737 Oct 12 06:11 ra000000364
-rw-r-----. 1 oracle dba 823298892 Oct 12 08:13 ra000000365

> rm /oraggrep/abcinfop/*

-- uxp34 (ggsci)
DBLOGIN USERID GGS@ABCINFOP PASSWORD M00nl1ght
delete extract PAB_FOP1
add extract PAB_FOP1, exttrailsource /nomove/app/oracle/ggate/12c/1/dirdat/abcinfop/ea
add rmttrail /app/oracle/product/ggate/12c/1/dirdat/abcinfop/ra, extract PAB_FOP1, megabytes 1000
start PAB_FOP1

EXTRACT    PAB_FOP1  Last Started 2018-10-12 09:47   Status RUNNING
Checkpoint Lag       03:35:46 (updated 00:00:13 ago)
Process ID           22741262
Log Read Checkpoint  File /nomove/app/oracle/ggate/12c/1/dirdat/abcinfop/ea000000001
                     2018-10-12 06:11:57.000000  RBA 23999692

-- lxoggp01
> ll /oraggrep/abcinfop
total 2026228
-rw-r-----. 1 oracle dba 999999425 Oct 12 09:47 ra000000000
-rw-r-----. 1 oracle dba 811427261 Oct 12 09:48 ra000000001


#########
# bpap  #
# 10/13 #
#########

*** ODBS Connection ***

-- /app/oracle/product/gateway/12c/1/hs/admin/initawd10prod.ora
HS_FDS_CONNECT_INFO = DB2DSTAWD10PROD
HS_FDS_TRACE_LEVEL = 0
HS_FDS_TRACE_FILE_NAME = db2dstawd10prod.trc
HS_FDS_SHAREABLE_NAME = /usr/lib64/libodbc.so
HS_FDS_TIMESTAMP_MAPPING=char
set ODBCINI=/opt/ibm/db2/V11.1/dsdriver/cfg/db2cli.ini
set LIBPATH=/usr/lib64

-- /opt/ibm/db2/V11.1/dsdriver/cfg/db2cli.ini
[DB2DSTAWD10PROD]
Driver=IBM i Access ODBC Driver 64-bit
Description=IBM i Access for Linux 64-bit ODBC Driver
System=awda3con.dstcorp.net
Trace=No
database=A3CNOPD
port=446
LogonID=A3CNOPDTAE
Password=PASSOPDTAE

-- UAT
[DB2DSTAWD10UAT]
Driver=IBM i Access ODBC Driver 64-bit
Description=IBM i Access for Linux 64-bit ODBC Driver
System=awda3con.dstcorp.net
Trace=No
AutoTranslate=No
Database=A3CNOPD
port=446
LogonID=A3CNOBDTAE
Password=PASSOBDTAE

-- lxorabpam01
-rwxrwxrwx. 1 root 7777 617 May 31 11:38 /opt/ibm/db2/V11.1/dsdriver/cfg/db2cli.ini

-- lxorabpap03
/opt/ibm/db2/V11.1/dsdriver/cfg/db2cli.ini
-rwxrwxrwx. 1 root 7777 1040 Oct 13 12:58 /opt/ibm/db2/V11.1/dsdriver/cfg/db2cli.ini



*** CREATE TABLE privilege ***

set lines 150 pages 200
select * from dba_sys_privs where privilege='CREATE TABLE' order by 1,2;

GRANTEE                        PRIVILEGE                                ADM
------------------------------ ---------------------------------------- ---
AWDSTG_SCHEMA                  CREATE TABLE                             NO
AWD_COMP                       CREATE TABLE                             NO
B2BG_GKPR_SCHEMA               CREATE TABLE                             NO
BIZFLOW_SCHEMA                 CREATE TABLE                             NO
BPARPT_SCHEMA                  CREATE TABLE                             NO
BPA_APPS_SCHEMA                CREATE TABLE                             NO
DATAPUMP_EXP_FULL_DATABASE     CREATE TABLE                             NO
DBA                            CREATE TABLE                             YES
DBSNMP                         CREATE TABLE                             NO
EXP_FULL_DATABASE              CREATE TABLE                             NO
IMC_SCHEMA                     CREATE TABLE                             NO
PERFSTAT                       CREATE TABLE                             NO
RECOVERY_CATALOG_OWNER         CREATE TABLE                             NO
RESOURCE                       CREATE TABLE                             NO
SQLTUNE                        CREATE TABLE                             NO
SYSTEM                         CREATE TABLE                             NO
TRCANLZR                       CREATE TABLE                             NO	--> not in Linux (user account)

GRANTEE                        PRIVILEGE                                ADM
------------------------------ ---------------------------------------- ---
APEX_030200                    CREATE TABLE                             YES
AWDSTG_SCHEMA                  CREATE TABLE                             NO
AWD_COMP                       CREATE TABLE                             NO
B2BG_GKPR_SCHEMA               CREATE TABLE                             NO
BIZFLOW_SCHEMA                 CREATE TABLE                             NO
BPARPT_SCHEMA                  CREATE TABLE                             NO
BPA_APPS_SCHEMA                CREATE TABLE                             NO
DATAPUMP_EXP_FULL_DATABASE     CREATE TABLE                             NO
DBA                            CREATE TABLE                             YES
DBSNMP                         CREATE TABLE                             NO
EXP_FULL_DATABASE              CREATE TABLE                             NO
IMC_SCHEMA                     CREATE TABLE                             NO
MDSYS                          CREATE TABLE                             NO
OLAPSYS                        CREATE TABLE                             NO
OLAP_USER                      CREATE TABLE                             NO
OWBSYS                         CREATE TABLE                             YES
PERFSTAT                       CREATE TABLE                             NO
RECOVERY_CATALOG_OWNER         CREATE TABLE                             NO
RESOURCE                       CREATE TABLE                             NO
SQLTUNE                        CREATE TABLE                             NO
SYS                            CREATE TABLE                             NO
SYSMAN                         CREATE TABLE                             NO
SYSTEM                         CREATE TABLE                             NO

-- UAT
USERNAME                       GRANTED_ROLE                   PRIVILEGE
------------------------------ ------------------------------ ----------------------------------------
AUTOCAPTM                      <user>                         CREATE SESSION
AUTOCAPTM                      <user>                         CREATE TABLE
AUTOCAPTM                      <user>                         SELECT ANY TABLE
AUTOCAPTM                      <user>                         UPDATE ANY TABLE
AUTOCAPTM                      AWDSTG_UPDATE                  ALTER SESSION
AUTOCAPTM                      AWDSTG_UPDATE                  CREATE SESSION
AUTOCAPTM                      BIZFLOW_LOAD                   ALTER SESSION
AUTOCAPTM                      BIZFLOW_LOAD                   CREATE SESSION
AUTOCAPTM                      BPARPT_LOAD                    ALTER SESSION
AUTOCAPTM                      BPARPT_LOAD                    CREATE SESSION
AUTOCAPTM                      BPA_APPS_EXECUTE
AUTOCAPTM                      BPA_APPS_LOAD                  ALTER SESSION
AUTOCAPTM                      BPA_APPS_LOAD                  CREATE SESSION
AUTOCAPTM                      BPA_APPS_LOAD                  SELECT ANY DICTIONARY
AUTOCAPTM                      CONNECT                        CREATE SESSION

-- PROD
USERNAME                       GRANTED_ROLE                   PRIVILEGE
------------------------------ ------------------------------ ----------------------------------------
AUTOCAPTP                      <user>                         SELECT ANY DICTIONARY
AUTOCAPTP                      AWDSTG_UPDATE                  ALTER SESSION
AUTOCAPTP                      AWDSTG_UPDATE                  CREATE SESSION
AUTOCAPTP                      BIZFLOW_LOAD                   ALTER SESSION
AUTOCAPTP                      BIZFLOW_LOAD                   CREATE SESSION
AUTOCAPTP                      BPARPT_LOAD                    ALTER SESSION
AUTOCAPTP                      BPARPT_LOAD                    CREATE SESSION
AUTOCAPTP                      BPA_APPS_EXECUTE
AUTOCAPTP                      BPA_APPS_LOAD                  ALTER SESSION
AUTOCAPTP                      BPA_APPS_LOAD                  CREATE SESSION
AUTOCAPTP                      BPA_APPS_LOAD                  SELECT ANY DICTIONARY


grant CONNECT to AUTOCAPTP;
grant CREATE SESSION to AUTOCAPTP;
grant CREATE TABLE to AUTOCAPTP;
grant SELECT ANY TABLE to AUTOCAPTP;
grant UPDATE ANY TABLE to AUTOCAPTP;

select 'grant '||privilege||' on '||owner||'.'||table_name||' to AUTOCAPTP;'
from dba_tab_privs where grantee='AUTOCAPTM'
order by owner, table_name, privilege;

grant SELECT on AWD_COMP.AWD_DW_DIFF to AUTOCAPTP;
grant EXECUTE on AWD_COMP.PKG_COMP_AWD_DW_TRANS to AUTOCAPTP;
grant EXECUTE on BPARPT.SP_FILE_CLEANUP to AUTOCAPTP;
grant EXECUTE on BPA_APPS.BA_WT_XREF_UAT to AUTOCAPTP;
grant READ on SYS.AWDSTG_DIR to AUTOCAPTP;
grant WRITE on SYS.AWDSTG_DIR to AUTOCAPTP;
grant READ on SYS.BPA_DIR to AUTOCAPTP;
grant WRITE on SYS.BPA_DIR to AUTOCAPTP;



-- as AUTOCAPTP
CREATE TABLE AWD_COMP.TRANS_AWD TABLESPACE AWD_COMP_DATA AS 
SELECT CRDATTIM, RECORDCD, LTRIM(RTRIM(UNITCD)) AS UNITCD, LTRIM(RTRIM(WRKTYPE)) AS WRKTYPE, LTRIM(RTRIM(STATCD)) AS STATCD, LTRIM(RTRIM(QUEUECD)) AS QUEUECD 
FROM A3CNOPD.W03U999S@AWD10PROD_DBL WHERE CRDATTIM >='2017-01-01-00.00.00.000000' AND CRDATTIM < '2018-10-14-00.00.00.000000';

select username, tablespace_name, bytes, max_bytes
from dba_ts_quotas
where username in ('AUTOCAPTP','AUTOCAPTM','AWDSTG_UPDATE','BIZFLOW_LOAD','BPARPT_LOAD','BPA_APPS_LOAD','AWD_COMP')
order by 1,2;
USERNAME                       TABLESPACE_NAME                     BYTES  MAX_BYTES
------------------------------ ------------------------------ ---------- ----------
AWD_COMP                       AWD_COMP_DATA                  1612709888         -1
AWD_COMP                       AWD_COMP_INDEX                 1020264448         -1
(same in UAT)


select * from dba_sys_privs where privilege='CREATE ANY TABLE' order by 1,2;
GRANTEE                        PRIVILEGE                                ADM
------------------------------ ---------------------------------------- ---
AUTODDL_ADMIN                  CREATE ANY TABLE                         NO
DBA                            CREATE ANY TABLE                         YES
IMP_FULL_DATABASE              CREATE ANY TABLE                         NO
OLAP_DBA                       CREATE ANY TABLE                         NO
SYS                            CREATE ANY TABLE                         NO
WMSYS                          CREATE ANY TABLE                         NO

grant CREATE ANY TABLE to AUTOCAPTP;


> free -g
              total        used        free      shared  buff/cache   available
Mem:             42          34           0           5           6           1
Swap:            16           2          14

> free -g
              total        used        free      shared  buff/cache   available
Mem:             47          35           4           5           7           5
Swap:            16           2          14


> pmonn
bpap
cbparptp
cmwarep
cntxmlmp
cpadrp
cpbizp

-- uxp33
> ping awda3con.dstcorp.net
6 packets transmitted, 6 packets received, 0% packet loss
round-trip min/avg/max = 43/50/64 ms

-- lxorabpap03
> ping awda3con.        dstcorp.net
7 packets transmitted, 7 received, 0% packet loss, time 6005ms
rtt min/avg/max/mdev = 43.020/44.117/49.780/2.327 ms


-- autocaptp / Nl#ip*ki5

CREATE TABLE AWD_COMP.TRANS_AWD TABLESPACE AWD_COMP_DATA AS 
SELECT CRDATTIM, RECORDCD, LTRIM(RTRIM(UNITCD)) AS UNITCD, LTRIM(RTRIM(WRKTYPE)) AS WRKTYPE, LTRIM(RTRIM(STATCD)) AS STATCD, LTRIM(RTRIM(QUEUECD)) AS QUEUECD 
FROM A3CNOPD.W03U999S@AWD10PROD_DBL WHERE CRDATTIM >='2017-01-01-00.00.00.000000' AND CRDATTIM < '2018-10-14-00.00.00.000000';

CREATE TABLE AWD_COMP.TRANS_AWD_TEST TABLESPACE AWD_COMP_DATA AS 
SELECT CRDATTIM, RECORDCD, LTRIM(RTRIM(UNITCD)) AS UNITCD, LTRIM(RTRIM(WRKTYPE)) AS WRKTYPE, LTRIM(RTRIM(STATCD)) AS STATCD, LTRIM(RTRIM(QUEUECD)) AS QUEUECD 
FROM A3CNOPD.W03U999S@AWD10PROD_DBL WHERE CRDATTIM >='2017-01-01-00.00.00.000000' AND CRDATTIM < '2018-10-14-00.00.00.000000';
ORA-01013: user requested cancel of current operation


set lines 150 pages 200
select * from dba_objects where owner='AWD_COMP' and object_name='TRANS_AWD';

select * from dba_segments where owner='AWD_COMP' and segment_name='TRANS_AWD';

select count(*) from dba_extents where owner='AWD_COMP' and segment_name='TRANS_AWD';


-- fix backup
/app/oracle/scripts/Rubrik/rubrik_begin_snapshot.sh 6e6263f1-45d0-43c8-a6b9-d68fe7c1f019
rm /rbkbak/ora_bpap_ch0/*
rm /rbkbak/ora_bpap_ch1/*
rm /rbkbak/ora_bpap_ch2/*
/app/oracle/scripts/Rubrik/rubrik_end_snapshot.sh 6e6263f1-45d0-43c8-a6b9-d68fe7c1f019

rman target / catalog rman@rman12p
crosscheck copy of database;
list expired copy of database;
delete expired copy of database;
list copy of database;
specification does not match any datafile copy in the repository

crosscheck backup;
list expired backup of database;
delete expired backup of database;
list backup of database;
specification does not match any datafile copy in the repository

re-run full backup job
BACKUP_BPAP_PROD_DAILY_HOT_FULL_RUBRIK1


############
# cigfdsp  #
# ECI_DSP1 #
# 10/16    #
############

EXTRACT    ECI_DSP1  Last Started 2018-10-16 07:34   Status RUNNING
Checkpoint Lag       04:12:21 (updated 00:00:00 ago)
Process ID           49218062
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-10-16 04:54:48
                     SCN 2555.45759325 (10973687200605)

-- uxp33
select al.sequence#
from v$archived_log al, dba_capture cp
where cp.CAPTURED_SCN between al.FIRST_CHANGE# and al.NEXT_CHANGE#-1;
2331725

select sequence# from v$archived_log where &what_scn between FIRST_CHANGE# and NEXT_CHANGE#-1;
2332134

> ll /oragg/cigfdsp_arch
-rw-r-----    1 oracle   dba       248528384 Oct 16 03:32 arch1_2331725_639811471.dbf

> df -g /move/*cigfdsp*
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
/dev/cigfdsparch01lv    153.62    117.56   24%      192     1% /move/cigfdsp_arch01
/dev/cigfdsp_trail01    300.00    182.66   40%      101     1% /move/cigfdsp_trail01

-- BACKUP_CIGFDSP_PROD_HOT_ARCHIVELOG_GG (10/16 8:50 AM)
RMAN-08137: WARNING: archived log not deleted, needed for standby or upstream capture process
archived log file name=/oragg/cigfdsp_arch/arch1_2331110_639811471.dbf thread=1 sequence=2331110

-- report (9:13)
2018-10-16 09:11:12  INFO    OGG-06509  Using the following key columns for source table DM_AGT_DIST.RPT_INFRC_POLCY_HOLDR: CTRCT_KEY.
            44419454 records processed as of 2018-10-16 09:11:25 (rate 49354,delta 31140)
2018-10-16 09:12:19  INFO    OGG-01026  Rolling over remote file /move/cigfdsp_trail01/trail/ea000000504.
...
2018-10-16 09:13:29  INFO    OGG-01026  Rolling over remote file /move/cigfdsp_trail01/trail/ea000000505.

EXTRACT    PCI_DSP1  Last Started 2018-10-16 00:08   Status RUNNING
Checkpoint Lag       00:00:00 (updated 00:00:09 ago)
Process ID           33096366
Log Read Checkpoint  File /move/cigfdsp_trail01/trail/ea000000508
                     2018-10-16 09:16:31.000000  RBA 114620809

					 
############
# abcinfop #
# EAB_FOP1 #
# 10/17    #
############

> df -g /move/*abcinfop*
Filesystem    GB blocks      Free %Used    Iused %Iused Mounted on
/dev/abcinfoparch01l     57.00     29.27   49%       38     1% /move/abcinfop_arch01

-- BACKUP_ARCHIVELOG_CORRECTIVE_ACTION
since 10/12 has run 45 times!!!


EXTRACT    EAB_FOP1  Last Started 2018-10-11 22:26   Status RUNNING
Checkpoint Lag       00:00:07 (updated 00:00:00 ago)
Process ID           32637176
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-10-17 14:04:27
                     SCN 2555.76542380 (10973717983660)

-- report (14:06)
2018-10-17 06:06:53  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/abcinfop/ea000000003.
             4215196 records processed as of 2018-10-17 06:07:27 (rate 9,delta 1736)
             4797680 records processed as of 2018-10-17 06:12:28 (rate 11,delta 1937)
2018-10-17 06:43:00  INFO    OGG-01738  BOUNDED RECOVERY: CHECKPOINT: for object pool 1: p32637176_extr: start=SeqNo: 738182, RBA: 346480, SCN: 2555.68480915 (10973709922195), Timestamp: 2018-10-17 06:42:51.000000, Thread: 1, end=SeqNo: 738182, RBA: 346480, SCN: 2555.68480915 (10973709922195), Timestamp: 2018-10-17 06:42:51.000000, Thread: 1.
2018-10-17 10:43:27  INFO    OGG-01738  BOUNDED RECOVERY: CHECKPOINT: for object pool 1: p32637176_extr: start=SeqNo: 738281, RBA: 615048, SCN: 2555.72666955 (10973714108235), Timestamp: 2018-10-17 10:43:18.000000, Thread: 1, end=SeqNo: 738281, RBA: 615048, SCN: 2555.72666955 (10973714108235), Timestamp: 2018-10-17 10:43:18.000000, Thread: 1.

stop EAB_FOP1
start EAB_FOP1

2018-10-17 14:07:47  INFO    OGG-00547  Increasing thread stack size from 196608 to 2097152.


-- old report
2018-10-11 22:26:48  INFO    OGG-00547  Increasing thread stack size from 196608 to 2097152.
2018-10-12 02:26:51  INFO    OGG-01738  BOUNDED RECOVERY: CHECKPOINT: for object pool 1: p32637176_extr: start=SeqNo: 735640, RBA: 427396, SCN: 2554.4101767521 (10973448241505), Timestamp: 2018-10-12 02:26:45.000000, Thread: 1, end=SeqNo: 735640, RBA: 427396, SCN: 2554.4101767521 (10973448241505), Timestamp: 2018-10-12 02:26:45.000000, Thread: 1.
...
2018-10-12 06:11:48  INFO    OGG-01026  Rolling over remote file /nomove/app/oracle/ggate/12c/1/dirdat/abcinfop/ea000000000.
             1110732 records processed as of 2018-10-12 06:12:31 (rate 1848,delta 1980)
...

SGA    COMPONENT                   CUR MB   MIN MB   MAX MB LAST_OPER_TYP CHANGED
------ ------------------------- -------- -------- -------- ------------- ---------------
SGA    DEFAULT buffer cache         5,648    5,632    6,912 SHRINK        12-OCT 00:52:05
       java pool                       80       80      112 SHRINK        06-MAY 07:21:52
       large pool                     160      112      160 GROW          29-APR 04:27:52
       shared pool                    944      848    1,232 GROW          12-OCT 00:52:05
       streams pool                 1,232       64    1,232 GROW          09-SEP 22:51:03
******                           -------- -------- --------
TOTAL                               8,064    6,736    9,648

-- report
2018-10-17 14:07:47  INFO    OGG-00547  Increasing thread stack size from 196608 to 2097152.
2018-10-17 18:07:49  INFO    OGG-01738  BOUNDED RECOVERY: CHECKPOINT: for object pool 1: p32637176_extr: start=SeqNo: 738379, RBA: 125446824, SCN: 2555.76895967 (10973718337247), Timestamp: 2018-10-17 18:07:39.000000, Thread: 1, end=SeqNo: 738379, RBA: 125446824, SCN: 2555.76895967 (10973718337247), Timestamp: 2018-10-17 18:07:39.000000, Thread: 1.


-- 10/18 8:43
EXTRACT    EAB_FOP1  Last Started 2018-10-17 14:07   Status RUNNING
Checkpoint Lag       00:00:10 (updated 00:00:08 ago)
Process ID           9634448
Log Read Checkpoint  Oracle Integrated Redo Logs
                     2018-10-18 08:42:51
                     SCN 2555.77345457 (10973718786737)

					 
############
# cdsinfop #
# RCD_FOP1 #
# 10/19    #
############

Program     Status      Group       Lag at Chkpt  Time Since Chkpt
REPLICAT    RUNNING     RCD_FOP1    00:00:20      06:50:53

REPLICAT   RCD_FOP1  Last Started 2018-10-13 06:00   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:20 (updated 06:51:08 ago)
Process ID           26354
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/cdsinfop/ra000000148
                     2018-10-19 02:33:48.913126  RBA 303545394

-- report 10:10
2018-10-18 23:10:00  INFO    OGG-02232  Switching to next trail file /app/oracle/product/ggate/12c/1/dirdat/cdsinfop/ra000000148 at 2018-10-18 23:10:00.870869 due to EOF. with current RBA 999999635.
            11050176 records processed as of 2018-10-18 23:10:17 (rate 31,delta 0)
            11050177 records processed as of 2018-10-19 02:33:46 (rate 30,delta 0)

-- LXORAFINP04
set lines 150 pages 200
alter session set container=cdsinfop;
ALTER SESSION SET NLS_DATE_FORMAT='MM/DD/RR HH24:MI';
COLUMN username FORMAT A10
COLUMN program FORMAT A35
col osuser format a10
col sid format 9990
col "SER" format 99990
col "Description" format a90
SELECT s.sid, s.serial# "SER", s.username, s.osuser, s.sql_id,
decode(s.state,'WAITING','Waiting '||s.seconds_in_wait||'s for '||NVL2(q.sql_text, q.sql_text, event),q.sql_text) "Description"
FROM v$session s left outer join v$sql q on s.sql_id=q.sql_id
WHERE s.username='GGS' and s.sql_id is not null;
no rows selected

SELECT DISTINCT s.sid, s.serial# "SER", s.username, s.osuser, s.logon_time, s.program,
decode(s.state,'WAITING','Waiting '||s.seconds_in_wait||'s for '||NVL2(s.sql_id, s.sql_id, event),s.sql_id) "Description"
FROM v$session s
WHERE s.username='GGS'
ORDER BY s.logon_time, s.program;
  SID    SER USERNAME   OSUSER     LOGON_TIME     PROGRAM                             Description
----- ------ ---------- ---------- -------------- ----------------------------------- -------------------------------------------------------
  926  16607 GGS        oracle     10/13/18 06:00 replicat@lxoggp01 (TNS V1-V3)       Waiting 1s for REPL Capture/Apply: miscellaneous
    7     54 GGS        oracle     10/13/18 06:00 oracle@LXORAFINP04 (AS01)           Waiting 0s for REPL Capture/Apply: messages
  168  58101 GGS        oracle     10/16/18 02:45 oracle@LXORAFINP04 (AS09)           Waiting 0s for rdbms ipc message
    3  27202 GGS        oracle     10/17/18 02:42 oracle@LXORAFINP04 (AS08)           Waiting 0s for rdbms ipc message
  473    471 GGS        oracle     10/18/18 02:15 oracle@LXORAFINP04 (AS04)           Waiting 4s for rdbms ipc message
  618  20883 GGS        oracle     10/18/18 03:39 oracle@LXORAFINP04 (AS0A)           Waiting 0s for rdbms ipc message
 1077  26814 GGS        oracle     10/18/18 03:42 oracle@LXORAFINP04 (AS05)           Waiting 0s for rdbms ipc message
  620  10590 GGS        oracle     10/19/18 02:34 oracle@LXORAFINP04 (AS06)           Waiting 27261s for library cache pin

select APPLY_NAME, STATUS from DBA_APPLY;

-- loxggp01
-- logdump
open /app/oracle/product/ggate/12c/1/dirdat/cdsinfop/ra000000148
ghdr on
detail data
pos 303545394
n

2018/10/19 02:33:55.999.176 Insert               Len    47 RBA 303545394
Name: CDSINFO.AP_BSTRN_DETAIL  (TDR Index: 8)

2018/10/19 02:33:55.999.176 Insert               Len   256 RBA 303545562
Name: CDSINFO.BSTRN_DETAIL  (TDR Index: 9)

2018/10/19 02:33:55.999.176 Insert               Len    58 RBA 303545898
Name: CDSINFO.BU_SETS  (TDR Index: 10)

-- params
MAP CDSINFO.AP_BSTRN_DETAIL, TARGET CDSINFO.AP_BSTRN_DETAIL, KEYCOLS (TRAN_ID, TRAN_DETAIL_ID);
MAP CDSINFO.BSTRN_DETAIL, TARGET CDSINFO.BSTRN_DETAIL, KEYCOLS (TRAN_ID, TRAN_DETAIL_ID);
MAP CDSINFO.BU_SETS, TARGET CDSINFO.BU_SETS, KEYCOLS (BU_SET_ID);

kill RCD_FOP1
mv ./dirpcs/RCD_FOP1.pcr /tmp

alter system kill session '926,16607';

start RCD_FOP1

  SID    SER USERNAME   OSUSER           LOGON_TIME     PROGRAM         Description
----- ------ ---------- ---------------- -------------- --------------- -----------------------------------
  168  45956 GGS        oracle           10/19/18 10:26 replicat@lxoggp 743b6nwu2uvcm
                                                        01 (TNS V1-V3)

REPLICAT   RCD_FOP1  Last Started 2018-10-19 10:26   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:00 ago)
Process ID           67215
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/cdsinfop/ra000000148
                     2018-10-19 10:27:03.989173  RBA 308034796

-- 11:27
REPLICAT   RCD_FOP1  Last Started 2018-10-19 10:26   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:06 ago)
Process ID           67215
Log Read Checkpoint  File /app/oracle/product/ggate/12c/1/dirdat/cdsinfop/ra000000152
                     2018-10-19 04:01:54.822521  RBA 281352177

					 
SELECT con_id, owner,table_name,compress_for ,num_rows  from cdb_tables where compression='ENABLED' order by con_id, owner, table_name ;


###############
# cdsinfop    #
# LXORAFINP04 #
# 10/27       #
###############

SELECT
  CDSINFO.AP_BSTRN_HEADER.COMPANY_CODE/*,
  Trim(CDSINFO.AP_BSTRN_HEADER.CHECK_NUMBER),
  CDSINFO.AP_BSTRN_HEADER.CHECK_DATE,
  CDSINFO.AP_BSTRN_HEADER.CHECK_AMT,
  CDSINFO.AP_BSTRN_HEADER.VENDOR_NAME1,
  CDSINFO.AP_DESCRIPTION.CHECK_NOTES,
  CDSINFO.AP_BSTRN_HEADER.CHECK_RECON_STATUS,
  CDSINFO.AP_BSTRN_HEADER.CHECK_RECON_DATE,
  Trim(CDSINFO.BSTRN_DETAIL.ACCOUNT_NUMBER),
  CDSINFO.BSTRN_DETAIL.CONVERTED_AMOUNT*/
FROM
  CDSINFO.AP_BSTRN_HEADER,
  CDSINFO.AP_DESCRIPTION,
  CDSINFO.BSTRN_DETAIL
WHERE
  ( CDSINFO.AP_BSTRN_HEADER.TRAN_ID=CDSINFO.AP_DESCRIPTION.TRAN_ID(+)  )
  AND  ( CDSINFO.AP_BSTRN_HEADER.TRAN_ID=CDSINFO.BSTRN_DETAIL.TRAN_ID  )
  AND  
  (
   (
    (
     CDSINFO.AP_BSTRN_HEADER.CHECK_DATE  >=  '2017/01/01 00:00:00'
     AND
     CDSINFO.AP_BSTRN_HEADER.COMPANY_CODE  IN  ('01','BLC','225')
     AND
     Trim(CDSINFO.AP_BSTRN_HEADER.CHECK_NUMBER)  =  '0098387839'
    )
    OR
    (
     CDSINFO.AP_BSTRN_HEADER.CHECK_DATE  >=  '2017/01/01 00:00:00'
     AND
     CDSINFO.AP_BSTRN_HEADER.COMPANY_CODE  IN  ('01','BLC','225')
     AND
     CDSINFO.AP_DESCRIPTION.CHECK_NOTES  LIKE  '%950175742%'
     AND
     CDSINFO.AP_BSTRN_HEADER.CHECK_AMT  =  3100
    )
   )
   AND
   ( ( CDSINFO.AP_BSTRN_HEADER.COMPANY_CODE )  != 'CHH'  )
  );
  
AIX:			ORA-01861: literal does not match format string
Linux:			ORA-01843: not a valid month
App Team Linux:	ORA-01861: literal does not match format string (BO and SQL Developer; same error in lower tiers)

sho parameter date
NAME                                 TYPE        AIX		LINUX
------------------------------------ ----------- ---------- -------------------
nls_date_format                      string                 MM/DD/YYYY

select name, value from v$parameter where name='nls_date_format';
NAME                                                                             AIX		LINUX
-------------------------------------------------------------------------------- ---------- -----------------------------
nls_date_format																				MM/DD/YYYY

select name, value from v$spparameter where name='nls_date_format';
NAME                                                                             AIX	LINUX-PDB	LINUX-CDB
-------------------------------------------------------------------------------- ------ ----------- ---------------------
nls_date_format																						MM/DD/YYYY


set lines 150 pages 200
col parameter format a30
col value format a40
select * from nls_database_parameters order by 1;
PARAMETER                      VALUE
------------------------------ ----------------------------------------
NLS_CHARACTERSET               US7ASCII
NLS_NCHAR_CHARACTERSET         AL16UTF16
NLS_DATE_FORMAT                DD-MON-RR
NLS_TIMESTAMP_FORMAT           DD-MON-RR HH.MI.SSXFF AM
NLS_TIMESTAMP_TZ_FORMAT        DD-MON-RR HH.MI.SSXFF AM TZR
NLS_TIME_FORMAT                HH.MI.SSXFF AM
NLS_TIME_TZ_FORMAT             HH.MI.SSXFF AM TZR
(all same on both sides)

select * from nls_instance_parameters order by 1;
PARAMETER                      AIX			LINUX
------------------------------ ------------ ---------------------------
NLS_DATE_FORMAT								MM/DD/YYYY

select * from nls_session_parameters order by 1;
PARAMETER                      AIX			LINUX
------------------------------ ------------ ---------------------------
NLS_DATE_FORMAT                DD-MON-RR	MM/DD/YYYY


-- lxorafinp04 (pdb)
alter session set nls_date_format='YYYY/MM/DD HH24:MI:SS';
PARAMETER                      VALUE
------------------------------ ----------------------------------------
NLS_DATE_FORMAT                YYYY/MM/DD HH24:MI:SS

(query works)

-- CDB$ROOT
alter session reset nls_date_format;
Session altered.

alter session reset nls_date_format scope=both;
ORA-00933: SQL command not properly ended

select name, value from v$parameter where name='nls_date_format';
NAME                                                                             VALUE
-------------------------------------------------------------------------------- ----------------------------------------
nls_date_format

alter session reset nls_date_format scope=spfile;
ORA-00933: SQL command not properly ended

create pfile='/database/Eccdsinfop/ccdsinfop_admn01/admin/pfile/initccds_fop.ora.20181027' from spfile;

cp /database/Eccdsinfop/ccdsinfop_admn01/admin/pfile/spfileccds_fop.ora /database/Eccdsinfop/ccdsinfop_admn01/admin/pfile/spfileccds_fop.ora.20181027
cp /database/Eccdsinfop/ccdsinfop_admn01/admin/pfile/initccds_fop.ora.20181027 /database/Eccdsinp/ccdsinfop_admn01/admin/pfile/initccds_fop.ora.20181027.bkp
vi /database/Eccdsinfop/ccdsinfop_admn01/admin/pfile/initccds_fop.ora.20181027

shutdown immediate
startup pfile='/database/Eccdsinfop/ccdsinfop_admn01/admin/pfile/initccds_fop.ora.20181027'
create spfile='/database/Eccdsinfop/ccdsinfop_admn01/admin/pfile/spfileccds_fop.ora' from pfile='/database/Eccdsinfop/ccdsinfop_admn01/admin/pfile/initccds_fop.ora.20181027';
shutdown immediate
startup

set lines 150 pages 200
col parameter format a30
col name format a30
col value format a40
select name, value from v$spparameter where name='nls_date_format';
NAME                           VALUE
------------------------------ ----------------------------------------
nls_date_format


############
# abcinfop #
# RAB_FOP2 #
# 10/27    #
############

REPLICAT   RAB_FOP2  Last Started 2018-10-27 20:01   Status RUNNING
INTEGRATED
Checkpoint Lag       13:55:14 (updated 03:00:11 ago)
Process ID           26920
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/abcinfop/RR/ra000000000
                     2018-10-27 06:07:06.436775  RBA 258277630

-- uxp34
SET LINES 150 PAGES 1000
COLUMN username FORMAT A19
COLUMN program FORMAT A20
col osuser format a15
col sid format 9990
col "SER" format 99990
col "Description" format a48
ALTER SESSION SET NLS_DATE_FORMAT='MM/DD/RR HH24:MI';
SELECT DISTINCT s.sid, s.serial# "SER", s.username, s.osuser, s.logon_time, s.program,
decode(s.state,'WAITING','Waiting '||s.seconds_in_wait||'s for '||NVL2(q.sql_text, q.sql_text, event),q.sql_text) "Description"
FROM v$session s left outer join v$sql q on s.sql_id=q.sql_id
WHERE s.username='GGS' and s.sql_id is not null
ORDER BY "Description" DESC, s.osuser, s.username, s.program, s.sid;
no rows selected

stop RAB_FOP2
start RAB_FOP2

REPLICAT   RAB_FOP2  Last Started 2018-10-27 23:11   Status RUNNING
INTEGRATED
Checkpoint Lag       00:00:00 (updated 00:00:31 ago)
Process ID           39153
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/abcinfop/RR/ra000000000
                     2018-10-27 09:17:39.545282  RBA 473449031

					 
############
# cigfdsp  #
# RCI_DSP1 #
# 10/27    #
############

REPLICAT   RCI_DSP1  Last Started 2018-10-27 23:01   Status RUNNING
INTEGRATED
Checkpoint Lag       03:28:22 (updated 00:02:06 ago)
Process ID           38393
Log Read Checkpoint  File /app/oracle/product/ggate/11g/1/dirdat/cigfdsp/ra000003117
                     2018-10-27 19:42:51.779982  RBA 916138931

					 
##########
# fnp8p  #
# export #
# 10/28  #
##########

set lines 150 pages 200
col osuser format a15
col sid format 9990
col "Progress" format a102
SELECT s.sid, s.osuser, s.program
      ,to_char(l.start_time,'DD-MON-YY HH24MI') "Time Started"
      ,l.sofar " Work Done"
      ,l.totalwork "Total Work"
      ,RPAD(DECODE(l.totalwork,0,'N/A',ROUND(100*l.sofar/l.totalwork,2)||'%'),12) "% Complete"
      ,TO_CHAR(SYSDATE+(l.time_remaining/24/3600),'DD-MON-YY HH24MI') "Estimated Finish Time"
      ,RPAD(RPAD('<',DECODE(l.totalwork,0,0,ROUND(100*l.sofar/l.totalwork,2)),'|'),101)||'>' "Progress"
FROM v$session_longops l JOIN v$session s on l.sid=s.sid
WHERE l.sofar<>l.totalwork and s.status='ACTIVE'
ORDER BY l.start_time desc;
  SID OSUSER          PROGRAM                                          Time Started    Work Done Total Work % Complete   Estimated Fini
----- --------------- ------------------------------------------------ -------------- ---------- ---------- ------------ --------------
Progress
------------------------------------------------------------------------------------------------------
 1276 oracle          oracle@uxorap01 (DM00)                           27-OCT-18 2323     231275     654379 35.34%       28-OCT-18 1639
<||||||||||||||||||||||||||||||||||                                                                  >

 1378 oracle          oracle@uxorap01 (DW01)                           27-OCT-18 2323   26964467   47275063 57.04%       28-OCT-18 1006
<||||||||||||||||||||||||||||||||||||||||||||||||||||||||                                            >


select count(*) from P8ROS.CBRTEMPDATA;
0

select count(*) from P8JRNL.DOCVERSION;
AIX		332,712,368
Linux	331,885,589

desc P8JRNL.DOCVERSION
 Name                                                                                Null?    Type
 ----------------------------------------------------------------------------------- -------- --------------------------------------------------------
 OBJECT_ID                                                                           NOT NULL RAW(16)
 OBJECT_CLASS_ID                                                                     NOT NULL RAW(16)
 SECURITY_ID                                                                         NOT NULL RAW(16)
 EPOCH_ID                                                                            NOT NULL NUMBER(10)
 HOME_ID                                                                                      RAW(16)
 CREATE_DATE                                                                                  TIMESTAMP(6)
 MODIFY_DATE                                                                                  TIMESTAMP(6)
 COMPONENT_TYPES_2                                                                            BLOB
 RETRIEVAL_NAMES_2                                                                            BLOB
 CONTENT_INFO_2                                                                               BLOB
 LOCK_SID                                                                                     BLOB
 RESERVATION_OWNER_SID                                                                        BLOB
 CONTENT_REFERRAL_BLOB                                                                        BLOB
 U42_PUBLICATIONINFO                                                                          BLOB
 U6FF1_ICCATTACHMENTCORRELATION                                                               BLOB

-- lxorabpap04
> df -h /database/Efnp8p/*fnp8p0*
Filesystem                        Size  Used Avail Use% Mounted on
/dev/mapper/fnp8pvg01-fnp8p01_lv  2.6T  2.1T  462G  82% /database/Efnp8p/fnp8p01
/dev/mapper/fnp8pvg01-fnp8p02_lv  306G  223G   68G  77% /database/Efnp8p/fnp8p02
/dev/mapper/fnp8pvg01-fnp8p03_lv  586G  400G  157G  72% /database/Efnp8p/fnp8p03

set lines 150 pages 200
col "OBJECT" format a40
col "REF_OBJ" format a30
select owner||'.'||name "OBJECT", type, referenced_owner||'.'||referenced_name "REF_OBJ",
  referenced_type "REFTYPE", dependency_type
from DBA_DEPENDENCIES where referenced_name='&what_name' and referenced_owner='&what_owner'
order by type, object;
no dependencies

col segment_name format a40
col "MB" format 9,999,990
break on report
compute sum label "TOTAL" of "MB" on report;
select seg.segment_name, seg.segment_type, (seg.bytes/1024/1024) "MB"
from dba_segments seg join dba_tables tab on seg.segment_name=tab.table_name and seg.owner=tab.owner
where seg.segment_type like '%TABLE%' and tab.table_name='DOCVERSION' and tab.owner='P8JRNL'
union all
select seg.segment_name, seg.segment_type, (seg.bytes/1024/1024) "MB"
from dba_segments seg join dba_lobs lob on seg.segment_name=lob.segment_name and seg.owner=lob.owner
where lob.table_name='DOCVERSION' and lob.owner='P8JRNL'
union all
select seg.segment_name, seg.segment_type, (seg.bytes/1024/1024) "MB"
from dba_segments seg join dba_indexes ind on seg.segment_name=ind.index_name and seg.owner=ind.owner
where seg.segment_type like '%INDEX%' and ind.table_name='DOCVERSION' and ind.owner='P8JRNL'
order by segment_type, segment_name;
DOCVERSION                               TABLE                 236,398
                                                            ----------
TOTAL                                                          448,801


select tablespace_name from dba_tables where owner='P8JRNL' and table_name='DOCVERSION';
P8JRNL_DATA

FILE_ID FILE_NAME                                                                           MB      MaxMB AUT
------- --------------------------------------------------------------------------- ---------- ---------- ---
    126 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data02.dbf                              10,000     10,000 NO
    127 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data03.dbf                              10,000     10,000 NO
    128 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data04.dbf                              10,000     10,000 NO
    129 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data05.dbf                              10,000     10,000 NO
    130 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data06.dbf                              10,000     10,000 NO
    131 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data07.dbf                              10,000     10,000 NO
    132 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data08.dbf                              10,000     10,000 NO
    133 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data09.dbf                              10,000     10,000 NO
    134 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data10.dbf                              10,000     10,000 NO
    135 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data11.dbf                              10,000     10,000 NO
    136 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data12.dbf                              10,000     10,000 NO
    137 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data13.dbf                              10,000     10,000 NO
    138 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data14.dbf                              10,000     10,000 NO
    139 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data15.dbf                              10,000     10,000 NO
    140 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data16.dbf                              10,000     10,000 NO
    141 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data17.dbf                              10,000     10,000 NO
    151 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data37.dbf                                 200        200 NO
    153 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data42.dbf                                 800        800 NO
    166 /database/Efnp8p/fnp8p01/oradata/p8jrnl_data57.dbf                                 100        100 NO
    167 /database/Efnp8p/fnp8p02/oradata/p8jrnl_data18.dbf                              10,240     10,240 NO
    168 /database/Efnp8p/fnp8p02/oradata/p8jrnl_data20.dbf                               8,000      8,000 NO
    169 /database/Efnp8p/fnp8p02/oradata/p8jrnl_data21.dbf                                 500        500 NO
TOTAL                                                                                  831,530    839,530
(files on all mount points)

ALTER DATABASE DATAFILE 151 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M;
ALTER DATABASE DATAFILE 153 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M;
ALTER DATABASE DATAFILE 166 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M;
ALTER DATABASE DATAFILE 169 AUTOEXTEND ON NEXT 256M MAXSIZE 32000M;
ALTER TABLESPACE P8JRNL_DATA ADD DATAFILE '/database/Efnp8p/fnp8p03/oradata/p8jrnl_data58.dbf' SIZE 256M AUTOEXTEND ON NEXT 256M MAXSIZE 32000M;
ALTER TABLESPACE P8JRNL_DATA ADD DATAFILE '/database/Efnp8p/fnp8p03/oradata/p8jrnl_data59.dbf' SIZE 256M AUTOEXTEND ON NEXT 256M MAXSIZE 32000M;
ALTER TABLESPACE P8JRNL_DATA ADD DATAFILE '/database/Efnp8p/fnp8p03/oradata/p8jrnl_data60.dbf' SIZE 256M AUTOEXTEND ON NEXT 256M MAXSIZE 32000M;
ALTER TABLESPACE P8JRNL_DATA ADD DATAFILE '/database/Efnp8p/fnp8p03/oradata/p8jrnl_data61.dbf' SIZE 256M AUTOEXTEND ON NEXT 256M MAXSIZE 32000M;

sqlplus system
create public database link get_lob
using '(DESCRIPTION = (ADDRESS_LIST = (ADDRESS= (COMMUNITY = tcp.world) (PROTOCOL = TCP)(HOST = uxorap01.conseco.com)(PORT = 1521))) (CONNECT_DATA = (SID = fnp8p)))';

set timing on
create table P8JRNL.DOCVERSION2 as select /*+ parallel (P8JRNL.DOCVERSION, 10) */ * from P8JRNL.DOCVERSION@get_lob;


*** 2nd GG process ***

-- uxorap01
mkdir /oragg/trail/fnp8p2

cp /nomove/app/oracle/ggate/12c/1/dirprm/EFNP8P1.prm /nomove/app/oracle/ggate/12c/1/dirprm/EDOCVER1.prm
cp /nomove/app/oracle/ggate/12c/1/dirprm/PFNP8P1.prm /nomove/app/oracle/ggate/12c/1/dirprm/PDOCVER1.prm

vi /nomove/app/oracle/ggate/12c/1/dirprm/EDOCVER1.prm
EXTRACT EDOCVER1
DISCARDFILE ./dirrpt/EDOCVER1.dsc, APPEND, MEGABYTES 500
ExtTrail /oragg/trail/fnp8p2/ea
TABLE P8JRNL.DOCVERSION;
TABLE P8JRNL.CONTENTQUEUE;
TABLE P8JRNL.INDEXREQUESTS;
(remove all other tables and sequences)

vi /nomove/app/oracle/ggate/12c/1/dirprm/PDOCVER1.prm
EXTRACT PDOCVER1
RMTTRAIL /oraggrep/fnp8p2/ra
TABLE P8JRNL.DOCVERSION;
TABLE P8JRNL.CONTENTQUEUE;
TABLE P8JRNL.INDEXREQUESTS;
(remove other tables and sequences)

cp /oragg/datapump/fnp8p/expdp_fnp8p_tables.par /oragg/datapump/fnp8p/expdp_fnp8p_docversion.par
vi /oragg/datapump/fnp8p/expdp_fnp8p_docversion.par
DUMPFILE=fnp8p_docversion_%U.dmp
LOGFILE=fnp8p_docversion.log
PARALLEL=8
TABLES=P8JRNL.CONTENTQUEUE,P8JRNL.INDEXREQUESTS,P8JRNL.DOCVERSION


cd /nomove/app/oracle/ggate/12c/1
ggsci
dblogin userid GGS@fnp8p
delete extract EDOCVER1
delete extract PDOCVER1
add extract EDOCVER1, integrated tranlog, begin now
add exttrail /oragg/trail/fnp8p2/ea, extract EDOCVER1, megabytes 1000
add extract PDOCVER1, exttrailsource /oragg/trail/fnp8p2/ea
add rmttrail /oraggrep/fnp8p2/ra, extract PDOCVER1, megabytes 1000
register extract EDOCVER1 database
start EDOCVER1
start PDOCVER1

sqlplus / as sysdba
set numf 99999999999990
select CURRENT_SCN from v$database;

expdp \"/ as sysdba\" flashback_scn=<CURRENT_SCN> parfile=/oragg/datapump/fnp8p/expdp_fnp8p_docversion.par


-- lxorabpap04
cp /database/Efnp8p/fnp8p_admn01/scripts/impdp_fnp8p_tables.par /database/Efnp8p/fnp8p_admn01/scripts/impdp_fnp8p_docversion.par
vi /database/Efnp8p/fnp8p_admn01/scripts/impdp_fnp8p_docversion.par
DIRECTORY=CNO_MIGRATE
DUMPFILE=fnp8p_docversion_%U.dmp
LOGFILE=impdp_fnp8p_docversion.log
TABLE_EXISTS_ACTION=REPLACE
PARALLEL=8
CLUSTER=Y
METRICS=Y

$ORACLE_HOME/bin/impdp \"system@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=LXORABPAP04.conseco.ad)(PORT=1521))(CONNECT_DATA=(SERVICE_NAME=fnp8p)))\" parfile=/database/Efnp8p/fnp8p_admn01/scripts/impdp_fnp8p_docversion.par


-- lxoggp01
mkdir /oraggrep/fnp8p2

cp /app/oracle/product/ggate/11g/1/dirprm/RFNP8P1.prm /app/oracle/product/ggate/11g/1/dirprm/RDOCVER1.prm

vi /app/oracle/product/ggate/11g/1/dirprm/RDOCVER1.prm
REPLICAT RDOCVER1
DISCARDFILE ./dirrpt/RDOCVER1.dsc, APPEND, MEGABYTES 500
MAP P8JRNL.DOCVERSION, TARGET P8JRNL.DOCVERSION;
MAP P8JRNL.CONTENTQUEUE, TARGET P8JRNL.CONTENTQUEUE;
MAP P8JRNL.INDEXREQUESTS, TARGET P8JRNL.INDEXREQUESTS;
(remove other tables)

cd /app/oracle/product/ggate/11g/1
ggsci
DBLOGIN USERID ggs@fnp8p
delete replicat RDOCVER1
ADD CHECKPOINTTABLE GGS.GGS_HEARTBEAT_DOCVER
add replicat RDOCVER1, exttrail /oraggrep/fnp8p2/ra, CHECKPOINTTABLE GGS.GGS_HEARTBEAT_DOCVER
start replicat RDOCVER1 aftercsn <CURRENT_SCN>


############
# documkrp #
# EDO_KRP1 #
# 1/14/19  #
############

-- previous error
2018-06-29 18:09:58  ERROR   OGG-02077  Extract encountered a read error in the asynchronous reader thread and is abending: Error code 600, error message: ORA-00600: internal error code, arguments: [knlogcPackLobXMLInfo:1], [48488], [203879], [2], [146], [], [], [], [], [], [], [].

-- extract report
2019-01-14 01:08:02  ERROR   OGG-02077  Extract encountered a read error in the asynchronous reader thread and is abending: Error code 600, error message: ORA-00600: internal error code, arguments: [knlogcPackLobXMLInfo:1], [60126], [203911], [1], [146], [], [], [], [], [], [], [].


-- Old SR 3-17814631261 : Oracle internal error ORA-600 in Production database
Bug 25953857 - INTEGRATED EXTRACT FAILING WITH ORA-600 [KNLOGCPACKLOBXMLINFO:1], [32768] (Doc ID 25953857.8)
Apply Patch 25953857 

-- lsinventory
Interim patches (4) :

Patch  26950793     : applied on Sat Nov 03 21:01:20 EDT 2018
Unique Patch ID:  21630789
   Created on 14 Dec 2017, 23:33:30 hrs PST8PDT
   Bugs fixed:
     26354017, 21893235, 18125929, 19781326, 19601228, 12668795, 20524085
     19403858, 18086801, 16854386, 21612959, 20563314, 18705484, 16674686
     20425790, 20390564, 19032777, 21275255, 17783445, 19943771, 18973548
     25953857, 21820934, 18411336, 18673090, 19768226, 16233738, 17030189
     18856106, 19693090, 21227138, 18492302, 19831647, 12897813, 19563300
     20914870, 19587324, 13254780, 18676416, 21834568, 19794897, 26744595
     17208934, 17031322, 14705949, 19060015, 19277336, 19455741, 21764119
     17785870, 20631846, 22185234, 20023340, 20647412, 19440386, 21281961
     17722535, 20926021, 20686773, 17621643, 18662619, 19563715, 21516611
     19442102, 14312810, 20672075, 21897746, 21534893, 2990912, 19644859
     19175543, 17644091, 20394750, 21506778, 19306797, 18819257
   This patch overlays patches:
     22502456
   This patch needs patches:
     22502456
   as prerequisites

-- uxorap02
select to_char(action_time,'DD-MON-YY') "ACTION_TIME", action, version, bundle_series, comments
from registry$history order by action_time desc;
ACTION_TIM ACTION             VERSION                        BUNDLE_SERIES                  COMMENTS
---------- ------------------ ------------------------------ ------------------------------ ----------------------------------------
22-JUN-14  APPLY              11.2.0.2                       PSU                            PSU 11.2.0.2.12
28-AUG-16  APPLY              11.2.0.4                       PSU                            PSU 11.2.0.4.160419
28-AUG-16  APPLY                                                                            Patch 22674697 applied
28-AUG-16  APPLY              11.2.0.4.160419OJVMPSU                                        OJVM PSU post-install
28-AUG-16  jvmpsu.sql         11.2.0.4.160419OJVMPSU                                        RAN jvmpsu.sql
14-FEB-16  APPLY              11.2.0.4                       PSU                            PSU 11.2.0.4.8
14-FEB-16  UPGRADE            11.2.0.4.0                                                    Upgraded from 11.2.0.2.0
14-FEB-16  VIEW INVALIDATE                                                                  view invalidation
30-JUL-17  APPLY                                                                            Patch 24491261 applied
03-NOV-18  APPLY                                                                            Patch 26950793 applied

set lines 150 pages 200
break on report;
compute sum label "TOTAL" of "GB" on report;
col column_name format a30
select a.owner, a.table_name, a.column_name, a.index_name, round(b.bytes/1024/1024/1024,2) GB
from dba_lobs a, dba_segments b
where a.segment_name=b.segment_name and a.owner not in
('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS','GGTEST')
and a.SECUREFILE='YES'
order by 1,2,3;

TOTAL = 512.17 GB
251 rows selected.


select b.owner, count(b.segment_name) "SEGMENTS", round(sum(b.bytes)/1024/1024/1024,2) GB
from dba_segments b
where b.owner not in
('GGS','ANONYMOUS','APEX_030200','APEX_040200','APPQOSSYS','AUDSYS','AUTODDL','CTXSYS','DB_BACKUP','DBAQUEST','DBSNMP','DMSYS','DVF','DVSYS','EXFSYS','FLOWS_FILES','GSMADMIN_INTERNAL','INSIGHT','LBACSYS','MDSYS','OJVMSYS','OLAPSYS','ORDDATA','ORDSYS','OUTLN','RMAN','SI_INFORMTN_SCHEMA','SYS','SYSTEM','WMSYS','XDB','XS$NULL','DIP','ORACLE_OCM','ORDPLUGINS','OPS$ORACLE','UIMMONITOR','AUTODML','ORA_QUALYS_DB','APEX_PUBLIC_USER','GSMCATUSER','SPATIAL_CSW_ADMIN_USR','SPATIAL_WFS_ADMIN_USR','SYSBACKUP','SYSDG','SYSKM','SYSMAN','MGMT_USER','MGMT_VIEW','OWB$CLIENT','OWBSYS','TRCANLZR','GSMUSER','MDDATA','PDBADMIN','OWBSYS_AUDIT','TSMSYS','GGTEST')
and b.segment_name not in
(select a.segment_name from dba_lobs a)
group by b.owner order by 1;
OWNER                            SEGMENTS         GB
------------------------------ ---------- ----------
DOCADMP                                 8          0
ODEE_1                                184       3.55
ODEE_10                               182        .94
ODEE_2                                182        .21
ODEE_20                               184        .03
ODEE_3                                182        .81
ODEE_4                                182       4.55
ODEE_5                                182        .09
ODEE_6                                155        .01
ODEE_7                                182          5
ODEE_8                                182        .03
ODEE_9                                182        .35
ODEE_ADMIN                             67        .07
                                          ----------
TOTAL                                          15.64
